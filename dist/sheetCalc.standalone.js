this.j$=this.jStat=function(a,b){function f(b,c){var d=b>c?b:c;return a.pow(10,17-~~(a.log(d>0?d:-d)*a.LOG10E))}function h(a){return e.call(a)==="[object Function]"}function i(a){return typeof a=="number"&&a===a}function j(a){return c.apply([],a)}function k(){return new k._init(arguments)}function l(){return 0}function m(){return 1}function n(a,b){return a===b?1:0}var c=Array.prototype.concat,d=Array.prototype.slice,e=Object.prototype.toString,g=Array.isArray||function(b){return e.call(b)==="[object Array]"};k.fn=k.prototype,k._init=function(b){var c;if(g(b[0]))if(g(b[0][0])){h(b[1])&&(b[0]=k.map(b[0],b[1]));for(c=0;c<b[0].length;c++)this[c]=b[0][c];this.length=b[0].length}else this[0]=h(b[1])?k.map(b[0],b[1]):b[0],this.length=1;else if(i(b[0]))this[0]=k.seq.apply(null,b),this.length=1;else{if(b[0]instanceof k)return k(b[0].toArray());this[0]=[],this.length=1}return this},k._init.prototype=k.prototype,k._init.constructor=k,k.utils={calcRdx:f,isArray:g,isFunction:h,isNumber:i,toVector:j},k.extend=function(b){var c,d;if(arguments.length===1){for(d in b)k[d]=b[d];return this}for(c=1;c<arguments.length;c++)for(d in arguments[c])b[d]=arguments[c][d];return b},k.rows=function(b){return b.length||1},k.cols=function(b){return b[0].length||1},k.dimensions=function(b){return{rows:k.rows(b),cols:k.cols(b)}},k.row=function(b,c){return b[c]},k.col=function(b,c){var d=new Array(b.length);for(var e=0;e<b.length;e++)d[e]=[b[e][c]];return d},k.diag=function(b){var c=k.rows(b),d=new Array(c);for(var e=0;e<c;e++)d[e]=[b[e][e]];return d},k.antidiag=function(b){var c=k.rows(b)-1,d=new Array(c);for(var e=0;c>=0;c--,e++)d[e]=[b[e][c]];return d},k.transpose=function(b){var c=[],d,e,f,h,i;g(b[0])||(b=[b]),e=b.length,f=b[0].length;for(i=0;i<f;i++){d=new Array(e);for(h=0;h<e;h++)d[h]=b[h][i];c.push(d)}return c.length===1?c[0]:c},k.map=function(b,c,d){var e,f,h,i,j;g(b[0])||(b=[b]),f=b.length,h=b[0].length,i=d?b:new Array(f);for(e=0;e<f;e++){i[e]||(i[e]=new Array(h));for(j=0;j<h;j++)i[e][j]=c(b[e][j],e,j)}return i.length===1?i[0]:i},k.alter=function(b,c){return k.map(b,c,!0)},k.create=function(b,c,d){var e=new Array(b),f,g;h(c)&&(d=c,c=b);for(f=0;f<b;f++){e[f]=new Array(c);for(g=0;g<c;g++)e[f][g]=d(f,g)}return e},k.zeros=function(b,c){return i(c)||(c=b),k.create(b,c,l)},k.ones=function(b,c){return i(c)||(c=b),k.create(b,c,m)},k.rand=function(c,d){return i(d)||(d=c),k.create(c,d,a.random)},k.identity=function(b,c){return i(c)||(c=b),k.create(b,c,n)},k.symmetric=function(b){var c=!0,d=b.length,e,f;if(b.length!==b[0].length)return!1;for(e=0;e<d;e++)for(f=0;f<d;f++)if(b[f][e]!==b[e][f])return!1;return!0},k.clear=function(b){return k.alter(b,l)},k.seq=function(b,c,d,e){h(e)||(e=!1);var g=[],i=f(b,c),j=(c*i-b*i)/((d-1)*i),k=b,l;for(l=0;k<=c;l++,k=(b*i+j*i*l)/i)g.push(e?e(k,l):k);return g};var o=k.prototype;return o.length=0,o.push=Array.prototype.push,o.sort=Array.prototype.sort,o.splice=Array.prototype.splice,o.slice=Array.prototype.slice,o.toArray=function(){return this.length>1?d.call(this):d.call(this)[0]},o.map=function(b,c){return k(k.map(this,b,c))},o.alter=function(b){return k.alter(this,b),this},function(a){for(var b=0;b<a.length;b++)(function(a){o[a]=function(b){var c=this,d;return b?(setTimeout(function(){b.call(c,o[a].call(c))}),this):(d=k[a](this),g(d)?k(d):d)}})(a[b])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(a){for(var b=0;b<a.length;b++)(function(a){o[a]=function(b,c){var d=this;return c?(setTimeout(function(){c.call(d,o[a].call(d,b))}),this):k(k[a](this,b))}})(a[b])}("row col".split(" ")),function(a){for(var b=0;b<a.length;b++)(function(a){o[a]=new Function("return jStat(jStat."+a+".apply(null, arguments));")})(a[b])}("create zeros ones rand identity".split(" ")),k}(Math),function(a,b){function d(a,b){return a-b}function e(a,c,d){return b.max(c,b.min(a,d))}var c=a.utils.isFunction;a.sum=function g(a){var g=0,b=a.length,c;while(--b>=0)g+=a[b];return g},a.sumsqrd=function(b){var c=0,d=b.length;while(--d>=0)c+=b[d]*b[d];return c},a.sumsqerr=function(c){var d=a.mean(c),e=0,f=c.length,g;while(--f>=0)g=c[f]-d,e+=g*g;return e},a.product=function(b){var c=1,d=b.length;while(--d>=0)c*=b[d];return c},a.min=function(b){var c=b[0],d=0;while(++d<b.length)b[d]<c&&(c=b[d]);return c},a.max=function(b){var c=b[0],d=0;while(++d<b.length)b[d]>c&&(c=b[d]);return c},a.mean=function(c){return a.sum(c)/c.length},a.meansqerr=function(c){return a.sumsqerr(c)/c.length},a.geomean=function(d){return b.pow(a.product(d),1/d.length)},a.median=function(b){var c=b.length,e=b.slice().sort(d);return c&1?e[c/2|0]:(e[c/2-1]+e[c/2])/2},a.cumsum=function(b){var c=b.length,d=new Array(c),e;d[0]=b[0];for(e=1;e<c;e++)d[e]=d[e-1]+b[e];return d},a.diff=function(b){var c=[],d=b.length,e;for(e=1;e<d;e++)c.push(b[e]-b[e-1]);return c},a.mode=function(b){var c=b.length,e=b.slice().sort(d),f=1,g=0,h=0,i=[],j;for(j=0;j<c;j++)e[j]===e[j+1]?f++:(f>g?(i=[e[j]],g=f,h=0):f===g&&(i.push(e[j]),h++),f=1);return h===0?i[0]:i},a.range=function(c){return a.max(c)-a.min(c)},a.variance=function(c,d){return a.sumsqerr(c)/(c.length-(d?1:0))},a.stdev=function(d,e){return b.sqrt(a.variance(d,e))},a.meandev=function(d){var e=0,f=a.mean(d),g;for(g=d.length-1;g>=0;g--)e+=b.abs(d[g]-f);return e/d.length},a.meddev=function(d){var e=0,f=a.median(d),g;for(g=d.length-1;g>=0;g--)e+=b.abs(d[g]-f);return e/d.length},a.coeffvar=function(c){return a.stdev(c)/a.mean(c)},a.quartiles=function(c){var e=c.length,f=c.slice().sort(d);return[f[b.round(e/4)-1],f[b.round(e/2)-1],f[b.round(e*3/4)-1]]},a.quantiles=function(c,f,g,h){var i=c.slice().sort(d),j=[f.length],k=c.length,l,m,n,o,p,q;typeof g=="undefined"&&(g=3/8),typeof h=="undefined"&&(h=3/8);for(l=0;l<f.length;l++)m=f[l],n=g+m*(1-g-h),o=k*m+n,p=b.floor(e(o,1,k-1)),q=e(o-p,0,1),j[l]=(1-q)*i[p-1]+q*i[p];return j},a.percentileOfScore=function(b,c,d){var e=0,f=b.length,g=!1,h,i;d==="strict"&&(g=!0);for(i=0;i<f;i++)h=b[i],(g&&h<c||!g&&h<=c)&&e++;return e/f},a.covariance=function(c,d){var e=a.mean(c),f=a.mean(d),g=c.length,h=new Array(g),i;for(i=0;i<g;i++)h[i]=(c[i]-e)*(d[i]-f);return a.sum(h)/(g-1)},a.corrcoeff=function(c,d){return a.covariance(c,d)/a.stdev(c,1)/a.stdev(d,1)};var f=a.prototype;f.cumsum=function(b,d){var e=[],g=0,h=this;c(b)&&(d=b,b=!1);if(d)return setTimeout(function(){d.call(h,f.cumsum.call(h,b))}),this;if(this.length>1){h=b===!0?this:this.transpose();for(;g<h.length;g++)e[g]=a.cumsum(h[g]);return e}return a.cumsum(this[0],b)},function(b){for(var d=0;d<b.length;d++)(function(b){f[b]=function(d,e){var g=[],h=0,i=this;c(d)&&(e=d,d=!1);if(e)return setTimeout(function(){e.call(i,f[b].call(i,d))}),this;if(this.length>1){i=d===!0?this:this.transpose();for(;h<i.length;h++)g[h]=a[b](i[h]);return d===!0?a[b](a.utils.toVector(g)):g}return a[b](this[0],d)}})(b[d])}("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles".split(" ")),function(b){for(var d=0;d<b.length;d++)(function(b){f[b]=function(){var d=[],e=0,g=this,h=Array.prototype.slice.call(arguments);if(c(h[h.length-1])){var i=h[h.length-1],j=h.slice(0,h.length-1);return setTimeout(function(){i.call(g,f[b].apply(g,j))}),this}var i=undefined,k=function(d){return a[b].apply(g,[d].concat(h))};if(this.length>1){g=g.transpose();for(;e<g.length;e++)d[e]=k(g[e]);return d}return k(this[0])}})(b[d])}("quantiles percentileOfScore".split(" "))}(this.jStat,Math),function(a,b){a.gammaln=function(c){var d=0,e=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-0.000005395239384953],f=1.000000000190015,g,h,i;i=(h=g=c)+5.5,i-=(g+.5)*b.log(i);for(;d<6;d++)f+=e[d]/++h;return b.log(2.5066282746310007*f/g)-i},a.gammafn=function(c){var d=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],e=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,g=0,h=0,i=0,j=c,k,l,m,n,o,p;if(j<=0){n=j%1+3.6e-16;if(n)f=(j&1?-1:1)*b.PI/b.sin(b.PI*n),j=1-j;else return Infinity}m=j,j<1?l=j++:l=(j-=g=(j|0)-1)-1;for(k=0;k<8;++k)i=(i+d[k])*l,h=h*l+e[k];n=i/h+1;if(m<j)n/=m;else if(m>j)for(k=0;k<g;++k)n*=j,j++;return f&&(n=f/n),n},a.gammap=function(d,e){var f=a.gammaln(d),g=d,h=1/d,i=h,j=e+1-d,k=1/1e-30,l=1/j,m=l,n=1,o=-~(b.log(d>=1?d:1/d)*8.5+d*.4+17),p,q;if(e<0||d<=0)return NaN;if(e<d+1){for(;n<=o;n++)h+=i*=e/++g;return h*b.exp(-e+d*b.log(e)-f)}for(;n<=o;n++)p=-n*(n-d),j+=2,l=p*l+j,k=j+p/k,l=1/l,m*=l*k;return 1-m*b.exp(-e+d*b.log(e)-f)},a.factorialln=function(c){return c<0?NaN:a.gammaln(c+1)},a.factorial=function(c){return c<0?NaN:a.gammafn(c+1)},a.combination=function(d,e){return d>170||e>170?b.exp(a.combinationln(d,e)):a.factorial(d)/a.factorial(e)/a.factorial(d-e)},a.combinationln=function(c,d){return a.factorialln(c)-a.factorialln(d)-a.factorialln(c-d)},a.permutation=function(c,d){return a.factorial(c)/a.factorial(c-d)},a.betafn=function(d,e){return d<=0||e<=0?undefined:d+e>170?b.exp(a.betaln(d,e)):a.gammafn(d)*a.gammafn(e)/a.gammafn(d+e)},a.betaln=function(c,d){return a.gammaln(c)+a.gammaln(d)-a.gammaln(c+d)},a.betacf=function(c,d,e){var f=1e-30,g=1,h=d+e,i=d+1,j=d-1,k=1,l=1-h*c/i,m,n,o,p;b.abs(l)<f&&(l=f),l=1/l,p=l;for(;g<=100;g++){m=2*g,n=g*(e-g)*c/((j+m)*(d+m)),l=1+n*l,b.abs(l)<f&&(l=f),k=1+n/k,b.abs(k)<f&&(k=f),l=1/l,p*=l*k,n=-(d+g)*(h+g)*c/((d+m)*(i+m)),l=1+n*l,b.abs(l)<f&&(l=f),k=1+n/k,b.abs(k)<f&&(k=f),l=1/l,o=l*k,p*=o;if(b.abs(o-1)<3e-7)break}return p},a.gammapinv=function(d,e){var f=0,g=e-1,h=1e-8,i=a.gammaln(e),j,k,l,m,n,o,p;if(d>=1)return b.max(100,e+100*b.sqrt(e));if(d<=0)return 0;e>1?(o=b.log(g),p=b.exp(g*(o-1)-i),n=d<.5?d:1-d,l=b.sqrt(-2*b.log(n)),j=(2.30753+l*.27061)/(1+l*(.99229+l*.04481))-l,d<.5&&(j=-j),j=b.max(.001,e*b.pow(1-1/(9*e)-j/(3*b.sqrt(e)),3))):(l=1-e*(.253+e*.12),d<l?j=b.pow(d/l,1/e):j=1-b.log(1-(d-l)/(1-l)));for(;f<12;f++){if(j<=0)return 0;k=a.gammap(e,j)-d,e>1?l=p*b.exp(-(j-g)+g*(b.log(j)-o)):l=b.exp(-j+g*b.log(j)-i),m=k/l,j-=l=m/(1-.5*b.min(1,m*((e-1)/j-1))),j<=0&&(j=.5*(j+l));if(b.abs(l)<h*j)break}return j},a.erf=function(c){var d=[-1.3026537197817094,.6419697923564902,.019476473204185836,-0.00956151478680863,-0.000946595344482036,.000366839497852761,42523324806907e-18,-0.000020278578112534,-0.000001624290004647,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],e=d.length-1,f=!1,g=0,h=0,i,j,k,l;c<0&&(c=-c,f=!0),i=2/(2+c),j=4*i-2;for(;e>0;e--)k=g,g=j*g-h+d[e],h=k;return l=i*b.exp(-c*c+.5*(d[0]+j*g)-h),f?l-1:1-l},a.erfc=function(c){return 1-a.erf(c)},a.erfcinv=function(d){var e=0,f,g,h,i;if(d>=2)return-100;if(d<=0)return 100;i=d<1?d:2-d,h=b.sqrt(-2*b.log(i/2)),f=-0.70711*((2.30753+h*.27061)/(1+h*(.99229+h*.04481))-h);for(;e<2;e++)g=a.erfc(f)-i,f+=g/(1.1283791670955126*b.exp(-f*f)-f*g);return d<1?f:-f},a.ibetainv=function(d,e,f){var g=1e-8,h=e-1,i=f-1,j=0,k,l,m,n,o,p,q,r,s,t,u;if(d<=0)return 0;if(d>=1)return 1;e>=1&&f>=1?(m=d<.5?d:1-d,n=b.sqrt(-2*b.log(m)),q=(2.30753+n*.27061)/(1+n*(.99229+n*.04481))-n,d<.5&&(q=-q),r=(q*q-3)/6,s=2/(1/(2*e-1)+1/(2*f-1)),t=q*b.sqrt(r+s)/s-(1/(2*f-1)-1/(2*e-1))*(r+5/6-2/(3*s)),q=e/(e+f*b.exp(2*t))):(k=b.log(e/(e+f)),l=b.log(f/(e+f)),n=b.exp(e*k)/e,o=b.exp(f*l)/f,t=n+o,d<n/t?q=b.pow(e*t*d,1/e):q=1-b.pow(f*t*(1-d),1/f)),u=-a.gammaln(e)-a.gammaln(f)+a.gammaln(e+f);for(;j<10;j++){if(q===0||q===1)return q;p=a.ibeta(q,e,f)-d,n=b.exp(h*b.log(q)+i*b.log(1-q)+u),o=p/n,q-=n=o/(1-.5*b.min(1,o*(h/q-i/(1-q)))),q<=0&&(q=.5*(q+n)),q>=1&&(q=.5*(q+n+1));if(b.abs(n)<g*q&&j>0)break}return q},a.ibeta=function(d,e,f){var g=d===0||d===1?0:b.exp(a.gammaln(e+f)-a.gammaln(e)-a.gammaln(f)+e*b.log(d)+f*b.log(1-d));return d<0||d>1?!1:d<(e+1)/(e+f+2)?g*a.betacf(d,e,f)/e:1-g*a.betacf(1-d,f,e)/f},a.randn=function(d,e){var f,g,h,i,j,k;e||(e=d);if(d)return a.create(d,e,function(){return a.randn()});do f=b.random(),g=1.7156*(b.random()-.5),h=f-.449871,i=b.abs(g)+.386595,j=h*h+i*(.196*i-.25472*h);while(j>.27597&&(j>.27846||g*g>-4*b.log(f)*f*f));return g/f},a.randg=function(d,e,f){var g=d,h,i,j,k,l,m;f||(f=e),d||(d=1);if(e)return m=a.zeros(e,f),m.alter(function(){return a.randg(d)}),m;d<1&&(d+=1),h=d-1/3,i=1/b.sqrt(9*h);do{do l=a.randn(),k=1+i*l;while(k<=0);k=k*k*k,j=b.random()}while(j>1-.331*b.pow(l,4)&&b.log(j)>.5*l*l+h*(1-k+b.log(k)));if(d==g)return h*k;do j=b.random();while(j===0);return b.pow(j,1/g)*h*k},function(b){for(var c=0;c<b.length;c++)(function(b){a.fn[b]=function(){return a(a.map(this,function(c){return a[b](c)}))}})(b[c])}("gammaln gammafn factorial factorialln".split(" ")),function(b){for(var c=0;c<b.length;c++)(function(b){a.fn[b]=function(){return a(a[b].apply(null,arguments))}})(b[c])}("randn".split(" "))}(this.jStat,Math),function(a,b){(function(b){for(var c=0;c<b.length;c++)(function(b){a[b]=function(a,b,c){return this instanceof arguments.callee?(this._a=a,this._b=b,this._c=c,this):new arguments.callee(a,b,c)},a.fn[b]=function(c,d,e){var f=a[b](c,d,e);return f.data=this,f},a[b].prototype.sample=function(c){var d=this._a,e=this._b,f=this._c;return c?a.alter(c,function(){return a[b].sample(d,e,f)}):a[b].sample(d,e,f)},function(c){for(var d=0;d<c.length;d++)(function(c){a[b].prototype[c]=function(d){var e=this._a,f=this._b,g=this._c;return!d&&d!==0&&(d=this.data),typeof d!="number"?a.fn.map.call(d,function(d){return a[b][c](d,e,f,g)}):a[b][c](d,e,f,g)}})(c[d])}("pdf cdf inv".split(" ")),function(c){for(var d=0;d<c.length;d++)(function(c){a[b].prototype[c]=function(){return a[b][c](this._a,this._b,this._c)}})(c[d])}("mean median mode variance".split(" "))})(b[c])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" ")),a.extend(a.beta,{pdf:function(d,e,f){return d>1||d<0?0:e==1&&f==1?1:e<512||f<512?b.pow(d,e-1)*b.pow(1-d,f-1)/a.betafn(e,f):b.exp((e-1)*b.log(d)+(f-1)*b.log(1-d)-a.betaln(e,f))},cdf:function(c,d,e){return c>1||c<0?(c>1)*1:a.ibeta(c,d,e)},inv:function(c,d,e){return a.ibetainv(c,d,e)},mean:function(b,c){return b/(b+c)},median:function(b,c){throw new Error("median not yet implemented")},mode:function(c,d){return c*d/(b.pow(c+d,2)*(c+d+1))},sample:function(c,d){var e=a.randg(c);return e/(e+a.randg(d))},variance:function(c,d){return c*d/(b.pow(c+d,2)*(c+d+1))}}),a.extend(a.centralF,{pdf:function(d,e,f){return d<0?undefined:b.sqrt(b.pow(e*d,e)*b.pow(f,f)/b.pow(e*d+f,e+f))/(d*a.betafn(e/2,f/2))},cdf:function(c,d,e){return a.ibeta(d*c/(d*c+e),d/2,e/2)},inv:function(c,d,e){return e/(d*(1/a.ibetainv(c,d/2,e/2)-1))},mean:function(b,c){return c>2?c/(c-2):undefined},mode:function(b,c){return b>2?c*(b-2)/(b*(c+2)):undefined},sample:function(c,d){var e=a.randg(c/2)*2,f=a.randg(d/2)*2;return e/c/(f/d)},variance:function(b,c){return c<=4?undefined:2*c*c*(b+c-2)/(b*(c-2)*(c-2)*(c-4))}}),a.extend(a.cauchy,{pdf:function(c,d,e){return e/(b.pow(c-d,2)+b.pow(e,2))/b.PI},cdf:function(c,d,e){return b.atan((c-d)/e)/b.PI+.5},inv:function(a,c,d){return c+d*b.tan(b.PI*(a-.5))},median:function(b,c){return b},mode:function(b,c){return b},sample:function(d,e){return a.randn()*b.sqrt(1/(2*a.randg(.5)))*e+d}}),a.extend(a.chisquare,{pdf:function(d,e){return b.exp((e/2-1)*b.log(d)-d/2-e/2*b.log(2)-a.gammaln(e/2))},cdf:function(c,d){return a.gammap(d/2,c/2)},inv:function(b,c){return 2*a.gammapinv(b,.5*c)},mean:function(a){return a},median:function(c){return c*b.pow(1-2/(9*c),3)},mode:function(b){return b-2>0?b-2:0},sample:function(c){return a.randg(c/2)*2},variance:function(b){return 2*b}}),a.extend(a.exponential,{pdf:function(c,d){return c<0?0:d*b.exp(-d*c)},cdf:function(c,d){return c<0?0:1-b.exp(-d*c)},inv:function(a,c){return-b.log(1-a)/c},mean:function(a){return 1/a},median:function(a){return 1/a*b.log(2)},mode:function(b){return 0},sample:function(c){return-1/c*b.log(b.random())},variance:function(a){return b.pow(a,-2)}}),a.extend(a.gamma,{pdf:function(d,e,f){return b.exp((e-1)*b.log(d)-d/f-a.gammaln(e)-e*b.log(f))},cdf:function(c,d,e){return a.gammap(d,c/e)},inv:function(b,c,d){return a.gammapinv(b,c)*d},mean:function(a,b){return a*b},mode:function(b,c){return b>1?(b-1)*c:undefined},sample:function(c,d){return a.randg(c)*d},variance:function(b,c){return b*c*c}}),a.extend(a.invgamma,{pdf:function(d,e,f){return b.exp(-(e+1)*b.log(d)-f/d-a.gammaln(e)+e*b.log(f))},cdf:function(c,d,e){return 1-a.gammap(d,e/c)},inv:function(b,c,d){return d/a.gammapinv(1-b,c)},mean:function(a,b){return a>1?b/(a-1):undefined},mode:function(b,c){return c/(b+1)},sample:function(c,d){return d/a.randg(c)},variance:function(b,c){return b<=2?undefined:c*c/((b-1)*(b-1)*(b-2))}}),a.extend(a.kumaraswamy,{pdf:function(c,d,e){return b.exp(b.log(d)+b.log(e)+(d-1)*b.log(c)+(e-1)*b.log(1-b.pow(c,d)))},cdf:function(c,d,e){return 1-b.pow(1-b.pow(c,d),e)},mean:function(b,c){return c*a.gammafn(1+1/b)*a.gammafn(c)/a.gammafn(1+1/b+c)},median:function(c,d){return b.pow(1-b.pow(2,-1/d),1/c)},mode:function(c,d){return c>=1&&d>=1&&c!==1&&d!==1?b.pow((c-1)/(c*d-1),1/c):undefined},variance:function(b,c){throw new Error("variance not yet implemented")}}),a.extend(a.lognormal,{pdf:function(c,d,e){return b.exp(-b.log(c)-.5*b.log(2*b.PI)-b.log(e)-b.pow(b.log(c)-d,2)/(2*e*e))},cdf:function(d,e,f){return.5+.5*a.erf((b.log(d)-e)/b.sqrt(2*f*f))},inv:function(c,d,e){return b.exp(-1.4142135623730951*e*a.erfcinv(2*c)+d)},mean:function(c,d){return b.exp(c+d*d/2)},median:function(c,d){return b.exp(c)},mode:function(c,d){return b.exp(c-d*d)},sample:function(d,e){return b.exp(a.randn()*e+d)},variance:function(c,d){return(b.exp(d*d)-1)*b.exp(2*c+d*d)}}),a.extend(a.normal,{pdf:function(c,d,e){return b.exp(-0.5*b.log(2*b.PI)-b.log(e)-b.pow(c-d,2)/(2*e*e))},cdf:function(d,e,f){return.5*(1+a.erf((d-e)/b.sqrt(2*f*f)))},inv:function(b,c,d){return-1.4142135623730951*d*a.erfcinv(2*b)+c},mean:function(a,b){return a},median:function(b,c){return b},mode:function(a,b){return a},sample:function(c,d){return a.randn()*d+c},variance:function(a,b){return b*b}}),a.extend(a.pareto,{pdf:function(c,d,e){return c<=d?undefined:e*b.pow(d,e)/b.pow(c,e+1)},cdf:function(c,d,e){return 1-b.pow(d/c,e)},mean:function(c,d){return d<=1?undefined:d*b.pow(c,d)/(d-1)},median:function(c,d){return c*d*b.SQRT2},mode:function(b,c){return b},variance:function(a,c){return c<=2?undefined:a*a*c/(b.pow(c-1,2)*(c-2))}}),a.extend(a.studentt,{pdf:function(d,e){return a.gammafn((e+1)/2)/(b.sqrt(e*b.PI)*a.gammafn(e/2))*b.pow(1+d*d/e,-((e+1)/2))},cdf:function(d,e){var f=e/2;return a.ibeta((d+b.sqrt(d*d+e))/(2*b.sqrt(d*d+e)),f,f)},inv:function(c,d){var e=a.ibetainv(2*b.min(c,1-c),.5*d,.5);return e=b.sqrt(d*(1-e)/e),c>.5?e:-e},mean:function(b){return b>1?0:undefined},median:function(b){return 0},mode:function(b){return 0},sample:function(d){return a.randn()*b.sqrt(d/(2*a.randg(d/2)))},variance:function(b){return b>2?b/(b-2):b>1?Infinity:undefined}}),a.extend(a.weibull,{pdf:function(c,d,e){return c<0?0:e/d*b.pow(c/d,e-1)*b.exp(-b.pow(c/d,e))},cdf:function(c,d,e){return c<0?0:1-b.exp(-b.pow(c/d,e))},inv:function(a,c,d){return c*b.pow(-b.log(1-a),1/d)},mean:function(b,c){return b*a.gammafn(1+1/c)},median:function(c,d){return c*b.pow(b.log(2),1/d)},mode:function(c,d){return d<=1?undefined:c*b.pow((d-1)/d,1/d)},sample:function(c,d){return c*b.pow(-b.log(b.random()),1/d)},variance:function(d,e){return d*d*a.gammafn(1+2/e)-b.pow(this.mean(d,e),2)}}),a.extend(a.uniform,{pdf:function(b,c,d){return b<c||b>d?0:1/(d-c)},cdf:function(b,c,d){return b<c?0:b<d?(b-c)/(d-c):1},mean:function(b,c){return.5*(b+c)},median:function(c,d){return a.mean(c,d)},mode:function(b,c){throw new Error("mode is not yet implemented")},sample:function(c,d){return c/2+d/2+(d/2-c/2)*(2*b.random()-1)},variance:function(c,d){return b.pow(d-c,2)/12}}),a.extend(a.binomial,{pdf:function(d,e,f){return f===0||f===1?e*f===d?1:0:a.combination(e,d)*b.pow(f,d)*b.pow(1-f,e-d)},cdf:function(c,d,e){var f=[],g=0;if(c<0)return 0;if(c<d){for(;g<=c;g++)f[g]=a.binomial.pdf(g,d,e);return a.sum(f)}return 1}}),a.extend(a.negbin,{pdf:function(d,e,f){return d!==d|0?!1:d<0?0:a.combination(d+e-1,e-1)*b.pow(1-f,d)*b.pow(f,e)},cdf:function(c,d,e){var f=0,g=0;if(c<0)return 0;for(;g<=c;g++)f+=a.negbin.pdf(g,d,e);return f}}),a.extend(a.hypgeom,{pdf:function(d,e,f,g){if(d!==d|0)return!1;if(d<0||d<f-(e-g))return 0;if(d>g||d>f)return 0;if(f*2>e)return g*2>e?a.hypgeom.pdf(e-f-g+d,e,e-f,e-g):a.hypgeom.pdf(g-d,e,e-f,g);if(g*2>e)return a.hypgeom.pdf(f-d,e,f,e-g);if(f<g)return a.hypgeom.pdf(d,e,g,f);var h=1,i=0;for(var j=0;j<d;j++){while(h>1&&i<g)h*=1-f/(e-i),i++;h*=(g-j)*(f-j)/((j+1)*(e-f-g+j+1))}for(;i<g;i++)h*=1-f/(e-i);return b.min(1,b.max(0,h))},cdf:function(d,e,f,g){if(d<0||d<f-(e-g))return 0;if(d>=g||d>=f)return 1;if(f*2>e)return g*2>e?a.hypgeom.cdf(e-f-g+d,e,e-f,e-g):1-a.hypgeom.cdf(g-d-1,e,e-f,g);if(g*2>e)return 1-a.hypgeom.cdf(f-d-1,e,f,e-g);if(f<g)return a.hypgeom.cdf(d,e,g,f);var h=1,i=1,j=0;for(var k=0;k<d;k++){while(h>1&&j<g){var l=1-f/(e-j);i*=l,h*=l,j++}i*=(g-k)*(f-k)/((k+1)*(e-f-g+k+1)),h+=i}for(;j<g;j++)h*=1-f/(e-j);return b.min(1,b.max(0,h))}}),a.extend(a.poisson,{pdf:function(d,e){return b.pow(e,d)*b.exp(-e)/a.factorial(d)},cdf:function(c,d){var e=[],f=0;if(c<0)return 0;for(;f<=c;f++)e.push(a.poisson.pdf(f,d));return a.sum(e)},mean:function(a){return a},variance:function(a){return a},sample:function(c){var d=1,e=0,f=b.exp(-c);do e++,d*=b.random();while(d>f);return e-1}}),a.extend(a.triangular,{pdf:function(b,c,d,e){return d<=c||e<c||e>d?undefined:b<c||b>d?0:b<=e?2*(b-c)/((d-c)*(e-c)):2*(d-b)/((d-c)*(d-e))},cdf:function(c,d,e,f){return e<=d||f<d||f>e?undefined:c<d?0:c<=f?b.pow(c-d,2)/((e-d)*(f-d)):1-b.pow(e-c,2)/((e-d)*(e-f))},mean:function(b,c,d){return(b+c+d)/3},median:function(c,d,e){if(e<=(c+d)/2)return d-b.sqrt((d-c)*(d-e))/b.sqrt(2);if(e>(c+d)/2)return c+b.sqrt((d-c)*(e-c))/b.sqrt(2)},mode:function(b,c,d){return d},sample:function(c,d,e){var f=b.random();return f<(e-c)/(d-c)?c+b.sqrt(f*(d-c)*(e-c)):d-b.sqrt((1-f)*(d-c)*(d-e))},variance:function(b,c,d){return(b*b+c*c+d*d-b*c-b*d-c*d)/18}})}(this.jStat,Math),function(a,b){var d=Array.prototype.push,e=a.utils.isArray;a.extend({add:function(c,d){return e(d)?(e(d[0])||(d=[d]),a.map(c,function(a,b,c){return a+d[b][c]})):a.map(c,function(a){return a+d})},subtract:function(c,d){return e(d)?(e(d[0])||(d=[d]),a.map(c,function(a,b,c){return a-d[b][c]||0})):a.map(c,function(a){return a-d})},divide:function(c,d){return e(d)?(e(d[0])||(d=[d]),a.multiply(c,a.inv(d))):a.map(c,function(a){return a/d})},multiply:function(c,d){var f,g,h,i,j=c.length,k=c[0].length,l=a.zeros(j,h=e(d)?d[0].length:k),m=0;if(e(d)){for(;m<h;m++)for(f=0;f<j;f++){i=0;for(g=0;g<k;g++)i+=c[f][g]*d[g][m];l[f][m]=i}return j===1&&m===1?l[0][0]:l}return a.map(c,function(a){return a*d})},dot:function(c,d){e(c[0])||(c=[c]),e(d[0])||(d=[d]);var f=c[0].length===1&&c.length!==1?a.transpose(c):c,g=d[0].length===1&&d.length!==1?a.transpose(d):d,h=[],i=0,j=f.length,k=f[0].length,l,m;for(;i<j;i++){h[i]=[],l=0;for(m=0;m<k;m++)l+=f[i][m]*g[i][m];h[i]=l}return h.length===1?h[0]:h},pow:function(d,e){return a.map(d,function(a){return b.pow(a,e)})},abs:function(d){return a.map(d,function(a){return b.abs(a)})},norm:function(c,d){var f=0,g=0;isNaN(d)&&(d=2),e(c[0])&&(c=c[0]);for(;g<c.length;g++)f+=b.pow(b.abs(c[g]),d);return b.pow(f,1/d)},angle:function(d,e){return b.acos(a.dot(d,e)/(a.norm(d)*a.norm(e)))},aug:function(b,c){var e=b.slice(),f=0;for(;f<e.length;f++)d.apply(e[f],c[f]);return e},inv:function(c){var d=c.length,e=c[0].length,f=a.identity(d,e),g=a.gauss_jordan(c,f),h=[],i=0,j;for(;i<d;i++){h[i]=[];for(j=e-1;j<g[0].length;j++)h[i][j-e]=g[i][j]}return h},det:function(b){var c=b.length,d=c*2,e=new Array(d),f=c-1,g=d-1,h=f-c+1,i=g,j=0,k=0,l;if(c===2)return b[0][0]*b[1][1]-b[0][1]*b[1][0];for(;j<d;j++)e[j]=1;for(j=0;j<c;j++){for(l=0;l<c;l++)e[h<0?h+c:h]*=b[j][l],e[i<c?i+c:i]*=b[j][l],h++,i--;h=--f-c+1,i=--g}for(j=0;j<c;j++)k+=e[j];for(;j<d;j++)k-=e[j];return k},gauss_elimination:function(d,e){var f=0,g=0,h=d.length,i=d[0].length,j=1,k=0,l=[],m,n,o,p;d=a.aug(d,e),m=d[0].length;for(;f<h;f++){n=d[f][f],g=f;for(p=f+1;p<i;p++)n<b.abs(d[p][f])&&(n=d[p][f],g=p);if(g!=f)for(p=0;p<m;p++)o=d[f][p],d[f][p]=d[g][p],d[g][p]=o;for(g=f+1;g<h;g++){j=d[g][f]/d[f][f];for(p=f;p<m;p++)d[g][p]=d[g][p]-j*d[f][p]}}for(f=h-1;f>=0;f--){k=0;for(g=f+1;g<=h-1;g++)k=l[g]*d[f][g];l[f]=(d[f][m-1]-k)/d[f][f]}return l},gauss_jordan:function(e,f){var g=a.aug(e,f),h=g.length,i=g[0].length;for(var j=0;j<h;j++){var k=j;for(var l=j+1;l<h;l++)b.abs(g[l][j])>b.abs(g[k][j])&&(k=l);var m=g[j];g[j]=g[k],g[k]=m;for(var l=j+1;l<h;l++){c=g[l][j]/g[j][j];for(var n=j;n<i;n++)g[l][n]-=g[j][n]*c}}for(var j=h-1;j>=0;j--){c=g[j][j];for(var l=0;l<j;l++)for(var n=i-1;n>j-1;n--)g[l][n]-=g[j][n]*g[l][j]/c;g[j][j]/=c;for(var n=h;n<i;n++)g[j][n]/=c}return g},lu:function(b,c){throw new Error("lu not yet implemented")},cholesky:function(b,c){throw new Error("cholesky not yet implemented")},gauss_jacobi:function(d,e,f,g){var h=0,i=0,j=d.length,k=[],l=[],m=[],n,o,p,q;for(;h<j;h++){k[h]=[],l[h]=[],m[h]=[];for(i=0;i<j;i++)h>i?(k[h][i]=d[h][i],l[h][i]=m[h][i]=0):h<i?(l[h][i]=d[h][i],k[h][i]=m[h][i]=0):(m[h][i]=d[h][i],k[h][i]=l[h][i]=0)}p=a.multiply(a.multiply(a.inv(m),a.add(k,l)),-1),o=a.multiply(a.inv(m),e),n=f,q=a.add(a.multiply(p,f),o),h=2;while(b.abs(a.norm(a.subtract(q,n)))>g)n=q,q=a.add(a.multiply(p,n),o),h++;return q},gauss_seidel:function(d,e,f,g){var h=0,i=d.length,j=[],k=[],l=[],m,n,o,p,q;for(;h<i;h++){j[h]=[],k[h]=[],l[h]=[];for(m=0;m<i;m++)h>m?(j[h][m]=d[h][m],k[h][m]=l[h][m]=0):h<m?(k[h][m]=d[h][m],j[h][m]=l[h][m]=0):(l[h][m]=d[h][m],j[h][m]=k[h][m]=0)}p=a.multiply(a.multiply(a.inv(a.add(l,j)),k),-1),o=a.multiply(a.inv(a.add(l,j)),e),n=f,q=a.add(a.multiply(p,f),o),h=2;while(b.abs(a.norm(a.subtract(q,n)))>g)n=q,q=a.add(a.multiply(p,n),o),h+=1;return q},SOR:function(d,e,f,g,h){var i=0,j=d.length,k=[],l=[],m=[],n,o,p,q,r;for(;i<j;i++){k[i]=[],l[i]=[],m[i]=[];for(n=0;n<j;n++)i>n?(k[i][n]=d[i][n],l[i][n]=m[i][n]=0):i<n?(l[i][n]=d[i][n],k[i][n]=m[i][n]=0):(m[i][n]=d[i][n],k[i][n]=l[i][n]=0)}q=a.multiply(a.inv(a.add(m,a.multiply(k,h))),a.subtract(a.multiply(m,1-h),a.multiply(l,h))),p=a.multiply(a.multiply(a.inv(a.add(m,a.multiply(k,h))),e),h),o=f,r=a.add(a.multiply(q,f),p),i=2;while(b.abs(a.norm(a.subtract(r,o)))>g)o=r,r=a.add(a.multiply(q,o),p),i++;return r},householder:function(d){var e=d.length,f=d[0].length,g=0,h=[],i=[],j,k,l,m,n;for(;g<e-1;g++){j=0;for(m=g+1;m<f;m++)j+=d[m][g]*d[m][g];n=d[g+1][g]>0?-1:1,j=n*b.sqrt(j),k=b.sqrt((j*j-d[g+1][g]*j)/2),h=a.zeros(e,1),h[g+1][0]=(d[g+1][g]-j)/(2*k);for(l=g+2;l<e;l++)h[l][0]=d[l][g]/(2*k);i=a.subtract(a.identity(e,f),a.multiply(a.multiply(h,a.transpose(h)),2)),d=a.multiply(i,a.multiply(d,i))}return d},QR:function(d,e){var f=d.length,g=d[0].length,h=0,i=[],j=[],k=[],l,m,n,o,p,q;for(;h<f-1;h++){m=0;for(l=h+1;l<g;l++)m+=d[l][h]*d[l][h];p=d[h+1][h]>0?-1:1,m=p*b.sqrt(m),n=b.sqrt((m*m-d[h+1][h]*m)/2),i=a.zeros(f,1),i[h+1][0]=(d[h+1][h]-m)/(2*n);for(o=h+2;o<f;o++)i[o][0]=d[o][h]/(2*n);j=a.subtract(a.identity(f,g),a.multiply(a.multiply(i,a.transpose(i)),2)),d=a.multiply(j,d),e=a.multiply(j,e)}for(h=f-1;h>=0;h--){q=0;for(l=h+1;l<=g-1;l++)q=k[l]*d[h][l];k[h]=e[h][0]/d[h][h]}return k},jacobi:function(d){var e=1,f=0,g=d.length,h=a.identity(g,g),i=[],j,k,l,m,n,o,p,q;while(e===1){f++,o=d[0][1],m=0,n=1;for(k=0;k<g;k++)for(l=0;l<g;l++)k!=l&&o<b.abs(d[k][l])&&(o=b.abs(d[k][l]),m=k,n=l);d[m][m]===d[n][n]?p=d[m][n]>0?b.PI/4:-b.PI/4:p=b.atan(2*d[m][n]/(d[m][m]-d[n][n]))/2,q=a.identity(g,g),q[m][m]=b.cos(p),q[m][n]=-b.sin(p),q[n][m]=b.sin(p),q[n][n]=b.cos(p),h=a.multiply(h,q),j=a.multiply(a.multiply(a.inv(q),d),q),d=j,e=0;for(k=1;k<g;k++)for(l=1;l<g;l++)k!=l&&b.abs(d[k][l])>.001&&(e=1)}for(k=0;k<g;k++)i.push(d[k][k]);return[h,i]},rungekutta:function(b,c,d,e,f,g){var h,i,j,k,l;if(g===2)while(e<=d)h=c*b(e,f),i=c*b(e+c,f+h),j=f+(h+i)/2,f=j,e+=c;if(g===4)while(e<=d)h=c*b(e,f),i=c*b(e+c/2,f+h/2),k=c*b(e+c/2,f+i/2),l=c*b(e+c,f+k),j=f+(h+2*i+2*k+l)/6,f=j,e+=c;return f},romberg:function(c,d,e,f){var g=0,h=(e-d)/2,i=[],j=[],k=[],l,m,n,o,p,q;while(g<f/2){p=c(d);for(n=d,o=0;n<=e;n+=h,o++)i[o]=n;l=i.length;for(n=1;n<l-1;n++)p+=(n%2!==0?4:2)*c(i[n]);p=h/3*(p+c(e)),k[g]=p,h/=2,g++}m=k.length,l=1;while(m!==1){for(n=0;n<m-1;n++)j[n]=(b.pow(4,l)*k[n+1]-k[n])/(b.pow(4,l)-1);m=j.length,k=j,j=[],l++}return k},richardson:function(c,d,e,f){function g(a,b){var c=0,d=a.length,e;for(;c<d;c++)a[c]===b&&(e=c);return e}var h=c.length,i=b.abs(e-c[g(c,e)+1]),j=0,k=[],l=[],m,n,o,p,q;while(f>=i)m=g(c,e+f),n=g(c,e),k[j]=(d[m]-2*d[n]+d[2*n-m])/(f*f),f/=2,j++;p=k.length,o=1;while(p!=1){for(q=0;q<p-1;q++)l[q]=(b.pow(4,o)*k[q+1]-k[q])/(b.pow(4,o)-1);p=l.length,k=l,l=[],o++}return k},simpson:function(b,c,d,e){var f=(d-c)/e,g=b(c),h=[],i=c,j=0,k=1,l;for(;i<=d;i+=f,j++)h[j]=i;l=h.length;for(;k<l-1;k++)g+=(k%2!==0?4:2)*b(h[k]);return f/3*(g+b(d))},hermite:function(b,c,d,e){var f=b.length,g=0,h=0,i=[],j=[],k=[],l=[],m;for(;h<f;h++){i[h]=1;for(m=0;m<f;m++)h!=m&&(i[h]*=(e-b[m])/(b[h]-b[m]));j[h]=0;for(m=0;m<f;m++)h!=m&&(j[h]+=1/(b[h]-b[m]));k[h]=(1-2*(e-b[h])*j[h])*i[h]*i[h],l[h]=(e-b[h])*i[h]*i[h],g+=k[h]*c[h]+l[h]*d[h]}return g},lagrange:function(b,c,d){var e=0,f=0,g,h,i=b.length;for(;f<i;f++){h=c[f];for(g=0;g<i;g++)f!=g&&(h*=(d-b[g])/(b[f]-b[g]));e+=h}return e},cubic_spline:function(c,d,e){var f=c.length,g=0,h,i=[],j=[],k=[],l=[],m=[],n=[],o=[];for(;g<f-1;g++)m[g]=c[g+1]-c[g];k[0]=0;for(g=1;g<f-1;g++)k[g]=3/m[g]*(d[g+1]-d[g])-3/m[g-1]*(d[g]-d[g-1]);for(g=1;g<f-1;g++)i[g]=[],j[g]=[],i[g][g-1]=m[g-1],i[g][g]=2*(m[g-1]+m[g]),i[g][g+1]=m[g],j[g][0]=k[g];l=a.multiply(a.inv(i),j);for(h=0;h<f-1;h++)n[h]=(d[h+1]-d[h])/m[h]-m[h]*(l[h+1][0]+2*l[h][0])/3,o[h]=(l[h+1][0]-l[h][0])/(3*m[h]);for(h=0;h<f;h++)if(c[h]>e)break;return h-=1,d[h]+(e-c[h])*n[h]+a.sq(e-c[h])*l[h]+(e-c[h])*a.sq(e-c[h])*o[h]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(c){var d=c.length,e=c[0].length,f=!1,g=0,h,i,j=[],k=[],l=[],m=[],n=[],o=[],p=[],q=[],r=[],s=[];for(g=0;g<d;g++)j[g]=a.sum(c[g])/e;for(g=0;g<e;g++){p[g]=[];for(h=0;h<d;h++)p[g][h]=c[h][g]-j[h]}p=a.transpose(p);for(g=0;g<d;g++){q[g]=[];for(h=0;h<d;h++)q[g][h]=a.dot([p[g]],[p[h]])/(e-1)}l=a.jacobi(q),r=l[0],k=l[1],s=a.transpose(r);for(g=0;g<k.length;g++)for(h=g;h<k.length;h++)k[g]<k[h]&&(i=k[g],k[g]=k[h],k[h]=i,m=s[g],s[g]=s[h],s[h]=m);o=a.transpose(p);for(g=0;g<d;g++){n[g]=[];for(h=0;h<o.length;h++)n[g][h]=a.dot([s[g]],[o[h]])}return[c,k,s,n]}}),function(b){for(var c=0;c<b.length;c++)(function(b){a.fn[b]=function(c,d){var e=this;return d?(setTimeout(function(){d.call(e,a.fn[b].call(e,c))},15),this):typeof a[b](this,c)=="number"?a[b](this,c):a(a[b](this,c))}})(b[c])}("add divide multiply subtract dot pow abs norm angle".split(" "))}(this.jStat,Math),function(a,b){var c=[].slice,d=a.utils.isNumber;a.extend({zscore:function(){var e=c.call(arguments);return d(e[1])?(e[0]-e[1])/e[2]:(e[0]-a.mean(e[1]))/a.stdev(e[1],e[2])},ztest:function(){var f=c.call(arguments);if(f.length===4){if(d(f[1])){var g=a.zscore(f[0],f[1],f[2]);return f[3]===1?a.normal.cdf(-b.abs(g),0,1):a.normal.cdf(-b.abs(g),0,1)*2}var g=f[0];return f[2]===1?a.normal.cdf(-b.abs(g),0,1):a.normal.cdf(-b.abs(g),0,1)*2}var g=a.zscore(f[0],f[1],f[3]);return f[1]===1?a.normal.cdf(-b.abs(g),0,1):a.normal.cdf(-b.abs(g),0,1)*2}}),a.extend(a.fn,{zscore:function(b,c){return(b-this.mean())/this.stdev(c)},ztest:function(d,e,f){var g=b.abs(this.zscore(d,f));return e===1?a.normal.cdf(-g,0,1):a.normal.cdf(-g,0,1)*2}}),a.extend({tscore:function(){var e=c.call(arguments);return e.length===4?(e[0]-e[1])/(e[2]/b.sqrt(e[3])):(e[0]-a.mean(e[1]))/(a.stdev(e[1],!0)/b.sqrt(e[1].length))},ttest:function(){var f=c.call(arguments),g;return f.length===5?(g=b.abs(a.tscore(f[0],f[1],f[2],f[3])),f[4]===1?a.studentt.cdf(-g,f[3]-1):a.studentt.cdf(-g,f[3]-1)*2):d(f[1])?(g=b.abs(f[0]),f[2]==1?a.studentt.cdf(-g,f[1]-1):a.studentt.cdf(-g,f[1]-1)*2):(g=b.abs(a.tscore(f[0],f[1])),f[2]==1?a.studentt.cdf(-g,f[1].length-1):a.studentt.cdf(-g,f[1].length-1)*2)}}),a.extend(a.fn,{tscore:function(c){return(c-this.mean())/(this.stdev(!0)/b.sqrt(this.cols()))},ttest:function(d,e){return e===1?1-a.studentt.cdf(b.abs(this.tscore(d)),this.cols()-1):a.studentt.cdf(-b.abs(this.tscore(d)),this.cols()-1)*2}}),a.extend({anovafscore:function(){var e=c.call(arguments),f,g,h,i,j,k,l,m;if(e.length===1){j=new Array(e[0].length);for(l=0;l<e[0].length;l++)j[l]=e[0][l];e=j}if(e.length===2)return a.variance(e[0])/a.variance(e[1]);g=new Array;for(l=0;l<e.length;l++)g=g.concat(e[l]);h=a.mean(g),f=0;for(l=0;l<e.length;l++)f+=e[l].length*b.pow(a.mean(
e[l])-h,2);f/=e.length-1,k=0;for(l=0;l<e.length;l++){i=a.mean(e[l]);for(m=0;m<e[l].length;m++)k+=b.pow(e[l][m]-i,2)}return k/=g.length-e.length,f/k},anovaftest:function(){var e=c.call(arguments),f,g,h,i;if(d(e[0]))return 1-a.centralF.cdf(e[0],e[1],e[2]);anovafscore=a.anovafscore(e),f=e.length-1,h=0;for(i=0;i<e.length;i++)h+=e[i].length;return g=h-f-1,1-a.centralF.cdf(anovafscore,f,g)},ftest:function(c,d,e){return 1-a.centralF.cdf(c,d,e)}}),a.extend(a.fn,{anovafscore:function(){return a.anovafscore(this.toArray())},anovaftes:function(){var c=0,d;for(d=0;d<this.length;d++)c+=this[d].length;return a.ftest(this.anovafscore(),this.length-1,c-this.length)}}),a.extend({normalci:function(){var e=c.call(arguments),f=new Array(2),g;return e.length===4?g=b.abs(a.normal.inv(e[1]/2,0,1)*e[2]/b.sqrt(e[3])):g=b.abs(a.normal.inv(e[1]/2,0,1)*a.stdev(e[2])/b.sqrt(e[2].length)),f[0]=e[0]-g,f[1]=e[0]+g,f},tci:function(){var e=c.call(arguments),f=new Array(2),g;return e.length===4?g=b.abs(a.studentt.inv(e[1]/2,e[3]-1)*e[2]/b.sqrt(e[3])):g=b.abs(a.studentt.inv(e[1]/2,e[2].length-1)*a.stdev(e[2],!0)/b.sqrt(e[2].length)),f[0]=e[0]-g,f[1]=e[0]+g,f},significant:function(b,c){return b<c}}),a.extend(a.fn,{normalci:function(c,d){return a.normalci(c,d,this.toArray())},tci:function(c,d){return a.tci(c,d,this.toArray())}})}(this.jStat,Math);;
/*!
 * numeral.js
 * version : 1.5.3
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */
(function(){function a(a){this._value=a}function b(a,b,c,d){var e,f,g=Math.pow(10,b);return f=(c(a*g)/g).toFixed(b),d&&(e=new RegExp("0{1,"+d+"}$"),f=f.replace(e,"")),f}function c(a,b,c){var d;return d=b.indexOf("$")>-1?e(a,b,c):b.indexOf("%")>-1?f(a,b,c):b.indexOf(":")>-1?g(a,b):i(a._value,b,c)}function d(a,b){var c,d,e,f,g,i=b,j=["KB","MB","GB","TB","PB","EB","ZB","YB"],k=!1;if(b.indexOf(":")>-1)a._value=h(b);else if(b===q)a._value=0;else{for("."!==o[p].delimiters.decimal&&(b=b.replace(/\./g,"").replace(o[p].delimiters.decimal,".")),c=new RegExp("[^a-zA-Z]"+o[p].abbreviations.thousand+"(?:\\)|(\\"+o[p].currency.symbol+")?(?:\\))?)?$"),d=new RegExp("[^a-zA-Z]"+o[p].abbreviations.million+"(?:\\)|(\\"+o[p].currency.symbol+")?(?:\\))?)?$"),e=new RegExp("[^a-zA-Z]"+o[p].abbreviations.billion+"(?:\\)|(\\"+o[p].currency.symbol+")?(?:\\))?)?$"),f=new RegExp("[^a-zA-Z]"+o[p].abbreviations.trillion+"(?:\\)|(\\"+o[p].currency.symbol+")?(?:\\))?)?$"),g=0;g<=j.length&&!(k=b.indexOf(j[g])>-1?Math.pow(1024,g+1):!1);g++);a._value=(k?k:1)*(i.match(c)?Math.pow(10,3):1)*(i.match(d)?Math.pow(10,6):1)*(i.match(e)?Math.pow(10,9):1)*(i.match(f)?Math.pow(10,12):1)*(b.indexOf("%")>-1?.01:1)*((b.split("-").length+Math.min(b.split("(").length-1,b.split(")").length-1))%2?1:-1)*Number(b.replace(/[^0-9\.]+/g,"")),a._value=k?Math.ceil(a._value):a._value}return a._value}function e(a,b,c){var d,e,f=b.indexOf("$"),g=b.indexOf("("),h=b.indexOf("-"),j="";return b.indexOf(" $")>-1?(j=" ",b=b.replace(" $","")):b.indexOf("$ ")>-1?(j=" ",b=b.replace("$ ","")):b=b.replace("$",""),e=i(a._value,b,c),1>=f?e.indexOf("(")>-1||e.indexOf("-")>-1?(e=e.split(""),d=1,(g>f||h>f)&&(d=0),e.splice(d,0,o[p].currency.symbol+j),e=e.join("")):e=o[p].currency.symbol+j+e:e.indexOf(")")>-1?(e=e.split(""),e.splice(-1,0,j+o[p].currency.symbol),e=e.join("")):e=e+j+o[p].currency.symbol,e}function f(a,b,c){var d,e="",f=100*a._value;return b.indexOf(" %")>-1?(e=" ",b=b.replace(" %","")):b=b.replace("%",""),d=i(f,b,c),d.indexOf(")")>-1?(d=d.split(""),d.splice(-1,0,e+"%"),d=d.join("")):d=d+e+"%",d}function g(a){var b=Math.floor(a._value/60/60),c=Math.floor((a._value-60*b*60)/60),d=Math.round(a._value-60*b*60-60*c);return b+":"+(10>c?"0"+c:c)+":"+(10>d?"0"+d:d)}function h(a){var b=a.split(":"),c=0;return 3===b.length?(c+=60*Number(b[0])*60,c+=60*Number(b[1]),c+=Number(b[2])):2===b.length&&(c+=60*Number(b[0]),c+=Number(b[1])),Number(c)}function i(a,c,d){var e,f,g,h,i,j,k=!1,l=!1,m=!1,n="",r=!1,s=!1,t=!1,u=!1,v=!1,w="",x="",y=Math.abs(a),z=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],A="",B=!1;if(0===a&&null!==q)return q;if(c.indexOf("(")>-1?(k=!0,c=c.slice(1,-1)):c.indexOf("+")>-1&&(l=!0,c=c.replace(/\+/g,"")),c.indexOf("a")>-1&&(r=c.indexOf("aK")>=0,s=c.indexOf("aM")>=0,t=c.indexOf("aB")>=0,u=c.indexOf("aT")>=0,v=r||s||t||u,c.indexOf(" a")>-1?(n=" ",c=c.replace(" a","")):c=c.replace("a",""),y>=Math.pow(10,12)&&!v||u?(n+=o[p].abbreviations.trillion,a/=Math.pow(10,12)):y<Math.pow(10,12)&&y>=Math.pow(10,9)&&!v||t?(n+=o[p].abbreviations.billion,a/=Math.pow(10,9)):y<Math.pow(10,9)&&y>=Math.pow(10,6)&&!v||s?(n+=o[p].abbreviations.million,a/=Math.pow(10,6)):(y<Math.pow(10,6)&&y>=Math.pow(10,3)&&!v||r)&&(n+=o[p].abbreviations.thousand,a/=Math.pow(10,3))),c.indexOf("b")>-1)for(c.indexOf(" b")>-1?(w=" ",c=c.replace(" b","")):c=c.replace("b",""),g=0;g<=z.length;g++)if(e=Math.pow(1024,g),f=Math.pow(1024,g+1),a>=e&&f>a){w+=z[g],e>0&&(a/=e);break}return c.indexOf("o")>-1&&(c.indexOf(" o")>-1?(x=" ",c=c.replace(" o","")):c=c.replace("o",""),x+=o[p].ordinal(a)),c.indexOf("[.]")>-1&&(m=!0,c=c.replace("[.]",".")),h=a.toString().split(".")[0],i=c.split(".")[1],j=c.indexOf(","),i?(i.indexOf("[")>-1?(i=i.replace("]",""),i=i.split("["),A=b(a,i[0].length+i[1].length,d,i[1].length)):A=b(a,i.length,d),h=A.split(".")[0],A=A.split(".")[1].length?o[p].delimiters.decimal+A.split(".")[1]:"",m&&0===Number(A.slice(1))&&(A="")):h=b(a,null,d),h.indexOf("-")>-1&&(h=h.slice(1),B=!0),j>-1&&(h=h.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+o[p].delimiters.thousands)),0===c.indexOf(".")&&(h=""),(k&&B?"(":"")+(!k&&B?"-":"")+(!B&&l?"+":"")+h+A+(x?x:"")+(n?n:"")+(w?w:"")+(k&&B?")":"")}function j(a,b){o[a]=b}function k(a){var b=a.toString().split(".");return b.length<2?1:Math.pow(10,b[1].length)}function l(){var a=Array.prototype.slice.call(arguments);return a.reduce(function(a,b){var c=k(a),d=k(b);return c>d?c:d},-1/0)}var m,n="1.5.3",o={},p="en",q=null,r="0,0",s="undefined"!=typeof module&&module.exports;m=function(b){return m.isNumeral(b)?b=b.value():0===b||"undefined"==typeof b?b=0:Number(b)||(b=m.fn.unformat(b)),new a(Number(b))},m.version=n,m.isNumeral=function(b){return b instanceof a},m.language=function(a,b){if(!a)return p;if(a&&!b){if(!o[a])throw new Error("Unknown language : "+a);p=a}return(b||!o[a])&&j(a,b),m},m.languageData=function(a){if(!a)return o[p];if(!o[a])throw new Error("Unknown language : "+a);return o[a]},m.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"$"}}),m.zeroFormat=function(a){q="string"==typeof a?a:null},m.defaultFormat=function(a){r="string"==typeof a?a:"0.0"},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(a,b){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof a)throw new TypeError(a+" is not a function");var c,d,e=this.length>>>0,f=!1;for(1<arguments.length&&(d=b,f=!0),c=0;e>c;++c)this.hasOwnProperty(c)&&(f?d=a(d,this[c],c,this):(d=this[c],f=!0));if(!f)throw new TypeError("Reduce of empty array with no initial value");return d}),m.fn=a.prototype={clone:function(){return m(this)},format:function(a,b){return c(this,a?a:r,void 0!==b?b:Math.round)},unformat:function(a){return"[object Number]"===Object.prototype.toString.call(a)?a:d(this,a?a:r)},value:function(){return this._value},valueOf:function(){return this._value},set:function(a){return this._value=Number(a),this},add:function(a){function b(a,b){return a+c*b}var c=l.call(null,this._value,a);return this._value=[this._value,a].reduce(b,0)/c,this},subtract:function(a){function b(a,b){return a-c*b}var c=l.call(null,this._value,a);return this._value=[a].reduce(b,this._value*c)/c,this},multiply:function(a){function b(a,b){var c=l(a,b);return a*c*b*c/(c*c)}return this._value=[this._value,a].reduce(b,1),this},divide:function(a){function b(a,b){var c=l(a,b);return a*c/(b*c)}return this._value=[this._value,a].reduce(b),this},difference:function(a){return Math.abs(m(this._value).subtract(a).value())}},s&&(module.exports=m),"undefined"==typeof ender&&(this.numeral=m),"function"==typeof define&&define.amd&&define([],function(){return m})}).call(this);;
"use strict";var numeric=typeof exports=="undefined"?function(){}:exports;typeof global!="undefined"&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(t,n){var r,i,s,o;typeof n=="undefined"&&(n=15),s=.5,r=new Date;for(;;){s*=2;for(o=s;o>3;o-=4)t(),t(),t(),t();while(o>0)t(),o--;i=new Date;if(i-r>n)break}for(o=s;o>3;o-=4)t(),t(),t(),t();while(o>0)t(),o--;return i=new Date,1e3*(3*s-1)/(i-r)},numeric._myIndexOf=function(t){var n=this.length,r;for(r=0;r<n;++r)if(this[r]===t)return r;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(t){function n(e){if(e===0)return"0";if(isNaN(e))return"NaN";if(e<0)return"-"+n(-e);if(isFinite(e)){var t=Math.floor(Math.log(e)/Math.log(10)),r=e/Math.pow(10,t),i=r.toPrecision(numeric.precision);return parseFloat(i)===10&&(t++,r=1,i=r.toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+t.toString()}return"Infinity"}function i(e){var t;if(typeof e=="undefined")return r.push(Array(numeric.precision+8).join(" ")),!1;if(typeof e=="string")return r.push('"'+e+'"'),!1;if(typeof e=="boolean")return r.push(e.toString()),!1;if(typeof e=="number"){var s=n(e),o=e.toPrecision(numeric.precision),u=parseFloat(e.toString()).toString(),a=[s,o,u,parseFloat(o).toString(),parseFloat(u).toString()];for(t=1;t<a.length;t++)a[t].length<s.length&&(s=a[t]);return r.push(Array(numeric.precision+8-s.length).join(" ")+s),!1}if(e===null)return r.push("null"),!1;if(typeof e=="function"){r.push(e.toString());var f=!1;for(t in e)e.hasOwnProperty(t)&&(f?r.push(",\n"):r.push("\n{"),f=!0,r.push(t),r.push(": \n"),i(e[t]));return f&&r.push("}\n"),!0}if(e instanceof Array){if(e.length>numeric.largeArray)return r.push("...Large Array..."),!0;var f=!1;r.push("[");for(t=0;t<e.length;t++)t>0&&(r.push(","),f&&r.push("\n ")),f=i(e[t]);return r.push("]"),!0}r.push("{");var f=!1;for(t in e)e.hasOwnProperty(t)&&(f&&r.push(",\n"),f=!0,r.push(t),r.push(": \n"),i(e[t]));return r.push("}"),!0}var r=[];return i(t),r.join("")},numeric.parseDate=function(t){function n(e){if(typeof e=="string")return Date.parse(e.replace(/-/g,"/"));if(e instanceof Array){var t=[],r;for(r=0;r<e.length;r++)t[r]=n(e[r]);return t}throw new Error("parseDate: parameter must be arrays of strings")}return n(t)},numeric.parseFloat=function(t){function n(e){if(typeof e=="string")return parseFloat(e);if(e instanceof Array){var t=[],r;for(r=0;r<e.length;r++)t[r]=n(e[r]);return t}throw new Error("parseFloat: parameter must be arrays of strings")}return n(t)},numeric.parseCSV=function(t){var n=t.split("\n"),r,i,s=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,u=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,a=function(e){return e.substr(0,e.length-1)},f=0;for(i=0;i<n.length;i++){var l=(n[i]+",").match(o),c;if(l.length>0){s[f]=[];for(r=0;r<l.length;r++)c=a(l[r]),u.test(c)?s[f][r]=parseFloat(c):s[f][r]=c;f++}}return s},numeric.toCSV=function(t){var n=numeric.dim(t),r,i,s,o,u,a;s=n[0],o=n[1],a=[];for(r=0;r<s;r++){u=[];for(i=0;i<s;i++)u[i]=t[r][i].toString();a[r]=u.join(", ")}return a.join("\n")+"\n"},numeric.getURL=function(t){var n=new XMLHttpRequest;return n.open("GET",t,!1),n.send(),n},numeric.imageURL=function(t){function n(e){var t=e.length,n,r,i,s,o,u,a,f,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";for(n=0;n<t;n+=3)r=e[n],i=e[n+1],s=e[n+2],o=r>>2,u=((r&3)<<4)+(i>>4),a=((i&15)<<2)+(s>>6),f=s&63,n+1>=t?a=f=64:n+2>=t&&(f=64),c+=l.charAt(o)+l.charAt(u)+l.charAt(a)+l.charAt(f);return c}function r(e,t,n){typeof t=="undefined"&&(t=0),typeof n=="undefined"&&(n=e.length);var r=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],i=-1,s=0,o=e.length,u;for(u=t;u<n;u++)s=(i^e[u])&255,i=i>>>8^r[s];return i^-1}var i=t[0].length,s=t[0][0].length,o,u,a,f,l,c,h,p,d,v,m,g=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,s>>24&255,s>>16&255,s>>8&255,s&255,i>>24&255,i>>16&255,i>>8&255,i&255,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];m=r(g,12,29),g[29]=m>>24&255,g[30]=m>>16&255,g[31]=m>>8&255,g[32]=m&255,o=1,u=0;for(p=0;p<i;p++){p<i-1?g.push(0):g.push(1),c=3*s+1+(p===0)&255,h=3*s+1+(p===0)>>8&255,g.push(c),g.push(h),g.push(~c&255),g.push(~h&255),p===0&&g.push(0);for(d=0;d<s;d++)for(f=0;f<3;f++)c=t[f][p][d],c>255?c=255:c<0?c=0:c=Math.round(c),o=(o+c)%65521,u=(u+o)%65521,g.push(c);g.push(0)}return v=(u<<16)+o,g.push(v>>24&255),g.push(v>>16&255),g.push(v>>8&255),g.push(v&255),l=g.length-41,g[33]=l>>24&255,g[34]=l>>16&255,g[35]=l>>8&255,g[36]=l&255,m=r(g,37),g.push(m>>24&255),g.push(m>>16&255),g.push(m>>8&255),g.push(m&255),g.push(0),g.push(0),g.push(0),g.push(0),g.push(73),g.push(69),g.push(78),g.push(68),g.push(174),g.push(66),g.push(96),g.push(130),"data:image/png;base64,"+n(g)},numeric._dim=function(t){var n=[];while(typeof t=="object")n.push(t.length),t=t[0];return n},numeric.dim=function(t){var n,r;if(typeof t=="object")return n=t[0],typeof n=="object"?(r=n[0],typeof r=="object"?numeric._dim(t):[t.length,n.length]):[t.length];return[]},numeric.mapreduce=function(t,n){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+n+";\n"+'if(typeof x === "number") { var xi = x; '+t+"; return accum; }\n"+'if(typeof _s === "undefined") _s = numeric.dim(x);\n'+'if(typeof _k === "undefined") _k = 0;\n'+"var _n = _s[_k];\n"+"var i,xi;\n"+"if(_k < _s.length-1) {\n"+"    for(i=_n-1;i>=0;i--) {\n"+"        accum = arguments.callee(x[i],accum,_s,_k+1);\n"+"    }"+"    return accum;\n"+"}\n"+"for(i=_n-1;i>=1;i-=2) { \n"+"    xi = x[i];\n"+"    "+t+";\n"+"    xi = x[i-1];\n"+"    "+t+";\n"+"}\n"+"if(i === 0) {\n"+"    xi = x[i];\n"+"    "+t+"\n"+"}\n"+"return accum;")},numeric.mapreduce2=function(t,n){return Function("x","var n = x.length;\nvar i,xi;\n"+n+";\n"+"for(i=n-1;i!==-1;--i) { \n"+"    xi = x[i];\n"+"    "+t+";\n"+"}\n"+"return accum;")},numeric.same=function same(e,t){var n,r;if(e instanceof Array&&t instanceof Array){r=e.length;if(r!==t.length)return!1;for(n=0;n<r;n++){if(e[n]===t[n])continue;if(typeof e[n]!="object")return!1;if(!same(e[n],t[n]))return!1}return!0}return!1},numeric.rep=function(t,n,r){typeof r=="undefined"&&(r=0);var i=t[r],s=Array(i),o;if(r===t.length-1){for(o=i-2;o>=0;o-=2)s[o+1]=n,s[o]=n;return o===-1&&(s[0]=n),s}for(o=i-1;o>=0;o--)s[o]=numeric.rep(t,n,r+1);return s},numeric.dotMMsmall=function(t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v,m;o=t.length,u=n.length,a=n[0].length,f=Array(o);for(r=o-1;r>=0;r--){l=Array(a),c=t[r];for(s=a-1;s>=0;s--){h=c[u-1]*n[u-1][s];for(i=u-2;i>=1;i-=2)p=i-1,h+=c[i]*n[i][s]+c[p]*n[p][s];i===0&&(h+=c[0]*n[0][s]),l[s]=h}f[r]=l}return f},numeric._getCol=function(t,n,r){var i=t.length,s;for(s=i-1;s>0;--s)r[s]=t[s][n],--s,r[s]=t[s][n];s===0&&(r[0]=t[0][n])},numeric.dotMMbig=function(t,n){var r=numeric._getCol,i=n.length,s=Array(i),o=t.length,u=n[0].length,a=new Array(o),f,l=numeric.dotVV,c,h,p,d;--i,--o;for(c=o;c!==-1;--c)a[c]=Array(u);--u;for(c=u;c!==-1;--c){r(n,c,s);for(h=o;h!==-1;--h)d=0,f=t[h],a[h][c]=l(f,s)}return a},numeric.dotMV=function(t,n){var r=t.length,i=n.length,s,o=Array(r),u=numeric.dotVV;for(s=r-1;s>=0;s--)o[s]=u(t[s],n);return o},numeric.dotVM=function(t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E;o=t.length,u=n[0].length,f=Array(u);for(s=u-1;s>=0;s--){h=t[o-1]*n[o-1][s];for(i=o-2;i>=1;i-=2)p=i-1,h+=t[i]*n[i][s]+t[p]*n[p][s];i===0&&(h+=t[0]*n[0][s]),f[s]=h}return f},numeric.dotVV=function(t,n){var r,i=t.length,s,o=t[i-1]*n[i-1];for(r=i-2;r>=1;r-=2)s=r-1,o+=t[r]*n[r]+t[s]*n[s];return r===0&&(o+=t[0]*n[0]),o},numeric.dot=function(t,n){var r=numeric.dim;switch(r(t).length*1e3+r(n).length){case 2002:return n.length<10?numeric.dotMMsmall(t,n):numeric.dotMMbig(t,n);case 2001:return numeric.dotMV(t,n);case 1002:return numeric.dotVM(t,n);case 1001:return numeric.dotVV(t,n);case 1e3:return numeric.mulVS(t,n);case 1:return numeric.mulSV(t,n);case 0:return t*n;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(t){var n,r,i,s=t.length,o=Array(s),u;for(n=s-1;n>=0;n--){u=Array(s),r=n+2;for(i=s-1;i>=r;i-=2)u[i]=0,u[i-1]=0;i>n&&(u[i]=0),u[n]=t[n];for(i=n-1;i>=1;i-=2)u[i]=0,u[i-1]=0;i===0&&(u[0]=0),o[n]=u}return o},numeric.getDiag=function(e){var t=Math.min(e.length,e[0].length),n,r=Array(t);for(n=t-1;n>=1;--n)r[n]=e[n][n],--n,r[n]=e[n][n];return n===0&&(r[0]=e[0][0]),r},numeric.identity=function(t){return numeric.diag(numeric.rep([t],1))},numeric.pointwise=function(t,n,r){typeof r=="undefined"&&(r="");var i=[],s,o=/\[i\]$/,u,a="",f=!1;for(s=0;s<t.length;s++)o.test(t[s])?(u=t[s].substring(0,t[s].length-3),a=u):u=t[s],u==="ret"&&(f=!0),i.push(u);return i[t.length]="_s",i[t.length+1]="_k",i[t.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+a+");\n"+'if(typeof _k === "undefined") _k = 0;\n'+"var _n = _s[_k];\n"+"var i"+(f?"":", ret = Array(_n)")+";\n"+"if(_k < _s.length-1) {\n"+"    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+t.join(",")+",_s,_k+1);\n"+"    return ret;\n"+"}\n"+r+"\n"+"for(i=_n-1;i!==-1;--i) {\n"+"    "+n+"\n"+"}\n"+"return ret;",Function.apply(null,i)},numeric.pointwise2=function(t,n,r){typeof r=="undefined"&&(r="");var i=[],s,o=/\[i\]$/,u,a="",f=!1;for(s=0;s<t.length;s++)o.test(t[s])?(u=t[s].substring(0,t[s].length-3),a=u):u=t[s],u==="ret"&&(f=!0),i.push(u);return i[t.length]="var _n = "+a+".length;\n"+"var i"+(f?"":", ret = Array(_n)")+";\n"+r+"\n"+"for(i=_n-1;i!==-1;--i) {\n"+n+"\n"+"}\n"+"return ret;",Function.apply(null,i)},numeric._biforeach=function _biforeach(e,t,n,r,i){if(r===n.length-1){i(e,t);return}var s,o=n[r];for(s=o-1;s>=0;s--)_biforeach(typeof e=="object"?e[s]:e,typeof t=="object"?t[s]:t,n,r+1,i)},numeric._biforeach2=function _biforeach2(e,t,n,r,i){if(r===n.length-1)return i(e,t);var s,o=n[r],u=Array(o);for(s=o-1;s>=0;--s)u[s]=_biforeach2(typeof e=="object"?e[s]:e,typeof t=="object"?t[s]:t,n,r+1,i);return u},numeric._foreach=function _foreach(e,t,n,r){if(n===t.length-1){r(e);return}var i,s=t[n];for(i=s-1;i>=0;i--)_foreach(e[i],t,n+1,r)},numeric._foreach2=function _foreach2(e,t,n,r){if(n===t.length-1)return r(e);var i,s=t[n],o=Array(s);for(i=s-1;i>=0;i--)o[i]=_foreach2(e[i],t,n+1,r);return o},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var e,t;for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],numeric.ops2[t]=t;for(e in numeric.ops2)if(numeric.ops2.hasOwnProperty(e)){t=numeric.ops2[e];var n,r,i="";numeric.myIndexOf.call(numeric.mathfuns2,e)!==-1?(i="var "+t+" = Math."+t+";\n",n=function(e,n,r){return e+" = "+t+"("+n+","+r+")"},r=function(e,n){return e+" = "+t+"("+e+","+n+")"}):(n=function(e,n,r){return e+" = "+n+" "+t+" "+r},numeric.opseq.hasOwnProperty(e+"eq")?r=function(e,n){return e+" "+t+"= "+n}:r=function(e,n){return e+" = "+e+" "+t+" "+n}),numeric[e+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),i),numeric[e+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),i),numeric[e+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),i),numeric[e]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+"SV;\n"+"var dim = numeric.dim;\n"+"for(i=1;i!==n;++i) { \n"+"  y = arguments[i];\n"+'  if(typeof x === "object") {\n'+'      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n'+"      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n"+'  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n'+"  else "+r("x","y")+"\n"+"}\nreturn x;\n"),numeric[t]=numeric[e],numeric[e+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],r("ret[i]","x[i]"),i),numeric[e+"eqS"]=numeric.pointwise2(["ret[i]","x"],r("ret[i]","x"),i),numeric[e+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+e+"eqV, S = numeric."+e+"eqS\n"+"var s = numeric.dim(x);\n"+"for(i=1;i!==n;++i) { \n"+"  y = arguments[i];\n"+'  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n'+"  else numeric._biforeach(x,y,s,0,S);\n"+"}\nreturn x;\n")}for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],delete numeric.ops2[t];for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],numeric.ops1[t]=t;for(e in numeric.ops1)numeric.ops1.hasOwnProperty(e)&&(i="",t=numeric.ops1[e],numeric.myIndexOf.call(numeric.mathfuns,e)!==-1&&Math.hasOwnProperty(t)&&(i="var "+t+" = Math."+t+";\n"),numeric[e+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",i),numeric[e+"eq"]=Function("x",'if(typeof x !== "object") return '+t+"x\n"+"var i;\n"+"var V = numeric."+e+"eqV;\n"+"var s = numeric.dim(x);\n"+"numeric._foreach(x,s,0,V);\n"+"return x;\n"),numeric[e+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",i),numeric[e]=Function("x",'if(typeof x !== "object") return '+t+"(x)\n"+"var i;\n"+"var V = numeric."+e+"V;\n"+"var s = numeric.dim(x);\n"+"return numeric._foreach2(x,s,0,V);\n"));for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],delete numeric.ops1[t];for(e in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(e)&&(t=numeric.mapreducers[e],numeric[e+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[e]=Function("x","s","k",t[1]+'if(typeof x !== "object") {'+"    xi = x;\n"+t[0]+";\n"+"    return accum;\n"+"}"+'if(typeof s === "undefined") s = numeric.dim(x);\n'+'if(typeof k === "undefined") k = 0;\n'+"if(k === s.length-1) return numeric."+e+"V(x);\n"+"var xi;\n"+"var n = x.length, i;\n"+"for(i=n-1;i!==-1;--i) {\n"+"   xi = arguments.callee(x[i]);\n"+t[0]+";\n"+"}\n"+"return accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(t,n){return typeof t=="object"?typeof n=="object"?numeric.truncVV(t,n):numeric.truncVS(t,n):typeof n=="object"?numeric.truncSV(t,n):Math.round(t/n)*n},numeric.inv=function(t){var n=numeric.dim(t),r=Math.abs,i=n[0],s=n[1],o=numeric.clone(t),u,a,f=numeric.identity(i),l,c,h,p,d,t;for(p=0;p<s;++p){var v=-1,m=-1;for(h=p;h!==i;++h)d=r(o[h][p]),d>m&&(v=h,m=d);a=o[v],o[v]=o[p],o[p]=a,c=f[v],f[v]=f[p],f[p]=c,t=a[p];for(d=p;d!==s;++d)a[d]/=t;for(d=s-1;d!==-1;--d)c[d]/=t;for(h=i-1;h!==-1;--h)if(h!==p){u=o[h],l=f[h],t=u[p];for(d=p+1;d!==s;++d)u[d]-=a[d]*t;for(d=s-1;d>0;--d)l[d]-=c[d]*t,--d,l[d]-=c[d]*t;d===0&&(l[0]-=c[0]*t)}}return f},numeric.det=function(t){var n=numeric.dim(t);if(n.length!==2||n[0]!==n[1])throw new Error("numeric: det() only works on square matrices");var r=n[0],i=1,s,o,u,a=numeric.clone(t),f,l,c,h,p,d,v;for(o=0;o<r-1;o++){u=o;for(s=o+1;s<r;s++)Math.abs(a[s][o])>Math.abs(a[u][o])&&(u=s);u!==o&&(h=a[u],a[u]=a[o],a[o]=h,i*=-1),f=a[o];for(s=o+1;s<r;s++){l=a[s],c=l[o]/f[o];for(u=o+1;u<r-1;u+=2)p=u+1,l[u]-=f[u]*c,l[p]-=f[p]*c;u!==r&&(l[u]-=f[u]*c)}if(f[o]===0)return 0;i*=f[o]}return i*a[o][o]},numeric.transpose=function(t){var n,r,i=t.length,s=t[0].length,o=Array(s),u,a,f;for(r=0;r<s;r++)o[r]=Array(i);for(n=i-1;n>=1;n-=2){a=t[n],u=t[n-1];for(r=s-1;r>=1;--r)f=o[r],f[n]=a[r],f[n-1]=u[r],--r,f=o[r],f[n]=a[r],f[n-1]=u[r];r===0&&(f=o[0],f[n]=a[0],f[n-1]=u[0])}if(n===0){u=t[0];for(r=s-1;r>=1;--r)o[r][0]=u[r],--r,o[r][0]=u[r];r===0&&(o[0][0]=u[0])}return o},numeric.negtranspose=function(t){var n,r,i=t.length,s=t[0].length,o=Array(s),u,a,f;for(r=0;r<s;r++)o[r]=Array(i);for(n=i-1;n>=1;n-=2){a=t[n],u=t[n-1];for(r=s-1;r>=1;--r)f=o[r],f[n]=-a[r],f[n-1]=-u[r],--r,f=o[r],f[n]=-a[r],f[n-1]=-u[r];r===0&&(f=o[0],f[n]=-a[0],f[n-1]=-u[0])}if(n===0){u=t[0];for(r=s-1;r>=1;--r)o[r][0]=-u[r],--r,o[r][0]=-u[r];r===0&&(o[0][0]=-u[0])}return o},numeric._random=function _random(e,t){var n,r=e[t],i=Array(r),s;if(t===e.length-1){s=Math.random;for(n=r-1;n>=1;n-=2)i[n]=s(),i[n-1]=s();return n===0&&(i[0]=s()),i}for(n=r-1;n>=0;n--)i[n]=_random(e,t+1);return i},numeric.random=function(t){return numeric._random(t,0)},numeric.norm2=function(t){return Math.sqrt(numeric.norm2Squared(t))},numeric.linspace=function(t,n,r){typeof r=="undefined"&&(r=Math.max(Math.round(n-t)+1,1));if(r<2)return r===1?[t]:[];var i,s=Array(r);r--;for(i=r;i>=0;i--)s[i]=(i*n+(r-i)*t)/r;return s},numeric.getBlock=function(t,n,r){function s(e,t){var o,u=n[t],a=r[t]-u,f=Array(a);if(t===i.length-1){for(o=a;o>=0;o--)f[o]=e[o+u];return f}for(o=a;o>=0;o--)f[o]=s(e[o+u],t+1);return f}var i=numeric.dim(t);return s(t,0)},numeric.setBlock=function(t,n,r,i){function o(e,t,i){var u,a=n[i],f=r[i]-a;if(i===s.length-1)for(u=f;u>=0;u--)e[u+a]=t[u];for(u=f;u>=0;u--)o(e[u+a],t[u],i+1)}var s=numeric.dim(t);return o(t,i,0),t},numeric.getRange=function(t,n,r){var i=n.length,s=r.length,o,u,a=Array(i),f,l;for(o=i-1;o!==-1;--o){a[o]=Array(s),f=a[o],l=t[n[o]];for(u=s-1;u!==-1;--u)f[u]=l[r[u]]}return a},numeric.blockMatrix=function(t){var n=numeric.dim(t);if(n.length<4)return numeric.blockMatrix([t]);var r=n[0],i=n[1],s,o,u,a,f;s=0,o=0;for(u=0;u<r;++u)s+=t[u][0].length;for(a=0;a<i;++a)o+=t[0][a][0].length;var l=Array(s);for(u=0;u<s;++u)l[u]=Array(o);var c=0,h,p,d,v,m;for(u=0;u<r;++u){h=o;for(a=i-1;a!==-1;--a){f=t[u][a],h-=f[0].length;for(d=f.length-1;d!==-1;--d){m=f[d],p=l[c+d];for(v=m.length-1;v!==-1;--v)p[h+v]=m[v]}}c+=t[u][0].length}return l},numeric.tensor=function(t,n){if(typeof t=="number"||typeof n=="number")return numeric.mul(t,n);var r=numeric.dim(t),i=numeric.dim(n);if(r.length!==1||i.length!==1)throw new Error("numeric: tensor product is only defined for vectors");var s=r[0],o=i[0],u=Array(s),a,f,l,c;for(f=s-1;f>=0;f--){a=Array(o),c=t[f];for(l=o-1;l>=3;--l)a[l]=c*n[l],--l,a[l]=c*n[l],--l,a[l]=c*n[l],--l,a[l]=c*n[l];while(l>=0)a[l]=c*n[l],--l;u[f]=a}return u},numeric.T=function(t,n){this.x=t,this.y=n},numeric.t=function(t,n){return new numeric.T(t,n)},numeric.Tbinop=function(t,n,r,i,s){var o=numeric.indexOf;if(typeof s!="string"){var u;s="";for(u in numeric)numeric.hasOwnProperty(u)&&(t.indexOf(u)>=0||n.indexOf(u)>=0||r.indexOf(u)>=0||i.indexOf(u)>=0)&&u.length>1&&(s+="var "+u+" = numeric."+u+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+s+"\n"+"if(x.y) {"+"  if(y.y) {"+"    return new numeric.T("+i+");\n"+"  }\n"+"  return new numeric.T("+r+");\n"+"}\n"+"if(y.y) {\n"+"  return new numeric.T("+n+");\n"+"}\n"+"return new numeric.T("+t+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var t=numeric.mul,n=numeric.div;if(this.y){var r=numeric.add(t(this.x,this.x),t(this.y,this.y));return new numeric.T(n(this.x,r),n(numeric.neg(this.y),r))}return new T(n(1,this.x))},numeric.T.prototype.div=function div(e){e instanceof numeric.T||(e=new numeric.T(e));if(e.y)return this.mul(e.reciprocal());var div=numeric.div;return this.y?new numeric.T(div(this.x,e.x),div(this.y,e.x)):new numeric.T(div(this.x,e.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var t=numeric.transpose,n=this.x,r=this.y;return r?new numeric.T(t(n),t(r)):new numeric.T(t(n))},numeric.T.prototype.transjugate=function(){var t=numeric.transpose,n=this.x,r=this.y;return r?new numeric.T(t(n),numeric.negtranspose(r)):new numeric.T(t(n))},numeric.Tunop=function(t,n,r){return typeof r!="string"&&(r=""),Function("var x = this;\n"+r+"\n"+"if(x.y) {"+"  "+n+";\n"+"}\n"+t+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var t=this;if(typeof t.y=="undefined")return new numeric.T(numeric.inv(t.x));var n=t.x.length,r,i,s,o=numeric.identity(n),u=numeric.rep([n,n],0),a=numeric.clone(t.x),f=numeric.clone(t.y),l,c,h,p,d,v,m,g,r,i,s,y,b,w,E,S,x,T;for(r=0;r<n;r++){w=a[r][r],E=f[r][r],y=w*w+E*E,s=r;for(i=r+1;i<n;i++)w=a[i][r],E=f[i][r],b=w*w+E*E,b>y&&(s=i,y=b);s!==r&&(T=a[r],a[r]=a[s],a[s]=T,T=f[r],f[r]=f[s],f[s]=T,T=o[r],o[r]=o[s],o[s]=T,T=u[r],u[r]=u[s],u[s]=T),l=a[r],c=f[r],d=o[r],v=u[r],w=l[r],E=c[r];for(i=r+1;i<n;i++)S=l[i],x=c[i],l[i]=(S*w+x*E)/y,c[i]=(x*w-S*E)/y;for(i=0;i<n;i++)S=d[i],x=v[i],d[i]=(S*w+x*E)/y,v[i]=(x*w-S*E)/y;for(i=r+1;i<n;i++){h=a[i],p=f[i],m=o[i],g=u[i],w=h[r],E=p[r];for(s=r+1;s<n;s++)S=l[s],x=c[s],h[s]-=S*w-x*E,p[s]-=x*w+S*E;for(s=0;s<n;s++)S=d[s],x=v[s],m[s]-=S*w-x*E,g[s]-=x*w+S*E}}for(r=n-1;r>0;r--){d=o[r],v=u[r];for(i=r-1;i>=0;i--){m=o[i],g=u[i],w=a[i][r],E=f[i][r];for(s=n-1;s>=0;s--)S=d[s],x=v[s],m[s]-=w*S-E*x,g[s]-=w*x+E*S}}return new numeric.T(o,u)},numeric.T.prototype.get=function(t){var n=this.x,r=this.y,i=0,s,o=t.length;if(r){while(i<o)s=t[i],n=n[s],r=r[s],i++;return new numeric.T(n,r)}while(i<o)s=t[i],n=n[s],i++;return new numeric.T(n)},numeric.T.prototype.set=function(t,n){var r=this.x,i=this.y,s=0,o,u=t.length,a=n.x,f=n.y;if(u===0)return f?this.y=f:i&&(this.y=undefined),this.x=r,this;if(f){i||(i=numeric.rep(numeric.dim(r),0),this.y=i);while(s<u-1)o=t[s],r=r[o],i=i[o],s++;return o=t[s],r[o]=a,i[o]=f,this}if(i){while(s<u-1)o=t[s],r=r[o],i=i[o],s++;return o=t[s],r[o]=a,a instanceof Array?i[o]=numeric.rep(numeric.dim(a),0):i[o]=0,this}while(s<u-1)o=t[s],r=r[o],s++;return o=t[s],r[o]=a,this},numeric.T.prototype.getRows=function(t,n){var r=n-t+1,i,s=Array(r),o,u=this.x,a=this.y;for(i=t;i<=n;i++)s[i-t]=u[i];if(a){o=Array(r);for(i=t;i<=n;i++)o[i-t]=a[i];return new numeric.T(s,o)}return new numeric.T(s)},numeric.T.prototype.setRows=function(t,n,r){var i,s=this.x,o=this.y,u=r.x,a=r.y;for(i=t;i<=n;i++)s[i]=u[i-t];if(a){o||(o=numeric.rep(numeric.dim(s),0),this.y=o);for(i=t;i<=n;i++)o[i]=a[i-t]}else if(o)for(i=t;i<=n;i++)o[i]=numeric.rep([u[i-t].length],0);return this},numeric.T.prototype.getRow=function(t){var n=this.x,r=this.y;return r?new numeric.T(n[t],r[t]):new numeric.T(n[t])},numeric.T.prototype.setRow=function(t,n){var r=this.x,i=this.y,s=n.x,o=n.y;return r[t]=s,o?(i||(i=numeric.rep(numeric.dim(r),0),this.y=i),i[t]=o):i&&(i=numeric.rep([s.length],0)),this},numeric.T.prototype.getBlock=function(t,n){var r=this.x,i=this.y,s=numeric.getBlock;return i?new numeric.T(s(r,t,n),s(i,t,n)):new numeric.T(s(r,t,n))},numeric.T.prototype.setBlock=function(t,n,r){r instanceof numeric.T||(r=new numeric.T(r));var i=this.x,s=this.y,o=numeric.setBlock,u=r.x,a=r.y;if(a)return s||(this.y=numeric.rep(numeric.dim(this),0),s=this.y),o(i,t,n,u),o(s,t,n,a),this;o(i,t,n,u),s&&o(s,t,n,numeric.rep(numeric.dim(u),0))},numeric.T.rep=function(t,n){var r=numeric.T;n instanceof r||(n=new r(n));var i=n.x,s=n.y,o=numeric.rep;return s?new r(o(t,i),o(t,s)):new r(o(t,i))},numeric.T.diag=function diag(e){e instanceof numeric.T||(e=new numeric.T(e));var t=e.x,n=e.y,diag=numeric.diag;return n?new numeric.T(diag(t),diag(n)):new numeric.T(diag(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(t){return new numeric.T(numeric.identity(t))},numeric.T.prototype.getDiag=function(){var t=numeric,n=this.x,r=this.y;return r?new t.T(t.getDiag(n),t.getDiag(r)):new t.T(t.getDiag(n))},numeric.house=function(t){var n=numeric.clone(t),r=t[0]>=0?1:-1,i=r*numeric.norm2(t);n[0]+=i;var s=numeric.norm2(n);if(s===0)throw new Error("eig: internal error");return numeric.div(n,s)},numeric.toUpperHessenberg=function(t){var n=numeric.dim(t);if(n.length!==2||n[0]!==n[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var r=n[0],i,s,o,u,a,f=numeric.clone(t),l,c,h,p,d=numeric.identity(r),v;for(s=0;s<r-2;s++){u=Array(r-s-1);for(i=s+1;i<r;i++)u[i-s-1]=f[i][s];if(numeric.norm2(u)>0){a=numeric.house(u),l=numeric.getBlock(f,[s+1,s],[r-1,r-1]),c=numeric.tensor(a,numeric.dot(a,l));for(i=s+1;i<r;i++){h=f[i],p=c[i-s-1];for(o=s;o<r;o++)h[o]-=2*p[o-s]}l=numeric.getBlock(f,[0,s+1],[r-1,r-1]),c=numeric.tensor(numeric.dot(l,a),a);for(i=0;i<r;i++){h=f[i],p=c[i];for(o=s+1;o<r;o++)h[o]-=2*p[o-s-1]}l=Array(r-s-1);for(i=s+1;i<r;i++)l[i-s-1]=d[i];c=numeric.tensor(a,numeric.dot(a,l));for(i=s+1;i<r;i++){v=d[i],p=c[i-s-1];for(o=0;o<r;o++)v[o]-=2*p[o]}}}return{H:f,Q:d}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(e,t){typeof t=="undefined"&&(t=1e4),e=numeric.clone(e);var n=numeric.clone(e),r=numeric.dim(e),i=r[0],s,o,u,a,f,l,c,h,p,d=numeric.identity(i),v,m,g,y,b,w,E,S,x;if(i<3)return{Q:d,B:[[0,i-1]]};var T=numeric.epsilon;for(x=0;x<t;x++){for(E=0;E<i-1;E++)if(Math.abs(e[E+1][E])<T*(Math.abs(e[E][E])+Math.abs(e[E+1][E+1]))){var N=numeric.QRFrancis(numeric.getBlock(e,[0,0],[E,E]),t),C=numeric.QRFrancis(numeric.getBlock(e,[E+1,E+1],[i-1,i-1]),t);g=Array(E+1);for(w=0;w<=E;w++)g[w]=d[w];y=numeric.dot(N.Q,g);for(w=0;w<=E;w++)d[w]=y[w];g=Array(i-E-1);for(w=E+1;w<i;w++)g[w-E-1]=d[w];y=numeric.dot(C.Q,g);for(w=E+1;w<i;w++)d[w]=y[w-E-1];return{Q:d,B:N.B.concat(numeric.add(C.B,E+1))}}u=e[i-2][i-2],a=e[i-2][i-1],f=e[i-1][i-2],l=e[i-1][i-1],h=u+l,c=u*l-a*f,p=numeric.getBlock(e,[0,0],[2,2]);if(h*h>=4*c){var k,L;k=.5*(h+Math.sqrt(h*h-4*c)),L=.5*(h-Math.sqrt(h*h-4*c)),p=numeric.add(numeric.sub(numeric.dot(p,p),numeric.mul(p,k+L)),numeric.diag(numeric.rep([3],k*L)))}else p=numeric.add(numeric.sub(numeric.dot(p,p),numeric.mul(p,h)),numeric.diag(numeric.rep([3],c)));s=[p[0][0],p[1][0],p[2][0]],o=numeric.house(s),g=[e[0],e[1],e[2]],y=numeric.tensor(o,numeric.dot(o,g));for(w=0;w<3;w++){m=e[w],b=y[w];for(S=0;S<i;S++)m[S]-=2*b[S]}g=numeric.getBlock(e,[0,0],[i-1,2]),y=numeric.tensor(numeric.dot(g,o),o);for(w=0;w<i;w++){m=e[w],b=y[w];for(S=0;S<3;S++)m[S]-=2*b[S]}g=[d[0],d[1],d[2]],y=numeric.tensor(o,numeric.dot(o,g));for(w=0;w<3;w++){v=d[w],b=y[w];for(S=0;S<i;S++)v[S]-=2*b[S]}var A;for(E=0;E<i-2;E++){for(S=E;S<=E+1;S++)if(Math.abs(e[S+1][S])<T*(Math.abs(e[S][S])+Math.abs(e[S+1][S+1]))){var N=numeric.QRFrancis(numeric.getBlock(e,[0,0],[S,S]),t),C=numeric.QRFrancis(numeric.getBlock(e,[S+1,S+1],[i-1,i-1]),t);g=Array(S+1);for(w=0;w<=S;w++)g[w]=d[w];y=numeric.dot(N.Q,g);for(w=0;w<=S;w++)d[w]=y[w];g=Array(i-S-1);for(w=S+1;w<i;w++)g[w-S-1]=d[w];y=numeric.dot(C.Q,g);for(w=S+1;w<i;w++)d[w]=y[w-S-1];return{Q:d,B:N.B.concat(numeric.add(C.B,S+1))}}A=Math.min(i-1,E+3),s=Array(A-E);for(w=E+1;w<=A;w++)s[w-E-1]=e[w][E];o=numeric.house(s),g=numeric.getBlock(e,[E+1,E],[A,i-1]),y=numeric.tensor(o,numeric.dot(o,g));for(w=E+1;w<=A;w++){m=e[w],b=y[w-E-1];for(S=E;S<i;S++)m[S]-=2*b[S-E]}g=numeric.getBlock(e,[0,E+1],[i-1,A]),y=numeric.tensor(numeric.dot(g,o),o);for(w=0;w<i;w++){m=e[w],b=y[w];for(S=E+1;S<=A;S++)m[S]-=2*b[S-E-1]}g=Array(A-E);for(w=E+1;w<=A;w++)g[w-E-1]=d[w];y=numeric.tensor(o,numeric.dot(o,g));for(w=E+1;w<=A;w++){v=d[w],b=y[w-E-1];for(S=0;S<i;S++)v[S]-=2*b[S]}}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(t,n){var r=numeric.toUpperHessenberg(t),i=numeric.QRFrancis(r.H,n),s=numeric.T,o=t.length,u,a,f=!1,l=i.B,c=numeric.dot(i.Q,numeric.dot(r.H,numeric.transpose(i.Q))),h=new s(numeric.dot(i.Q,r.Q)),p,d=l.length,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A=Math.sqrt;for(a=0;a<d;a++){u=l[a][0];if(u!==l[a][1]){v=u+1,m=c[u][u],g=c[u][v],y=c[v][u],b=c[v][v];if(g===0&&y===0)continue;w=-m-b,E=m*b-g*y,S=w*w-4*E,S>=0?(w<0?x=-0.5*(w-A(S)):x=-0.5*(w+A(S)),k=(m-x)*(m-x)+g*g,L=y*y+(b-x)*(b-x),k>L?(k=A(k),N=(m-x)/k,C=g/k):(L=A(L),N=y/L,C=(b-x)/L),p=new s([[C,-N],[N,C]]),h.setRows(u,v,p.dot(h.getRows(u,v)))):(x=-0.5*w,T=.5*A(-S),k=(m-x)*(m-x)+g*g,L=y*y+(b-x)*(b-x),k>L?(k=A(k+T*T),N=(m-x)/k,C=g/k,x=0,T/=k):(L=A(L+T*T),N=y/L,C=(b-x)/L,x=T/L,T=0),p=new s([[C,-N],[N,C]],[[x,
T],[T,-x]]),h.setRows(u,v,p.dot(h.getRows(u,v))))}}var O=h.dot(t).dot(h.transjugate()),o=t.length,M=numeric.T.identity(o);for(v=0;v<o;v++)if(v>0)for(a=v-1;a>=0;a--){var _=O.get([a,a]),D=O.get([v,v]);if(!numeric.neq(_.x,D.x)&&!numeric.neq(_.y,D.y)){M.setRow(v,M.getRow(a));continue}x=O.getRow(a).getBlock([a],[v-1]),T=M.getRow(v).getBlock([a],[v-1]),M.set([v,a],O.get([a,v]).neg().sub(x.dot(T)).div(_.sub(D)))}for(v=0;v<o;v++)x=M.getRow(v),M.setRow(v,x.div(x.norm2()));return M=M.transpose(),M=h.transjugate().dot(M),{lambda:O.getDiag(),E:M}},numeric.ccsSparse=function(t){var n=t.length,r,i,s,o,u=[];for(s=n-1;s!==-1;--s){i=t[s];for(o in i){o=parseInt(o);while(o>=u.length)u[u.length]=0;i[o]!==0&&u[o]++}}var r=u.length,a=Array(r+1);a[0]=0;for(s=0;s<r;++s)a[s+1]=a[s]+u[s];var f=Array(a[r]),l=Array(a[r]);for(s=n-1;s!==-1;--s){i=t[s];for(o in i)i[o]!==0&&(u[o]--,f[a[o]+u[o]]=s,l[a[o]+u[o]]=i[o])}return[a,f,l]},numeric.ccsFull=function(t){var n=t[0],r=t[1],i=t[2],s=numeric.ccsDim(t),o=s[0],u=s[1],a,f,l,c,h,p=numeric.rep([o,u],0);for(a=0;a<u;a++){l=n[a],c=n[a+1];for(f=l;f<c;++f)p[r[f]][a]=i[f]}return p},numeric.ccsTSolve=function(t,n,r,i,s){function h(e){var t;if(r[e]!==0)return;r[e]=1;for(t=o[e];t<o[e+1];++t)h(u[t]);s[c]=e,++c}var o=t[0],u=t[1],a=t[2],f=o.length-1,l=Math.max,c=0;typeof i=="undefined"&&(r=numeric.rep([f],0)),typeof i=="undefined"&&(i=numeric.linspace(0,r.length-1)),typeof s=="undefined"&&(s=[]);var p,d,v,m,g,y,b,w,E;for(p=i.length-1;p!==-1;--p)h(i[p]);s.length=c;for(p=s.length-1;p!==-1;--p)r[s[p]]=0;for(p=i.length-1;p!==-1;--p)d=i[p],r[d]=n[d];for(p=s.length-1;p!==-1;--p){d=s[p],v=o[d],m=l(o[d+1],v);for(g=v;g!==m;++g)if(u[g]===d){r[d]/=a[g];break}E=r[d];for(g=v;g!==m;++g)y=u[g],y!==d&&(r[y]-=E*a[g])}return r},numeric.ccsDFS=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS.prototype.dfs=function(t,n,r,i,s,o){var u=0,a,f=s.length,l=this.k,c=this.k1,h=this.j,p,d;if(i[t]!==0)return;i[t]=1,h[0]=t,l[0]=p=n[t],c[0]=d=n[t+1];for(;;)if(p>=d){s[f]=h[u];if(u===0)return;++f,--u,p=l[u],d=c[u]}else a=o[r[p]],i[a]===0?(i[a]=1,l[u]=p,++u,h[u]=a,p=n[a],c[u]=d=n[a+1]):++p},numeric.ccsLPSolve=function(t,n,r,i,s,o,u){var a=t[0],f=t[1],l=t[2],c=a.length-1,h=0,p=n[0],d=n[1],v=n[2],m,g,y,b,w,E,S,x,T,N,C,k;g=p[s],y=p[s+1],i.length=0;for(m=g;m<y;++m)u.dfs(o[d[m]],a,f,r,i,o);for(m=i.length-1;m!==-1;--m)r[i[m]]=0;for(m=g;m!==y;++m)b=o[d[m]],r[b]=v[m];for(m=i.length-1;m!==-1;--m){b=i[m],E=a[b],S=a[b+1];for(x=E;x<S;++x)if(o[f[x]]===b){r[b]/=l[x];break}k=r[b];for(x=E;x<S;++x)T=o[f[x]],T!==b&&(r[T]-=k*l[x])}return r},numeric.ccsLUP1=function(t,n){var r=t[0].length-1,i=[numeric.rep([r+1],0),[],[]],s=[numeric.rep([r+1],0),[],[]],o=i[0],u=i[1],a=i[2],f=s[0],l=s[1],c=s[2],h=numeric.rep([r],0),p=numeric.rep([r],0),d,v,m,g,y,b,w,E,S,x,T=numeric.ccsLPSolve,N=Math.max,C=Math.abs,k=numeric.linspace(0,r-1),L=numeric.linspace(0,r-1),A=new numeric.ccsDFS(r);typeof n=="undefined"&&(n=1);for(d=0;d<r;++d){T(i,t,h,p,d,L,A),b=-1,w=-1;for(v=p.length-1;v!==-1;--v){m=p[v];if(m<=d)continue;E=C(h[m]),E>b&&(w=m,b=E)}C(h[d])<n*b&&(v=k[d],b=k[w],k[d]=b,L[b]=d,k[w]=v,L[v]=w,b=h[d],h[d]=h[w],h[w]=b),b=o[d],w=f[d],S=h[d],u[b]=k[d],a[b]=1,++b;for(v=p.length-1;v!==-1;--v)m=p[v],E=h[m],p[v]=0,h[m]=0,m<=d?(l[w]=m,c[w]=E,++w):(u[b]=k[m],a[b]=E/S,++b);o[d+1]=b,f[d+1]=w}for(v=u.length-1;v!==-1;--v)u[v]=L[u[v]];return{L:i,U:s,P:k,Pinv:L}},numeric.ccsDFS0=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS0.prototype.dfs=function(t,n,r,i,s,o,u){var a=0,f,l=s.length,c=this.k,h=this.k1,p=this.j,d,v;if(i[t]!==0)return;i[t]=1,p[0]=t,c[0]=d=n[o[t]],h[0]=v=n[o[t]+1];for(;;){if(isNaN(d))throw new Error("Ow!");if(d>=v){s[l]=o[p[a]];if(a===0)return;++l,--a,d=c[a],v=h[a]}else f=r[d],i[f]===0?(i[f]=1,c[a]=d,++a,p[a]=f,f=o[f],d=n[f],h[a]=v=n[f+1]):++d}},numeric.ccsLPSolve0=function(t,n,r,i,s,o,u,a){var f=t[0],l=t[1],c=t[2],h=f.length-1,p=0,d=n[0],v=n[1],m=n[2],g,y,b,w,E,S,x,T,N,C,k,L;y=d[s],b=d[s+1],i.length=0;for(g=y;g<b;++g)a.dfs(v[g],f,l,r,i,o,u);for(g=i.length-1;g!==-1;--g)w=i[g],r[u[w]]=0;for(g=y;g!==b;++g)w=v[g],r[w]=m[g];for(g=i.length-1;g!==-1;--g){w=i[g],N=u[w],S=f[w],x=f[w+1];for(T=S;T<x;++T)if(l[T]===N){r[N]/=c[T];break}L=r[N];for(T=S;T<x;++T)r[l[T]]-=L*c[T];r[N]=L}},numeric.ccsLUP0=function(t,n){var r=t[0].length-1,i=[numeric.rep([r+1],0),[],[]],s=[numeric.rep([r+1],0),[],[]],o=i[0],u=i[1],a=i[2],f=s[0],l=s[1],c=s[2],h=numeric.rep([r],0),p=numeric.rep([r],0),d,v,m,g,y,b,w,E,S,x,T=numeric.ccsLPSolve0,N=Math.max,C=Math.abs,k=numeric.linspace(0,r-1),L=numeric.linspace(0,r-1),A=new numeric.ccsDFS0(r);typeof n=="undefined"&&(n=1);for(d=0;d<r;++d){T(i,t,h,p,d,L,k,A),b=-1,w=-1;for(v=p.length-1;v!==-1;--v){m=p[v];if(m<=d)continue;E=C(h[k[m]]),E>b&&(w=m,b=E)}C(h[k[d]])<n*b&&(v=k[d],b=k[w],k[d]=b,L[b]=d,k[w]=v,L[v]=w),b=o[d],w=f[d],S=h[k[d]],u[b]=k[d],a[b]=1,++b;for(v=p.length-1;v!==-1;--v)m=p[v],E=h[k[m]],p[v]=0,h[k[m]]=0,m<=d?(l[w]=m,c[w]=E,++w):(u[b]=k[m],a[b]=E/S,++b);o[d+1]=b,f[d+1]=w}for(v=u.length-1;v!==-1;--v)u[v]=L[u[v]];return{L:i,U:s,P:k,Pinv:L}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(t){return[numeric.sup(t[1])+1,t[0].length-1]},numeric.ccsGetBlock=function(t,n,r){var i=numeric.ccsDim(t),s=i[0],o=i[1];typeof n=="undefined"?n=numeric.linspace(0,s-1):typeof n=="number"&&(n=[n]),typeof r=="undefined"?r=numeric.linspace(0,o-1):typeof r=="number"&&(r=[r]);var u,a,f,l=n.length,c,h=r.length,p,d,v,m=numeric.rep([o],0),g=[],y=[],b=[m,g,y],w=t[0],E=t[1],S=t[2],x=numeric.rep([s],0),T=0,N=numeric.rep([s],0);for(c=0;c<h;++c){d=r[c];var C=w[d],k=w[d+1];for(u=C;u<k;++u)p=E[u],N[p]=1,x[p]=S[u];for(u=0;u<l;++u)v=n[u],N[v]&&(g[T]=u,y[T]=x[n[u]],++T);for(u=C;u<k;++u)p=E[u],N[p]=0;m[c+1]=T}return b},numeric.ccsDot=function(t,n){var r=t[0],i=t[1],s=t[2],o=n[0],u=n[1],a=n[2],f=numeric.ccsDim(t),l=numeric.ccsDim(n),c=f[0],h=f[1],p=l[1],d=numeric.rep([c],0),v=numeric.rep([c],0),m=Array(c),g=numeric.rep([p],0),y=[],b=[],w=[g,y,b],E,S,x,T,N,C,k,L,A,O,M;for(x=0;x!==p;++x){T=o[x],N=o[x+1],A=0;for(S=T;S<N;++S){O=u[S],M=a[S],C=r[O],k=r[O+1];for(E=C;E<k;++E)L=i[E],v[L]===0&&(m[A]=L,v[L]=1,A+=1),d[L]=d[L]+s[E]*M}T=g[x],N=T+A,g[x+1]=N;for(S=A-1;S!==-1;--S)M=T+S,E=m[S],y[M]=E,b[M]=d[E],v[E]=0,d[E]=0;g[x+1]=g[x]+A}return w},numeric.ccsLUPSolve=function(t,n){var r=t.L,i=t.U,s=t.P,o=n[0],u=!1;typeof o!="object"&&(n=[[0,n.length],numeric.linspace(0,n.length-1),n],o=n[0],u=!0);var a=n[1],f=n[2],l=r[0].length-1,c=o.length-1,h=numeric.rep([l],0),p=Array(l),d=numeric.rep([l],0),v=Array(l),m=numeric.rep([c+1],0),g=[],y=[],b=numeric.ccsTSolve,w,E,S,x,T,N,C=0;for(w=0;w<c;++w){T=0,S=o[w],x=o[w+1];for(E=S;E<x;++E)N=t.Pinv[a[E]],v[T]=N,d[N]=f[E],++T;v.length=T,b(r,d,h,v,p);for(E=v.length-1;E!==-1;--E)d[v[E]]=0;b(i,h,d,p,v);if(u)return d;for(E=p.length-1;E!==-1;--E)h[p[E]]=0;for(E=v.length-1;E!==-1;--E)N=v[E],g[C]=N,y[C]=d[N],d[N]=0,++C;m[w+1]=C}return[m,g,y]},numeric.ccsbinop=function(t,n){return typeof n=="undefined"&&(n=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+n+"for(i=0;i<n;++i) {\n"+"  j0 = Xi[i]; j1 = Xi[i+1];\n"+"  for(j=j0;j!==j1;++j) {\n"+"    k = Xj[j];\n"+"    x[k] = 1;\n"+"    Zj[p] = k;\n"+"    ++p;\n"+"  }\n"+"  j0 = Yi[i]; j1 = Yi[i+1];\n"+"  for(j=j0;j!==j1;++j) {\n"+"    k = Yj[j];\n"+"    y[k] = Yv[j];\n"+"    if(x[k] === 0) {\n"+"      Zj[p] = k;\n"+"      ++p;\n"+"    }\n"+"  }\n"+"  Zi[i+1] = p;\n"+"  j0 = Xi[i]; j1 = Xi[i+1];\n"+"  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n"+"  j0 = Zi[i]; j1 = Zi[i+1];\n"+"  for(j=j0;j!==j1;++j) {\n"+"    k = Zj[j];\n"+"    xk = x[k];\n"+"    yk = y[k];\n"+t+"\n"+"    Zv[j] = zk;\n"+"  }\n"+"  j0 = Xi[i]; j1 = Xi[i+1];\n"+"  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n"+"  j0 = Yi[i]; j1 = Yi[i+1];\n"+"  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n"+"}\n"+"return [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)isFinite(eval("1"+numeric.ops2[k]+"0"))?A="[Y[0],Y[1],numeric."+k+"(X,Y[2])]":A="NaN",isFinite(eval("0"+numeric.ops2[k]+"1"))?B="[X[0],X[1],numeric."+k+"(X[2],Y)]":B="NaN",isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?C="numeric.ccs"+k+"MM(X,Y)":C="NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+";\n"+'if(typeof Y === "number") return '+B+";\n"+"return "+C+";\n")}(),numeric.ccsScatter=function(t){var n=t[0],r=t[1],i=t[2],s=numeric.sup(r)+1,o=n.length,u=numeric.rep([s],0),a=Array(o),f=Array(o),l=numeric.rep([s],0),c;for(c=0;c<o;++c)l[r[c]]++;for(c=0;c<s;++c)u[c+1]=u[c]+l[c];var h=u.slice(0),p,d;for(c=0;c<o;++c)d=r[c],p=h[d],a[p]=n[c],f[p]=i[c],h[d]=h[d]+1;return[u,a,f]},numeric.ccsGather=function(t){var n=t[0],r=t[1],i=t[2],s=n.length-1,o=r.length,u=Array(o),a=Array(o),f=Array(o),l,c,h,p,d;d=0;for(l=0;l<s;++l){h=n[l],p=n[l+1];for(c=h;c!==p;++c)a[d]=l,u[d]=r[c],f[d]=i[c],++d}return[u,a,f]},numeric.sdim=function dim(e,t,n){typeof t=="undefined"&&(t=[]);if(typeof e!="object")return t;typeof n=="undefined"&&(n=0),n in t||(t[n]=0),e.length>t[n]&&(t[n]=e.length);var r;for(r in e)e.hasOwnProperty(r)&&dim(e[r],t,n+1);return t},numeric.sclone=function clone(e,t,n){typeof t=="undefined"&&(t=0),typeof n=="undefined"&&(n=numeric.sdim(e).length);var r,i=Array(e.length);if(t===n-1){for(r in e)e.hasOwnProperty(r)&&(i[r]=e[r]);return i}for(r in e)e.hasOwnProperty(r)&&(i[r]=clone(e[r],t+1,n));return i},numeric.sdiag=function(t){var n=t.length,r,i=Array(n),s,o,u;for(r=n-1;r>=1;r-=2)s=r-1,i[r]=[],i[r][r]=t[r],i[s]=[],i[s][s]=t[s];return r===0&&(i[0]=[],i[0][0]=t[r]),i},numeric.sidentity=function(t){return numeric.sdiag(numeric.rep([t],1))},numeric.stranspose=function(t){var n=[],r=t.length,i,s,o;for(i in t){if(!t.hasOwnProperty(i))continue;o=t[i];for(s in o){if(!o.hasOwnProperty(s))continue;typeof n[s]!="object"&&(n[s]=[]),n[s][i]=o[s]}}return n},numeric.sLUP=function(t,n){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(t,n){var r=t.length,i=n.length,s=numeric.stranspose(n),o=s.length,u,a,f,l,c,h,p=Array(r),d;for(f=r-1;f>=0;f--){d=[],u=t[f];for(c=o-1;c>=0;c--){h=0,a=s[c];for(l in u){if(!u.hasOwnProperty(l))continue;l in a&&(h+=u[l]*a[l])}h&&(d[c]=h)}p[f]=d}return p},numeric.sdotMV=function(t,n){var r=t.length,i,s,o,u=Array(r),a;for(s=r-1;s>=0;s--){i=t[s],a=0;for(o in i){if(!i.hasOwnProperty(o))continue;n[o]&&(a+=i[o]*n[o])}a&&(u[s]=a)}return u},numeric.sdotVM=function(t,n){var r,i,s,o,u=[],a;for(r in t){if(!t.hasOwnProperty(r))continue;s=n[r],o=t[r];for(i in s){if(!s.hasOwnProperty(i))continue;u[i]||(u[i]=0),u[i]+=o*s[i]}}return u},numeric.sdotVV=function(t,n){var r,i=0;for(r in t)t[r]&&n[r]&&(i+=t[r]*n[r]);return i},numeric.sdot=function(t,n){var r=numeric.sdim(t).length,i=numeric.sdim(n).length,s=r*1e3+i;switch(s){case 0:return t*n;case 1001:return numeric.sdotVV(t,n);case 2001:return numeric.sdotMV(t,n);case 1002:return numeric.sdotVM(t,n);case 2002:return numeric.sdotMM(t,n);default:throw new Error("numeric.sdot not implemented for tensors of order "+r+" and "+i)}},numeric.sscatter=function(t){var n=t[0].length,r,i,s,o=t.length,u=[],a;for(i=n-1;i>=0;--i){if(!t[o-1][i])continue;a=u;for(s=0;s<o-2;s++)r=t[s][i],a[r]||(a[r]=[]),a=a[r];a[t[s][i]]=t[s+1][i]}return u},numeric.sgather=function gather(e,t,n){typeof t=="undefined"&&(t=[]),typeof n=="undefined"&&(n=[]);var r,i,s;r=n.length;for(i in e)if(e.hasOwnProperty(i)){n[r]=parseInt(i),s=e[i];if(typeof s=="number"){if(s){if(t.length===0)for(i=r+1;i>=0;--i)t[i]=[];for(i=r;i>=0;--i)t[i].push(n[i]);t[r+1].push(s)}}else gather(s,t,n)}return n.length>r&&n.pop(),t},numeric.cLU=function(t){var n=t[0],r=t[1],i=t[2],s=n.length,o=0,u,a,f,l,c,h;for(u=0;u<s;u++)n[u]>o&&(o=n[u]);o++;var p=Array(o),d=Array(o),v=numeric.rep([o],Infinity),m=numeric.rep([o],-Infinity),g,y,b;for(f=0;f<s;f++)u=n[f],a=r[f],a<v[u]&&(v[u]=a),a>m[u]&&(m[u]=a);for(u=0;u<o-1;u++)m[u]>m[u+1]&&(m[u+1]=m[u]);for(u=o-1;u>=1;u--)v[u]<v[u-1]&&(v[u-1]=v[u]);var w=0,E=0;for(u=0;u<o;u++)d[u]=numeric.rep([m[u]-v[u]+1],0),p[u]=numeric.rep([u-v[u]],0),w+=u-v[u]+1,E+=m[u]-u+1;for(f=0;f<s;f++)u=n[f],d[u][r[f]-v[u]]=i[f];for(u=0;u<o-1;u++){l=u-v[u],g=d[u];for(a=u+1;v[a]<=u&&a<o;a++){c=u-v[a],h=m[u]-u,y=d[a],b=y[c]/g[l];if(b){for(f=1;f<=h;f++)y[f+c]-=b*g[f+l];p[a][u-v[a]]=b}}}var g=[],y=[],S=[],x=[],T=[],N=[],s,C,k;s=0,C=0;for(u=0;u<o;u++){l=v[u],c=m[u],k=d[u];for(a=u;a<=c;a++)k[a-l]&&(g[s]=u,y[s]=a,S[s]=k[a-l],s++);k=p[u];for(a=l;a<u;a++)k[a-l]&&(x[C]=u,T[C]=a,N[C]=k[a-l],C++);x[C]=u,T[C]=u,N[C]=1,C++}return{U:[g,y,S],L:[x,T,N]}},numeric.cLUsolve=function(t,n){var r=t.L,i=t.U,s=numeric.clone(n),o=r[0],u=r[1],a=r[2],f=i[0],l=i[1],c=i[2],h=f.length,p=o.length,d=s.length,v,m,g;g=0;for(v=0;v<d;v++){while(u[g]<v)s[v]-=a[g]*s[u[g]],g++;g++}g=h-1;for(v=d-1;v>=0;v--){while(l[g]>v)s[v]-=c[g]*s[l[g]],g--;s[v]/=c[g],g--}return s},numeric.cgrid=function(t,n){typeof t=="number"&&(t=[t,t]);var r=numeric.rep(t,-1),i,s,o;if(typeof n!="function")switch(n){case"L":n=function(e,n){return e>=t[0]/2||n<t[1]/2};break;default:n=function(e,t){return!0}}o=0;for(i=1;i<t[0]-1;i++)for(s=1;s<t[1]-1;s++)n(i,s)&&(r[i][s]=o,o++);return r},numeric.cdelsq=function(t){var n=[[-1,0],[0,-1],[0,1],[1,0]],r=numeric.dim(t),i=r[0],s=r[1],o,u,a,f,l,c=[],h=[],p=[];for(o=1;o<i-1;o++)for(u=1;u<s-1;u++){if(t[o][u]<0)continue;for(a=0;a<4;a++){f=o+n[a][0],l=u+n[a][1];if(t[f][l]<0)continue;c.push(t[o][u]),h.push(t[f][l]),p.push(-1)}c.push(t[o][u]),h.push(t[o][u]),p.push(4)}return[c,h,p]},numeric.cdotMV=function(t,n){var r,i=t[0],s=t[1],o=t[2],u,a=i.length,f;f=0;for(u=0;u<a;u++)i[u]>f&&(f=i[u]);f++,r=numeric.rep([f],0);for(u=0;u<a;u++)r[i[u]]+=o[u]*n[s[u]];return r},numeric.Spline=function(t,n,r,i,s){this.x=t,this.yl=n,this.yr=r,this.kl=i,this.kr=s},numeric.Spline.prototype._at=function(t,n){var r=this.x,i=this.yl,s=this.yr,o=this.kl,u=this.kr,t,a,f,l,c=numeric.add,h=numeric.sub,p=numeric.mul;a=h(p(o[n],r[n+1]-r[n]),h(s[n+1],i[n])),f=c(p(u[n+1],r[n]-r[n+1]),h(s[n+1],i[n])),l=(t-r[n])/(r[n+1]-r[n]);var d=l*(1-l);return c(c(c(p(1-l,i[n]),p(l,s[n+1])),p(a,d*(1-l))),p(f,d*l))},numeric.Spline.prototype.at=function(t){if(typeof t=="number"){var n=this.x,r=n.length,i,s,o,u=Math.floor,a,f,l;i=0,s=r-1;while(s-i>1)o=u((i+s)/2),n[o]<=t?i=o:s=o;return this._at(t,i)}var r=t.length,c,h=Array(r);for(c=r-1;c!==-1;--c)h[c]=this.at(t[c]);return h},numeric.Spline.prototype.diff=function(){var t=this.x,n=this.yl,r=this.yr,i=this.kl,s=this.kr,o=n.length,u,a,f,l=i,c=s,h=Array(o),p=Array(o),d=numeric.add,v=numeric.mul,m=numeric.div,g=numeric.sub;for(u=o-1;u!==-1;--u)a=t[u+1]-t[u],f=g(r[u+1],n[u]),h[u]=m(d(v(f,6),v(i[u],-4*a),v(s[u+1],-2*a)),a*a),p[u+1]=m(d(v(f,-6),v(i[u],2*a),v(s[u+1],4*a)),a*a);return new numeric.Spline(t,l,c,h,p)},numeric.Spline.prototype.roots=function(){function t(e){return e*e}function n(e,t,n,r,i){var s=n*2-(t-e),o=-r*2+(t-e),u=(i+1)*.5,a=u*(1-u);return(1-u)*e+u*t+s*a*(1-u)+o*a*u}var r=[],i=this.x,s=this.yl,o=this.yr,u=this.kl,a=this.kr;typeof s[0]=="number"&&(s=[s],o=[o],u=[u],a=[a]);var f=s.length,l=i.length-1,c,h,p,d,v,m,g,y,b,w,r=Array(f),E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F=Math.sqrt;for(c=0;c!==f;++c){g=s[c],y=o[c],b=u[c],w=a[c],E=[];for(h=0;h!==l;h++){h>0&&y[h]*g[h]<0&&E.push(i[h]),A=i[h+1]-i[h],O=i[h],T=g[h],N=y[h+1],S=b[h]/A,x=w[h+1]/A,L=t(S-x+3*(T-N))+12*x*T,C=x+3*T+2*S-3*N,k=3*(x+S+2*(T-N)),L<=0?(_=C/k,_>i[h]&&_<i[h+1]?M=[i[h],_,i[h+1]]:M=[i[h],i[h+1]]):(_=(C-F(L))/k,D=(C+F(L))/k,M=[i[h]],_>i[h]&&_<i[h+1]&&M.push(_),D>i[h]&&D<i[h+1]&&M.push(D),M.push(i[h+1])),H=M[0],_=this._at(H,h);for(p=0;p<M.length-1;p++){B=M[p+1],D=this._at(B,h);if(_===0){E.push(H),H=B,_=D;continue}if(D===0||_*D>0){H=B,_=D;continue}var I=0;for(;;){j=(_*B-D*H)/(_-D);if(j<=H||j>=B)break;P=this._at(j,h);if(P*D>0)B=j,D=P,I===-1&&(_*=.5),I=-1;else{if(!(P*_>0))break;H=j,_=P,I===1&&(D*=.5),I=1}}E.push(j),H=M[p+1],_=this._at(H,h)}D===0&&E.push(B)}r[c]=E}return typeof this.yl[0]=="number"?r[0]:r},numeric.spline=function(t,n,r,i){var s=t.length,o=[],u=[],a=[],f,l=numeric.sub,c=numeric.mul,h=numeric.add;for(f=s-2;f>=0;f--)u[f]=t[f+1]-t[f],a[f]=l(n[f+1],n[f]);if(typeof r=="string"||typeof i=="string")r=i="periodic";var p=[[],[],[]];switch(typeof r){case"undefined":o[0]=c(3/(u[0]*u[0]),a[0]),p[0].push(0,0),p[1].push(0,1),p[2].push(2/u[0],1/u[0]);break;case"string":o[0]=h(c(3/(u[s-2]*u[s-2]),a[s-2]),c(3/(u[0]*u[0]),a[0])),p[0].push(0,0,0),p[1].push(s-2,0,1),p[2].push(1/u[s-2],2/u[s-2]+2/u[0],1/u[0]);break;default:o[0]=r,p[0].push(0),p[1].push(0),p[2].push(1)}for(f=1;f<s-1;f++)o[f]=h(c(3/(u[f-1]*u[f-1]),a[f-1]),c(3/(u[f]*u[f]),a[f])),p[0].push(f,f,f),p[1].push(f-1,f,f+1),p[2].push(1/u[f-1],2/u[f-1]+2/u[f],1/u[f]);switch(typeof i){case"undefined":o[s-1]=c(3/(u[s-2]*u[s-2]),a[s-2]),p[0].push(s-1,s-1),p[1].push(s-2,s-1),p[2].push(1/u[s-2],2/u[s-2]);break;case"string":p[1][p[1].length-1]=0;break;default:o[s-1]=i,p[0].push(s-1),p[1].push(s-1),p[2].push(1)}typeof o[0]!="number"?o=numeric.transpose(o):o=[o];var d=Array(o.length);if(typeof r=="string")for(f=d.length-1;f!==-1;--f)d[f]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(p)),o[f]),d[f][s-1]=d[f][0];else for(f=d.length-1;f!==-1;--f)d[f]=numeric.cLUsolve(numeric.cLU(p),o[f]);return typeof n[0]=="number"?d=d[0]:d=numeric.transpose(d),new numeric.Spline(t,n,n,d,d)},numeric.fftpow2=function fftpow2(e,t){var n=e.length;if(n===1)return;var r=Math.cos,i=Math.sin,s,o,u=Array(n/2),a=Array(n/2),f=Array(n/2),l=Array(n/2);o=n/2;for(s=n-1;s!==-1;--s)--o,f[o]=e[s],l[o]=t[s],--s,u[o]=e[s],a[o]=t[s];fftpow2(u,a),fftpow2(f,l),o=n/2;var c,h=-6.283185307179586/n,p,d;for(s=n-1;s!==-1;--s)--o,o===-1&&(o=n/2-1),c=h*s,p=r(c),d=i(c),e[s]=u[o]+p*f[o]-d*l[o],t[s]=a[o]+p*l[o]+d*f[o]},numeric._ifftpow2=function _ifftpow2(e,t){var n=e.length;if(n===1)return;var r=Math.cos,i=Math.sin,s,o,u=Array(n/2),a=Array(n/2),f=Array(n/2),l=Array(n/2);o=n/2;for(s=n-1;s!==-1;--s)--o,f[o]=e[s],l[o]=t[s],--s,u[o]=e[s],a[o]=t[s];_ifftpow2(u,a),_ifftpow2(f,l),o=n/2;var c,h=6.283185307179586/n,p,d;for(s=n-1;s!==-1;--s)--o,o===-1&&(o=n/2-1),c=h*s,p=r(c),d=i(c),e[s]=u[o]+p*f[o]-d*l[o],t[s]=a[o]+p*l[o]+d*f[o]},numeric.ifftpow2=function(t,n){numeric._ifftpow2(t,n),numeric.diveq(t,t.length),numeric.diveq(n,n.length)},numeric.convpow2=function(t,n,r,i){numeric.fftpow2(t,n),numeric.fftpow2(r,i);var s,o=t.length,u,a,f,l;for(s=o-1;s!==-1;--s)u=t[s],f=n[s],a=r[s],l=i[s],t[s]=u*a-f*l,n[s]=u*l+f*a;numeric.ifftpow2(t,n)},numeric.T.prototype.fft=function(){var t=this.x,n=this.y,r=t.length,i=Math.log,s=i(2),o=Math.ceil(i(2*r-1)/s),u=Math.pow(2,o),a=numeric.rep([u],0),f=numeric.rep([u],0),l=Math.cos,c=Math.sin,h,p=-3.141592653589793/r,d,v=numeric.rep([u],0),m=numeric.rep([u],0),g=Math.floor(r/2);for(h=0;h<r;h++)v[h]=t[h];if(typeof n!="undefined")for(h=0;h<r;h++)m[h]=n[h];a[0]=1;for(h=1;h<=u/2;h++)d=p*h*h,a[h]=l(d),f[h]=c(d),a[u-h]=l(d),f[u-h]=c(d);var y=new numeric.T(v,m),b=new numeric.T(a,f);return y=y.mul(b),numeric.convpow2(y.x,y.y,numeric.clone(b.x),numeric.neg(b.y)),y=y.mul(b),y.x.length=r,y.y.length=r,y},numeric.T.prototype.ifft=function(){var t=this.x,n=this.y,r=t.length,i=Math.log,s=i(2),o=Math.ceil(i(2*r-1)/s),u=Math.pow(2,o),a=numeric.rep([u],0),f=numeric.rep([u],0),l=Math.cos,c=Math.sin,h,p=3.141592653589793/r,d,v=numeric.rep([u],0),m=numeric.rep([u],0),g=Math.floor(r/2);for(h=0;h<r;h++)v[h]=t[h];if(typeof n!="undefined")for(h=0;h<r;h++)m[h]=n[h];a[0]=1;for(h=1;h<=u/2;h++)d=p*h*h,a[h]=l(d),f[h]=c(d),a[u-h]=l(d),f[u-h]=c(d);var y=new numeric.T(v,m),b=new numeric.T(a,f);return y=y.mul(b),numeric.convpow2(y.x,y.y,numeric.clone(b.x),numeric.neg(b.y)),y=y.mul(b),y.x.length=r,y.y.length=r,y.div(r)},numeric.gradient=function(t,n){var r=n.length,i=t(n);if(isNaN(i))throw new Error("gradient: f(x) is a NaN!");var s=Math.max,o,u=numeric.clone(n),a,f,l=Array(r),c=numeric.div,h=numeric.sub,p,d,s=Math.max,v=.001,m=Math.abs,g=Math.min,y,b,w,E=0,S,x,T;for(o=0;o<r;o++){var N=s(1e-6*i,1e-8);for(;;){++E;if(E>20)throw new Error("Numerical gradient fails");u[o]=n[o]+N,a=t(u),u[o]=n[o]-N,f=t(u),u[o]=n[o];if(isNaN(a)||isNaN(f)){N/=16;continue}l[o]=(a-f)/(2*N),y=n[o]-N,b=n[o],w=n[o]+N,S=(a-i)/N,x=(i-f)/N,T=s(m(l[o]),m(i),m(a),m(f),m(y),m(b),m(w),1e-8),p=g(s(m(S-l[o]),m(x-l[o]),m(S-x))/T,N/T);if(!(p>v))break;N/=16}}return l},numeric.uncmin=function(t,n,r,i,s,o,u){var a=numeric.gradient;typeof u=="undefined"&&(u={}),typeof r=="undefined"&&(r=1e-8),typeof i=="undefined"&&(i=function(e){return a(t,e)}),typeof s=="undefined"&&(s=1e3),n=numeric.clone(n);var f=n.length,l=t(n),c,h;if(isNaN(l))throw new Error("uncmin: f(x0) is a NaN!");var p=Math.max,d=numeric.norm2;r=p(r,numeric.epsilon);var v,m,g,y=u.Hinv||numeric.identity(f),b=numeric.dot,w=numeric.inv,E=numeric.sub,S=numeric.add,x=numeric.tensor,T=numeric.div,N=numeric.mul,C=numeric.all,k=numeric.isFinite,L=numeric.neg,A=0,O,M,_,D,P,H,B,j,F,I,q,R,U="";m=i(n);while(A<s){if(typeof o=="function"&&o(A,n,l,m,y)){U="Callback returned true";break}if(!C(k(m))){U="Gradient has Infinity or NaN";break}v=L(b(y,m));if(!C(k(v))){U="Search direction has Infinity or NaN";break}I=d(v);if(I<r){U="Newton step smaller than tol";break}F=1,h=b(m,v),_=n;while(A<s){if(F*I<r)break;M=N(v,F),_=S(n,M),c=t(_);if(c-l>=.1*F*h||isNaN(c)){F*=.5,++A;continue}break}if(F*I<r){U="Line search step size smaller than tol";break}if(A===s){U="maxit reached during line search";break}g=i(_),D=E(g,m),B=b(D,M),P=b(y,D),y=E(S(y,N((B+b(D,P))/(B*B),x(M,M))),T(S(x(P,M),x(M,P)),B)),n=_,l=c,m=g,++A}return{solution:n,f:l,gradient:m,invHessian:y,iterations:A,message:U}},numeric.Dopri=function(t,n,r,i,s,o,u){this.x=t,this.y=n,this.f=r,this.ymid=i,this.iterations=s,this.events=u,this.message=o},numeric.Dopri.prototype._at=function(t,n){function r(e){return e*e}var i=this,s=i.x,o=i.y,u=i.f,a=i.ymid,f=s.length,l,c,h,p,d,v,t,m=Math.floor,g,y=.5,b=numeric.add,w=numeric.mul,E=numeric.sub,S,x,T;return l=s[n],c=s[n+1],p=o[n],d=o[n+1],g=c-l,h=l+y*g,v=a[n],S=E(u[n],w(p,1/(l-h)+2/(l-c))),x=E(u[n+1],w(d,1/(c-h)+2/(c-l))),T=[r(t-c)*(t-h)/r(l-c)/(l-h),r(t-l)*r(t-c)/r(l-h)/r(c-h),r(t-l)*(t-h)/r(c-l)/(c-h),(t-l)*r(t-c)*(t-h)/r(l-c)/(l-h),(t-c)*r(t-l)*(t-h)/r(l-c)/(c-h)],b(b(b(b(w(p,T[0]),w(v,T[1])),w(d,T[2])),w(S,T[3])),w(x,T[4]))},numeric.Dopri.prototype.at=function(t){var n,r,i,s=Math.floor;if(typeof t!="number"){var o=t.length,u=Array(o);for(n=o-1;n!==-1;--n)u[n]=this.at(t[n]);return u}var a=this.x;n=0,r=a.length-1;while(r-n>1)i=s(.5*(n+r)),a[i]<=t?n=i:r=i;return this._at(t,n)},numeric.dopri=function(t,n,r,i,s,o,u){typeof s=="undefined"&&(s=1e-6),typeof o=="undefined"&&(o=1e3);var a=[t],f=[r],l=[i(t,r)],c,h,p,d,v,m,g=[],y=.2,b=[.075,.225],w=[44/45,-56/15,32/9],E=[19372/6561,-25360/2187,64448/6561,-212/729],S=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],x=[35/384,0,500/1113,125/192,-2187/6784,11/84],T=[.10013431883002395,0,.3918321794184259,-0.02982460176594817,.05893268337240795,-0.04497888809104361,.023904308236133973],N=[.2,.3,.8,8/9,1,1],C=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],k=0,L,A,O=(n-t)/10,M=0,_=numeric.add,D=numeric.mul,P,H,B=Math.max,j=Math.min,F=Math.abs,I=numeric.norminf,q=Math.pow,R=numeric.any,U=numeric.lt,z=numeric.and,W=numeric.sub,X,V,$,J=new numeric.Dopri(a,f,l,g,-1,"");typeof u=="function"&&(X=u(t,r));while(t<n&&M<o){++M,t+O>n&&(O=n-t),c=i(t+N[0]*O,_(r,D(y*O,l[k]))),h=i(t+N[1]*O,_(_(r,D(b[0]*O,l[k])),D(b[1]*O,c))),p=i(t+N[2]*O,_(_(_(r,D(w[0]*O,l[k])),D(w[1]*O,c)),D(w[2]*O,h))),d=i(t+N[3]*O,_(_(_(_(r,D(E[0]*O,l[k])),D(E[1]*O,c)),D(E[2]*O,h)),D(E[3]*O,p))),v=i(t+N[4]*O,_(_(_(_(_(r,D(S[0]*O,l[k])),D(S[1]*O,c)),D(S[2]*O,h)),D(S[3]*O,p)),D(S[4]*O,d))),P=_(_(_(_(_(r,D(l[k],O*x[0])),D(h,O*x[2])),D(p,O*x[3])),D(d,O*x[4])),D(v,O*x[5])),m=i(t+O,P),L=_(_(_(_(_(D(l[k],O*C[0]),D(h,O*C[2])),D(p,O*C[3])),D(d,O*C[4])),D(v,O*C[5])),D(m,O*C[6])),typeof L=="number"?H=F(L):H=I(L);if(H>s){O=.2*O*q(s/H,.25);if(t+O===t){J.msg="Step size became too small";break}continue}g[k]=_(_(_(_(_(_(r,D(l[k],O*T[0])),D(h,O*T[2])),D(p,O*T[3])),D(d,O*T[4])),D(v,O*T[5])),D(m,O*T[6])),++k,a[k]=t+O,f[k]=P,l[k]=m;if(typeof u=="function"){var K,Q=t,G=t+.5*O,Y;V=u(G,g[k-1]),$=z(U(X,0),U(0,V)),R($)||(Q=G,G=t+O,X=V,V=u(G,P),$=z(U(X,0),U(0,V)));if(R($)){var Z,et,tt,nt,rt=0,it=1,st=1;for(;;){if(typeof X=="number")Y=(st*V*Q-it*X*G)/(st*V-it*X);else{Y=G;for(A=X.length-1;A!==-1;--A)X[A]<0&&V[A]>0&&(Y=j(Y,(st*V[A]*Q-it*X[A]*G)/(st*V[A]-it*X[A])))}if(Y<=Q||Y>=G)break;K=J._at(Y,k-1),nt=u(Y,K),tt=z(U(X,0),U(0,nt)),R(tt)?(G=Y,V=nt,$=tt,st=1,rt===-1?it*=.5:it=1,rt=-1):(Q=Y,X=nt,it=1,rt===1?st*=.5:st=1,rt=1)}return P=J._at(.5*(t+Y),k-1),J.f[k]=i(Y,K),J.x[k]=Y,J.y[k]=K,J.ymid[k-1]=P,J.events=$,J.iterations=M,J}}t+=O,r=P,X=V,O=j(.8*O*q(s/H,.25),4*O)}return J.iterations=M,J},numeric.LU=function(e,t){t=t||!1;var n=Math.abs,r,i,s,o,u,a,f,l,c,h=e.length,p=h-1,d=new Array(h);t||(e=numeric.clone(e));for(s=0;s<h;++s){f=s,a=e[s],c=n(a[s]);for(i=s+1;i<h;++i)o=n(e[i][s]),c<o&&(c=o,f=i);d[s]=f,f!=s&&(e[s]=e[f],e[f]=a,a=e[s]),u=a[s];for(r=s+1;r<h;++r)e[r][s]/=u;for(r=s+1;r<h;++r){l=e[r];for(i=s+1;i<p;++i)l[i]-=l[s]*a[i],++i,l[i]-=l[s]*a[i];i===p&&(l[i]-=l[s]*a[i])}}return{LU:e,P:d}},numeric.LUsolve=function(t,n){var r,i,s=t.LU,o=s.length,u=numeric.clone(n),a=t.P,f,l,c,h;for(r=o-1;r!==-1;--r)u[r]=n[r];for(r=0;r<o;++r){f=a[r],a[r]!==r&&(h=u[r],u[r]=u[f],u[f]=h),l=s[r];for(i=0;i<r;++i)u[r]-=u[i]*l[i]}for(r=o-1;r>=0;--r){l=s[r];for(i=r+1;i<o;++i)u[r]-=u[i]*l[i];u[r]/=l[r]}return u},numeric.solve=function(t,n,r){return numeric.LUsolve(numeric.LU(t,r),n)},numeric.echelonize=function(t){var n=numeric.dim(t),r=n[0],i=n[1],s=numeric.identity(r),o=Array(r),u,a,f,l,c,h,p,d,v=Math.abs,m=numeric.diveq;t=numeric.clone(t);for(u=0;u<r;++u){f=0,c=t[u],h=s[u];for(a=1;a<i;++a)v(c[f])<v(c[a])&&(f=a);o[u]=f,m(h,c[f]),m(c,c[f]);for(a=0;a<r;++a)if(a!==u){p=t[a],d=p[f];for(l=i-1;l!==-1;--l)p[l]-=c[l]*d;p=s[a];for(l=r-1;l!==-1;--l)p[l]-=h[l]*d}}return{I:s,A:t,P:o}},numeric.__solveLP=function(t,n,r,i,s,o,u){var a=numeric.sum,f=numeric.log,l=numeric.mul,c=numeric.sub,h=numeric.dot,p=numeric.div,d=numeric.add,v=t.length,m=r.length,g,y=!1,b,w=0,E=1,S,x,T=numeric.transpose(n),N=numeric.svd,C=numeric.transpose,k=numeric.leq,L=Math.sqrt,A=Math.abs,O=numeric.muleq,M=numeric.norminf,_=numeric.any,D=Math.min,P=numeric.all,H=numeric.gt,B=Array(v),j=Array(m),F=numeric.rep([m],1),I,q=numeric.solve,R=c(r,h(n,o)),U,z=h(t,t),W;for(U=w;U<s;++U){var X,V,$;for(X=m-1;X!==-1;--X)j[X]=p(n[X],R[X]);var J=C(j);for(X=v-1;X!==-1;--X)B[X]=a(J[X]);E=.25*A(z/h(t,B));var K=100*L(z/h(B,B));if(!isFinite(E)||E>K)E=K;W=d(t,l(E,B)),I=h(J,j);for(X=v-1;X!==-1;--X)I[X][X]+=1;$=q(I,p(W,E),!0);var Q=p(R,h(n,$)),G=1;for(X=m-1;X!==-1;--X)Q[X]<0&&(G=D(G,-0.999*Q[X]));g=c(o,l($,G)),R=c(r,h(n,g));if(!P(H(R,0)))return{solution:o,message:"",iterations:U};o=g;if(E<i)return{solution:g,message:"",iterations:U};if(u){var Y=h(t,W),Z=h(n,W);y=!0;for(X=m-1;X!==-1;--X)if(Y*Z[X]<0){y=!1;break}}else o[v-1]>=0?y=!1:y=!0;if(y)return{solution:g,message:"Unbounded",iterations:U}}return{solution:o,message:"maximum iteration count exceeded",iterations:U}},numeric._solveLP=function(t,n,r,i,s){var o=t.length,u=r.length,a,f=numeric.sum,l=numeric.log,c=numeric.mul,h=numeric.sub,p=numeric.dot,d=numeric.div,v=numeric.add,m=numeric.rep([o],0).concat([1]),g=numeric.rep([u,1],-1),y=numeric.blockMatrix([[n,g]]),b=r,a=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(r)))+1),w=numeric.__solveLP(m,y,b,i,s,a,!1),E=numeric.clone(w.solution);E.length=o;var S=numeric.inf(h(r,p(n,E)));if(S<0)return{solution:NaN,message:"Infeasible",iterations:w.iterations};var x=numeric.__solveLP(t,n,r,i,s-w.iterations,E,!0);return x.iterations+=w.iterations,x},numeric.solveLP=function(t,n,r,i,s,o,u){typeof u=="undefined"&&(u=1e3),typeof o=="undefined"&&(o=numeric.epsilon);if(typeof i=="undefined")return numeric._solveLP(t,n,r,o,u);var a=i.length,f=i[0].length,l=n.length,c=numeric.echelonize(i),h=numeric.rep([f],0),p=c.P,d=[],v;for(v=p.length-1;v!==-1;--v)h[p[v]]=1;for(v=f-1;v!==-1;--v)h[v]===0&&d.push(v);var m=numeric.getRange,g=numeric.linspace(0,a-1),y=numeric.linspace(0,l-1),b=m(i,g,d),w=m(n,y,p),E=m(n,y,d),S=numeric.dot,x=numeric.sub,T=S(w,c.I),N=x(E,S(T,b)),C=x(r,S(T,s)),k=Array(p.length),L=Array(d.length);for(v=p.length-1;v!==-1;--v)k[v]=t[p[v]];for(v=d.length-1;v!==-1;--v)L[v]=t[d[v]];var A=x(L,S(k,S(c.I,b))),O=numeric._solveLP(A,N,C,o,u),M=O.solution;if(M!==M)return O;var _=S(c.I,x(s,S(b,M))),D=Array(t.length);for(v=p.length-1;v!==-1;--v)D[p[v]]=_[v];for(v=d.length-1;v!==-1;--v)D[d[v]]=M[v];return{solution:D,message:O.message,iterations:O.iterations}},numeric.MPStoLP=function(t){function y(e){throw new Error("MPStoLP: "+e+"\nLine "+s+": "+t[s]+"\nCurrent state: "+r[n]+"\n")}t instanceof String&&t.split("\n");var n=0,r=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],i=t.length,s,o,u,a=0,f={},l=[],c=0,h={},p=0,d,v=[],m=[],g=[];for(s=0;s<i;++s){u=t[s];var b=u.match(/\S*/g),w=[];for(o=0;o<b.length;++o)b[o]!==""&&w.push(b[o]);if(w.length===0)continue;for(o=0;o<r.length;++o)if(u.substr(0,r[o].length)===r[o])break;if(o<r.length){n=o,o===1&&(d=w[1]);if(o===6)return{name:d,c:v,A:numeric.transpose(m),b:g,rows:f,vars:h};continue}switch(n){case 0:case 1:y("Unexpected line");case 2:switch(w[0]){case"N":a===0?a=w[1]:y("Two or more N rows");break;case"L":f[w[1]]=c,l[c]=1,g[c]=0,++c;break;case"G":f[w[1]]=c,l[c]=-1,g[c]=0,++c;break;case"E":f[w[1]]=c,l[c]=0,g[c]=0,++c;break;default:y("Parse error "+numeric.prettyPrint(w))}break;case 3:h.hasOwnProperty(w[0])||(h[w[0]]=p,v[p]=0,m[p]=numeric.rep([c],0),++p);var E=h[w[0]];for(o=1;o<w.length;o+=2){if(w[o]===a){v[E]=parseFloat(w[o+1]);continue}var S=f[w[o]];m[E][S]=(l[S]<0?-1:1)*parseFloat(w[o+1])}break;case 4:for(o=1;o<w.length;o+=2)g[f[w[o]]]=(l[f[w[o]]]<0?-1:1)*parseFloat(w[o+1]);break;case 5:break;case 6:y("Internal error")}}y("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(e,t,n,r,i,s,o){function u(e){var t,r,i=this,s=e.length,o=0,u=i.i=i.j=i.m=0;i.S=[],i.c=[],s||(e=[s++]);while(o<n)i.S[o]=o++;for(o=0;o<n;o++)t=i.S[o],u=l(u+t+e[o%s]),r=i.S[u],i.S[o]=r,i.S[u]=t;i.g=function(t){var r=i.S,s=l(i.i+1),o=r[s],u=l(i.j+o),a=r[u];r[s]=a,r[u]=o;var f=r[l(o+a)];while(--t)s=l(s+1),o=r[s],u=l(u+o),a=r[u],r[s]=a,r[u]=o,f=f*n+r[l(o+a)];return i.i=s,i.j=u,f},i.g(n)}function a(e,t,n,r,i){n=[],i=typeof e;if(t&&i=="object")for(r in e)if(r.indexOf("S")<5)try{n.push(a(e[r],t-1))}catch(s){}return n.length?n:e+(i!="string"?"\0":"")}function f(e,t,n,r){e+="",n=0;for(r=0;r<e.length;r++)t[l(r)]=l((n^=t[l(r)]*19)+e.charCodeAt(r));e="";for(r in t)e+=String.fromCharCode(t[r]);return e}function l(e){return e&n-1}t.seedrandom=function(c,h){var p=[],d;return c=f(a(h?[c,e]:arguments.length?c:[(new Date).getTime(),e,window],3),p),d=new u(p),f(d.S,e),t.random=function(){var t=d.g(r),u=o,a=0;while(t<i)t=(t+a)*n,u*=n,a=d.g(1);while(t>=s)t/=2,u/=2,a>>>=1;return(t+a)/u},c},o=t.pow(n,r),i=t.pow(2,i),s=i*2,f(t.random(),e)}([],numeric.seedrandom,256,6,52),function(e){function t(e){if(typeof e!="object")return e;var n=[],r,i=e.length;for(r=0;r<i;r++)n[r+1]=t(e[r]);return n}function n(e){if(typeof e!="object")return e;var t=[],r,i=e.length;for(r=1;r<i;r++)t[r-1]=n(e[r]);return t}function r(e,t,n){var r,i,s,o,u;for(s=1;s<=n;s+=1){e[s][s]=1/e[s][s],u=-e[s][s];for(r=1;r<s;r+=1)e[r][s]=u*e[r][s];o=s+1;if(n<o)break;for(i=o;i<=n;i+=1){u=e[s][i],e[s][i]=0;for(r=1;r<=s;r+=1)e[r][i]=e[r][i]+u*e[r][s]}}}function i(e,t,n,r){var i,s,o,u;for(s=1;s<=n;s+=1){u=0;for(i=1;i<s;i+=1)u+=e[i][s]*r[i];r[s]=(r[s]-u)/e[s][s]}for(o=1;o<=n;o+=1){s=n+1-o,r[s]=r[s]/e[s][s],u=-r[s];for(i=1;i<s;i+=1)r[i]=r[i]+u*e[i][s]}}function s(e,t,n,r){var i,s,o,u,a,f;for(s=1;s<=n;s+=1){r[1]=s,f=0,o=s-1;if(o<1){f=e[s][s]-f;if(f<=0)break;e[s][s]=Math.sqrt(f)}else{for(u=1;u<=o;u+=1){a=e[u][s];for(i=1;i<u;i+=1)a-=e[i][s]*e[i][u];a/=e[u][u],e[u][s]=a,f+=a*a}f=e[s][s]-f;if(f<=0)break;e[s][s]=Math.sqrt(f)}r[1]=0}}function o(e,t,n,o,u,a,f,l,c,h,p,d,v,m,g,y){function V(){m[1]=m[1]+1,E=L;for(b=1;b<=h;b+=1){E+=1,P=-l[b];for(w=1;w<=o;w+=1)P+=f[w][b]*u[w];Math.abs(P)<U&&(P=0);if(b>p)g[E]=P;else{g[E]=-Math.abs(P);if(P>0){for(w=1;w<=o;w+=1)f[w][b]=-f[w][b];l[b]=-l[b]}}}for(b=1;b<=v;b+=1)g[L+d[b]]=0;O=0,D=0;for(b=1;b<=h;b+=1)g[L+b]<D*g[_+b]&&(O=b,D=g[L+b]/g[_+b]);return O===0?999:0}function $(){for(b=1;b<=o;b+=1){P=0;for(w=1;w<=o;w+=1)P+=e[w][b]*f[w][O];g[b]=P}S=N;for(b=1;b<=o;b+=1)g[S+b]=0;for(w=v+1;w<=o;w+=1)for(b=1;b<=o;b+=1)g[S+b]=g[S+b]+e[b][w]*g[w];q=!0;for(b=v;b>=1;b-=1){P=g[b],E=k+b*(b+3)/2,S=E-b;for(w=b+1;w<=v;w+=1)P-=g[E]*g[C+w],E+=w;P/=g[S],g[C+b]=P;if(d[b]<p)break;if(P<0)break;q=!1,T=b}if(!q){H=g[A+T]/g[C+T];for(b=1;b<=v;b+=1){if(d[b]<p)break;if(g[C+b]<0)break;D=g[A+b]/g[C+b],D<
H&&(H=D,T=b)}}P=0;for(b=N+1;b<=N+o;b+=1)P+=g[b]*g[b];if(Math.abs(P)<=U){if(q)return y[1]=1,999;for(b=1;b<=v;b+=1)g[A+b]=g[A+b]-H*g[C+b];return g[A+v+1]=g[A+v+1]+H,700}P=0;for(b=1;b<=o;b+=1)P+=g[N+b]*f[b][O];B=-g[L+O]/P,R=!0,q||H<B&&(B=H,R=!1);for(b=1;b<=o;b+=1)u[b]=u[b]+B*g[N+b],Math.abs(u[b])<U&&(u[b]=0);a[1]=a[1]+B*P*(B/2+g[A+v+1]);for(b=1;b<=v;b+=1)g[A+b]=g[A+b]-B*g[C+b];g[A+v+1]=g[A+v+1]+B;if(!R){P=-l[O];for(w=1;w<=o;w+=1)P+=u[w]*f[w][O];if(O>p)g[L+O]=P;else{g[L+O]=-Math.abs(P);if(P>0){for(w=1;w<=o;w+=1)f[w][O]=-f[w][O];l[O]=-l[O]}}return 700}v+=1,d[v]=O,E=k+(v-1)*v/2+1;for(b=1;b<=v-1;b+=1)g[E]=g[b],E+=1;if(v===o)g[E]=g[o];else{for(b=o;b>=v+1;b-=1){if(g[b]===0)break;j=Math.max(Math.abs(g[b-1]),Math.abs(g[b])),F=Math.min(Math.abs(g[b-1]),Math.abs(g[b])),g[b-1]>=0?D=Math.abs(j*Math.sqrt(1+F*F/(j*j))):D=-Math.abs(j*Math.sqrt(1+F*F/(j*j))),j=g[b-1]/D,F=g[b]/D;if(j===1)break;if(j===0){g[b-1]=F*D;for(w=1;w<=o;w+=1)D=e[w][b-1],e[w][b-1]=e[w][b],e[w][b]=D}else{g[b-1]=D,I=F/(1+j);for(w=1;w<=o;w+=1)D=j*e[w][b-1]+F*e[w][b],e[w][b]=I*(e[w][b-1]+D)-e[w][b],e[w][b-1]=D}}g[E]=g[v]}return 0}function J(){E=k+T*(T+1)/2+1,S=E+T;if(g[S]===0)return 798;j=Math.max(Math.abs(g[S-1]),Math.abs(g[S])),F=Math.min(Math.abs(g[S-1]),Math.abs(g[S])),g[S-1]>=0?D=Math.abs(j*Math.sqrt(1+F*F/(j*j))):D=-Math.abs(j*Math.sqrt(1+F*F/(j*j))),j=g[S-1]/D,F=g[S]/D;if(j===1)return 798;if(j===0){for(b=T+1;b<=v;b+=1)D=g[S-1],g[S-1]=g[S],g[S]=D,S+=b;for(b=1;b<=o;b+=1)D=e[b][T],e[b][T]=e[b][T+1],e[b][T+1]=D}else{I=F/(1+j);for(b=T+1;b<=v;b+=1)D=j*g[S-1]+F*g[S],g[S]=I*(g[S-1]+D)-g[S],g[S-1]=D,S+=b;for(b=1;b<=o;b+=1)D=j*e[b][T]+F*e[b][T+1],e[b][T+1]=I*(e[b][T]+D)-e[b][T+1],e[b][T]=D}return 0}function K(){S=E-T;for(b=1;b<=T;b+=1)g[S]=g[E],E+=1,S+=1;return g[A+T]=g[A+T+1],d[T]=d[T+1],T+=1,T<v?797:0}function Q(){return g[A+v]=g[A+v+1],g[A+v+1]=0,d[v]=0,v-=1,m[2]=m[2]+1,0}var b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X;M=Math.min(o,h),E=2*o+M*(M+5)/2+2*h+1,U=1e-60;do U+=U,z=1+.1*U,W=1+.2*U;while(z<=1||W<=1);for(b=1;b<=o;b+=1)g[b]=t[b];for(b=o+1;b<=E;b+=1)g[b]=0;for(b=1;b<=h;b+=1)d[b]=0;x=[];if(y[1]===0){s(e,n,o,x);if(x[1]!==0){y[1]=2;return}i(e,n,o,t),r(e,n,o)}else{for(w=1;w<=o;w+=1){u[w]=0;for(b=1;b<=w;b+=1)u[w]=u[w]+e[b][w]*t[b]}for(w=1;w<=o;w+=1){t[w]=0;for(b=w;b<=o;b+=1)t[w]=t[w]+e[w][b]*u[b]}}a[1]=0;for(w=1;w<=o;w+=1){u[w]=t[w],a[1]=a[1]+g[w]*u[w],g[w]=0;for(b=w+1;b<=o;b+=1)e[b][w]=0}a[1]=-a[1]/2,y[1]=0,N=o,C=N+o,A=C+M,k=A+M+1,L=k+M*(M+1)/2,_=L+h;for(b=1;b<=h;b+=1){P=0;for(w=1;w<=o;w+=1)P+=f[w][b]*f[w][b];g[_+b]=Math.sqrt(P)}v=0,m[1]=0,m[2]=0,X=0;for(;;){X=V();if(X===999)return;for(;;){X=$();if(X===0)break;if(X===999)return;if(X===700)if(T===v)Q();else{for(;;){J(),X=K();if(X!==797)break}Q()}}}}function u(e,r,i,s,u,a){e=t(e),r=t(r),i=t(i);var f,l,c,h,p,d=[],v=[],m=[],g=[],y=[],b;u=u||0,a=a?t(a):[undefined,0],s=s?t(s):[],l=e.length-1,c=i[1].length-1;if(!s)for(f=1;f<=c;f+=1)s[f]=0;for(f=1;f<=c;f+=1)v[f]=0;h=0,p=Math.min(l,c);for(f=1;f<=l;f+=1)m[f]=0;d[1]=0;for(f=1;f<=2*l+p*(p+5)/2+2*c+1;f+=1)g[f]=0;for(f=1;f<=2;f+=1)y[f]=0;return o(e,r,l,l,m,d,i,s,l,c,u,v,h,y,g,a),b="",a[1]===1&&(b="constraints are inconsistent, no solution!"),a[1]===2&&(b="matrix D in quadratic function is not positive definite!"),{solution:n(m),value:n(d),unconstrained_solution:n(r),iterations:n(y),iact:n(v),message:b}}e.solveQP=u}(numeric),numeric.svd=function(t){function g(e,t){return e=Math.abs(e),t=Math.abs(t),e>t?e*Math.sqrt(1+t*t/e/e):t==0?e:t*Math.sqrt(1+e*e/t/t)}var n,r=numeric.epsilon,i=1e-64/r,s=50,o=0,u=0,a=0,f=0,l=0,c=numeric.clone(t),h=c.length,p=c[0].length;if(h<p)throw"Need more rows than columns";var d=new Array(p),v=new Array(p);for(u=0;u<p;u++)d[u]=v[u]=0;var m=numeric.rep([p,p],0),y=0,b=0,w=0,E=0,S=0,x=0,T=0;for(u=0;u<p;u++){d[u]=b,T=0,l=u+1;for(a=u;a<h;a++)T+=c[a][u]*c[a][u];if(T<=i)b=0;else{y=c[u][u],b=Math.sqrt(T),y>=0&&(b=-b),w=y*b-T,c[u][u]=y-b;for(a=l;a<p;a++){T=0;for(f=u;f<h;f++)T+=c[f][u]*c[f][a];y=T/w;for(f=u;f<h;f++)c[f][a]+=y*c[f][u]}}v[u]=b,T=0;for(a=l;a<p;a++)T+=c[u][a]*c[u][a];if(T<=i)b=0;else{y=c[u][u+1],b=Math.sqrt(T),y>=0&&(b=-b),w=y*b-T,c[u][u+1]=y-b;for(a=l;a<p;a++)d[a]=c[u][a]/w;for(a=l;a<h;a++){T=0;for(f=l;f<p;f++)T+=c[a][f]*c[u][f];for(f=l;f<p;f++)c[a][f]+=T*d[f]}}S=Math.abs(v[u])+Math.abs(d[u]),S>E&&(E=S)}for(u=p-1;u!=-1;u+=-1){if(b!=0){w=b*c[u][u+1];for(a=l;a<p;a++)m[a][u]=c[u][a]/w;for(a=l;a<p;a++){T=0;for(f=l;f<p;f++)T+=c[u][f]*m[f][a];for(f=l;f<p;f++)m[f][a]+=T*m[f][u]}}for(a=l;a<p;a++)m[u][a]=0,m[a][u]=0;m[u][u]=1,b=d[u],l=u}for(u=p-1;u!=-1;u+=-1){l=u+1,b=v[u];for(a=l;a<p;a++)c[u][a]=0;if(b!=0){w=c[u][u]*b;for(a=l;a<p;a++){T=0;for(f=l;f<h;f++)T+=c[f][u]*c[f][a];y=T/w;for(f=u;f<h;f++)c[f][a]+=y*c[f][u]}for(a=u;a<h;a++)c[a][u]=c[a][u]/b}else for(a=u;a<h;a++)c[a][u]=0;c[u][u]+=1}r*=E;for(f=p-1;f!=-1;f+=-1)for(var N=0;N<s;N++){var C=!1;for(l=f;l!=-1;l+=-1){if(Math.abs(d[l])<=r){C=!0;break}if(Math.abs(v[l-1])<=r)break}if(!C){o=0,T=1;var k=l-1;for(u=l;u<f+1;u++){y=T*d[u],d[u]=o*d[u];if(Math.abs(y)<=r)break;b=v[u],w=g(y,b),v[u]=w,o=b/w,T=-y/w;for(a=0;a<h;a++)S=c[a][k],x=c[a][u],c[a][k]=S*o+x*T,c[a][u]=-S*T+x*o}}x=v[f];if(l==f){if(x<0){v[f]=-x;for(a=0;a<p;a++)m[a][f]=-m[a][f]}break}if(N>=s-1)throw"Error: no convergence.";E=v[l],S=v[f-1],b=d[f-1],w=d[f],y=((S-x)*(S+x)+(b-w)*(b+w))/(2*w*S),b=g(y,1),y<0?y=((E-x)*(E+x)+w*(S/(y-b)-w))/E:y=((E-x)*(E+x)+w*(S/(y+b)-w))/E,o=1,T=1;for(u=l+1;u<f+1;u++){b=d[u],S=v[u],w=T*b,b=o*b,x=g(y,w),d[u-1]=x,o=y/x,T=w/x,y=E*o+b*T,b=-E*T+b*o,w=S*T,S*=o;for(a=0;a<p;a++)E=m[a][u-1],x=m[a][u],m[a][u-1]=E*o+x*T,m[a][u]=-E*T+x*o;x=g(y,w),v[u-1]=x,o=y/x,T=w/x,y=o*b+T*S,E=-T*b+o*S;for(a=0;a<h;a++)S=c[a][u-1],x=c[a][u],c[a][u-1]=S*o+x*T,c[a][u]=-S*T+x*o}d[l]=0,d[f]=y,v[f]=E}for(u=0;u<v.length;u++)v[u]<r&&(v[u]=0);for(u=0;u<p;u++)for(a=u-1;a>=0;a--)if(v[a]<v[u]){o=v[a],v[a]=v[u],v[u]=o;for(f=0;f<c.length;f++)n=c[f][u],c[f][u]=c[f][a],c[f][a]=n;for(f=0;f<m.length;f++)n=m[f][u],m[f][u]=m[f][a],m[f][a]=n;u=a}return{U:c,S:v,V:m}};;
var M = Math;
function _horner(arr, v) { return arr.reduce(function(z,w){return v * z + w;},0); };
function _bessel_iter(x, n, f0, f1, sign) {
  if(!sign) sign = -1;
  var tdx = 2 / x, f2;
  if(n === 0) return f0;
  if(n === 1) return f1;
  for(var o = 1; o != n; ++o) {
    f2 = f1 * o * tdx + sign * f0;
    f0 = f1; f1 = f2;
  }
  return f1;
}
function _bessel_wrap(bessel0, bessel1, name, nonzero, sign) {
  return function bessel(x,n) {
    if(n === 0) return bessel0(x);
    if(n === 1) return bessel1(x);
    if(n < 0) throw name + ': Order (' + n + ') must be nonnegative';
    if(nonzero == 1 && x === 0) throw name + ': Undefined when x == 0';
    if(nonzero == 2 && x <= 0) throw name + ': Undefined when x <= 0';
    var b0 = bessel0(x), b1 = bessel1(x);
    return _bessel_iter(x, n, b0, b1, sign);
  };
}
var besselj = (function() {
  var b0_a1a = [57568490574.0,-13362590354.0,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse();
  var b0_a2a = [57568490411.0,1029532985.0,9494680.718,59272.64853,267.8532712,1.0].reverse();
  var b0_a1b = [1.0, -0.1098628627e-2, 0.2734510407e-4, -0.2073370639e-5, 0.2093887211e-6].reverse();
  var b0_a2b = [-0.1562499995e-1, 0.1430488765e-3, -0.6911147651e-5, 0.7621095161e-6, -0.934935152e-7].reverse();
  var W = 0.636619772; // 2 / Math.PI

  function bessel0(x) {
    var a, a1, a2, y = x * x, xx = M.abs(x) - 0.785398164;
    if(M.abs(x) < 8) {
      a1 = _horner(b0_a1a, y);
      a2 = _horner(b0_a2a, y);
      a = a1/a2;
    }
    else {
      y = 64 / y;
      a1 = _horner(b0_a1b, y);
      a2 = _horner(b0_a2b, y);
      a = M.sqrt(W/M.abs(x))*(M.cos(xx)*a1-M.sin(xx)*a2*8/M.abs(x));
    }
    return a;
  }
  var b1_a1a = [72362614232.0,-7895059235.0,242396853.1,-2972611.439, 15704.48260, -30.16036606].reverse();
  var b1_a2a = [144725228442.0, 2300535178.0, 18583304.74, 99447.43394, 376.9991397, 1.0].reverse();
  var b1_a1b = [1.0, 0.183105e-2, -0.3516396496e-4, 0.2457520174e-5, -0.240337019e-6].reverse();
  var b1_a2b = [0.04687499995, -0.2002690873e-3, 0.8449199096e-5, -0.88228987e-6, 0.105787412e-6].reverse();
  function bessel1(x) {
    var a, a1, a2, y = x*x, xx = M.abs(x) - 2.356194491;
    if(Math.abs(x)< 8) {
      a1 = x*_horner(b1_a1a, y);
      a2 = _horner(b1_a2a, y);
      a = a1 / a2;
    } else {
      y = 64 / y;
      a1=_horner(b1_a1b, y);
      a2=_horner(b1_a2b, y);
      a=M.sqrt(W/M.abs(x))*(M.cos(xx)*a1-M.sin(xx)*a2*8/M.abs(x));
      if(x < 0) a = -a;
    }
    return a;
  }
  return function besselj(x, n) {
    n = Math.round(n);
    if(n === 0) return bessel0(M.abs(x));
    if(n === 1) return bessel1(M.abs(x));
    if(n < 0) throw 'BESSELJ: Order (' + n + ') must be nonnegative';
    if(M.abs(x) === 0) return 0;

    var ret, j, tox = 2 / M.abs(x), m, jsum, sum, bjp, bj, bjm;
    if(M.abs(x) > n) {
      ret = _bessel_iter(x, n, bessel0(M.abs(x)), bessel1(M.abs(x)),-1);
    } else {
      m=2*M.floor((n+M.floor(M.sqrt(40*n)))/2);
      jsum=0;
      bjp=ret=sum=0.0;
      bj=1.0;
      for (j=m;j>0;j--) {
        bjm=j*tox*bj-bjp;
        bjp=bj;
        bj=bjm;
        if (M.abs(bj) > 1E10) {
          bj *= 1E-10;
          bjp *= 1E-10;
          ret *= 1E-10;
          sum *= 1E-10;
        }
        if (jsum) sum += bj;
        jsum=!jsum;
        if (j == n) ret=bjp;
      }
      sum=2.0*sum-bj;
      ret /= sum;
    }
    return x < 0 && (n%2) ? -ret : ret;
  };
})();
var bessely = (function() {
  var b0_a1a = [-2957821389.0, 7062834065.0, -512359803.6, 10879881.29, -86327.92757, 228.4622733].reverse();
  var b0_a2a = [40076544269.0, 745249964.8, 7189466.438, 47447.26470, 226.1030244, 1.0].reverse();
  var b0_a1b = [1.0, -0.1098628627e-2, 0.2734510407e-4, -0.2073370639e-5, 0.2093887211e-6].reverse();
  var b0_a2b = [-0.1562499995e-1, 0.1430488765e-3, -0.6911147651e-5, 0.7621095161e-6, -0.934945152e-7].reverse();

  var W = 0.636619772;
  function bessel0(x) {
    var a, a1, a2, y = x * x, xx = x - 0.785398164;
    if(x < 8) {
      a1 = _horner(b0_a1a, y);
      a2 = _horner(b0_a2a, y);
      a = a1/a2 + W * besselj(x,0) * M.log(x);
    } else {
      y = 64 / y;
      a1 = _horner(b0_a1b, y);
      a2 = _horner(b0_a2b, y);
      a = M.sqrt(W/x)*(M.sin(xx)*a1+M.cos(xx)*a2*8/x);
    }
    return a;
  }

  var b1_a1a = [-0.4900604943e13, 0.1275274390e13, -0.5153438139e11, 0.7349264551e9, -0.4237922726e7, 0.8511937935e4].reverse();
  var b1_a2a = [0.2499580570e14, 0.4244419664e12, 0.3733650367e10, 0.2245904002e8, 0.1020426050e6, 0.3549632885e3, 1].reverse();
  var b1_a1b = [1.0, 0.183105e-2, -0.3516396496e-4, 0.2457520174e-5, -0.240337019e-6].reverse();
  var b1_a2b = [0.04687499995, -0.2002690873e-3, 0.8449199096e-5, -0.88228987e-6, 0.105787412e-6].reverse();
  function bessel1(x) {
    var a, a1, a2, y = x*x, xx = x - 2.356194491;
    if(x < 8) {
      a1 = x*_horner(b1_a1a, y);
      a2 = _horner(b1_a2a, y);
      a = a1/a2 + W * (besselj(x,1) * M.log(x) - 1 / x);
    } else {
      y = 64 / y;
      a1=_horner(b1_a1b, y);
      a2=_horner(b1_a2b, y);
      a=M.sqrt(W/x)*(M.sin(xx)*a1+M.cos(xx)*a2*8/x);
    }
    return a;
  }

  return _bessel_wrap(bessel0, bessel1, 'BESSELY', 1, -1);
})();
var besseli = (function() {
  var b0_a = [1.0, 3.5156229, 3.0899424, 1.2067492, 0.2659732, 0.360768e-1, 0.45813e-2].reverse();
  var b0_b = [0.39894228, 0.1328592e-1, 0.225319e-2, -0.157565e-2, 0.916281e-2, -0.2057706e-1, 0.2635537e-1, -0.1647633e-1, 0.392377e-2].reverse();
  function bessel0(x) {
    if(x <= 3.75) return _horner(b0_a, x*x/(3.75*3.75));
    return M.exp(M.abs(x))/M.sqrt(M.abs(x))*_horner(b0_b, 3.75/M.abs(x));
  }

  var b1_a = [0.5, 0.87890594, 0.51498869, 0.15084934, 0.2658733e-1, 0.301532e-2, 0.32411e-3].reverse();
  var b1_b = [0.39894228, -0.3988024e-1, -0.362018e-2, 0.163801e-2, -0.1031555e-1, 0.2282967e-1, -0.2895312e-1, 0.1787654e-1, -0.420059e-2].reverse();
  function bessel1(x) {
    if(x < 3.75) return x * _horner(b1_a, x*x/(3.75*3.75));
    return (x < 0 ? -1 : 1) * M.exp(M.abs(x))/M.sqrt(M.abs(x))*_horner(b1_b, 3.75/M.abs(x));
  }

  return function besseli(x, n) {
    n = Math.round(n);
    if(n === 0) return bessel0(x);
    if(n == 1) return bessel1(x);
    if(n < 0) throw 'BESSELI Order (' + n + ') must be nonnegative';
    if(M.abs(x) === 0) return 0;

    var ret, j, tox = 2 / M.abs(x), m, bip, bi, bim;
    m=2*M.round((n+M.round(M.sqrt(40*n)))/2);
    bip=ret=0.0;
    bi=1.0;
    for (j=m;j>0;j--) {
      bim=j*tox*bi + bip;
      bip=bi; bi=bim;
      if (M.abs(bi) > 1E10) {
        bi *= 1E-10;
        bip *= 1E-10;
        ret *= 1E-10;
      }
      if(j == n) ret = bip;
    }
    ret *= besseli(x, 0) / bi;
    return x < 0 && (n%2) ? -ret : ret;
  };

})();

var besselk = (function() {
  var b0_a = [-0.57721566, 0.42278420, 0.23069756, 0.3488590e-1, 0.262698e-2, 0.10750e-3, 0.74e-5].reverse();
  var b0_b = [1.25331414, -0.7832358e-1, 0.2189568e-1, -0.1062446e-1, 0.587872e-2, -0.251540e-2, 0.53208e-3].reverse();
  function bessel0(x) {
    if(x <= 2) return -M.log(x/2)*besseli(x,0) + _horner(b0_a, x*x/4);
    return M.exp(-x)/M.sqrt(x)*_horner(b0_b, 2/x);
  }

  var b1_a = [1.0, 0.15443144, -0.67278579, -0.18156897, -0.1919402e-1, -0.110404e-2, -0.4686e-4].reverse();
  var b1_b = [1.25331414, 0.23498619, -0.3655620e-1, 0.1504268e-1, -0.780353e-2, 0.325614e-2, -0.68245e-3].reverse();
  function bessel1(x) {
    if(x <= 2) return M.log(x/2)*besseli(x,1) + (1/x)*_horner(b1_a, x*x/4);
    return M.exp(-x)/M.sqrt(x)*_horner(b1_b, 2/x);
  }

  return _bessel_wrap(bessel0, bessel1, 'BESSELK', 2, 1);
})();
if(typeof exports !== "undefined") {
  exports.besselj = besselj;
  exports.bessely = bessely;
  exports.besseli = besseli;
  exports.besselk = besselk;
}

;
!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):"object"==typeof exports?exports.formulajs=e():r.formulajs=e()}(this,function(){return function(r){function e(t){if(n[t])return n[t].exports;var u=n[t]={exports:{},id:t,loaded:!1};return r[t].call(u.exports,u,u.exports,e),u.loaded=!0,u.exports}var n={};return e.m=r,e.c=n,e.p="",e(0)}([function(r,e,n){var t=[n(1),n(2),n(3),n(4),n(5),n(6),n(7),n(8),n(9),n(10),n(11),n(12)];for(var u in t){var i=t[u];for(var a in i)e[a]=e[a]||i[a]}},function(r,e,n){function t(r,e){if(e)for(var n in e)r[n]=e[n];return r}var u=n(5),i=n(11),a=n(3),o=n(7);e.BETADIST=i.BETA.DIST,e.BETAINV=i.BETA.INV,e.BINOMDIST=i.BINOM.DIST,e.CEILING=e.ISOCEILING=t(u.CEILING.MATH,u.CEILING),e.CEILINGMATH=u.CEILING.MATH,e.CEILINGPRECISE=u.CEILING.PRECISE,e.CHIDIST=i.CHISQ.DIST,e.CHIDISTRT=i.CHISQ.DIST.RT,e.CHIINV=i.CHISQ.INV,e.CHIINVRT=i.CHISQ.INV.RT,e.CHITEST=i.CHISQ.TEST,e.CONFIDENCE=t(i.CONFIDENCE.NORM,i.CONFIDENCE),e.COVAR=i.COVARIANCE.P,e.COVARIANCEP=i.COVARIANCE.P,e.COVARIANCES=i.COVARIANCE.S,e.CRITBINOM=i.BINOM.INV,e.EXPONDIST=i.EXPON.DIST,e.ERFCPRECISE=a.ERFC.PRECISE,e.ERFPRECISE=a.ERF.PRECISE,e.FDIST=i.F.DIST,e.FDISTRT=i.F.DIST.RT,e.FINVRT=i.F.INV.RT,e.FINV=i.F.INV,e.FLOOR=t(u.FLOOR.MATH,u.FLOOR),e.FLOORMATH=u.FLOOR.MATH,e.FLOORPRECISE=u.FLOOR.PRECISE,e.FTEST=i.F.TEST,e.GAMMADIST=i.GAMMA.DIST,e.GAMMAINV=i.GAMMA.INV,e.GAMMALNPRECISE=i.GAMMALN.PRECISE,e.HYPGEOMDIST=i.HYPGEOM.DIST,e.LOGINV=i.LOGNORM.INV,e.LOGNORMINV=i.LOGNORM.INV,e.LOGNORMDIST=i.LOGNORM.DIST,e.MODE=t(i.MODE.SNGL,i.MODE),e.MODEMULT=i.MODE.MULT,e.MODESNGL=i.MODE.SNGL,e.NEGBINOMDIST=i.NEGBINOM.DIST,e.NETWORKDAYSINTL=o.NETWORKDAYS.INTL,e.NORMDIST=i.NORM.DIST,e.NORMINV=i.NORM.INV,e.NORMSDIST=i.NORM.S.DIST,e.NORMSINV=i.NORM.S.INV,e.PERCENTILE=t(i.PERCENTILE.EXC,i.PERCENTILE),e.PERCENTILEEXC=i.PERCENTILE.EXC,e.PERCENTILEINC=i.PERCENTILE.INC,e.PERCENTRANK=t(i.PERCENTRANK.INC,i.PERCENTRANK),e.PERCENTRANKEXC=i.PERCENTRANK.EXC,e.PERCENTRANKINC=i.PERCENTRANK.INC,e.POISSON=t(i.POISSON.DIST,i.POISSON),e.POISSONDIST=i.POISSON.DIST,e.QUARTILE=t(i.QUARTILE.INC,i.QUARTILE),e.QUARTILEEXC=i.QUARTILE.EXC,e.QUARTILEINC=i.QUARTILE.INC,e.RANK=t(i.RANK.EQ,i.RANK),e.RANKAVG=i.RANK.AVG,e.RANKEQ=i.RANK.EQ,e.SKEWP=i.SKEW.P,e.STDEV=t(i.STDEV.S,i.STDEV),e.STDEVP=i.STDEV.P,e.STDEVS=i.STDEV.S,e.TDIST=i.T.DIST,e.TDISTRT=i.T.DIST.RT,e.TINV=i.T.INV,e.TTEST=i.T.TEST,e.VAR=t(i.VAR.S,i.VAR),e.VARP=i.VAR.P,e.VARS=i.VAR.S,e.WEIBULL=t(i.WEIBULL.DIST,i.WEIBULL),e.WEIBULLDIST=i.WEIBULL.DIST,e.WORKDAYINTL=o.WORKDAY.INTL,e.ZTEST=i.Z.TEST},function(module,exports,__webpack_require__){function compact(r){if(!r)return r;for(var e=[],n=0;n<r.length;++n)r[n]&&e.push(r[n]);return e}function findResultIndex(database,criterias){for(var matches={},i=1;i<database[0].length;++i)matches[i]=!0;var maxCriteriaLength=criterias[0].length;for(i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(var k=1;k<database.length;++k)for(var l=1;l<database[k].length;++l){for(var currentCriteriaResult=!1,hasMatchingCriteria=!1,j=0;j<criterias.length;++j){var criteria=criterias[j];if(!(criteria.length<maxCriteriaLength)){var criteriaField=criteria[0];if(database[k][0]===criteriaField){hasMatchingCriteria=!0;for(var p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}}hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}for(var result=[],n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result}var error=__webpack_require__(13),stats=__webpack_require__(11),maths=__webpack_require__(5),utils=__webpack_require__(14);exports.FINDFIELD=function(r,e){for(var n=null,t=0;t<r.length;t++)if(r[t][0]===e){n=t;break}return null==n?error.value:n},exports.DAVERAGE=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=0,o=0;o<t.length;o++)a+=u[t[o]];return 0===t.length?error.div0:a/t.length},exports.DCOUNT=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=[],o=0;o<t.length;o++)a[o]=u[t[o]];return stats.COUNT(a)},exports.DCOUNTA=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=[],o=0;o<t.length;o++)a[o]=u[t[o]];return stats.COUNTA(a)},exports.DGET=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);return 0===t.length?error.value:t.length>1?error.num:u[t[0]]},exports.DMAX=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=u[t[0]],o=1;o<t.length;o++)a<u[t[o]]&&(a=u[t[o]]);return a},exports.DMIN=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=u[t[0]],o=1;o<t.length;o++)a>u[t[o]]&&(a=u[t[o]]);return a},exports.DPRODUCT=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=[],o=0;o<t.length;o++)a[o]=u[t[o]];a=compact(a);var s=1;for(o=0;o<a.length;o++)s*=a[o];return s},exports.DSTDEV=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=[],o=0;o<t.length;o++)a[o]=u[t[o]];return a=compact(a),stats.STDEV.S(a)},exports.DSTDEVP=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=[],o=0;o<t.length;o++)a[o]=u[t[o]];return a=compact(a),stats.STDEV.P(a)},exports.DSUM=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=[],o=0;o<t.length;o++)a[o]=u[t[o]];return maths.SUM(a)},exports.DVAR=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=[],o=0;o<t.length;o++)a[o]=u[t[o]];return stats.VAR.S(a)},exports.DVARP=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=[],o=0;o<t.length;o++)a[o]=u[t[o]];return stats.VAR.P(a)}},function(r,e,n){function t(r){return/^[01]{1,10}$/.test(r)}var u=n(13),i=n(18).jStat,a=n(6),o=n(14),s=n(15);e.BESSELI=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:s.besseli(r,e)},e.BESSELJ=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:s.besselj(r,e)},e.BESSELK=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:s.besselk(r,e)},e.BESSELY=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:s.bessely(r,e)},e.BIN2DEC=function(r){if(!t(r))return u.num;var e=parseInt(r,2),n=r.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:e},e.BIN2HEX=function(r,e){if(!t(r))return u.num;var n=r.toString();if(10===n.length&&"1"===n.substring(0,1))return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);var i=parseInt(r,2).toString(16);return void 0===e?i:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=i.length?a.REPT("0",e-i.length)+i:u.num)},e.BIN2OCT=function(r,e){if(!t(r))return u.num;var n=r.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);var i=parseInt(r,2).toString(8);return void 0===e?i:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=i.length?a.REPT("0",e-i.length)+i:u.num)},e.BITAND=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:0>r||0>e?u.num:Math.floor(r)!==r||Math.floor(e)!==e?u.num:r>0xffffffffffff||e>0xffffffffffff?u.num:r&e},e.BITLSHIFT=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:0>r?u.num:Math.floor(r)!==r?u.num:r>0xffffffffffff?u.num:Math.abs(e)>53?u.num:e>=0?r<<e:r>>-e},e.BITOR=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:0>r||0>e?u.num:Math.floor(r)!==r||Math.floor(e)!==e?u.num:r>0xffffffffffff||e>0xffffffffffff?u.num:r|e},e.BITRSHIFT=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:0>r?u.num:Math.floor(r)!==r?u.num:r>0xffffffffffff?u.num:Math.abs(e)>53?u.num:e>=0?r>>e:r<<-e},e.BITXOR=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:0>r||0>e?u.num:Math.floor(r)!==r||Math.floor(e)!==e?u.num:r>0xffffffffffff||e>0xffffffffffff?u.num:r^e},e.COMPLEX=function(r,e,n){if(r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e))return r;if(n=void 0===n?"i":n,"i"!==n&&"j"!==n)return u.value;if(0===r&&0===e)return 0;if(0===r)return 1===e?n:e.toString()+n;if(0===e)return r.toString();var t=e>0?"+":"";return r.toString()+t+(1===e?n:e.toString()+n)},e.CONVERT=function(r,e,n){if(r=o.parseNumber(r),r instanceof Error)return r;for(var t,i=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576e-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182e-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667e-11],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715e-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828e-27],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189e31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],a={Yi:["yobi",80,1.2089258196146292e24,"Yi","yotta"],Zi:["zebi",70,0x400000000000000000,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},s={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},f=null,l=null,c=e,m=n,p=1,h=1,g=0;g<i.length;g++)t=null===i[g][2]?[]:i[g][2],(i[g][1]===c||t.indexOf(c)>=0)&&(f=i[g]),(i[g][1]===m||t.indexOf(m)>=0)&&(l=i[g]);if(null===f){var v=a[e.substring(0,2)],d=s[e.substring(0,1)];"da"===e.substring(0,2)&&(d=["dekao",10,"da"]),v?(p=v[2],c=e.substring(2)):d&&(p=d[1],c=e.substring(d[2].length));for(var y=0;y<i.length;y++)t=null===i[y][2]?[]:i[y][2],(i[y][1]===c||t.indexOf(c)>=0)&&(f=i[y])}if(null===l){var b=a[n.substring(0,2)],N=s[n.substring(0,1)];"da"===n.substring(0,2)&&(N=["dekao",10,"da"]),b?(h=b[2],m=n.substring(2)):N&&(h=N[1],m=n.substring(N[2].length));for(var E=0;E<i.length;E++)t=null===i[E][2]?[]:i[E][2],(i[E][1]===m||t.indexOf(m)>=0)&&(l=i[E])}return null===f||null===l?u.na:f[3]!==l[3]?u.na:r*f[6]*p/(l[6]*h)},e.DEC2BIN=function(r,e){if(r=o.parseNumber(r),r instanceof Error)return r;if(!/^-?[0-9]{1,3}$/.test(r)||-512>r||r>511)return u.num;if(0>r)return"1"+a.REPT("0",9-(512+r).toString(2).length)+(512+r).toString(2);var n=parseInt(r,10).toString(2);return"undefined"==typeof e?n:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=n.length?a.REPT("0",e-n.length)+n:u.num)},e.DEC2HEX=function(r,e){if(r=o.parseNumber(r),r instanceof Error)return r;if(!/^-?[0-9]{1,12}$/.test(r)||-549755813888>r||r>549755813887)return u.num;if(0>r)return(1099511627776+r).toString(16);var n=parseInt(r,10).toString(16);return"undefined"==typeof e?n:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=n.length?a.REPT("0",e-n.length)+n:u.num)},e.DEC2OCT=function(r,e){if(r=o.parseNumber(r),r instanceof Error)return r;if(!/^-?[0-9]{1,9}$/.test(r)||-536870912>r||r>536870911)return u.num;if(0>r)return(1073741824+r).toString(8);var n=parseInt(r,10).toString(8);return"undefined"==typeof e?n:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=n.length?a.REPT("0",e-n.length)+n:u.num)},e.DELTA=function(r,e){return e=void 0===e?0:e,r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:r===e?1:0},e.ERF=function(r,e){return e=void 0===e?0:e,r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:i.erf(r)},e.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")},e.ERFC=function(r){return isNaN(r)?u.value:i.erfc(r)},e.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")},e.GESTEP=function(r,e){return e=e||0,r=o.parseNumber(r),o.anyIsError(e,r)?r:r>=e?1:0},e.HEX2BIN=function(r,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return u.num;var n=10===r.length&&"f"===r.substring(0,1).toLowerCase()?!0:!1,t=n?parseInt(r,16)-1099511627776:parseInt(r,16);if(-512>t||t>511)return u.num;if(n)return"1"+a.REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);var i=t.toString(2);return void 0===e?i:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=i.length?a.REPT("0",e-i.length)+i:u.num)},e.HEX2DEC=function(r){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return u.num;var e=parseInt(r,16);return e>=549755813888?e-1099511627776:e},e.HEX2OCT=function(r,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return u.num;var n=parseInt(r,16);if(n>536870911&&0xffe0000000>n)return u.num;if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);var t=n.toString(8);return void 0===e?t:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=t.length?a.REPT("0",e-t.length)+t:u.num)},e.IMABS=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);return o.anyIsError(n,t)?u.value:Math.sqrt(Math.pow(n,2)+Math.pow(t,2))},e.IMAGINARY=function(r){if(void 0===r||r===!0||r===!1)return u.value;if(0===r||"0"===r)return 0;if(["i","j"].indexOf(r)>=0)return 1;r=r.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var e=r.indexOf("+"),n=r.indexOf("-");0===e&&(e=r.indexOf("+",1)),0===n&&(n=r.indexOf("-",1));var t=r.substring(r.length-1,r.length),i="i"===t||"j"===t;return e>=0||n>=0?i?e>=0?isNaN(r.substring(0,e))||isNaN(r.substring(e+1,r.length-1))?u.num:Number(r.substring(e+1,r.length-1)):isNaN(r.substring(0,n))||isNaN(r.substring(n+1,r.length-1))?u.num:-Number(r.substring(n+1,r.length-1)):u.num:i?isNaN(r.substring(0,r.length-1))?u.num:r.substring(0,r.length-1):isNaN(r)?u.num:0},e.IMARGUMENT=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);return o.anyIsError(n,t)?u.value:0===n&&0===t?u.div0:0===n&&t>0?Math.PI/2:0===n&&0>t?-Math.PI/2:0===t&&n>0?0:0===t&&0>n?-Math.PI:n>0?Math.atan(t/n):0>n&&t>=0?Math.atan(t/n)+Math.PI:Math.atan(t/n)-Math.PI},e.IMCONJUGATE=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);return i="i"===i||"j"===i?i:"i",0!==t?e.COMPLEX(n,-t,i):r},e.IMCOS=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(n)*(Math.exp(t)+Math.exp(-t))/2,-Math.sin(n)*(Math.exp(t)-Math.exp(-t))/2,i)},e.IMCOSH=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(t)*(Math.exp(n)+Math.exp(-n))/2,Math.sin(t)*(Math.exp(n)-Math.exp(-n))/2,i)},e.IMCOT=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);return o.anyIsError(n,t)?u.value:e.IMDIV(e.IMCOS(r),e.IMSIN(r))},e.IMDIV=function(r,n){var t=e.IMREAL(r),i=e.IMAGINARY(r),a=e.IMREAL(n),s=e.IMAGINARY(n);if(o.anyIsError(t,i,a,s))return u.value;var f=r.substring(r.length-1),l=n.substring(n.length-1),c="i";if("j"===f?c="j":"j"===l&&(c="j"),0===a&&0===s)return u.num;var m=a*a+s*s;return e.COMPLEX((t*a+i*s)/m,(i*a-t*s)/m,c)},e.IMEXP=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);i="i"===i||"j"===i?i:"i";var a=Math.exp(n);return e.COMPLEX(a*Math.cos(t),a*Math.sin(t),i)},e.IMLN=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(n*n+t*t)),Math.atan(t/n),i)},e.IMLOG10=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(n*n+t*t))/Math.log(10),Math.atan(t/n)/Math.log(10),i)},e.IMLOG2=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(n*n+t*t))/Math.log(2),Math.atan(t/n)/Math.log(2),i)},e.IMPOWER=function(r,n){n=o.parseNumber(n);var t=e.IMREAL(r),i=e.IMAGINARY(r);if(o.anyIsError(n,t,i))return u.value;var a=r.substring(r.length-1);a="i"===a||"j"===a?a:"i";var s=Math.pow(e.IMABS(r),n),f=e.IMARGUMENT(r);return e.COMPLEX(s*Math.cos(n*f),s*Math.sin(n*f),a)},e.IMPRODUCT=function(){for(var r=arguments[0],n=1;n<arguments.length;n++){var t=e.IMREAL(r),i=e.IMAGINARY(r),a=e.IMREAL(arguments[n]),s=e.IMAGINARY(arguments[n]);if(o.anyIsError(t,i,a,s))return u.value;r=e.COMPLEX(t*a-i*s,t*s+i*a)}return r},e.IMREAL=function(r){if(void 0===r||r===!0||r===!1)return u.value;if(0===r||"0"===r)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(r)>=0)return 0;var e=r.indexOf("+"),n=r.indexOf("-");0===e&&(e=r.indexOf("+",1)),0===n&&(n=r.indexOf("-",1));var t=r.substring(r.length-1,r.length),i="i"===t||"j"===t;return e>=0||n>=0?i?e>=0?isNaN(r.substring(0,e))||isNaN(r.substring(e+1,r.length-1))?u.num:Number(r.substring(0,e)):isNaN(r.substring(0,n))||isNaN(r.substring(n+1,r.length-1))?u.num:Number(r.substring(0,n)):u.num:i?isNaN(r.substring(0,r.length-1))?u.num:0:isNaN(r)?u.num:r},e.IMSEC=function(r){if(r===!0||r===!1)return u.value;var n=e.IMREAL(r),t=e.IMAGINARY(r);return o.anyIsError(n,t)?u.value:e.IMDIV("1",e.IMCOS(r))},e.IMSECH=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);return o.anyIsError(n,t)?u.value:e.IMDIV("1",e.IMCOSH(r))},e.IMSIN=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.sin(n)*(Math.exp(t)+Math.exp(-t))/2,Math.cos(n)*(Math.exp(t)-Math.exp(-t))/2,i)},e.IMSINH=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(t)*(Math.exp(n)-Math.exp(-n))/2,Math.sin(t)*(Math.exp(n)+Math.exp(-n))/2,i)},e.IMSQRT=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);i="i"===i||"j"===i?i:"i";var a=Math.sqrt(e.IMABS(r)),s=e.IMARGUMENT(r);return e.COMPLEX(a*Math.cos(s/2),a*Math.sin(s/2),i)},e.IMCSC=function(r){if(r===!0||r===!1)return u.value;var n=e.IMREAL(r),t=e.IMAGINARY(r);return o.anyIsError(n,t)?u.num:e.IMDIV("1",e.IMSIN(r))},e.IMCSCH=function(r){if(r===!0||r===!1)return u.value;var n=e.IMREAL(r),t=e.IMAGINARY(r);return o.anyIsError(n,t)?u.num:e.IMDIV("1",e.IMSINH(r))},e.IMSUB=function(r,e){var n=this.IMREAL(r),t=this.IMAGINARY(r),i=this.IMREAL(e),a=this.IMAGINARY(e);if(o.anyIsError(n,t,i,a))return u.value;var s=r.substring(r.length-1),f=e.substring(e.length-1),l="i";return"j"===s?l="j":"j"===f&&(l="j"),this.COMPLEX(n-i,t-a,l)},e.IMSUM=function(){for(var r=o.flatten(arguments),e=r[0],n=1;n<r.length;n++){var t=this.IMREAL(e),i=this.IMAGINARY(e),a=this.IMREAL(r[n]),s=this.IMAGINARY(r[n]);if(o.anyIsError(t,i,a,s))return u.value;e=this.COMPLEX(t+a,i+s)}return e},e.IMTAN=function(r){if(r===!0||r===!1)return u.value;var n=e.IMREAL(r),t=e.IMAGINARY(r);return o.anyIsError(n,t)?u.value:this.IMDIV(this.IMSIN(r),this.IMCOS(r))},e.OCT2BIN=function(r,e){if(!/^[0-7]{1,10}$/.test(r))return u.num;var n=10===r.length&&"7"===r.substring(0,1)?!0:!1,t=n?parseInt(r,8)-1073741824:parseInt(r,8);if(-512>t||t>511)return u.num;if(n)return"1"+a.REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);var i=t.toString(2);return"undefined"==typeof e?i:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=i.length?a.REPT("0",e-i.length)+i:u.num)},e.OCT2DEC=function(r){if(!/^[0-7]{1,10}$/.test(r))return u.num;var e=parseInt(r,8);return e>=536870912?e-1073741824:e},e.OCT2HEX=function(r,e){if(!/^[0-7]{1,10}$/.test(r))return u.num;var n=parseInt(r,8);if(n>=536870912)return"ff"+(n+3221225472).toString(16);var t=n.toString(16);return void 0===e?t:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=t.length?a.REPT("0",e-t.length)+t:u.num)}},function(r,e,n){var t=n(13),u=n(14),i=n(9);e.AND=function(){for(var r=u.flatten(arguments),e=!0,n=0;n<r.length;n++)r[n]||(e=!1);return e},e.CHOOSE=function(){if(arguments.length<2)return t.na;var r=arguments[0];return 1>r||r>254?t.value:arguments.length<r+1?t.value:arguments[r]},e.FALSE=function(){return!1},e.IF=function(r,e,n){return r?e:n},e.IFERROR=function(r,e){return i.ISERROR(r)?e:r},e.IFNA=function(r,e){return r===t.na?e:r},e.NOT=function(r){return!r},e.OR=function(){for(var r=u.flatten(arguments),e=!1,n=0;n<r.length;n++)r[n]&&(e=!0);return e},e.TRUE=function(){return!0},e.XOR=function(){for(var r=u.flatten(arguments),e=0,n=0;n<r.length;n++)r[n]&&e++;return 1&Math.floor(Math.abs(e))?!0:!1},e.SWITCH=function(){var r;if(arguments.length>0){var e=arguments[0],n=arguments.length-1,t=Math.floor(n/2),u=!1,i=n%2===0?null:arguments[arguments.length-1];if(t)for(var a=0;t>a;a++)if(e===arguments[2*a+1]){r=arguments[2*a+2],u=!0;break}!u&&i&&(r=i)}return r}},function(module,exports,__webpack_require__){var numeric=__webpack_require__(16),utils=__webpack_require__(14),error=__webpack_require__(13),statistical=__webpack_require__(11),information=__webpack_require__(9);exports.ABS=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.abs(utils.parseNumber(r))},exports.ACOS=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.acos(r)},exports.ACOSH=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.log(r+Math.sqrt(r*r-1))},exports.ACOT=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.atan(1/r)},exports.ACOTH=function(r){return r=utils.parseNumber(r),r instanceof Error?r:.5*Math.log((r+1)/(r-1))},exports.AGGREGATE=function(r,e,n,t){if(r=utils.parseNumber(r),e=utils.parseNumber(r),utils.anyIsError(r,e))return error.value;switch(r){case 1:return statistical.AVERAGE(n);case 2:return statistical.COUNT(n);case 3:return statistical.COUNTA(n);case 4:return statistical.MAX(n);case 5:return statistical.MIN(n);case 6:return exports.PRODUCT(n);case 7:return statistical.STDEV.S(n);case 8:return statistical.STDEV.P(n);case 9:return exports.SUM(n);case 10:return statistical.VAR.S(n);case 11:return statistical.VAR.P(n);case 12:return statistical.MEDIAN(n);case 13:return statistical.MODE.SNGL(n);case 14:return statistical.LARGE(n,t);case 15:return statistical.SMALL(n,t);case 16:return statistical.PERCENTILE.INC(n,t);case 17:return statistical.QUARTILE.INC(n,t);case 18:return statistical.PERCENTILE.EXC(n,t);case 19:return statistical.QUARTILE.EXC(n,t)}},exports.ARABIC=function(r){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(r))return error.value;var e=0;return r.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(r){e+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[r]}),e},exports.ASIN=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.asin(r)},exports.ASINH=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.log(r+Math.sqrt(r*r+1))},exports.ATAN=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.atan(r)},exports.ATAN2=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:Math.atan2(r,e)},exports.ATANH=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.log((1+r)/(1-r))/2},exports.BASE=function(r,e,n){if(n=n||0,r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n))return error.value;
n=void 0===n?0:n;var t=r.toString(e);return new Array(Math.max(n+1-t.length,0)).join("0")+t},exports.CEILING=function(r,e,n){if(e=void 0===e?1:Math.abs(e),n=n||0,r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n))return error.value;if(0===e)return 0;var t=-Math.floor(Math.log(e)/Math.log(10));return r>=0?exports.ROUND(Math.ceil(r/e)*e,t):0===n?-exports.ROUND(Math.floor(Math.abs(r)/e)*e,t):-exports.ROUND(Math.ceil(Math.abs(r)/e)*e,t)},exports.CEILING.MATH=exports.CEILING,exports.CEILING.PRECISE=exports.CEILING,exports.COMBIN=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:exports.FACT(r)/(exports.FACT(e)*exports.FACT(r-e))},exports.COMBINA=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:0===r&&0===e?1:exports.COMBIN(r+e-1,r-1)},exports.COS=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.cos(r)},exports.COSH=function(r){return r=utils.parseNumber(r),r instanceof Error?r:(Math.exp(r)+Math.exp(-r))/2},exports.COT=function(r){return r=utils.parseNumber(r),r instanceof Error?r:1/Math.tan(r)},exports.COTH=function(r){if(r=utils.parseNumber(r),r instanceof Error)return r;var e=Math.exp(2*r);return(e+1)/(e-1)},exports.CSC=function(r){return r=utils.parseNumber(r),r instanceof Error?r:1/Math.sin(r)},exports.CSCH=function(r){return r=utils.parseNumber(r),r instanceof Error?r:2/(Math.exp(r)-Math.exp(-r))},exports.DECIMAL=function(r,e){return arguments.length<1?error.value:parseInt(r,e)},exports.DEGREES=function(r){return r=utils.parseNumber(r),r instanceof Error?r:180*r/Math.PI},exports.EVEN=function(r){return r=utils.parseNumber(r),r instanceof Error?r:exports.CEILING(r,-2,-1)},exports.EXP=Math.exp;var MEMOIZED_FACT=[];exports.FACT=function(r){if(r=utils.parseNumber(r),r instanceof Error)return r;var e=Math.floor(r);return 0===e||1===e?1:MEMOIZED_FACT[e]>0?MEMOIZED_FACT[e]:(MEMOIZED_FACT[e]=exports.FACT(e-1)*e,MEMOIZED_FACT[e])},exports.FACTDOUBLE=function(r){if(r=utils.parseNumber(r),r instanceof Error)return r;var e=Math.floor(r);return 0>=e?1:e*exports.FACTDOUBLE(e-2)},exports.FLOOR=function(r,e){if(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;if(0===e)return 0;if(!(r>0&&e>0||0>r&&0>e))return error.num;e=Math.abs(e);var n=-Math.floor(Math.log(e)/Math.log(10));return r>=0?exports.ROUND(Math.floor(r/e)*e,n):-exports.ROUND(Math.ceil(Math.abs(r)/e),n)},exports.FLOOR.MATH=function(r,e,n){if(e=void 0===e?1:e,n=void 0===n?0:n,r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n))return error.value;if(0===e)return 0;e=e?Math.abs(e):1;var t=-Math.floor(Math.log(e)/Math.log(10));return r>=0?exports.ROUND(Math.floor(r/e)*e,t):0===n||void 0===n?-exports.ROUND(Math.ceil(Math.abs(r)/e)*e,t):-exports.ROUND(Math.floor(Math.abs(r)/e)*e,t)},exports.FLOOR.PRECISE=exports.FLOOR.MATH,exports.GCD=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=r.length,n=r[0],t=0>n?-n:n,u=1;e>u;u++){for(var i=r[u],a=0>i?-i:i;t&&a;)t>a?t%=a:a%=t;t+=a}return t},exports.INT=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.floor(r)},exports.ISO={CEILING:exports.CEILING},exports.LCM=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e,n,t,u,i=1;void 0!==(t=r.pop());)for(;t>1;){if(t%2){for(e=3,n=Math.floor(Math.sqrt(t));n>=e&&t%e;e+=2);u=n>=e?e:t}else u=2;for(t/=u,i*=u,e=r.length;e;r[--e]%u===0&&1===(r[e]/=u)&&r.splice(e,1));}return i},exports.LN=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.log(r)},exports.LOG=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:(e=void 0===e?10:e,Math.log(r)/Math.log(e))},exports.LOG10=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.log(r)/Math.log(10)},exports.MDETERM=function(r){return r=utils.parseMatrix(r),r instanceof Error?r:numeric.det(r)},exports.MINVERSE=function(r){return r=utils.parseMatrix(r),r instanceof Error?r:numeric.inv(r)},exports.MMULT=function(r,e){return r=utils.parseMatrix(r),e=utils.parseMatrix(e),utils.anyIsError(r,e)?error.value:numeric.dot(r,e)},exports.MOD=function(r,e){if(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;if(0===e)return error.div0;var n=Math.abs(r%e);return e>0?n:-n},exports.MROUND=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:0>r*e?error.num:Math.round(r/e)*e},exports.MULTINOMIAL=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=0,n=1,t=0;t<r.length;t++)e+=r[t],n*=exports.FACT(r[t]);return exports.FACT(e)/n},exports.MUNIT=function(r){return r=utils.parseNumber(r),r instanceof Error?r:numeric.identity(r)},exports.ODD=function(r){if(r=utils.parseNumber(r),r instanceof Error)return r;var e=Math.ceil(Math.abs(r));return e=1&e?e:e+1,r>0?e:-e},exports.PI=function(){return Math.PI},exports.POWER=function(r,e){if(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;var n=Math.pow(r,e);return isNaN(n)?error.num:n},exports.PRODUCT=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=1,n=0;n<r.length;n++)e*=r[n];return e},exports.QUOTIENT=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:parseInt(r/e,10)},exports.RADIANS=function(r){return r=utils.parseNumber(r),r instanceof Error?r:r*Math.PI/180},exports.RAND=function(){return Math.random()},exports.RANDBETWEEN=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:r+Math.ceil((e-r+1)*Math.random())-1},exports.ROMAN=function(r){if(r=utils.parseNumber(r),r instanceof Error)return r;for(var e=String(r).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],t="",u=3;u--;)t=(n[+e.pop()+10*u]||"")+t;return new Array(+e.join("")+1).join("M")+t},exports.ROUND=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:Math.round(r*Math.pow(10,e))/Math.pow(10,e)},exports.ROUNDDOWN=function(r,e){if(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;var n=r>0?1:-1;return n*Math.floor(Math.abs(r)*Math.pow(10,e))/Math.pow(10,e)},exports.ROUNDUP=function(r,e){if(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;var n=r>0?1:-1;return n*Math.ceil(Math.abs(r)*Math.pow(10,e))/Math.pow(10,e)},exports.SEC=function(r){return r=utils.parseNumber(r),r instanceof Error?r:1/Math.cos(r)},exports.SECH=function(r){return r=utils.parseNumber(r),r instanceof Error?r:2/(Math.exp(r)+Math.exp(-r))},exports.SERIESSUM=function(r,e,n,t){r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n);var t=utils.parseNumberArray(t);if(utils.anyIsError(r,e,n,t))return error.value;for(var u=t[0]*Math.pow(r,e),i=1;i<t.length;i++)u+=t[i]*Math.pow(r,e+i*n);return u},exports.SIGN=function(r){return r=utils.parseNumber(r),r instanceof Error?r:0>r?-1:0===r?0:1},exports.SIN=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.sin(r)},exports.SINH=function(r){return r=utils.parseNumber(r),r instanceof Error?r:(Math.exp(r)-Math.exp(-r))/2},exports.SQRT=function(r){return r=utils.parseNumber(r),r instanceof Error?r:0>r?error.num:Math.sqrt(r)},exports.SQRTPI=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.sqrt(r*Math.PI)},exports.SUBTOTAL=function(r,e){if(r=utils.parseNumber(r),r instanceof Error)return r;switch(r){case 1:return statistical.AVERAGE(e);case 2:return statistical.COUNT(e);case 3:return statistical.COUNTA(e);case 4:return statistical.MAX(e);case 5:return statistical.MIN(e);case 6:return exports.PRODUCT(e);case 7:return statistical.STDEV.S(e);case 8:return statistical.STDEV.P(e);case 9:return exports.SUM(e);case 10:return statistical.VAR.S(e);case 11:return statistical.VAR.P(e);case 101:return statistical.AVERAGE(e);case 102:return statistical.COUNT(e);case 103:return statistical.COUNTA(e);case 104:return statistical.MAX(e);case 105:return statistical.MIN(e);case 106:return exports.PRODUCT(e);case 107:return statistical.STDEV.S(e);case 108:return statistical.STDEV.P(e);case 109:return exports.SUM(e);case 110:return statistical.VAR.S(e);case 111:return statistical.VAR.P(e)}},exports.ADD=function(r,e){return 2!==arguments.length?error.na:(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:r+e)},exports.MINUS=function(r,e){return 2!==arguments.length?error.na:(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:r-e)},exports.DIVIDE=function(r,e){return 2!==arguments.length?error.na:(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:0===e?error.div0:r/e)},exports.MULTIPLY=function(r,e){return 2!==arguments.length?error.na:(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:r*e)},exports.GTE=function(r,e){return 2!==arguments.length?error.na:(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.error:r>=e)},exports.LT=function(r,e){return 2!==arguments.length?error.na:(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.error:e>r)},exports.LTE=function(r,e){return 2!==arguments.length?error.na:(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.error:e>=r)},exports.EQ=function(r,e){return 2!==arguments.length?error.na:r===e},exports.NE=function(r,e){return 2!==arguments.length?error.na:r!==e},exports.POW=function(r,e){return 2!==arguments.length?error.na:(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.error:exports.POWER(r,e))},exports.SUM=function(){for(var r=utils.numbers(utils.flatten(arguments)),e=0,n=r.length;n--;)e+=r[n];return e},exports.SUMIF=function(range,criteria){var range=utils.parseNumberArray(utils.flatten(range));if(range instanceof Error)return range;for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},exports.SUMIFS=function(){var args=utils.argsToArray(arguments),range=utils.parseNumberArray(utils.flatten(args.shift()));if(range instanceof Error)return range;for(var criteria=args,n_range_elements=range.length,n_criterias=criteria.length,result=0,i=0;n_range_elements>i;i++){for(var el=range[i],condition="",c=0;n_criterias>c;c++)condition+=el+criteria[c],c!==n_criterias-1&&(condition+="&&");eval(condition)&&(result+=el)}return result},exports.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return error.value;for(var r,e,n,t,u=arguments.length+1,i=0,a=0;a<arguments[0].length;a++)if(arguments[0][a]instanceof Array)for(var o=0;o<arguments[0][a].length;o++){for(r=1,e=1;u>e;e++){if(t=utils.parseNumber(arguments[e-1][a][o]),t instanceof Error)return t;r*=t}i+=r}else{for(r=1,e=1;u>e;e++){if(n=utils.parseNumber(arguments[e-1][a]),n instanceof Error)return n;r*=n}i+=r}return i},exports.SUMSQ=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=0,n=r.length,t=0;n>t;t++)e+=information.ISNUMBER(r[t])?r[t]*r[t]:0;return e},exports.SUMX2MY2=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;for(var n=0,t=0;t<r.length;t++)n+=r[t]*r[t]-e[t]*e[t];return n},exports.SUMX2PY2=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;var n=0;r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e));for(var t=0;t<r.length;t++)n+=r[t]*r[t]+e[t]*e[t];return n},exports.SUMXMY2=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;var n=0;r=utils.flatten(r),e=utils.flatten(e);for(var t=0;t<r.length;t++)n+=Math.pow(r[t]-e[t],2);return n},exports.TAN=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.tan(r)},exports.TANH=function(r){if(r=utils.parseNumber(r),r instanceof Error)return r;var e=Math.exp(2*r);return(e-1)/(e+1)},exports.TRUNC=function(r,e){if(e=void 0===e?0:e,r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;var n=r>0?1:-1;return n*Math.floor(Math.abs(r)*Math.pow(10,e))/Math.pow(10,e)}},function(r,e,n){var t=n(14),u=n(13),i=n(17);e.ASC=function(){throw new Error("ASC is not implemented")},e.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},e.CHAR=function(r){return r=t.parseNumber(r),r instanceof Error?r:String.fromCharCode(r)},e.CLEAN=function(r){r=r||"";var e=/[\0-\x1F]/g;return r.replace(e,"")},e.CODE=function(r){return r=r||"",r.charCodeAt(0)},e.CONCATENATE=function(){for(var r=t.flatten(arguments),e=0;(e=r.indexOf(!0))>-1;)r[e]="TRUE";for(var n=0;(n=r.indexOf(!1))>-1;)r[n]="FALSE";return r.join("")},e.DBCS=function(){throw new Error("DBCS is not implemented")},e.DOLLAR=function(r,e){if(e=void 0===e?2:e,r=t.parseNumber(r),e=t.parseNumber(e),t.anyIsError(r,e))return u.value;var n="";return 0>=e?(r=Math.round(r*Math.pow(10,e))/Math.pow(10,e),n="($0,0)"):e>0&&(n="($0,0."+new Array(e+1).join("0")+")"),i(r).format(n)},e.EXACT=function(r,e){return r===e},e.FIND=function(r,e,n){return n=void 0===n?0:n,e?e.indexOf(r,n-1)+1:null},e.FIXED=function(r,e,n){if(e=void 0===e?2:e,n=void 0===n?!1:n,r=t.parseNumber(r),e=t.parseNumber(e),t.anyIsError(r,e))return u.value;var a=n?"0":"0,0";return 0>=e?r=Math.round(r*Math.pow(10,e))/Math.pow(10,e):e>0&&(a+="."+new Array(e+1).join("0")),i(r).format(a)},e.HTML2TEXT=function(r){var e="";return r&&(r instanceof Array?r.forEach(function(r){""!==e&&(e+="\n"),e+=r.replace(/<(?:.|\n)*?>/gm,"")}):e=r.replace(/<(?:.|\n)*?>/gm,"")),e},e.LEFT=function(r,e){return e=void 0===e?1:e,e=t.parseNumber(e),e instanceof Error||"string"!=typeof r?u.value:r?r.substring(0,e):null},e.LEN=function(r){return 0===arguments.length?u.error:"string"==typeof r?r?r.length:0:r.length?r.length:u.value},e.LOWER=function(r){return"string"!=typeof r?u.value:r?r.toLowerCase():r},e.MID=function(r,e,n){return e=t.parseNumber(e),n=t.parseNumber(n),t.anyIsError(e,n)||"string"!=typeof r?n:r.substring(e-1,n)},e.NUMBERVALUE=function(r,e,n){return e="undefined"==typeof e?".":e,n="undefined"==typeof n?",":n,Number(r.replace(e,".").replace(n,""))},e.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},e.PROPER=function(r){return void 0===r||0===r.length?u.value:(r===!0&&(r="TRUE"),r===!1&&(r="FALSE"),isNaN(r)&&"number"==typeof r?u.value:("number"==typeof r&&(r=""+r),r.replace(/\w\S*/g,function(r){return r.charAt(0).toUpperCase()+r.substr(1).toLowerCase()})))},e.REGEXEXTRACT=function(r,e){var n=r.match(new RegExp(e));return n?n[n.length>1?n.length-1:0]:null},e.REGEXMATCH=function(r,e,n){var t=r.match(new RegExp(e));return n?t:!!t},e.REGEXREPLACE=function(r,e,n){return r.replace(new RegExp(e),n)},e.REPLACE=function(r,e,n,i){return e=t.parseNumber(e),n=t.parseNumber(n),t.anyIsError(e,n)||"string"!=typeof r||"string"!=typeof i?u.value:r.substr(0,e-1)+i+r.substr(e-1+n)},e.REPT=function(r,e){return e=t.parseNumber(e),e instanceof Error?e:new Array(e+1).join(r)},e.RIGHT=function(r,e){return e=void 0===e?1:e,e=t.parseNumber(e),e instanceof Error?e:r?r.substring(r.length-e):null},e.SEARCH=function(r,e,n){return"string"!=typeof r||"string"!=typeof e?u.value:(n=void 0===n?0:n,e.toLowerCase().indexOf(r.toLowerCase(),n-1)+1)},e.SPLIT=function(r,e){return r.split(e)},e.SUBSTITUTE=function(r,e,n,t){if(!(r&&e&&n))return r;if(void 0===t)return r.replace(new RegExp(e,"g"),n);for(var u=0,i=0;r.indexOf(e,u)>0;)if(u=r.indexOf(e,u+1),i++,i===t)return r.substring(0,u)+n+r.substring(u+e.length)},e.T=function(r){return"string"==typeof r?r:""},e.TEXT=function(r,e){return r=t.parseNumber(r),t.anyIsError(r)?u.na:i(r).format(e)},e.TRIM=function(r){return"string"!=typeof r?u.value:r.replace(/ +/g," ").trim()},e.UNICHAR=this.CHAR,e.UNICODE=this.CODE,e.UPPER=function(r){return"string"!=typeof r?u.value:r.toUpperCase()},e.VALUE=function(r){return"string"!=typeof r?u.value:i().unformat(r)}},function(r,e,n){function t(r){return 1===new Date(r,1,29).getMonth()}function u(r,e){return Math.ceil((e-r)/1e3/60/60/24)}function i(r){var e=r>-22038912e5?2:1;return(r-s)/864e5+e}var a=n(13),o=n(14),s=new Date(1900,0,1),f=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],l=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],c=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];e.DATE=function(r,e,n){if(r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),o.anyIsError(r,e,n))return a.value;if(0>r||0>e||0>n)return a.num;var t=new Date(r,e-1,n);return t},e.DATEVALUE=function(r){if("string"!=typeof r)return a.value;var e=Date.parse(r);return isNaN(e)?a.value:-22038912e5>=e?(e-s)/864e5+1:(e-s)/864e5+2},e.DAY=function(r){var e=o.parseDate(r);return e instanceof Error?e:e.getDate()},e.DAYS=function(r,e){return r=o.parseDate(r),e=o.parseDate(e),r instanceof Error?r:e instanceof Error?e:i(r)-i(e)},e.DAYS360=function(r,e,n){if(n=o.parseBool(n),r=o.parseDate(r),e=o.parseDate(e),r instanceof Error)return r;if(e instanceof Error)return e;if(n instanceof Error)return n;var t,u,i=r.getMonth(),a=e.getMonth();if(n)t=31===r.getDate()?30:r.getDate(),u=31===e.getDate()?30:e.getDate();else{var s=new Date(r.getFullYear(),i+1,0).getDate(),f=new Date(e.getFullYear(),a+1,0).getDate();t=r.getDate()===s?30:r.getDate(),e.getDate()===f?30>t?(a++,u=1):u=30:u=e.getDate()}return 360*(e.getFullYear()-r.getFullYear())+30*(a-i)+(u-t)},e.EDATE=function(r,e){return r=o.parseDate(r),r instanceof Error?r:isNaN(e)?a.value:(e=parseInt(e,10),r.setMonth(r.getMonth()+e),i(r))},e.EOMONTH=function(r,e){return r=o.parseDate(r),r instanceof Error?r:isNaN(e)?a.value:(e=parseInt(e,10),i(new Date(r.getFullYear(),r.getMonth()+e+1,0)))},e.HOUR=function(r){return r=o.parseDate(r),r instanceof Error?r:r.getHours()},e.INTERVAL=function(r){if("number"!=typeof r&&"string"!=typeof r)return a.value;r=parseInt(r,10);var e=Math.floor(r/94608e4);r%=94608e4;var n=Math.floor(r/2592e3);r%=2592e3;var t=Math.floor(r/86400);r%=86400;var u=Math.floor(r/3600);r%=3600;var i=Math.floor(r/60);r%=60;var o=r;return e=e>0?e+"Y":"",n=n>0?n+"M":"",t=t>0?t+"D":"",u=u>0?u+"H":"",i=i>0?i+"M":"",o=o>0?o+"S":"","P"+e+n+t+"T"+u+i+o},e.ISOWEEKNUM=function(r){if(r=o.parseDate(r),r instanceof Error)return r;r.setHours(0,0,0),r.setDate(r.getDate()+4-(r.getDay()||7));var e=new Date(r.getFullYear(),0,1);return Math.ceil(((r-e)/864e5+1)/7)},e.MINUTE=function(r){return r=o.parseDate(r),r instanceof Error?r:r.getMinutes()},e.MONTH=function(r){return r=o.parseDate(r),r instanceof Error?r:r.getMonth()+1},e.NETWORKDAYS=function(r,e,n){return this.NETWORKDAYS.INTL(r,e,1,n)},e.NETWORKDAYS.INTL=function(r,e,n,t){if(r=o.parseDate(r),r instanceof Error)return r;if(e=o.parseDate(e),e instanceof Error)return e;if(n=void 0===n?c[1]:c[n],!(n instanceof Array))return a.value;void 0===t?t=[]:t instanceof Array||(t=[t]);for(var u=0;u<t.length;u++){var i=o.parseDate(t[u]);if(i instanceof Error)return i;t[u]=i}var s=(e-r)/864e5+1,f=s,l=r;for(u=0;s>u;u++){var m=(new Date).getTimezoneOffset()>0?l.getUTCDay():l.getDay(),p=!1;(m===n[0]||m===n[1])&&(p=!0);for(var h=0;h<t.length;h++){var g=t[h];if(g.getDate()===l.getDate()&&g.getMonth()===l.getMonth()&&g.getFullYear()===l.getFullYear()){p=!0;break}}p&&f--,l.setDate(l.getDate()+1)}return f},e.NOW=function(){return new Date},e.SECOND=function(r){return r=o.parseDate(r),r instanceof Error?r:r.getSeconds()},e.TIME=function(r,e,n){return r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),o.anyIsError(r,e,n)?a.value:0>r||0>e||0>n?a.num:(3600*r+60*e+n)/86400},e.TIMEVALUE=function(r){return r=o.parseDate(r),r instanceof Error?r:(3600*r.getHours()+60*r.getMinutes()+r.getSeconds())/86400},e.TODAY=function(){return new Date},e.WEEKDAY=function(r,e){if(r=o.parseDate(r),r instanceof Error)return r;void 0===e&&(e=1);var n=r.getDay();return l[e][n]},e.WEEKNUM=function(r,e){if(r=o.parseDate(r),r instanceof Error)return r;if(void 0===e&&(e=1),21===e)return this.ISOWEEKNUM(r);var n=f[e],t=new Date(r.getFullYear(),0,1),u=t.getDay()<n?1:0;return t-=24*Math.abs(t.getDay()-n)*60*60*1e3,Math.floor((r-t)/864e5/7+1)+u},e.WORKDAY=function(r,e,n){return this.WORKDAY.INTL(r,e,1,n)},e.WORKDAY.INTL=function(r,e,n,t){if(r=o.parseDate(r),r instanceof Error)return r;if(e=o.parseNumber(e),e instanceof Error)return e;if(0>e)return a.num;if(n=void 0===n?c[1]:c[n],!(n instanceof Array))return a.value;void 0===t?t=[]:t instanceof Array||(t=[t]);for(var u=0;u<t.length;u++){var i=o.parseDate(t[u]);if(i instanceof Error)return i;t[u]=i}for(var s=0;e>s;){r.setDate(r.getDate()+1);var f=r.getDay();if(f!==n[0]&&f!==n[1]){for(var l=0;l<t.length;l++){var m=t[l];if(m.getDate()===r.getDate()&&m.getMonth()===r.getMonth()&&m.getFullYear()===r.getFullYear()){s--;break}}s++}}return r},e.YEAR=function(r){return r=o.parseDate(r),r instanceof Error?r:r.getFullYear()},e.YEARFRAC=function(r,e,n){if(r=o.parseDate(r),r instanceof Error)return r;if(e=o.parseDate(e),e instanceof Error)return e;n=n||0;var i=r.getDate(),a=r.getMonth()+1,s=r.getFullYear(),f=e.getDate(),l=e.getMonth()+1,c=e.getFullYear();switch(n){case 0:return 31===i&&31===f?(i=30,f=30):31===i?i=30:30===i&&31===f&&(f=30),(f+30*l+360*c-(i+30*a+360*s))/360;case 1:var m=function(r,e){var n=r.getFullYear(),u=new Date(n,2,1);if(t(n)&&u>r&&e>=u)return!0;var i=e.getFullYear(),a=new Date(i,2,1);return t(i)&&e>=a&&a>r},p=365;if(s===c||s+1===c&&(a>l||a===l&&i>=f))return(s===c&&t(s)||m(r,e)||1===l&&29===f)&&(p=366),u(r,e)/p;var h=c-s+1,g=(new Date(c+1,0,1)-new Date(s,0,1))/1e3/60/60/24,v=g/h;return u(r,e)/v;case 2:return u(r,e)/360;case 3:return u(r,e)/365;case 4:return(f+30*l+360*c-(i+30*a+360*s))/360}}},function(r,e,n){function t(r){return r&&r.getTime&&!isNaN(r.getTime())}function u(r){return r instanceof Date?r:new Date(r)}var i=n(13),a=n(7),o=n(14);e.ACCRINT=function(r,e,n,i,o,s,f){return r=u(r),e=u(e),n=u(n),t(r)&&t(e)&&t(n)?0>=i||0>=o?"#NUM!":-1===[1,2,4].indexOf(s)?"#NUM!":-1===[0,1,2,3,4].indexOf(f)?"#NUM!":r>=n?"#NUM!":(o=o||0,f=f||0,o*i*a.YEARFRAC(r,n,f)):"#VALUE!"},e.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},e.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},e.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},e.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},e.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},e.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},e.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},e.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},e.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},e.CUMIPMT=function(r,n,t,u,a,s){if(r=o.parseNumber(r),n=o.parseNumber(n),t=o.parseNumber(t),o.anyIsError(r,n,t))return i.value;if(0>=r||0>=n||0>=t)return i.num;if(1>u||1>a||u>a)return i.num;if(0!==s&&1!==s)return i.num;var f=e.PMT(r,n,t,0,s),l=0;1===u&&0===s&&(l=-t,u++);for(var c=u;a>=c;c++)l+=1===s?e.FV(r,c-2,f,t,1)-f:e.FV(r,c-1,f,t,0);return l*=r},e.CUMPRINC=function(r,n,t,u,a,s){if(r=o.parseNumber(r),n=o.parseNumber(n),t=o.parseNumber(t),o.anyIsError(r,n,t))return i.value;if(0>=r||0>=n||0>=t)return i.num;if(1>u||1>a||u>a)return i.num;if(0!==s&&1!==s)return i.num;var f=e.PMT(r,n,t,0,s),l=0;1===u&&(l=0===s?f+t*r:f,u++);for(var c=u;a>=c;c++)l+=s>0?f-(e.FV(r,c-2,f,t,1)-f)*r:f-e.FV(r,c-1,f,t,0)*r;return l},e.DB=function(r,e,n,t,u){if(u=void 0===u?12:u,r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),u=o.parseNumber(u),o.anyIsError(r,e,n,t,u))return i.value;if(0>r||0>e||0>n||0>t)return i.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(u))return i.num;if(t>n)return i.num;if(e>=r)return 0;for(var a=(1-Math.pow(e/r,1/n)).toFixed(3),s=r*a*u/12,f=s,l=0,c=t===n?n-1:t,m=2;c>=m;m++)l=(r-f)*a,f+=l;return 1===t?s:t===n?(r-f)*a:l},e.DDB=function(r,e,n,t,u){if(u=void 0===u?2:u,r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),u=o.parseNumber(u),o.anyIsError(r,e,n,t,u))return i.value;if(0>r||0>e||0>n||0>t||0>=u)return i.num;if(t>n)return i.num;if(e>=r)return 0;for(var a=0,s=0,f=1;t>=f;f++)s=Math.min((r-a)*(u/n),r-e-a),a+=s;return s},e.DISC=function(){throw new Error("DISC is not implemented")},e.DOLLARDE=function(r,e){if(r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e))return i.value;if(0>e)return i.num;if(e>=0&&1>e)return i.div0;e=parseInt(e,10);var n=parseInt(r,10);n+=r%1*Math.pow(10,Math.ceil(Math.log(e)/Math.LN10))/e;var t=Math.pow(10,Math.ceil(Math.log(e)/Math.LN2)+1);return n=Math.round(n*t)/t},e.DOLLARFR=function(r,e){if(r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e))return i.value;if(0>e)return i.num;if(e>=0&&1>e)return i.div0;e=parseInt(e,10);var n=parseInt(r,10);return n+=r%1*Math.pow(10,-Math.ceil(Math.log(e)/Math.LN10))*e},e.DURATION=function(){throw new Error("DURATION is not implemented")},e.EFFECT=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?i.value:0>=r||1>e?i.num:(e=parseInt(e,10),Math.pow(1+r/e,e)-1)},e.FV=function(r,e,n,t,u){if(t=t||0,u=u||0,r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),u=o.parseNumber(u),o.anyIsError(r,e,n,t,u))return i.value;var a;if(0===r)a=t+n*e;else{var s=Math.pow(1+r,e);a=1===u?t*s+n*(1+r)*(s-1)/r:t*s+n*(s-1)/r}return-a},e.FVSCHEDULE=function(r,e){if(r=o.parseNumber(r),e=o.parseNumberArray(o.flatten(e)),o.anyIsError(r,e))return i.value;for(var n=e.length,t=r,u=0;n>u;u++)t*=1+e[u];return t},e.INTRATE=function(){throw new Error("INTRATE is not implemented")},e.IPMT=function(r,n,t,u,a,s){if(a=a||0,s=s||0,r=o.parseNumber(r),n=o.parseNumber(n),t=o.parseNumber(t),u=o.parseNumber(u),a=o.parseNumber(a),s=o.parseNumber(s),o.anyIsError(r,n,t,u,a,s))return i.value;var f,l=e.PMT(r,t,u,a,s);return f=1===n?1===s?0:-u:1===s?e.FV(r,n-2,l,u,1)-l:e.FV(r,n-1,l,u,0),f*r},e.IRR=function(r,e){if(e=e||0,r=o.parseNumberArray(o.flatten(r)),e=o.parseNumber(e),o.anyIsError(r,e))return i.value;for(var n=function(r,e,n){for(var t=n+1,u=r[0],i=1;i<r.length;i++)u+=r[i]/Math.pow(t,(e[i]-e[0])/365);return u},t=function(r,e,n){for(var t=n+1,u=0,i=1;i<r.length;i++){var a=(e[i]-e[0])/365;u-=a*r[i]/Math.pow(t,a+1)}return u},u=[],a=!1,s=!1,f=0;f<r.length;f++)u[f]=0===f?0:u[f-1]+365,r[f]>0&&(a=!0),r[f]<0&&(s=!0);if(!a||!s)return i.num;e=void 0===e?.1:e;var l,c,m,p=e,h=1e-10,g=!0;do m=n(r,u,p),l=p-m/t(r,u,p),c=Math.abs(l-p),p=l,g=c>h&&Math.abs(m)>h;while(g);return p},e.ISPMT=function(r,e,n,t){return r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),o.anyIsError(r,e,n,t)?i.value:t*r*(e/n-1)},e.MDURATION=function(){throw new Error("MDURATION is not implemented")},e.MIRR=function(r,n,t){if(r=o.parseNumberArray(o.flatten(r)),n=o.parseNumber(n),t=o.parseNumber(t),o.anyIsError(r,n,t))return i.value;for(var u=r.length,a=[],s=[],f=0;u>f;f++)r[f]<0?a.push(r[f]):s.push(r[f]);var l=-e.NPV(t,s)*Math.pow(1+t,u-1),c=e.NPV(n,a)*(1+n);return Math.pow(l/c,1/(u-1))-1},e.NOMINAL=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?i.value:0>=r||1>e?i.num:(e=parseInt(e,10),(Math.pow(r+1,1/e)-1)*e)},e.NPER=function(r,e,n,t,u){if(u=void 0===u?0:u,t=void 0===t?0:t,r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),u=o.parseNumber(u),o.anyIsError(r,e,n,t,u))return i.value;var a=e*(1+r*u)-t*r,s=n*r+e*(1+r*u);return Math.log(a/s)/Math.log(1+r)},e.NPV=function(){var r=o.parseNumberArray(o.flatten(arguments));if(r instanceof Error)return r;for(var e=r[0],n=0,t=1;t<r.length;t++)n+=r[t]/Math.pow(1+e,t);return n},e.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},e.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},e.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},e.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},e.PDURATION=function(r,e,n){return r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),o.anyIsError(r,e,n)?i.value:0>=r?i.num:(Math.log(n)-Math.log(e))/Math.log(1+r)},e.PMT=function(r,e,n,t,u){if(t=t||0,u=u||0,r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),u=o.parseNumber(u),o.anyIsError(r,e,n,t,u))return i.value;var a;if(0===r)a=(n+t)/e;else{var s=Math.pow(1+r,e);a=1===u?(t*r/(s-1)+n*r/(1-1/s))/(1+r):t*r/(s-1)+n*r/(1-1/s)}return-a},e.PPMT=function(r,n,t,u,a,s){return a=a||0,s=s||0,r=o.parseNumber(r),t=o.parseNumber(t),u=o.parseNumber(u),a=o.parseNumber(a),s=o.parseNumber(s),o.anyIsError(r,t,u,a,s)?i.value:e.PMT(r,t,u,a,s)-e.IPMT(r,n,t,u,a,s)},e.PRICE=function(){throw new Error("PRICE is not implemented")},e.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")},e.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},e.PV=function(r,e,n,t,u){return t=t||0,u=u||0,r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),u=o.parseNumber(u),o.anyIsError(r,e,n,t,u)?i.value:0===r?-n*e-t:((1-Math.pow(1+r,e))/r*n*(1+r*u)-t)/Math.pow(1+r,e)},e.RATE=function(r,e,n,t,u,a){if(a=void 0===a?.01:a,t=void 0===t?0:t,u=void 0===u?0:u,r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),u=o.parseNumber(u),a=o.parseNumber(a),o.anyIsError(r,e,n,t,u,a))return i.value;var s,f,l,c,m=1e-10,p=50,h=0,g=0,v=0,d=a;for(Math.abs(d)<m?s=n*(1+r*d)+e*(1+d*u)*r+t:(g=Math.exp(r*Math.log(1+d)),s=n*g+e*(1/d+u)*(g-1)+t),f=n+e*r+t,l=n*g+e*(1/d+u)*(g-1)+t,v=c=0,h=d;Math.abs(f-l)>m&&p>v;)d=(l*c-f*h)/(l-f),c=h,h=d,Math.abs(d)<m?s=n*(1+r*d)+e*(1+d*u)*r+t:(g=Math.exp(r*Math.log(1+d)),s=n*g+e*(1/d+u)*(g-1)+t),f=l,l=s,++v;return d},e.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},e.RRI=function(r,e,n){return r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),o.anyIsError(r,e,n)?i.value:0===r||0===e?i.num:Math.pow(n/e,1/r)-1},e.SLN=function(r,e,n){return r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),o.anyIsError(r,e,n)?i.value:0===n?i.num:(r-e)/n},e.SYD=function(r,e,n,t){return r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),o.anyIsError(r,e,n,t)?i.value:0===n?i.num:1>t||t>n?i.num:(t=parseInt(t,10),(r-e)*(n-t+1)*2/(n*(n+1)))},e.TBILLEQ=function(r,e,n){return r=o.parseDate(r),e=o.parseDate(e),n=o.parseNumber(n),o.anyIsError(r,e,n)?i.value:0>=n?i.num:r>e?i.num:e-r>31536e6?i.num:365*n/(360-n*a.DAYS360(r,e,!1))},e.TBILLPRICE=function(r,e,n){return r=o.parseDate(r),e=o.parseDate(e),n=o.parseNumber(n),o.anyIsError(r,e,n)?i.value:0>=n?i.num:r>e?i.num:e-r>31536e6?i.num:100*(1-n*a.DAYS360(r,e,!1)/360)},e.TBILLYIELD=function(r,e,n){return r=o.parseDate(r),e=o.parseDate(e),n=o.parseNumber(n),o.anyIsError(r,e,n)?i.value:0>=n?i.num:r>e?i.num:e-r>31536e6?i.num:360*(100-n)/(n*a.DAYS360(r,e,!1))},e.VDB=function(){throw new Error("VDB is not implemented")},e.XIRR=function(r,e,n){if(r=o.parseNumberArray(o.flatten(r)),e=o.parseDateArray(o.flatten(e)),n=o.parseNumber(n),o.anyIsError(r,e,n))return i.value;for(var t=function(r,e,n){for(var t=n+1,u=r[0],i=1;i<r.length;i++)u+=r[i]/Math.pow(t,a.DAYS(e[i],e[0])/365);return u},u=function(r,e,n){for(var t=n+1,u=0,i=1;i<r.length;i++){var o=a.DAYS(e[i],e[0])/365;u-=o*r[i]/Math.pow(t,o+1)}return u},s=!1,f=!1,l=0;l<r.length;l++)r[l]>0&&(s=!0),r[l]<0&&(f=!0);if(!s||!f)return i.num;n=n||.1;var c,m,p,h=n,g=1e-10,v=!0;do p=t(r,e,h),c=h-p/u(r,e,h),m=Math.abs(c-h),h=c,v=m>g&&Math.abs(p)>g;while(v);return h},e.XNPV=function(r,e,n){if(r=o.parseNumber(r),e=o.parseNumberArray(o.flatten(e)),n=o.parseDateArray(o.flatten(n)),o.anyIsError(r,e,n))return i.value;
for(var t=0,u=0;u<e.length;u++)t+=e[u]/Math.pow(1+r,a.DAYS(n[u],n[0])/365);return t},e.YIELD=function(){throw new Error("YIELD is not implemented")},e.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},e.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}},function(r,e,n){var t=n(13);e.CELL=function(){throw new Error("CELL is not implemented")},e.ERROR={},e.ERROR.TYPE=function(r){switch(r){case t.nil:return 1;case t.div0:return 2;case t.value:return 3;case t.ref:return 4;case t.name:return 5;case t.num:return 6;case t.na:return 7;case t.data:return 8}return t.na},e.INFO=function(){throw new Error("INFO is not implemented")},e.ISBLANK=function(r){return null===r},e.ISBINARY=function(r){return/^[01]{1,10}$/.test(r)},e.ISERR=function(r){return[t.value,t.ref,t.div0,t.num,t.name,t.nil].indexOf(r)>=0||"number"==typeof r&&(isNaN(r)||!isFinite(r))},e.ISERROR=function(r){return e.ISERR(r)||r===t.na},e.ISEVEN=function(r){return 1&Math.floor(Math.abs(r))?!1:!0},e.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},e.ISLOGICAL=function(r){return r===!0||r===!1},e.ISNA=function(r){return r===t.na},e.ISNONTEXT=function(r){return"string"!=typeof r},e.ISNUMBER=function(r){return"number"==typeof r&&!isNaN(r)&&isFinite(r)},e.ISODD=function(r){return 1&Math.floor(Math.abs(r))?!0:!1},e.ISREF=function(){throw new Error("ISREF is not implemented")},e.ISTEXT=function(r){return"string"==typeof r},e.N=function(r){return this.ISNUMBER(r)?r:r instanceof Date?r.getTime():r===!0?1:r===!1?0:this.ISERROR(r)?r:0},e.NA=function(){return t.na},e.SHEET=function(){throw new Error("SHEET is not implemented")},e.SHEETS=function(){throw new Error("SHEETS is not implemented")},e.TYPE=function(r){return this.ISNUMBER(r)?1:this.ISTEXT(r)?2:this.ISLOGICAL(r)?4:this.ISERROR(r)?16:Array.isArray(r)?64:void 0}},function(r,e,n){var t=n(13);e.MATCH=function(r,e,n){if(!r&&!e)return t.na;if(2===arguments.length&&(n=1),!(e instanceof Array))return t.na;if(-1!==n&&0!==n&&1!==n)return t.na;for(var u,i,a=0;a<e.length;a++)if(1===n){if(e[a]===r)return a+1;e[a]<r&&(i?e[a]>i&&(u=a+1,i=e[a]):(u=a+1,i=e[a]))}else if(0===n){if("string"==typeof r){if(r=r.replace(/\?/g,"."),e[a].toLowerCase().match(r.toLowerCase()))return a+1}else if(e[a]===r)return a+1}else if(-1===n){if(e[a]===r)return a+1;e[a]>r&&(i?e[a]<i&&(u=a+1,i=e[a]):(u=a+1,i=e[a]))}return u?u:t.na}},function(module,exports,__webpack_require__){var mathTrig=__webpack_require__(5),text=__webpack_require__(6),jStat=__webpack_require__(18).jStat,utils=__webpack_require__(14),error=__webpack_require__(13),misc=__webpack_require__(12),SQRT2PI=2.5066282746310002;exports.AVEDEV=function(){var r=utils.parseNumberArray(utils.flatten(arguments));return r instanceof Error?r:jStat.sum(jStat(r).subtract(jStat.mean(r)).abs()[0])/r.length},exports.AVERAGE=function(){for(var r=utils.numbers(utils.flatten(arguments)),e=r.length,n=0,t=0,u=0;e>u;u++)n+=r[u],t+=1;return n/t},exports.AVERAGEA=function(){for(var r=utils.flatten(arguments),e=r.length,n=0,t=0,u=0;e>u;u++){var i=r[u];"number"==typeof i&&(n+=i),i===!0&&n++,null!==i&&t++}return n/t},exports.AVERAGEIF=function(range,criteria,average_range){if(average_range=average_range||range,range=utils.flatten(range),average_range=utils.parseNumberArray(utils.flatten(average_range)),average_range instanceof Error)return average_range;for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},exports.AVERAGEIFS=function(){for(var args=utils.argsToArray(arguments),criteria=(args.length-1)/2,range=utils.flatten(args[0]),count=0,result=0,i=0;i<range.length;i++){for(var condition="",j=0;criteria>j;j++)condition+=args[2*j+1][i]+args[2*j+2],j!==criteria-1&&(condition+="&&");eval(condition)&&(result+=range[i],count++)}var average=result/count;return isNaN(average)?0:average},exports.BETA={},exports.BETA.DIST=function(r,e,n,t,u,i){return u=void 0===u?0:u,i=void 0===i?1:i,r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),u=utils.parseNumber(u),i=utils.parseNumber(i),utils.anyIsError(r,e,n,u,i)?error.value:(r=(r-u)/(i-u),t?jStat.beta.cdf(r,e,n):jStat.beta.pdf(r,e,n))},exports.BETA.INV=function(r,e,n,t,u){return t=void 0===t?0:t,u=void 0===u?1:u,r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),t=utils.parseNumber(t),u=utils.parseNumber(u),utils.anyIsError(r,e,n,t,u)?error.value:jStat.beta.inv(r,e,n)*(u-t)+t},exports.BINOM={},exports.BINOM.DIST=function(r,e,n,t){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(r,e,n,t)?error.value:t?jStat.binomial.cdf(r,e,n):jStat.binomial.pdf(r,e,n)},exports.BINOM.DIST.RANGE=function(r,e,n,t){if(t=void 0===t?n:t,r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(r,e,n,t))return error.value;for(var u=0,i=n;t>=i;i++)u+=mathTrig.COMBIN(r,i)*Math.pow(e,i)*Math.pow(1-e,r-i);return u},exports.BINOM.INV=function(r,e,n){if(r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n))return error.value;for(var t=0;r>=t;){if(jStat.binomial.cdf(t,r,e)>=n)return t;t++}},exports.CHISQ={},exports.CHISQ.DIST=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:n?jStat.chisquare.cdf(r,e):jStat.chisquare.pdf(r,e)},exports.CHISQ.DIST.RT=function(r,e){return!r|!e?error.na:1>r||e>Math.pow(10,10)?error.num:"number"!=typeof r||"number"!=typeof e?error.value:1-jStat.chisquare.cdf(r,e)},exports.CHISQ.INV=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:jStat.chisquare.inv(r,e)},exports.CHISQ.INV.RT=function(r,e){return!r|!e?error.na:0>r||r>1||1>e||e>Math.pow(10,10)?error.num:"number"!=typeof r||"number"!=typeof e?error.value:jStat.chisquare.inv(1-r,e)},exports.CHISQ.TEST=function(r,e){function n(r,e){var n=Math.exp(-.5*r);e%2===1&&(n*=Math.sqrt(2*r/l));for(var t=e;t>=2;)n=n*r/t,t-=2;for(var u=n,i=e;u>1e-10*n;)i+=2,u=u*r/i,n+=u;return 1-n}if(2!==arguments.length)return error.na;if(!(r instanceof Array&&e instanceof Array))return error.value;if(r.length!==e.length)return error.value;if(r[0]&&e[0]&&r[0].length!==e[0].length)return error.value;var t,u,i,a=r.length;for(u=0;a>u;u++)r[u]instanceof Array||(t=r[u],r[u]=[],r[u].push(t)),e[u]instanceof Array||(t=e[u],e[u]=[],e[u].push(t));var o=r[0].length,s=1===o?a-1:(a-1)*(o-1),f=0,l=Math.PI;for(u=0;a>u;u++)for(i=0;o>i;i++)f+=Math.pow(r[u][i]-e[u][i],2)/e[u][i];return Math.round(1e6*n(f,s))/1e6},exports.COLUMN=function(r,e){return 2!==arguments.length?error.na:0>e?error.num:r instanceof Array&&"number"==typeof e?0===r.length?void 0:jStat.col(r,e):error.value},exports.COLUMNS=function(r){return 1!==arguments.length?error.na:r instanceof Array?0===r.length?0:jStat.cols(r):error.value},exports.CONFIDENCE={},exports.CONFIDENCE.NORM=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:jStat.normalci(1,r,e,n)[1]-1},exports.CONFIDENCE.T=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:jStat.tci(1,r,e,n)[1]-1},exports.CORREL=function(r,e){return r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e)?error.value:jStat.corrcoeff(r,e)},exports.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length},exports.COUNTA=function(){var r=utils.flatten(arguments);return r.length-exports.COUNTBLANK(r)},exports.COUNTIN=function(r,e){for(var n=0,t=0;t<r.length;t++)r[t]===e&&n++;return n},exports.COUNTBLANK=function(){for(var r,e=utils.flatten(arguments),n=0,t=0;t<e.length;t++)r=e[t],(null===r||""===r)&&n++;return n},exports.COUNTIF=function(range,criteria){range=utils.flatten(range),/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var matches=0,i=0;i<range.length;i++)"string"!=typeof range[i]?eval(range[i]+criteria)&&matches++:eval('"'+range[i]+'"'+criteria)&&matches++;return matches},exports.COUNTIFS=function(){for(var args=utils.argsToArray(arguments),results=new Array(utils.flatten(args[0]).length),i=0;i<results.length;i++)results[i]=!0;for(i=0;i<args.length;i+=2){var range=utils.flatten(args[i]),criteria=args[i+1];/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var j=0;j<range.length;j++)results[j]="string"!=typeof range[j]?results[j]&&eval(range[j]+criteria):results[j]&&eval('"'+range[j]+'"'+criteria)}var result=0;for(i=0;i<results.length;i++)results[i]&&result++;return result},exports.COUNTUNIQUE=function(){return misc.UNIQUE.apply(null,utils.flatten(arguments)).length},exports.COVARIANCE={},exports.COVARIANCE.P=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;for(var n=jStat.mean(r),t=jStat.mean(e),u=0,i=r.length,a=0;i>a;a++)u+=(r[a]-n)*(e[a]-t);return u/i},exports.COVARIANCE.S=function(r,e){return r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e)?error.value:jStat.covariance(r,e)},exports.DEVSQ=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=jStat.mean(r),n=0,t=0;t<r.length;t++)n+=Math.pow(r[t]-e,2);return n},exports.EXPON={},exports.EXPON.DIST=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:n?jStat.exponential.cdf(r,e):jStat.exponential.pdf(r,e)},exports.F={},exports.F.DIST=function(r,e,n,t){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:t?jStat.centralF.cdf(r,e,n):jStat.centralF.pdf(r,e,n)},exports.F.DIST.RT=function(r,e,n){return 3!==arguments.length?error.na:0>r||1>e||1>n?error.num:"number"!=typeof r||"number"!=typeof e||"number"!=typeof n?error.value:1-jStat.centralF.cdf(r,e,n)},exports.F.INV=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:0>=r||r>1?error.num:jStat.centralF.inv(r,e,n)},exports.F.INV.RT=function(r,e,n){return 3!==arguments.length?error.na:0>r||r>1||1>e||e>Math.pow(10,10)||1>n||n>Math.pow(10,10)?error.num:"number"!=typeof r||"number"!=typeof e||"number"!=typeof n?error.value:jStat.centralF.inv(1-r,e,n)},exports.F.TEST=function(r,e){if(!r||!e)return error.na;if(!(r instanceof Array&&e instanceof Array))return error.na;if(r.length<2||e.length<2)return error.div0;var n=function(r,e){for(var n=0,t=0;t<r.length;t++)n+=Math.pow(r[t]-e,2);return n},t=mathTrig.SUM(r)/r.length,u=mathTrig.SUM(e)/e.length,i=n(r,t)/(r.length-1),a=n(e,u)/(e.length-1);return i/a},exports.FISHER=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.log((1+r)/(1-r))/2},exports.FISHERINV=function(r){if(r=utils.parseNumber(r),r instanceof Error)return r;var e=Math.exp(2*r);return(e-1)/(e+1)},exports.FORECAST=function(r,e,n){if(r=utils.parseNumber(r),e=utils.parseNumberArray(utils.flatten(e)),n=utils.parseNumberArray(utils.flatten(n)),utils.anyIsError(r,e,n))return error.value;for(var t=jStat.mean(n),u=jStat.mean(e),i=n.length,a=0,o=0,s=0;i>s;s++)a+=(n[s]-t)*(e[s]-u),o+=Math.pow(n[s]-t,2);var f=a/o,l=u-f*t;return l+f*r},exports.FREQUENCY=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;for(var n=r.length,t=e.length,u=[],i=0;t>=i;i++){u[i]=0;for(var a=0;n>a;a++)0===i?r[a]<=e[0]&&(u[0]+=1):t>i?r[a]>e[i-1]&&r[a]<=e[i]&&(u[i]+=1):i===t&&r[a]>e[t-1]&&(u[t]+=1)}return u},exports.GAMMA=function(r){return r=utils.parseNumber(r),r instanceof Error?r:0===r?error.num:parseInt(r,10)===r&&0>r?error.num:jStat.gammafn(r)},exports.GAMMA.DIST=function(r,e,n,t){return 4!==arguments.length?error.na:0>r||0>=e||0>=n?error.value:"number"!=typeof r||"number"!=typeof e||"number"!=typeof n?error.value:t?jStat.gamma.cdf(r,e,n,!0):jStat.gamma.pdf(r,e,n,!1)},exports.GAMMA.INV=function(r,e,n){return 3!==arguments.length?error.na:0>r||r>1||0>=e||0>=n?error.num:"number"!=typeof r||"number"!=typeof e||"number"!=typeof n?error.value:jStat.gamma.inv(r,e,n)},exports.GAMMALN=function(r){return r=utils.parseNumber(r),r instanceof Error?r:jStat.gammaln(r)},exports.GAMMALN.PRECISE=function(r){return 1!==arguments.length?error.na:0>=r?error.num:"number"!=typeof r?error.value:jStat.gammaln(r)},exports.GAUSS=function(r){return r=utils.parseNumber(r),r instanceof Error?r:jStat.normal.cdf(r,0,1)-.5},exports.GEOMEAN=function(){var r=utils.parseNumberArray(utils.flatten(arguments));return r instanceof Error?r:jStat.geomean(r)},exports.GROWTH=function(r,e,n,t){if(r=utils.parseNumberArray(r),r instanceof Error)return r;var u;if(void 0===e)for(e=[],u=1;u<=r.length;u++)e.push(u);if(void 0===n)for(n=[],u=1;u<=r.length;u++)n.push(u);if(e=utils.parseNumberArray(e),n=utils.parseNumberArray(n),utils.anyIsError(e,n))return error.value;void 0===t&&(t=!0);var i=r.length,a=0,o=0,s=0,f=0;for(u=0;i>u;u++){var l=e[u],c=Math.log(r[u]);a+=l,o+=c,s+=l*c,f+=l*l}a/=i,o/=i,s/=i,f/=i;var m,p;t?(m=(s-a*o)/(f-a*a),p=o-m*a):(m=s/f,p=0);var h=[];for(u=0;u<n.length;u++)h.push(Math.exp(p+m*n[u]));return h},exports.HARMEAN=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=r.length,n=0,t=0;e>t;t++)n+=1/r[t];return e/n},exports.HYPGEOM={},exports.HYPGEOM.DIST=function(r,e,n,t,u){function i(r,e,n,t){return mathTrig.COMBIN(n,r)*mathTrig.COMBIN(t-n,e-r)/mathTrig.COMBIN(t,e)}function a(r,e,n,t){for(var u=0,a=0;r>=a;a++)u+=i(a,e,n,t);return u}return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(r,e,n,t)?error.value:u?a(r,e,n,t):i(r,e,n,t)},exports.INTERCEPT=function(r,e){return r=utils.parseNumberArray(r),e=utils.parseNumberArray(e),utils.anyIsError(r,e)?error.value:r.length!==e.length?error.na:exports.FORECAST(0,r,e)},exports.KURT=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=jStat.mean(r),n=r.length,t=0,u=0;n>u;u++)t+=Math.pow(r[u]-e,4);return t/=Math.pow(jStat.stdev(r,!0),4),n*(n+1)/((n-1)*(n-2)*(n-3))*t-3*(n-1)*(n-1)/((n-2)*(n-3))},exports.LARGE=function(r,e){return r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),utils.anyIsError(r,e)?r:r.sort(function(r,e){return e-r})[e-1]},exports.LINEST=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;for(var n=jStat.mean(r),t=jStat.mean(e),u=e.length,i=0,a=0,o=0;u>o;o++)i+=(e[o]-t)*(r[o]-n),a+=Math.pow(e[o]-t,2);var s=i/a,f=n-s*t;return[s,f]},exports.LOGEST=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;for(var n=0;n<r.length;n++)r[n]=Math.log(r[n]);var t=exports.LINEST(r,e);return t[0]=Math.round(1e6*Math.exp(t[0]))/1e6,t[1]=Math.round(1e6*Math.exp(t[1]))/1e6,t},exports.LOGNORM={},exports.LOGNORM.DIST=function(r,e,n,t){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:t?jStat.lognormal.cdf(r,e,n):jStat.lognormal.pdf(r,e,n)},exports.LOGNORM.INV=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:jStat.lognormal.inv(r,e,n)},exports.MAX=function(){var r=utils.numbers(utils.flatten(arguments));return 0===r.length?0:Math.max.apply(Math,r)},exports.MAXA=function(){var r=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===r.length?0:Math.max.apply(Math,r)},exports.MEDIAN=function(){var r=utils.arrayValuesToNumbers(utils.flatten(arguments));return jStat.median(r)},exports.MIN=function(){var r=utils.numbers(utils.flatten(arguments));return 0===r.length?0:Math.min.apply(Math,r)},exports.MINA=function(){var r=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===r.length?0:Math.min.apply(Math,r)},exports.MODE={},exports.MODE.MULT=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e,n=r.length,t={},u=[],i=0,a=0;n>a;a++)e=r[a],t[e]=t[e]?t[e]+1:1,t[e]>i&&(i=t[e],u=[]),t[e]===i&&(u[u.length]=e);return u},exports.MODE.SNGL=function(){var r=utils.parseNumberArray(utils.flatten(arguments));return r instanceof Error?r:exports.MODE.MULT(r).sort(function(r,e){return r-e})[0]},exports.NEGBINOM={},exports.NEGBINOM.DIST=function(r,e,n,t){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:t?jStat.negbin.cdf(r,e,n):jStat.negbin.pdf(r,e,n)},exports.NORM={},exports.NORM.DIST=function(r,e,n,t){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:0>=n?error.num:t?jStat.normal.cdf(r,e,n):jStat.normal.pdf(r,e,n)},exports.NORM.INV=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:jStat.normal.inv(r,e,n)},exports.NORM.S={},exports.NORM.S.DIST=function(r,e){return r=utils.parseNumber(r),r instanceof Error?error.value:e?jStat.normal.cdf(r,0,1):jStat.normal.pdf(r,0,1)},exports.NORM.S.INV=function(r){return r=utils.parseNumber(r),r instanceof Error?error.value:jStat.normal.inv(r,0,1)},exports.PEARSON=function(r,e){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(e,r))return error.value;for(var n=jStat.mean(r),t=jStat.mean(e),u=r.length,i=0,a=0,o=0,s=0;u>s;s++)i+=(r[s]-n)*(e[s]-t),a+=Math.pow(r[s]-n,2),o+=Math.pow(e[s]-t,2);return i/Math.sqrt(a*o)},exports.PERCENTILE={},exports.PERCENTILE.EXC=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;r=r.sort(function(r,e){return r-e});var n=r.length;if(1/(n+1)>e||e>1-1/(n+1))return error.num;var t=e*(n+1)-1,u=Math.floor(t);return utils.cleanFloat(t===u?r[t]:r[u]+(t-u)*(r[u+1]-r[u]))},exports.PERCENTILE.INC=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;r=r.sort(function(r,e){return r-e});var n=r.length,t=e*(n-1),u=Math.floor(t);return utils.cleanFloat(t===u?r[t]:r[u]+(t-u)*(r[u+1]-r[u]))},exports.PERCENTRANK={},exports.PERCENTRANK.EXC=function(r,e,n){if(n=void 0===n?3:n,r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n))return error.value;r=r.sort(function(r,e){return r-e});for(var t=misc.UNIQUE.apply(null,r),u=r.length,i=t.length,a=Math.pow(10,n),o=0,s=!1,f=0;!s&&i>f;)e===t[f]?(o=(r.indexOf(t[f])+1)/(u+1),s=!0):e>=t[f]&&(e<t[f+1]||f===i-1)&&(o=(r.indexOf(t[f])+1+(e-t[f])/(t[f+1]-t[f]))/(u+1),s=!0),f++;return Math.floor(o*a)/a},exports.PERCENTRANK.INC=function(r,e,n){if(n=void 0===n?3:n,r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n))return error.value;r=r.sort(function(r,e){return r-e});for(var t=misc.UNIQUE.apply(null,r),u=r.length,i=t.length,a=Math.pow(10,n),o=0,s=!1,f=0;!s&&i>f;)e===t[f]?(o=r.indexOf(t[f])/(u-1),s=!0):e>=t[f]&&(e<t[f+1]||f===i-1)&&(o=(r.indexOf(t[f])+(e-t[f])/(t[f+1]-t[f]))/(u-1),s=!0),f++;return Math.floor(o*a)/a},exports.PERMUT=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:mathTrig.FACT(r)/mathTrig.FACT(r-e)},exports.PERMUTATIONA=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:Math.pow(r,e)},exports.PHI=function(r){return r=utils.parseNumber(r),r instanceof Error?error.value:Math.exp(-.5*r*r)/SQRT2PI},exports.POISSON={},exports.POISSON.DIST=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:n?jStat.poisson.cdf(r,e):jStat.poisson.pdf(r,e)},exports.PROB=function(r,e,n,t){if(void 0===n)return 0;if(t=void 0===t?n:t,r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(r,e,n,t))return error.value;if(n===t)return r.indexOf(n)>=0?e[r.indexOf(n)]:0;for(var u=r.sort(function(r,e){return r-e}),i=u.length,a=0,o=0;i>o;o++)u[o]>=n&&u[o]<=t&&(a+=e[r.indexOf(u[o])]);return a},exports.QUARTILE={},exports.QUARTILE.EXC=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;switch(e){case 1:return exports.PERCENTILE.EXC(r,.25);case 2:return exports.PERCENTILE.EXC(r,.5);case 3:return exports.PERCENTILE.EXC(r,.75);default:return error.num}},exports.QUARTILE.INC=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;switch(e){case 1:return exports.PERCENTILE.INC(r,.25);case 2:return exports.PERCENTILE.INC(r,.5);case 3:return exports.PERCENTILE.INC(r,.75);default:return error.num}},exports.RANK={},exports.RANK.AVG=function(r,e,n){if(r=utils.parseNumber(r),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;e=utils.flatten(e),n=n||!1;var t=n?function(r,e){return r-e}:function(r,e){return e-r};e=e.sort(t);for(var u=e.length,i=0,a=0;u>a;a++)e[a]===r&&i++;return i>1?(2*e.indexOf(r)+i+1)/2:e.indexOf(r)+1},exports.RANK.EQ=function(r,e,n){if(r=utils.parseNumber(r),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;n=n||!1;var t=n?function(r,e){return r-e}:function(r,e){return e-r};return e=e.sort(t),e.indexOf(r)+1},exports.ROW=function(r,e){return 2!==arguments.length?error.na:0>e?error.num:r instanceof Array&&"number"==typeof e?0===r.length?void 0:jStat.row(r,e):error.value},exports.ROWS=function(r){return 1!==arguments.length?error.na:r instanceof Array?0===r.length?0:jStat.rows(r):error.value},exports.RSQ=function(r,e){return r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e)?error.value:Math.pow(exports.PEARSON(r,e),2)},exports.SKEW=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=jStat.mean(r),n=r.length,t=0,u=0;n>u;u++)t+=Math.pow(r[u]-e,3);return n*t/((n-1)*(n-2)*Math.pow(jStat.stdev(r,!0),3))},exports.SKEW.P=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=jStat.mean(r),n=r.length,t=0,u=0,i=0;n>i;i++)u+=Math.pow(r[i]-e,3),t+=Math.pow(r[i]-e,2);return u/=n,t/=n,u/Math.pow(t,1.5)},exports.SLOPE=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;for(var n=jStat.mean(e),t=jStat.mean(r),u=e.length,i=0,a=0,o=0;u>o;o++)i+=(e[o]-n)*(r[o]-t),a+=Math.pow(e[o]-n,2);return i/a},exports.SMALL=function(r,e){return r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),utils.anyIsError(r,e)?r:r.sort(function(r,e){return r-e})[e-1]},exports.STANDARDIZE=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:(r-e)/n},exports.STDEV={},exports.STDEV.P=function(){var r=exports.VAR.P.apply(this,arguments);return Math.sqrt(r)},exports.STDEV.S=function(){var r=exports.VAR.S.apply(this,arguments);return Math.sqrt(r)},exports.STDEVA=function(){var r=exports.VARA.apply(this,arguments);return Math.sqrt(r)},exports.STDEVPA=function(){var r=exports.VARPA.apply(this,arguments);return Math.sqrt(r)},exports.STEYX=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;for(var n=jStat.mean(e),t=jStat.mean(r),u=e.length,i=0,a=0,o=0,s=0;u>s;s++)i+=Math.pow(r[s]-t,2),a+=(e[s]-n)*(r[s]-t),o+=Math.pow(e[s]-n,2);return Math.sqrt((i-a*a/o)/(u-2))},exports.TRANSPOSE=function(r){return r?jStat.transpose(r):error.na},exports.T=text.T,exports.T.DIST=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:n?jStat.studentt.cdf(r,e):jStat.studentt.pdf(r,e)},exports.T.DIST["2T"]=function(r,e){return 2!==arguments.length?error.na:0>r||1>e?error.num:"number"!=typeof r||"number"!=typeof e?error.value:2*(1-jStat.studentt.cdf(r,e))},exports.T.DIST.RT=function(r,e){return 2!==arguments.length?error.na:0>r||1>e?error.num:"number"!=typeof r||"number"!=typeof e?error.value:1-jStat.studentt.cdf(r,e)},exports.T.INV=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:jStat.studentt.inv(r,e)},exports.T.INV["2T"]=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),0>=r||r>1||1>e?error.num:utils.anyIsError(r,e)?error.value:Math.abs(jStat.studentt.inv(r/2,e))},exports.T.TEST=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;var n,t=jStat.mean(r),u=jStat.mean(e),i=0,a=0;for(n=0;n<r.length;n++)i+=Math.pow(r[n]-t,2);for(n=0;n<e.length;n++)a+=Math.pow(e[n]-u,2);i/=r.length-1,a/=e.length-1;var o=Math.abs(t-u)/Math.sqrt(i/r.length+a/e.length);return exports.T.DIST["2T"](o,r.length+e.length-2)},exports.TREND=function(r,e,n){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),n=utils.parseNumberArray(utils.flatten(n)),utils.anyIsError(r,e,n))return error.value;var t=exports.LINEST(r,e),u=t[0],i=t[1],a=[];return n.forEach(function(r){a.push(u*r+i)}),a},exports.TRIMMEAN=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;var n=mathTrig.FLOOR(r.length*e,2)/2;return jStat.mean(utils.initial(utils.rest(r.sort(function(r,e){return r-e}),n),n))},exports.VAR={},exports.VAR.P=function(){for(var r=utils.numbers(utils.flatten(arguments)),e=r.length,n=0,t=exports.AVERAGE(r),u=0;e>u;u++)n+=Math.pow(r[u]-t,2);return n/e},exports.VAR.S=function(){for(var r=utils.numbers(utils.flatten(arguments)),e=r.length,n=0,t=exports.AVERAGE(r),u=0;e>u;u++)n+=Math.pow(r[u]-t,2);return n/(e-1)},exports.VARA=function(){for(var r=utils.flatten(arguments),e=r.length,n=0,t=0,u=exports.AVERAGEA(r),i=0;e>i;i++){var a=r[i];n+="number"==typeof a?Math.pow(a-u,2):a===!0?Math.pow(1-u,2):Math.pow(0-u,2),null!==a&&t++}return n/(t-1)},exports.VARPA=function(){for(var r=utils.flatten(arguments),e=r.length,n=0,t=0,u=exports.AVERAGEA(r),i=0;e>i;i++){var a=r[i];n+="number"==typeof a?Math.pow(a-u,2):a===!0?Math.pow(1-u,2):Math.pow(0-u,2),null!==a&&t++}return n/t},exports.WEIBULL={},exports.WEIBULL.DIST=function(r,e,n,t){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:t?1-Math.exp(-Math.pow(r/n,e)):Math.pow(r,e-1)*Math.exp(-Math.pow(r/n,e))*e/Math.pow(n,e)},exports.Z={},exports.Z.TEST=function(r,e,n){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;n=n||exports.STDEV.S(r);var t=r.length;return 1-exports.NORM.S.DIST((exports.AVERAGE(r)-e)/(n/Math.sqrt(t)),!0)}},function(r,e,n){var t=n(14),u=n(17);e.UNIQUE=function(){for(var r=[],e=0;e<arguments.length;++e){for(var n=!1,t=arguments[e],u=0;u<r.length&&!(n=r[u]===t);++u);n||r.push(t)}return r},e.FLATTEN=t.flatten,e.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},e.REFERENCE=function(r,e){try{for(var n=e.split("."),t=r,u=0;u<n.length;++u){var i=n[u];if("]"===i[i.length-1]){var a=i.indexOf("["),o=i.substring(a+1,i.length-1);t=t[i.substring(0,a)][o]}else t=t[i]}return t}catch(s){}},e.JOIN=function(r,e){return r.join(e)},e.NUMBERS=function(){var r=t.flatten(arguments);return r.filter(function(r){return"number"==typeof r})},e.NUMERAL=function(r,e){return u(r).format(e)}},function(r,e){e.nil=new Error("#NULL!"),e.div0=new Error("#DIV/0!"),e.value=new Error("#VALUE?"),e.ref=new Error("#REF!"),e.name=new Error("#NAME?"),e.num=new Error("#NUM!"),e.na=new Error("#N/A"),e.error=new Error("#ERROR!"),e.data=new Error("#GETTING_DATA")},function(r,e,n){function t(r){return r&&r.reduce?r.reduce(function(r,e){var n=Array.isArray(r),t=Array.isArray(e);return n&&t?r.concat(e):n?(r.push(e),r):t?[r].concat(e):[r,e]}):r}function u(r){if(!r)return!1;for(var e=0;e<r.length;++e)if(Array.isArray(r[e]))return!1;return!0}var i=n(13);e.flatten=function(){for(var r=e.argsToArray.apply(null,arguments);!u(r);)r=t(r);return r},e.argsToArray=function(r){return Array.prototype.slice.call(r,0)},e.numbers=function(){var r=this.flatten.apply(null,arguments);return r.filter(function(r){return"number"==typeof r})},e.cleanFloat=function(r){var e=1e14;return Math.round(r*e)/e},e.parseBool=function(r){if("boolean"==typeof r)return r;if(r instanceof Error)return r;if("number"==typeof r)return 0!==r;if("string"==typeof r){var e=r.toUpperCase();if("TRUE"===e)return!0;if("FALSE"===e)return!1}return r instanceof Date&&!isNaN(r)?!0:i.value},e.parseNumber=function(r){return void 0===r||""===r?i.value:isNaN(r)?i.value:parseFloat(r)},e.parseNumberArray=function(r){var n;if(!r||0===(n=r.length))return i.value;for(var t;n--;){if(t=e.parseNumber(r[n]),t===i.value)return t;r[n]=t}return r},e.parseMatrix=function(r){var n;if(!r||0===(n=r.length))return i.value;for(var t,u=0;u<r.length;u++)if(t=e.parseNumberArray(r[u]),r[u]=t,t instanceof Error)return t;return r};var a=new Date(1900,0,1);e.parseDate=function(r){if(!isNaN(r)){if(r instanceof Date)return new Date(r);var e=parseInt(r,10);return 0>e?i.num:new Date(60>=e?a.getTime()+864e5*(e-1):a.getTime()+864e5*(e-2))}return"string"!=typeof r||(r=new Date(r),isNaN(r))?i.value:r},e.parseDateArray=function(r){for(var e,n=r.length;n--;){if(e=this.parseDate(r[n]),e===i.value)return e;r[n]=e}return r},e.anyIsError=function(){for(var r=arguments.length;r--;)if(arguments[r]instanceof Error)return!0;return!1},e.arrayValuesToNumbers=function(r){for(var e,n=r.length;n--;)if(e=r[n],"number"!=typeof e)if(e!==!0)if(e!==!1){if("string"==typeof e){var t=this.parseNumber(e);r[n]=t instanceof Error?0:t}}else r[n]=0;else r[n]=1;return r},e.rest=function(r,e){return e=e||1,r&&"function"==typeof r.slice?r.slice(e):r},e.initial=function(r,e){return e=e||1,r&&"function"==typeof r.slice?r.slice(0,r.length-e):r}},function(r,e){function n(r,e){return r.reduce(function(r,n){return e*r+n},0)}function t(r,e,n,t,u){u||(u=-1);var i,a=2/r;if(0===e)return n;if(1===e)return t;for(var o=1;o!=e;++o)i=t*o*a+u*n,n=t,t=i;return t}function u(r,e,n,u,i){return function(a,o){if(0===o)return r(a);if(1===o)return e(a);if(0>o)throw n+": Order ("+o+") must be nonnegative";if(1==u&&0===a)throw n+": Undefined when x == 0";if(2==u&&0>=a)throw n+": Undefined when x <= 0";var s=r(a),f=e(a);return t(a,o,s,f,i)}}var i=Math,a=function(){function r(r){var e,t,l,c=r*r,m=i.abs(r)-.785398164;return i.abs(r)<8?(t=n(u,c),l=n(a,c),e=t/l):(c=64/c,t=n(o,c),l=n(s,c),e=i.sqrt(f/i.abs(r))*(i.cos(m)*t-i.sin(m)*l*8/i.abs(r))),e}function e(r){var e,t,u,a=r*r,o=i.abs(r)-2.356194491;return Math.abs(r)<8?(t=r*n(l,a),u=n(c,a),e=t/u):(a=64/a,t=n(m,a),u=n(p,a),e=i.sqrt(f/i.abs(r))*(i.cos(o)*t-i.sin(o)*u*8/i.abs(r)),0>r&&(e=-e)),e}var u=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),a=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),o=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),s=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),f=.636619772,l=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),c=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),m=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return function(n,u){if(u=Math.round(u),0===u)return r(i.abs(n));if(1===u)return e(i.abs(n));if(0>u)throw"BESSELJ: Order ("+u+") must be nonnegative";
if(0===i.abs(n))return 0;var a,o,s,f,l,c,m,p,h=2/i.abs(n);if(i.abs(n)>u)a=t(n,u,r(i.abs(n)),e(i.abs(n)),-1);else{for(s=2*i.floor((u+i.floor(i.sqrt(40*u)))/2),f=0,c=a=l=0,m=1,o=s;o>0;o--)p=o*h*m-c,c=m,m=p,i.abs(m)>1e10&&(m*=1e-10,c*=1e-10,a*=1e-10,l*=1e-10),f&&(l+=m),f=!f,o==u&&(a=c);l=2*l-m,a/=l}return 0>n&&u%2?-a:a}}(),o=function(){function r(r){var e,u,c,m=r*r,p=r-.785398164;return 8>r?(u=n(t,m),c=n(o,m),e=u/c+l*a(r,0)*i.log(r)):(m=64/m,u=n(s,m),c=n(f,m),e=i.sqrt(l/r)*(i.sin(p)*u+i.cos(p)*c*8/r)),e}function e(r){var e,t,u,o=r*r,s=r-2.356194491;return 8>r?(t=r*n(c,o),u=n(m,o),e=t/u+l*(a(r,1)*i.log(r)-1/r)):(o=64/o,t=n(p,o),u=n(h,o),e=i.sqrt(l/r)*(i.sin(s)*t+i.cos(s)*u*8/r)),e}var t=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),o=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),s=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),f=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),l=.636619772,c=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),m=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),p=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),h=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return u(r,e,"BESSELY",1,-1)}(),s=function(){function r(r){return 3.75>=r?n(t,r*r/14.0625):i.exp(i.abs(r))/i.sqrt(i.abs(r))*n(u,3.75/i.abs(r))}function e(r){return 3.75>r?r*n(a,r*r/14.0625):(0>r?-1:1)*i.exp(i.abs(r))/i.sqrt(i.abs(r))*n(o,3.75/i.abs(r))}var t=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),u=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),a=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),o=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();return function s(n,t){if(t=Math.round(t),0===t)return r(n);if(1==t)return e(n);if(0>t)throw"BESSELI Order ("+t+") must be nonnegative";if(0===i.abs(n))return 0;var u,a,o,f,l,c,m=2/i.abs(n);for(o=2*i.round((t+i.round(i.sqrt(40*t)))/2),f=u=0,l=1,a=o;a>0;a--)c=a*m*l+f,f=l,l=c,i.abs(l)>1e10&&(l*=1e-10,f*=1e-10,u*=1e-10),a==t&&(u=f);return u*=s(n,0)/l,0>n&&t%2?-u:u}}(),f=function(){function r(r){return 2>=r?-i.log(r/2)*s(r,0)+n(t,r*r/4):i.exp(-r)/i.sqrt(r)*n(a,2/r)}function e(r){return 2>=r?i.log(r/2)*s(r,1)+1/r*n(o,r*r/4):i.exp(-r)/i.sqrt(r)*n(f,2/r)}var t=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),a=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),o=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),f=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return u(r,e,"BESSELK",2,1)}();e.besselj=a,e.bessely=o,e.besseli=s,e.besselk=f},function(module,exports,__webpack_require__){(function(global){"use strict";var numeric=exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(r,e){var n,t,u,i;for("undefined"==typeof e&&(e=15),u=.5,n=new Date;;){for(u*=2,i=u;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;if(t=new Date,t-n>e)break}for(i=u;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;return t=new Date,1e3*(3*u-1)/(t-n)},numeric._myIndexOf=function(r){var e,n=this.length;for(e=0;n>e;++e)if(this[e]===r)return e;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){function e(r){if(0===r)return"0";if(isNaN(r))return"NaN";if(0>r)return"-"+e(-r);if(isFinite(r)){var n=Math.floor(Math.log(r)/Math.log(10)),t=r/Math.pow(10,n),u=t.toPrecision(numeric.precision);return 10===parseFloat(u)&&(n++,t=1,u=t.toPrecision(numeric.precision)),parseFloat(u).toString()+"e"+n.toString()}return"Infinity"}function n(r){var u;if("undefined"==typeof r)return t.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof r)return t.push('"'+r+'"'),!1;if("boolean"==typeof r)return t.push(r.toString()),!1;if("number"==typeof r){var i=e(r),a=r.toPrecision(numeric.precision),o=parseFloat(r.toString()).toString(),s=[i,a,o,parseFloat(a).toString(),parseFloat(o).toString()];for(u=1;u<s.length;u++)s[u].length<i.length&&(i=s[u]);return t.push(Array(numeric.precision+8-i.length).join(" ")+i),!1}if(null===r)return t.push("null"),!1;if("function"==typeof r){t.push(r.toString());var f=!1;for(u in r)r.hasOwnProperty(u)&&(t.push(f?",\n":"\n{"),f=!0,t.push(u),t.push(": \n"),n(r[u]));return f&&t.push("}\n"),!0}if(r instanceof Array){if(r.length>numeric.largeArray)return t.push("...Large Array..."),!0;var f=!1;for(t.push("["),u=0;u<r.length;u++)u>0&&(t.push(","),f&&t.push("\n ")),f=n(r[u]);return t.push("]"),!0}t.push("{");var f=!1;for(u in r)r.hasOwnProperty(u)&&(f&&t.push(",\n"),f=!0,t.push(u),t.push(": \n"),n(r[u]));return t.push("}"),!0}var t=[];return n(r),t.join("")},numeric.parseDate=function(r){function e(r){if("string"==typeof r)return Date.parse(r.replace(/-/g,"/"));if(!(r instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,t=[];for(n=0;n<r.length;n++)t[n]=e(r[n]);return t}return e(r)},numeric.parseFloat=function(r){function e(r){if("string"==typeof r)return parseFloat(r);if(!(r instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,t=[];for(n=0;n<r.length;n++)t[n]=e(r[n]);return t}return e(r)},numeric.parseCSV=function(r){var e,n,t=r.split("\n"),u=[],i=/(([^'",]*)|('[^']*')|("[^"]*")),/g,a=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,o=function(r){return r.substr(0,r.length-1)},s=0;for(n=0;n<t.length;n++){var f,l=(t[n]+",").match(i);if(l.length>0){for(u[s]=[],e=0;e<l.length;e++)f=o(l[e]),u[s][e]=a.test(f)?parseFloat(f):f;s++}}return u},numeric.toCSV=function(r){var e,n,t,u,i,a,o=numeric.dim(r);for(t=o[0],u=o[1],a=[],e=0;t>e;e++){for(i=[],n=0;t>n;n++)i[n]=r[e][n].toString();a[e]=i.join(", ")}return a.join("\n")+"\n"},numeric.getURL=function(r){var e=new XMLHttpRequest;return e.open("GET",r,!1),e.send(),e},numeric.imageURL=function(r){function e(r){var e,n,t,u,i,a,o,s,f=r.length,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";for(e=0;f>e;e+=3)n=r[e],t=r[e+1],u=r[e+2],i=n>>2,a=((3&n)<<4)+(t>>4),o=((15&t)<<2)+(u>>6),s=63&u,e+1>=f?o=s=64:e+2>=f&&(s=64),c+=l.charAt(i)+l.charAt(a)+l.charAt(o)+l.charAt(s);return c}function n(r,e,n){"undefined"==typeof e&&(e=0),"undefined"==typeof n&&(n=r.length);{var t,u=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],i=-1,a=0;r.length}for(t=e;n>t;t++)a=255&(i^r[t]),i=i>>>8^u[a];return-1^i}var t,u,i,a,o,s,f,l,c,m,p=r[0].length,h=r[0][0].length,g=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,h>>24&255,h>>16&255,h>>8&255,255&h,p>>24&255,p>>16&255,p>>8&255,255&p,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(m=n(g,12,29),g[29]=m>>24&255,g[30]=m>>16&255,g[31]=m>>8&255,g[32]=255&m,t=1,u=0,f=0;p>f;f++){for(g.push(p-1>f?0:1),o=3*h+1+(0===f)&255,s=3*h+1+(0===f)>>8&255,g.push(o),g.push(s),g.push(255&~o),g.push(255&~s),0===f&&g.push(0),l=0;h>l;l++)for(i=0;3>i;i++)o=r[i][f][l],o=o>255?255:0>o?0:Math.round(o),t=(t+o)%65521,u=(u+t)%65521,g.push(o);g.push(0)}return c=(u<<16)+t,g.push(c>>24&255),g.push(c>>16&255),g.push(c>>8&255),g.push(255&c),a=g.length-41,g[33]=a>>24&255,g[34]=a>>16&255,g[35]=a>>8&255,g[36]=255&a,m=n(g,37),g.push(m>>24&255),g.push(m>>16&255),g.push(m>>8&255),g.push(255&m),g.push(0),g.push(0),g.push(0),g.push(0),g.push(73),g.push(69),g.push(78),g.push(68),g.push(174),g.push(66),g.push(96),g.push(130),"data:image/png;base64,"+e(g)},numeric._dim=function(r){for(var e=[];"object"==typeof r;)e.push(r.length),r=r[0];return e},numeric.dim=function(r){var e,n;return"object"==typeof r?(e=r[0],"object"==typeof e?(n=e[0],"object"==typeof n?numeric._dim(r):[r.length,e.length]):[r.length]):[]},numeric.mapreduce=function(r,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+';\nif(typeof x === "number") { var xi = x; '+r+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+r+";\n    xi = x[i-1];\n    "+r+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+r+"\n}\nreturn accum;")},numeric.mapreduce2=function(r,e){return Function("x","var n = x.length;\nvar i,xi;\n"+e+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+r+";\n}\nreturn accum;")},numeric.same=function r(e,n){var t,u;if(!(e instanceof Array&&n instanceof Array))return!1;if(u=e.length,u!==n.length)return!1;for(t=0;u>t;t++)if(e[t]!==n[t]){if("object"!=typeof e[t])return!1;if(!r(e[t],n[t]))return!1}return!0},numeric.rep=function(r,e,n){"undefined"==typeof n&&(n=0);var t,u=r[n],i=Array(u);if(n===r.length-1){for(t=u-2;t>=0;t-=2)i[t+1]=e,i[t]=e;return-1===t&&(i[0]=e),i}for(t=u-1;t>=0;t--)i[t]=numeric.rep(r,e,n+1);return i},numeric.dotMMsmall=function(r,e){var n,t,u,i,a,o,s,f,l,c,m;for(i=r.length,a=e.length,o=e[0].length,s=Array(i),n=i-1;n>=0;n--){for(f=Array(o),l=r[n],u=o-1;u>=0;u--){for(c=l[a-1]*e[a-1][u],t=a-2;t>=1;t-=2)m=t-1,c+=l[t]*e[t][u]+l[m]*e[m][u];0===t&&(c+=l[0]*e[0][u]),f[u]=c}s[n]=f}return s},numeric._getCol=function(r,e,n){var t,u=r.length;for(t=u-1;t>0;--t)n[t]=r[t][e],--t,n[t]=r[t][e];0===t&&(n[0]=r[0][e])},numeric.dotMMbig=function(r,e){var n,t,u,i,a=numeric._getCol,o=e.length,s=Array(o),f=r.length,l=e[0].length,c=new Array(f),m=numeric.dotVV;for(--o,--f,t=f;-1!==t;--t)c[t]=Array(l);for(--l,t=l;-1!==t;--t)for(a(e,t,s),u=f;-1!==u;--u)i=0,n=r[u],c[u][t]=m(n,s);return c},numeric.dotMV=function(r,e){var n,t=r.length,u=(e.length,Array(t)),i=numeric.dotVV;for(n=t-1;n>=0;n--)u[n]=i(r[n],e);return u},numeric.dotVM=function(r,e){var n,t,u,i,a,o,s;for(u=r.length,i=e[0].length,a=Array(i),t=i-1;t>=0;t--){for(o=r[u-1]*e[u-1][t],n=u-2;n>=1;n-=2)s=n-1,o+=r[n]*e[n][t]+r[s]*e[s][t];0===n&&(o+=r[0]*e[0][t]),a[t]=o}return a},numeric.dotVV=function(r,e){var n,t,u=r.length,i=r[u-1]*e[u-1];for(n=u-2;n>=1;n-=2)t=n-1,i+=r[n]*e[n]+r[t]*e[t];return 0===n&&(i+=r[0]*e[0]),i},numeric.dot=function(r,e){var n=numeric.dim;switch(1e3*n(r).length+n(e).length){case 2002:return e.length<10?numeric.dotMMsmall(r,e):numeric.dotMMbig(r,e);case 2001:return numeric.dotMV(r,e);case 1002:return numeric.dotVM(r,e);case 1001:return numeric.dotVV(r,e);case 1e3:return numeric.mulVS(r,e);case 1:return numeric.mulSV(r,e);case 0:return r*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(r){var e,n,t,u,i=r.length,a=Array(i);for(e=i-1;e>=0;e--){for(u=Array(i),n=e+2,t=i-1;t>=n;t-=2)u[t]=0,u[t-1]=0;for(t>e&&(u[t]=0),u[e]=r[e],t=e-1;t>=1;t-=2)u[t]=0,u[t-1]=0;0===t&&(u[0]=0),a[e]=u}return a},numeric.getDiag=function(r){var e,n=Math.min(r.length,r[0].length),t=Array(n);for(e=n-1;e>=1;--e)t[e]=r[e][e],--e,t[e]=r[e][e];return 0===e&&(t[0]=r[0][0]),t},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric.pointwise=function(r,e,n){"undefined"==typeof n&&(n="");var t,u,i=[],a=/\[i\]$/,o="",s=!1;for(t=0;t<r.length;t++)a.test(r[t])?(u=r[t].substring(0,r[t].length-3),o=u):u=r[t],"ret"===u&&(s=!0),i.push(u);return i[r.length]="_s",i[r.length+1]="_k",i[r.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+o+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(s?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+r.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+e+"\n}\nreturn ret;",Function.apply(null,i)},numeric.pointwise2=function(r,e,n){"undefined"==typeof n&&(n="");var t,u,i=[],a=/\[i\]$/,o="",s=!1;for(t=0;t<r.length;t++)a.test(r[t])?(u=r[t].substring(0,r[t].length-3),o=u):u=r[t],"ret"===u&&(s=!0),i.push(u);return i[r.length]="var _n = "+o+".length;\nvar i"+(s?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+e+"\n}\nreturn ret;",Function.apply(null,i)},numeric._biforeach=function e(r,n,t,u,i){if(u===t.length-1)return void i(r,n);var a,o=t[u];for(a=o-1;a>=0;a--)e("object"==typeof r?r[a]:r,"object"==typeof n?n[a]:n,t,u+1,i)},numeric._biforeach2=function n(r,e,t,u,i){if(u===t.length-1)return i(r,e);var a,o=t[u],s=Array(o);for(a=o-1;a>=0;--a)s[a]=n("object"==typeof r?r[a]:r,"object"==typeof e?e[a]:e,t,u+1,i);return s},numeric._foreach=function t(r,e,n,u){if(n===e.length-1)return void u(r);var i,a=e[n];for(i=a-1;i>=0;i--)t(r[i],e,n+1,u)},numeric._foreach2=function u(r,e,n,t){if(n===e.length-1)return t(r);var i,a=e[n],o=Array(a);for(i=a-1;i>=0;i--)o[i]=u(r[i],e,n+1,t);return o},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var r,e;for(r=0;r<numeric.mathfuns2.length;++r)e=numeric.mathfuns2[r],numeric.ops2[e]=e;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){e=numeric.ops2[r];var n,t,u="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,r)?(u="var "+e+" = Math."+e+";\n",n=function(r,n,t){return r+" = "+e+"("+n+","+t+")"},t=function(r,n){return r+" = "+e+"("+r+","+n+")"}):(n=function(r,n,t){return r+" = "+n+" "+e+" "+t},t=numeric.opseq.hasOwnProperty(r+"eq")?function(r,n){return r+" "+e+"= "+n}:function(r,n){return r+" = "+r+" "+e+" "+n}),numeric[r+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),u),numeric[r+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),u),numeric[r+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),u),numeric[r]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+r+"VV, VS = numeric."+r+"VS, SV = numeric."+r+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+t("x","y")+"\n}\nreturn x;\n"),numeric[e]=numeric[r],numeric[r+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],t("ret[i]","x[i]"),u),numeric[r+"eqS"]=numeric.pointwise2(["ret[i]","x"],t("ret[i]","x"),u),numeric[r+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+r+"eqV, S = numeric."+r+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(r=0;r<numeric.mathfuns2.length;++r)e=numeric.mathfuns2[r],delete numeric.ops2[e];for(r=0;r<numeric.mathfuns.length;++r)e=numeric.mathfuns[r],numeric.ops1[e]=e;for(r in numeric.ops1)numeric.ops1.hasOwnProperty(r)&&(u="",e=numeric.ops1[r],-1!==numeric.myIndexOf.call(numeric.mathfuns,r)&&Math.hasOwnProperty(e)&&(u="var "+e+" = Math."+e+";\n"),numeric[r+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",u),numeric[r+"eq"]=Function("x",'if(typeof x !== "object") return '+e+"x\nvar i;\nvar V = numeric."+r+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[r+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",u),numeric[r]=Function("x",'if(typeof x !== "object") return '+e+"(x)\nvar i;\nvar V = numeric."+r+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(r=0;r<numeric.mathfuns.length;++r)e=numeric.mathfuns[r],delete numeric.ops1[e];for(r in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(r)&&(e=numeric.mapreducers[r],numeric[r+"V"]=numeric.mapreduce2(e[0],e[1]),numeric[r]=Function("x","s","k",e[1]+'if(typeof x !== "object") {    xi = x;\n'+e[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+r+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+e[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(r,e){return"object"==typeof r?"object"==typeof e?numeric.truncVV(r,e):numeric.truncVS(r,e):"object"==typeof e?numeric.truncSV(r,e):Math.round(r/e)*e},numeric.inv=function(r){var e,n,t,u,i,a,o,r,s=numeric.dim(r),f=Math.abs,l=s[0],c=s[1],m=numeric.clone(r),p=numeric.identity(l);for(a=0;c>a;++a){var h=-1,g=-1;for(i=a;i!==l;++i)o=f(m[i][a]),o>g&&(h=i,g=o);for(n=m[h],m[h]=m[a],m[a]=n,u=p[h],p[h]=p[a],p[a]=u,r=n[a],o=a;o!==c;++o)n[o]/=r;for(o=c-1;-1!==o;--o)u[o]/=r;for(i=l-1;-1!==i;--i)if(i!==a){for(e=m[i],t=p[i],r=e[a],o=a+1;o!==c;++o)e[o]-=n[o]*r;for(o=c-1;o>0;--o)t[o]-=u[o]*r,--o,t[o]-=u[o]*r;0===o&&(t[0]-=u[0]*r)}}return p},numeric.det=function(r){var e=numeric.dim(r);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var n,t,u,i,a,o,s,f,l=e[0],c=1,m=numeric.clone(r);for(t=0;l-1>t;t++){for(u=t,n=t+1;l>n;n++)Math.abs(m[n][t])>Math.abs(m[u][t])&&(u=n);for(u!==t&&(s=m[u],m[u]=m[t],m[t]=s,c*=-1),i=m[t],n=t+1;l>n;n++){for(a=m[n],o=a[t]/i[t],u=t+1;l-1>u;u+=2)f=u+1,a[u]-=i[u]*o,a[f]-=i[f]*o;u!==l&&(a[u]-=i[u]*o)}if(0===i[t])return 0;c*=i[t]}return c*m[t][t]},numeric.transpose=function(r){var e,n,t,u,i,a=r.length,o=r[0].length,s=Array(o);for(n=0;o>n;n++)s[n]=Array(a);for(e=a-1;e>=1;e-=2){for(u=r[e],t=r[e-1],n=o-1;n>=1;--n)i=s[n],i[e]=u[n],i[e-1]=t[n],--n,i=s[n],i[e]=u[n],i[e-1]=t[n];0===n&&(i=s[0],i[e]=u[0],i[e-1]=t[0])}if(0===e){for(t=r[0],n=o-1;n>=1;--n)s[n][0]=t[n],--n,s[n][0]=t[n];0===n&&(s[0][0]=t[0])}return s},numeric.negtranspose=function(r){var e,n,t,u,i,a=r.length,o=r[0].length,s=Array(o);for(n=0;o>n;n++)s[n]=Array(a);for(e=a-1;e>=1;e-=2){for(u=r[e],t=r[e-1],n=o-1;n>=1;--n)i=s[n],i[e]=-u[n],i[e-1]=-t[n],--n,i=s[n],i[e]=-u[n],i[e-1]=-t[n];0===n&&(i=s[0],i[e]=-u[0],i[e-1]=-t[0])}if(0===e){for(t=r[0],n=o-1;n>=1;--n)s[n][0]=-t[n],--n,s[n][0]=-t[n];0===n&&(s[0][0]=-t[0])}return s},numeric._random=function i(r,e){var n,t,u=r[e],a=Array(u);if(e===r.length-1){for(t=Math.random,n=u-1;n>=1;n-=2)a[n]=t(),a[n-1]=t();return 0===n&&(a[0]=t()),a}for(n=u-1;n>=0;n--)a[n]=i(r,e+1);return a},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r){return Math.sqrt(numeric.norm2Squared(r))},numeric.linspace=function(r,e,n){if("undefined"==typeof n&&(n=Math.max(Math.round(e-r)+1,1)),2>n)return 1===n?[r]:[];var t,u=Array(n);for(n--,t=n;t>=0;t--)u[t]=(t*e+(n-t)*r)/n;return u},numeric.getBlock=function(r,e,n){function t(r,i){var a,o=e[i],s=n[i]-o,f=Array(s);if(i===u.length-1){for(a=s;a>=0;a--)f[a]=r[a+o];return f}for(a=s;a>=0;a--)f[a]=t(r[a+o],i+1);return f}var u=numeric.dim(r);return t(r,0)},numeric.setBlock=function(r,e,n,t){function u(r,t,a){var o,s=e[a],f=n[a]-s;if(a===i.length-1)for(o=f;o>=0;o--)r[o+s]=t[o];for(o=f;o>=0;o--)u(r[o+s],t[o],a+1)}var i=numeric.dim(r);return u(r,t,0),r},numeric.getRange=function(r,e,n){var t,u,i,a,o=e.length,s=n.length,f=Array(o);for(t=o-1;-1!==t;--t)for(f[t]=Array(s),i=f[t],a=r[e[t]],u=s-1;-1!==u;--u)i[u]=a[n[u]];return f},numeric.blockMatrix=function(r){var e=numeric.dim(r);if(e.length<4)return numeric.blockMatrix([r]);var n,t,u,i,a,o=e[0],s=e[1];for(n=0,t=0,u=0;o>u;++u)n+=r[u][0].length;for(i=0;s>i;++i)t+=r[0][i][0].length;var f=Array(n);for(u=0;n>u;++u)f[u]=Array(t);var l,c,m,p,h,g=0;for(u=0;o>u;++u){for(l=t,i=s-1;-1!==i;--i)for(a=r[u][i],l-=a[0].length,m=a.length-1;-1!==m;--m)for(h=a[m],c=f[g+m],p=h.length-1;-1!==p;--p)c[l+p]=h[p];g+=r[u][0].length}return f},numeric.tensor=function(r,e){if("number"==typeof r||"number"==typeof e)return numeric.mul(r,e);var n=numeric.dim(r),t=numeric.dim(e);if(1!==n.length||1!==t.length)throw new Error("numeric: tensor product is only defined for vectors");var u,i,a,o,s=n[0],f=t[0],l=Array(s);for(i=s-1;i>=0;i--){for(u=Array(f),o=r[i],a=f-1;a>=3;--a)u[a]=o*e[a],--a,u[a]=o*e[a],--a,u[a]=o*e[a],--a,u[a]=o*e[a];for(;a>=0;)u[a]=o*e[a],--a;l[i]=u}return l},numeric.T=function(r,e){this.x=r,this.y=e},numeric.t=function(r,e){return new numeric.T(r,e)},numeric.Tbinop=function(r,e,n,t,u){numeric.indexOf;if("string"!=typeof u){var i;u="";for(i in numeric)numeric.hasOwnProperty(i)&&(r.indexOf(i)>=0||e.indexOf(i)>=0||n.indexOf(i)>=0||t.indexOf(i)>=0)&&i.length>1&&(u+="var "+i+" = numeric."+i+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+u+"\nif(x.y) {  if(y.y) {    return new numeric.T("+t+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+e+");\n}\nreturn new numeric.T("+r+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,e=numeric.div;if(this.y){var n=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(e(this.x,n),e(numeric.neg(this.y),n))}return new T(e(1,this.x))},numeric.T.prototype.div=function a(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var a=numeric.div;return this.y?new numeric.T(a(this.x,r.x),a(this.y,r.x)):new numeric.T(a(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(r(e),r(n)):new numeric.T(r(e))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(r(e),numeric.negtranspose(n)):new numeric.T(r(e))},numeric.Tunop=function(r,e,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+e+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r=this;if("undefined"==typeof r.y)return new numeric.T(numeric.inv(r.x));var e,n,t,u,i,a,o,s,f,l,c,e,n,t,m,p,h,g,v,d,y,b=r.x.length,N=numeric.identity(b),E=numeric.rep([b,b],0),x=numeric.clone(r.x),M=numeric.clone(r.y);for(e=0;b>e;e++){for(h=x[e][e],g=M[e][e],m=h*h+g*g,t=e,n=e+1;b>n;n++)h=x[n][e],g=M[n][e],p=h*h+g*g,p>m&&(t=n,m=p);for(t!==e&&(y=x[e],x[e]=x[t],x[t]=y,y=M[e],M[e]=M[t],M[t]=y,y=N[e],N[e]=N[t],N[t]=y,y=E[e],E[e]=E[t],E[t]=y),u=x[e],i=M[e],s=N[e],f=E[e],h=u[e],g=i[e],n=e+1;b>n;n++)v=u[n],d=i[n],u[n]=(v*h+d*g)/m,i[n]=(d*h-v*g)/m;for(n=0;b>n;n++)v=s[n],d=f[n],s[n]=(v*h+d*g)/m,f[n]=(d*h-v*g)/m;for(n=e+1;b>n;n++){for(a=x[n],o=M[n],l=N[n],c=E[n],h=a[e],g=o[e],t=e+1;b>t;t++)v=u[t],d=i[t],a[t]-=v*h-d*g,o[t]-=d*h+v*g;for(t=0;b>t;t++)v=s[t],d=f[t],l[t]-=v*h-d*g,c[t]-=d*h+v*g}}for(e=b-1;e>0;e--)for(s=N[e],f=E[e],n=e-1;n>=0;n--)for(l=N[n],c=E[n],h=x[n][e],g=M[n][e],t=b-1;t>=0;t--)v=s[t],d=f[t],l[t]-=h*v-g*d,c[t]-=h*d+g*v;return new numeric.T(N,E)},numeric.T.prototype.get=function(r){var e,n=this.x,t=this.y,u=0,i=r.length;if(t){for(;i>u;)e=r[u],n=n[e],t=t[e],u++;return new numeric.T(n,t)}for(;i>u;)e=r[u],n=n[e],u++;return new numeric.T(n)},numeric.T.prototype.set=function(r,e){var n,t=this.x,u=this.y,i=0,a=r.length,o=e.x,s=e.y;if(0===a)return s?this.y=s:u&&(this.y=void 0),this.x=t,this;if(s){for(u||(u=numeric.rep(numeric.dim(t),0),this.y=u);a-1>i;)n=r[i],t=t[n],u=u[n],i++;return n=r[i],t[n]=o,u[n]=s,this}if(u){for(;a-1>i;)n=r[i],t=t[n],u=u[n],i++;return n=r[i],t[n]=o,u[n]=o instanceof Array?numeric.rep(numeric.dim(o),0):0,this}for(;a-1>i;)n=r[i],t=t[n],i++;return n=r[i],t[n]=o,this},numeric.T.prototype.getRows=function(r,e){var n,t,u=e-r+1,i=Array(u),a=this.x,o=this.y;for(n=r;e>=n;n++)i[n-r]=a[n];if(o){for(t=Array(u),n=r;e>=n;n++)t[n-r]=o[n];return new numeric.T(i,t)}return new numeric.T(i)},numeric.T.prototype.setRows=function(r,e,n){var t,u=this.x,i=this.y,a=n.x,o=n.y;for(t=r;e>=t;t++)u[t]=a[t-r];if(o)for(i||(i=numeric.rep(numeric.dim(u),0),this.y=i),t=r;e>=t;t++)i[t]=o[t-r];else if(i)for(t=r;e>=t;t++)i[t]=numeric.rep([a[t-r].length],0);return this},numeric.T.prototype.getRow=function(r){var e=this.x,n=this.y;return n?new numeric.T(e[r],n[r]):new numeric.T(e[r])},numeric.T.prototype.setRow=function(r,e){var n=this.x,t=this.y,u=e.x,i=e.y;return n[r]=u,i?(t||(t=numeric.rep(numeric.dim(n),0),this.y=t),t[r]=i):t&&(t=numeric.rep([u.length],0)),this},numeric.T.prototype.getBlock=function(r,e){var n=this.x,t=this.y,u=numeric.getBlock;return t?new numeric.T(u(n,r,e),u(t,r,e)):new numeric.T(u(n,r,e))},numeric.T.prototype.setBlock=function(r,e,n){n instanceof numeric.T||(n=new numeric.T(n));var t=this.x,u=this.y,i=numeric.setBlock,a=n.x,o=n.y;return o?(u||(this.y=numeric.rep(numeric.dim(this),0),u=this.y),i(t,r,e,a),i(u,r,e,o),this):(i(t,r,e,a),void(u&&i(u,r,e,numeric.rep(numeric.dim(a),0))))},numeric.T.rep=function(r,e){var n=numeric.T;e instanceof n||(e=new n(e));var t=e.x,u=e.y,i=numeric.rep;return u?new n(i(r,t),i(r,u)):new n(i(r,t))},numeric.T.diag=function o(r){r instanceof numeric.T||(r=new numeric.T(r));var e=r.x,n=r.y,o=numeric.diag;return n?new numeric.T(o(e),o(n)):new numeric.T(o(e))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,e=this.x,n=this.y;return n?new r.T(r.getDiag(e),r.getDiag(n)):new r.T(r.getDiag(e))},numeric.house=function(r){var e=numeric.clone(r),n=r[0]>=0?1:-1,t=n*numeric.norm2(r);e[0]+=t;var u=numeric.norm2(e);if(0===u)throw new Error("eig: internal error");return numeric.div(e,u)},numeric.toUpperHessenberg=function(r){var e=numeric.dim(r);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,t,u,i,a,o,s,f,l,c,m=e[0],p=numeric.clone(r),h=numeric.identity(m);for(t=0;m-2>t;t++){for(i=Array(m-t-1),n=t+1;m>n;n++)i[n-t-1]=p[n][t];if(numeric.norm2(i)>0){for(a=numeric.house(i),o=numeric.getBlock(p,[t+1,t],[m-1,m-1]),s=numeric.tensor(a,numeric.dot(a,o)),n=t+1;m>n;n++)for(f=p[n],l=s[n-t-1],u=t;m>u;u++)f[u]-=2*l[u-t];for(o=numeric.getBlock(p,[0,t+1],[m-1,m-1]),s=numeric.tensor(numeric.dot(o,a),a),n=0;m>n;n++)for(f=p[n],l=s[n],u=t+1;m>u;u++)f[u]-=2*l[u-t-1];for(o=Array(m-t-1),n=t+1;m>n;n++)o[n-t-1]=h[n];for(s=numeric.tensor(a,numeric.dot(a,o)),n=t+1;m>n;n++)for(c=h[n],l=s[n-t-1],u=0;m>u;u++)c[u]-=2*l[u]}}return{H:p,Q:h}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(r,e){"undefined"==typeof e&&(e=1e4),r=numeric.clone(r);var n,t,u,i,a,o,s,f,l,c,m,p,h,g,v,d,y,b,N=(numeric.clone(r),numeric.dim(r)),E=N[0],x=numeric.identity(E);
if(3>E)return{Q:x,B:[[0,E-1]]};var M=numeric.epsilon;for(b=0;e>b;b++){for(d=0;E-1>d;d++)if(Math.abs(r[d+1][d])<M*(Math.abs(r[d][d])+Math.abs(r[d+1][d+1]))){var I=numeric.QRFrancis(numeric.getBlock(r,[0,0],[d,d]),e),A=numeric.QRFrancis(numeric.getBlock(r,[d+1,d+1],[E-1,E-1]),e);for(p=Array(d+1),v=0;d>=v;v++)p[v]=x[v];for(h=numeric.dot(I.Q,p),v=0;d>=v;v++)x[v]=h[v];for(p=Array(E-d-1),v=d+1;E>v;v++)p[v-d-1]=x[v];for(h=numeric.dot(A.Q,p),v=d+1;E>v;v++)x[v]=h[v-d-1];return{Q:x,B:I.B.concat(numeric.add(A.B,d+1))}}if(u=r[E-2][E-2],i=r[E-2][E-1],a=r[E-1][E-2],o=r[E-1][E-1],f=u+o,s=u*o-i*a,l=numeric.getBlock(r,[0,0],[2,2]),f*f>=4*s){var T,w;T=.5*(f+Math.sqrt(f*f-4*s)),w=.5*(f-Math.sqrt(f*f-4*s)),l=numeric.add(numeric.sub(numeric.dot(l,l),numeric.mul(l,T+w)),numeric.diag(numeric.rep([3],T*w)))}else l=numeric.add(numeric.sub(numeric.dot(l,l),numeric.mul(l,f)),numeric.diag(numeric.rep([3],s)));for(n=[l[0][0],l[1][0],l[2][0]],t=numeric.house(n),p=[r[0],r[1],r[2]],h=numeric.tensor(t,numeric.dot(t,p)),v=0;3>v;v++)for(m=r[v],g=h[v],y=0;E>y;y++)m[y]-=2*g[y];for(p=numeric.getBlock(r,[0,0],[E-1,2]),h=numeric.tensor(numeric.dot(p,t),t),v=0;E>v;v++)for(m=r[v],g=h[v],y=0;3>y;y++)m[y]-=2*g[y];for(p=[x[0],x[1],x[2]],h=numeric.tensor(t,numeric.dot(t,p)),v=0;3>v;v++)for(c=x[v],g=h[v],y=0;E>y;y++)c[y]-=2*g[y];var S;for(d=0;E-2>d;d++){for(y=d;d+1>=y;y++)if(Math.abs(r[y+1][y])<M*(Math.abs(r[y][y])+Math.abs(r[y+1][y+1]))){var I=numeric.QRFrancis(numeric.getBlock(r,[0,0],[y,y]),e),A=numeric.QRFrancis(numeric.getBlock(r,[y+1,y+1],[E-1,E-1]),e);for(p=Array(y+1),v=0;y>=v;v++)p[v]=x[v];for(h=numeric.dot(I.Q,p),v=0;y>=v;v++)x[v]=h[v];for(p=Array(E-y-1),v=y+1;E>v;v++)p[v-y-1]=x[v];for(h=numeric.dot(A.Q,p),v=y+1;E>v;v++)x[v]=h[v-y-1];return{Q:x,B:I.B.concat(numeric.add(A.B,y+1))}}for(S=Math.min(E-1,d+3),n=Array(S-d),v=d+1;S>=v;v++)n[v-d-1]=r[v][d];for(t=numeric.house(n),p=numeric.getBlock(r,[d+1,d],[S,E-1]),h=numeric.tensor(t,numeric.dot(t,p)),v=d+1;S>=v;v++)for(m=r[v],g=h[v-d-1],y=d;E>y;y++)m[y]-=2*g[y-d];for(p=numeric.getBlock(r,[0,d+1],[E-1,S]),h=numeric.tensor(numeric.dot(p,t),t),v=0;E>v;v++)for(m=r[v],g=h[v],y=d+1;S>=y;y++)m[y]-=2*g[y-d-1];for(p=Array(S-d),v=d+1;S>=v;v++)p[v-d-1]=x[v];for(h=numeric.tensor(t,numeric.dot(t,p)),v=d+1;S>=v;v++)for(c=x[v],g=h[v-d-1],y=0;E>y;y++)c[y]-=2*g[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,e){var n,t,u,i,a,o,s,f,l,c,m,p,h,g,v,d,y,b=numeric.toUpperHessenberg(r),N=numeric.QRFrancis(b.H,e),E=numeric.T,x=r.length,M=N.B,I=numeric.dot(N.Q,numeric.dot(b.H,numeric.transpose(N.Q))),A=new E(numeric.dot(N.Q,b.Q)),T=M.length,w=Math.sqrt;for(t=0;T>t;t++)if(n=M[t][0],n===M[t][1]);else{if(i=n+1,a=I[n][n],o=I[n][i],s=I[i][n],f=I[i][i],0===o&&0===s)continue;l=-a-f,c=a*f-o*s,m=l*l-4*c,m>=0?(p=0>l?-.5*(l-w(m)):-.5*(l+w(m)),d=(a-p)*(a-p)+o*o,y=s*s+(f-p)*(f-p),d>y?(d=w(d),g=(a-p)/d,v=o/d):(y=w(y),g=s/y,v=(f-p)/y),u=new E([[v,-g],[g,v]]),A.setRows(n,i,u.dot(A.getRows(n,i)))):(p=-.5*l,h=.5*w(-m),d=(a-p)*(a-p)+o*o,y=s*s+(f-p)*(f-p),d>y?(d=w(d+h*h),g=(a-p)/d,v=o/d,p=0,h/=d):(y=w(y+h*h),g=s/y,v=(f-p)/y,p=h/y,h=0),u=new E([[v,-g],[g,v]],[[p,h],[h,-p]]),A.setRows(n,i,u.dot(A.getRows(n,i))))}var S=A.dot(r).dot(A.transjugate()),x=r.length,R=numeric.T.identity(x);for(i=0;x>i;i++)if(i>0)for(t=i-1;t>=0;t--){var O=S.get([t,t]),D=S.get([i,i]);numeric.neq(O.x,D.x)||numeric.neq(O.y,D.y)?(p=S.getRow(t).getBlock([t],[i-1]),h=R.getRow(i).getBlock([t],[i-1]),R.set([i,t],S.get([t,i]).neg().sub(p.dot(h)).div(O.sub(D)))):R.setRow(i,R.getRow(t))}for(i=0;x>i;i++)p=R.getRow(i),R.setRow(i,p.div(p.norm2()));return R=R.transpose(),R=A.transjugate().dot(R),{lambda:S.getDiag(),E:R}},numeric.ccsSparse=function(r){var e,n,t,u,i=r.length,a=[];for(t=i-1;-1!==t;--t){n=r[t];for(u in n){for(u=parseInt(u);u>=a.length;)a[a.length]=0;0!==n[u]&&a[u]++}}var e=a.length,o=Array(e+1);for(o[0]=0,t=0;e>t;++t)o[t+1]=o[t]+a[t];var s=Array(o[e]),f=Array(o[e]);for(t=i-1;-1!==t;--t){n=r[t];for(u in n)0!==n[u]&&(a[u]--,s[o[u]+a[u]]=t,f[o[u]+a[u]]=n[u])}return[o,s,f]},numeric.ccsFull=function(r){var e,n,t,u,i=r[0],a=r[1],o=r[2],s=numeric.ccsDim(r),f=s[0],l=s[1],c=numeric.rep([f,l],0);for(e=0;l>e;e++)for(t=i[e],u=i[e+1],n=t;u>n;++n)c[a[n]][e]=o[n];return c},numeric.ccsTSolve=function(r,e,n,t,u){function i(r){var e;if(0===n[r]){for(n[r]=1,e=a[r];e<a[r+1];++e)i(o[e]);u[c]=r,++c}}var a=r[0],o=r[1],s=r[2],f=a.length-1,l=Math.max,c=0;"undefined"==typeof t&&(n=numeric.rep([f],0)),"undefined"==typeof t&&(t=numeric.linspace(0,n.length-1)),"undefined"==typeof u&&(u=[]);var m,p,h,g,v,d,y;for(m=t.length-1;-1!==m;--m)i(t[m]);for(u.length=c,m=u.length-1;-1!==m;--m)n[u[m]]=0;for(m=t.length-1;-1!==m;--m)p=t[m],n[p]=e[p];for(m=u.length-1;-1!==m;--m){for(p=u[m],h=a[p],g=l(a[p+1],h),v=h;v!==g;++v)if(o[v]===p){n[p]/=s[v];break}for(y=n[p],v=h;v!==g;++v)d=o[v],d!==p&&(n[d]-=y*s[v])}return n},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,e,n,t,u,i){var a,o,s,f=0,l=u.length,c=this.k,m=this.k1,p=this.j;if(0===t[r])for(t[r]=1,p[0]=r,c[0]=o=e[r],m[0]=s=e[r+1];;)if(o>=s){if(u[l]=p[f],0===f)return;++l,--f,o=c[f],s=m[f]}else a=i[n[o]],0===t[a]?(t[a]=1,c[f]=o,++f,p[f]=a,o=e[a],m[f]=s=e[a+1]):++o},numeric.ccsLPSolve=function(r,e,n,t,u,i,a){var o,s,f,l,c,m,p,h,g,v=r[0],d=r[1],y=r[2],b=(v.length-1,e[0]),N=e[1],E=e[2];for(s=b[u],f=b[u+1],t.length=0,o=s;f>o;++o)a.dfs(i[N[o]],v,d,n,t,i);for(o=t.length-1;-1!==o;--o)n[t[o]]=0;for(o=s;o!==f;++o)l=i[N[o]],n[l]=E[o];for(o=t.length-1;-1!==o;--o){for(l=t[o],c=v[l],m=v[l+1],p=c;m>p;++p)if(i[d[p]]===l){n[l]/=y[p];break}for(g=n[l],p=c;m>p;++p)h=i[d[p]],h!==l&&(n[h]-=g*y[p])}return n},numeric.ccsLUP1=function(r,e){var n,t,u,i,a,o,s,f=r[0].length-1,l=[numeric.rep([f+1],0),[],[]],c=[numeric.rep([f+1],0),[],[]],m=l[0],p=l[1],h=l[2],g=c[0],v=c[1],d=c[2],y=numeric.rep([f],0),b=numeric.rep([f],0),N=numeric.ccsLPSolve,E=(Math.max,Math.abs),x=numeric.linspace(0,f-1),M=numeric.linspace(0,f-1),I=new numeric.ccsDFS(f);for("undefined"==typeof e&&(e=1),n=0;f>n;++n){for(N(l,r,y,b,n,M,I),i=-1,a=-1,t=b.length-1;-1!==t;--t)u=b[t],n>=u||(o=E(y[u]),o>i&&(a=u,i=o));for(E(y[n])<e*i&&(t=x[n],i=x[a],x[n]=i,M[i]=n,x[a]=t,M[t]=a,i=y[n],y[n]=y[a],y[a]=i),i=m[n],a=g[n],s=y[n],p[i]=x[n],h[i]=1,++i,t=b.length-1;-1!==t;--t)u=b[t],o=y[u],b[t]=0,y[u]=0,n>=u?(v[a]=u,d[a]=o,++a):(p[i]=x[u],h[i]=o/s,++i);m[n+1]=i,g[n+1]=a}for(t=p.length-1;-1!==t;--t)p[t]=M[p[t]];return{L:l,U:c,P:x,Pinv:M}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,e,n,t,u,i){var a,o,s,f=0,l=u.length,c=this.k,m=this.k1,p=this.j;if(0===t[r])for(t[r]=1,p[0]=r,c[0]=o=e[i[r]],m[0]=s=e[i[r]+1];;){if(isNaN(o))throw new Error("Ow!");if(o>=s){if(u[l]=i[p[f]],0===f)return;++l,--f,o=c[f],s=m[f]}else a=n[o],0===t[a]?(t[a]=1,c[f]=o,++f,p[f]=a,a=i[a],o=e[a],m[f]=s=e[a+1]):++o}},numeric.ccsLPSolve0=function(r,e,n,t,u,i,a,o){var s,f,l,c,m,p,h,g,v,d=r[0],y=r[1],b=r[2],N=(d.length-1,e[0]),E=e[1],x=e[2];for(f=N[u],l=N[u+1],t.length=0,s=f;l>s;++s)o.dfs(E[s],d,y,n,t,i,a);for(s=t.length-1;-1!==s;--s)c=t[s],n[a[c]]=0;for(s=f;s!==l;++s)c=E[s],n[c]=x[s];for(s=t.length-1;-1!==s;--s){for(c=t[s],g=a[c],m=d[c],p=d[c+1],h=m;p>h;++h)if(y[h]===g){n[g]/=b[h];break}for(v=n[g],h=m;p>h;++h)n[y[h]]-=v*b[h];n[g]=v}},numeric.ccsLUP0=function(r,e){var n,t,u,i,a,o,s,f=r[0].length-1,l=[numeric.rep([f+1],0),[],[]],c=[numeric.rep([f+1],0),[],[]],m=l[0],p=l[1],h=l[2],g=c[0],v=c[1],d=c[2],y=numeric.rep([f],0),b=numeric.rep([f],0),N=numeric.ccsLPSolve0,E=(Math.max,Math.abs),x=numeric.linspace(0,f-1),M=numeric.linspace(0,f-1),I=new numeric.ccsDFS0(f);for("undefined"==typeof e&&(e=1),n=0;f>n;++n){for(N(l,r,y,b,n,M,x,I),i=-1,a=-1,t=b.length-1;-1!==t;--t)u=b[t],n>=u||(o=E(y[x[u]]),o>i&&(a=u,i=o));for(E(y[x[n]])<e*i&&(t=x[n],i=x[a],x[n]=i,M[i]=n,x[a]=t,M[t]=a),i=m[n],a=g[n],s=y[x[n]],p[i]=x[n],h[i]=1,++i,t=b.length-1;-1!==t;--t)u=b[t],o=y[x[u]],b[t]=0,y[x[u]]=0,n>=u?(v[a]=u,d[a]=o,++a):(p[i]=x[u],h[i]=o/s,++i);m[n+1]=i,g[n+1]=a}for(t=p.length-1;-1!==t;--t)p[t]=M[p[t]];return{L:l,U:c,P:x,Pinv:M}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,e,n){var t=numeric.ccsDim(r),u=t[0],i=t[1];"undefined"==typeof e?e=numeric.linspace(0,u-1):"number"==typeof e&&(e=[e]),"undefined"==typeof n?n=numeric.linspace(0,i-1):"number"==typeof n&&(n=[n]);var a,o,s,f,l,c=e.length,m=n.length,p=numeric.rep([i],0),h=[],g=[],v=[p,h,g],d=r[0],y=r[1],b=r[2],N=numeric.rep([u],0),E=0,x=numeric.rep([u],0);for(o=0;m>o;++o){f=n[o];var M=d[f],I=d[f+1];for(a=M;I>a;++a)s=y[a],x[s]=1,N[s]=b[a];for(a=0;c>a;++a)l=e[a],x[l]&&(h[E]=a,g[E]=N[e[a]],++E);for(a=M;I>a;++a)s=y[a],x[s]=0;p[o+1]=E}return v},numeric.ccsDot=function(r,e){var n,t,u,i,a,o,s,f,l,c,m,p=r[0],h=r[1],g=r[2],v=e[0],d=e[1],y=e[2],b=numeric.ccsDim(r),N=numeric.ccsDim(e),E=b[0],x=(b[1],N[1]),M=numeric.rep([E],0),I=numeric.rep([E],0),A=Array(E),T=numeric.rep([x],0),w=[],S=[],R=[T,w,S];for(u=0;u!==x;++u){for(i=v[u],a=v[u+1],l=0,t=i;a>t;++t)for(c=d[t],m=y[t],o=p[c],s=p[c+1],n=o;s>n;++n)f=h[n],0===I[f]&&(A[l]=f,I[f]=1,l+=1),M[f]=M[f]+g[n]*m;for(i=T[u],a=i+l,T[u+1]=a,t=l-1;-1!==t;--t)m=i+t,n=A[t],w[m]=n,S[m]=M[n],I[n]=0,M[n]=0;T[u+1]=T[u]+l}return R},numeric.ccsLUPSolve=function(r,e){var n=r.L,t=r.U,u=(r.P,e[0]),i=!1;"object"!=typeof u&&(e=[[0,e.length],numeric.linspace(0,e.length-1),e],u=e[0],i=!0);var a,o,s,f,l,c,m=e[1],p=e[2],h=n[0].length-1,g=u.length-1,v=numeric.rep([h],0),d=Array(h),y=numeric.rep([h],0),b=Array(h),N=numeric.rep([g+1],0),E=[],x=[],M=numeric.ccsTSolve,I=0;for(a=0;g>a;++a){for(l=0,s=u[a],f=u[a+1],o=s;f>o;++o)c=r.Pinv[m[o]],b[l]=c,y[c]=p[o],++l;for(b.length=l,M(n,y,v,b,d),o=b.length-1;-1!==o;--o)y[b[o]]=0;if(M(t,v,y,d,b),i)return y;for(o=d.length-1;-1!==o;--o)v[d[o]]=0;for(o=b.length-1;-1!==o;--o)c=b[o],E[I]=c,x[I]=y[c],y[c]=0,++I;N[a+1]=I}return[N,E,x]},numeric.ccsbinop=function(r,e){return"undefined"==typeof e&&(e=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+e+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+r+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(r){var e,n=r[0],t=r[1],u=r[2],i=numeric.sup(t)+1,a=n.length,o=numeric.rep([i],0),s=Array(a),f=Array(a),l=numeric.rep([i],0);for(e=0;a>e;++e)l[t[e]]++;for(e=0;i>e;++e)o[e+1]=o[e]+l[e];var c,m,p=o.slice(0);for(e=0;a>e;++e)m=t[e],c=p[m],s[c]=n[e],f[c]=u[e],p[m]=p[m]+1;return[o,s,f]},numeric.ccsGather=function(r){var e,n,t,u,i,a=r[0],o=r[1],s=r[2],f=a.length-1,l=o.length,c=Array(l),m=Array(l),p=Array(l);for(i=0,e=0;f>e;++e)for(t=a[e],u=a[e+1],n=t;n!==u;++n)m[i]=e,c[i]=o[n],p[i]=s[n],++i;return[c,m,p]},numeric.sdim=function s(r,e,n){if("undefined"==typeof e&&(e=[]),"object"!=typeof r)return e;"undefined"==typeof n&&(n=0),n in e||(e[n]=0),r.length>e[n]&&(e[n]=r.length);var t;for(t in r)r.hasOwnProperty(t)&&s(r[t],e,n+1);return e},numeric.sclone=function f(r,e,n){"undefined"==typeof e&&(e=0),"undefined"==typeof n&&(n=numeric.sdim(r).length);var t,u=Array(r.length);if(e===n-1){for(t in r)r.hasOwnProperty(t)&&(u[t]=r[t]);return u}for(t in r)r.hasOwnProperty(t)&&(u[t]=f(r[t],e+1,n));return u},numeric.sdiag=function(r){var e,n,t=r.length,u=Array(t);for(e=t-1;e>=1;e-=2)n=e-1,u[e]=[],u[e][e]=r[e],u[n]=[],u[n][n]=r[n];return 0===e&&(u[0]=[],u[0][0]=r[e]),u},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){{var e,n,t,u=[];r.length}for(e in r)if(r.hasOwnProperty(e)){t=r[e];for(n in t)t.hasOwnProperty(n)&&("object"!=typeof u[n]&&(u[n]=[]),u[n][e]=t[n])}return u},numeric.sLUP=function(){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,e){var n,t,u,i,a,o,s,f=r.length,l=(e.length,numeric.stranspose(e)),c=l.length,m=Array(f);for(u=f-1;u>=0;u--){for(s=[],n=r[u],a=c-1;a>=0;a--){o=0,t=l[a];for(i in n)n.hasOwnProperty(i)&&i in t&&(o+=n[i]*t[i]);o&&(s[a]=o)}m[u]=s}return m},numeric.sdotMV=function(r,e){var n,t,u,i,a=r.length,o=Array(a);for(t=a-1;t>=0;t--){n=r[t],i=0;for(u in n)n.hasOwnProperty(u)&&e[u]&&(i+=n[u]*e[u]);i&&(o[t]=i)}return o},numeric.sdotVM=function(r,e){var n,t,u,i,a=[];for(n in r)if(r.hasOwnProperty(n)){u=e[n],i=r[n];for(t in u)u.hasOwnProperty(t)&&(a[t]||(a[t]=0),a[t]+=i*u[t])}return a},numeric.sdotVV=function(r,e){var n,t=0;for(n in r)r[n]&&e[n]&&(t+=r[n]*e[n]);return t},numeric.sdot=function(r,e){var n=numeric.sdim(r).length,t=numeric.sdim(e).length,u=1e3*n+t;switch(u){case 0:return r*e;case 1001:return numeric.sdotVV(r,e);case 2001:return numeric.sdotMV(r,e);case 1002:return numeric.sdotVM(r,e);case 2002:return numeric.sdotMM(r,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+t)}},numeric.sscatter=function(r){var e,n,t,u,i=r[0].length,a=r.length,o=[];for(n=i-1;n>=0;--n)if(r[a-1][n]){for(u=o,t=0;a-2>t;t++)e=r[t][n],u[e]||(u[e]=[]),u=u[e];u[r[t][n]]=r[t+1][n]}return o},numeric.sgather=function l(r,e,n){"undefined"==typeof e&&(e=[]),"undefined"==typeof n&&(n=[]);var t,u,i;t=n.length;for(u in r)if(r.hasOwnProperty(u))if(n[t]=parseInt(u),i=r[u],"number"==typeof i){if(i){if(0===e.length)for(u=t+1;u>=0;--u)e[u]=[];for(u=t;u>=0;--u)e[u].push(n[u]);e[t+1].push(i)}}else l(i,e,n);return n.length>t&&n.pop(),e},numeric.cLU=function(r){var e,n,t,u,i,a,o=r[0],s=r[1],f=r[2],l=o.length,c=0;for(e=0;l>e;e++)o[e]>c&&(c=o[e]);c++;var m,p,h,g=Array(c),v=Array(c),d=numeric.rep([c],1/0),y=numeric.rep([c],-1/0);for(t=0;l>t;t++)e=o[t],n=s[t],n<d[e]&&(d[e]=n),n>y[e]&&(y[e]=n);for(e=0;c-1>e;e++)y[e]>y[e+1]&&(y[e+1]=y[e]);for(e=c-1;e>=1;e--)d[e]<d[e-1]&&(d[e-1]=d[e]);var b=0,N=0;for(e=0;c>e;e++)v[e]=numeric.rep([y[e]-d[e]+1],0),g[e]=numeric.rep([e-d[e]],0),b+=e-d[e]+1,N+=y[e]-e+1;for(t=0;l>t;t++)e=o[t],v[e][s[t]-d[e]]=f[t];for(e=0;c-1>e;e++)for(u=e-d[e],m=v[e],n=e+1;d[n]<=e&&c>n;n++)if(i=e-d[n],a=y[e]-e,p=v[n],h=p[i]/m[u]){for(t=1;a>=t;t++)p[t+i]-=h*m[t+u];g[n][e-d[n]]=h}var l,E,x,m=[],p=[],M=[],I=[],A=[],T=[];for(l=0,E=0,e=0;c>e;e++){for(u=d[e],i=y[e],x=v[e],n=e;i>=n;n++)x[n-u]&&(m[l]=e,p[l]=n,M[l]=x[n-u],l++);for(x=g[e],n=u;e>n;n++)x[n-u]&&(I[E]=e,A[E]=n,T[E]=x[n-u],E++);I[E]=e,A[E]=e,T[E]=1,E++}return{U:[m,p,M],L:[I,A,T]}},numeric.cLUsolve=function(r,e){var n,t,u=r.L,i=r.U,a=numeric.clone(e),o=u[0],s=u[1],f=u[2],l=i[0],c=i[1],m=i[2],p=l.length,h=(o.length,a.length);for(t=0,n=0;h>n;n++){for(;s[t]<n;)a[n]-=f[t]*a[s[t]],t++;t++}for(t=p-1,n=h-1;n>=0;n--){for(;c[t]>n;)a[n]-=m[t]*a[c[t]],t--;a[n]/=m[t],t--}return a},numeric.cgrid=function(r,e){"number"==typeof r&&(r=[r,r]);var n,t,u,i=numeric.rep(r,-1);if("function"!=typeof e)switch(e){case"L":e=function(e,n){return e>=r[0]/2||n<r[1]/2};break;default:e=function(){return!0}}for(u=0,n=1;n<r[0]-1;n++)for(t=1;t<r[1]-1;t++)e(n,t)&&(i[n][t]=u,u++);return i},numeric.cdelsq=function(r){var e,n,t,u,i,a=[[-1,0],[0,-1],[0,1],[1,0]],o=numeric.dim(r),s=o[0],f=o[1],l=[],c=[],m=[];for(e=1;s-1>e;e++)for(n=1;f-1>n;n++)if(!(r[e][n]<0)){for(t=0;4>t;t++)u=e+a[t][0],i=n+a[t][1],r[u][i]<0||(l.push(r[e][n]),c.push(r[u][i]),m.push(-1));l.push(r[e][n]),c.push(r[e][n]),m.push(4)}return[l,c,m]},numeric.cdotMV=function(r,e){var n,t,u,i=r[0],a=r[1],o=r[2],s=i.length;for(u=0,t=0;s>t;t++)i[t]>u&&(u=i[t]);for(u++,n=numeric.rep([u],0),t=0;s>t;t++)n[i[t]]+=o[t]*e[a[t]];return n},numeric.Spline=function(r,e,n,t,u){this.x=r,this.yl=e,this.yr=n,this.kl=t,this.kr=u},numeric.Spline.prototype._at=function(r,e){var r,n,t,u,i=this.x,a=this.yl,o=this.yr,s=this.kl,f=this.kr,l=numeric.add,c=numeric.sub,m=numeric.mul;n=c(m(s[e],i[e+1]-i[e]),c(o[e+1],a[e])),t=l(m(f[e+1],i[e]-i[e+1]),c(o[e+1],a[e])),u=(r-i[e])/(i[e+1]-i[e]);var p=u*(1-u);return l(l(l(m(1-u,a[e]),m(u,o[e+1])),m(n,p*(1-u))),m(t,p*u))},numeric.Spline.prototype.at=function(r){if("number"==typeof r){var e,n,t,u=this.x,i=u.length,a=Math.floor;for(e=0,n=i-1;n-e>1;)t=a((e+n)/2),u[t]<=r?e=t:n=t;return this._at(r,e)}var o,i=r.length,s=Array(i);for(o=i-1;-1!==o;--o)s[o]=this.at(r[o]);return s},numeric.Spline.prototype.diff=function(){var r,e,n,t=this.x,u=this.yl,i=this.yr,a=this.kl,o=this.kr,s=u.length,f=a,l=o,c=Array(s),m=Array(s),p=numeric.add,h=numeric.mul,g=numeric.div,v=numeric.sub;for(r=s-1;-1!==r;--r)e=t[r+1]-t[r],n=v(i[r+1],u[r]),c[r]=g(p(h(n,6),h(a[r],-4*e),h(o[r+1],-2*e)),e*e),m[r+1]=g(p(h(n,-6),h(a[r],2*e),h(o[r+1],4*e)),e*e);return new numeric.Spline(t,f,l,c,m)},numeric.Spline.prototype.roots=function(){function r(r){return r*r}var e=[],n=this.x,t=this.yl,u=this.yr,i=this.kl,a=this.kr;"number"==typeof t[0]&&(t=[t],u=[u],i=[i],a=[a]);var o,s,f,l,c,m,p,h,g,v,d,y,b,N,E,x,M,I,A,T,w,S,R,O,D=t.length,C=n.length-1,e=Array(D),L=Math.sqrt;for(o=0;o!==D;++o){for(l=t[o],c=u[o],m=i[o],p=a[o],h=[],s=0;s!==C;s++){for(s>0&&c[s]*l[s]<0&&h.push(n[s]),x=n[s+1]-n[s],M=n[s],d=l[s],y=c[s+1],g=m[s]/x,v=p[s+1]/x,E=r(g-v+3*(d-y))+12*v*d,b=v+3*d+2*g-3*y,N=3*(v+g+2*(d-y)),0>=E?(A=b/N,I=A>n[s]&&A<n[s+1]?[n[s],A,n[s+1]]:[n[s],n[s+1]]):(A=(b-L(E))/N,T=(b+L(E))/N,I=[n[s]],A>n[s]&&A<n[s+1]&&I.push(A),T>n[s]&&T<n[s+1]&&I.push(T),I.push(n[s+1])),S=I[0],A=this._at(S,s),f=0;f<I.length-1;f++)if(R=I[f+1],T=this._at(R,s),0!==A)if(0===T||A*T>0)S=R,A=T;else{for(var P=0;;){if(O=(A*R-T*S)/(A-T),S>=O||O>=R)break;if(w=this._at(O,s),w*T>0)R=O,T=w,-1===P&&(A*=.5),P=-1;else{if(!(w*A>0))break;S=O,A=w,1===P&&(T*=.5),P=1}}h.push(O),S=I[f+1],A=this._at(S,s)}else h.push(S),S=R,A=T;0===T&&h.push(R)}e[o]=h}return"number"==typeof this.yl[0]?e[0]:e},numeric.spline=function(r,e,n,t){var u,i=r.length,a=[],o=[],s=[],f=numeric.sub,l=numeric.mul,c=numeric.add;for(u=i-2;u>=0;u--)o[u]=r[u+1]-r[u],s[u]=f(e[u+1],e[u]);("string"==typeof n||"string"==typeof t)&&(n=t="periodic");var m=[[],[],[]];switch(typeof n){case"undefined":a[0]=l(3/(o[0]*o[0]),s[0]),m[0].push(0,0),m[1].push(0,1),m[2].push(2/o[0],1/o[0]);break;case"string":a[0]=c(l(3/(o[i-2]*o[i-2]),s[i-2]),l(3/(o[0]*o[0]),s[0])),m[0].push(0,0,0),m[1].push(i-2,0,1),m[2].push(1/o[i-2],2/o[i-2]+2/o[0],1/o[0]);break;default:a[0]=n,m[0].push(0),m[1].push(0),m[2].push(1)}for(u=1;i-1>u;u++)a[u]=c(l(3/(o[u-1]*o[u-1]),s[u-1]),l(3/(o[u]*o[u]),s[u])),m[0].push(u,u,u),m[1].push(u-1,u,u+1),m[2].push(1/o[u-1],2/o[u-1]+2/o[u],1/o[u]);switch(typeof t){case"undefined":a[i-1]=l(3/(o[i-2]*o[i-2]),s[i-2]),m[0].push(i-1,i-1),m[1].push(i-2,i-1),m[2].push(1/o[i-2],2/o[i-2]);break;case"string":m[1][m[1].length-1]=0;break;default:a[i-1]=t,m[0].push(i-1),m[1].push(i-1),m[2].push(1)}a="number"!=typeof a[0]?numeric.transpose(a):[a];var p=Array(a.length);if("string"==typeof n)for(u=p.length-1;-1!==u;--u)p[u]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(m)),a[u]),p[u][i-1]=p[u][0];else for(u=p.length-1;-1!==u;--u)p[u]=numeric.cLUsolve(numeric.cLU(m),a[u]);return p="number"==typeof e[0]?p[0]:numeric.transpose(p),new numeric.Spline(r,e,e,p,p)},numeric.fftpow2=function c(r,e){var n=r.length;if(1!==n){var t,u,i=Math.cos,a=Math.sin,o=Array(n/2),s=Array(n/2),f=Array(n/2),l=Array(n/2);for(u=n/2,t=n-1;-1!==t;--t)--u,f[u]=r[t],l[u]=e[t],--t,o[u]=r[t],s[u]=e[t];c(o,s),c(f,l),u=n/2;var m,p,h,g=-6.283185307179586/n;for(t=n-1;-1!==t;--t)--u,-1===u&&(u=n/2-1),m=g*t,p=i(m),h=a(m),r[t]=o[u]+p*f[u]-h*l[u],e[t]=s[u]+p*l[u]+h*f[u]}},numeric._ifftpow2=function m(r,e){var n=r.length;if(1!==n){var t,u,i=Math.cos,a=Math.sin,o=Array(n/2),s=Array(n/2),f=Array(n/2),l=Array(n/2);for(u=n/2,t=n-1;-1!==t;--t)--u,f[u]=r[t],l[u]=e[t],--t,o[u]=r[t],s[u]=e[t];m(o,s),m(f,l),u=n/2;var c,p,h,g=6.283185307179586/n;for(t=n-1;-1!==t;--t)--u,-1===u&&(u=n/2-1),c=g*t,p=i(c),h=a(c),r[t]=o[u]+p*f[u]-h*l[u],e[t]=s[u]+p*l[u]+h*f[u]}},numeric.ifftpow2=function(r,e){numeric._ifftpow2(r,e),numeric.diveq(r,r.length),numeric.diveq(e,e.length)},numeric.convpow2=function(r,e,n,t){numeric.fftpow2(r,e),numeric.fftpow2(n,t);var u,i,a,o,s,f=r.length;for(u=f-1;-1!==u;--u)i=r[u],o=e[u],a=n[u],s=t[u],r[u]=i*a-o*s,e[u]=i*s+o*a;numeric.ifftpow2(r,e)},numeric.T.prototype.fft=function(){{var r,e,n=this.x,t=this.y,u=n.length,i=Math.log,a=i(2),o=Math.ceil(i(2*u-1)/a),s=Math.pow(2,o),f=numeric.rep([s],0),l=numeric.rep([s],0),c=Math.cos,m=Math.sin,p=-3.141592653589793/u,h=numeric.rep([s],0),g=numeric.rep([s],0);Math.floor(u/2)}for(r=0;u>r;r++)h[r]=n[r];if("undefined"!=typeof t)for(r=0;u>r;r++)g[r]=t[r];for(f[0]=1,r=1;s/2>=r;r++)e=p*r*r,f[r]=c(e),l[r]=m(e),f[s-r]=c(e),l[s-r]=m(e);var v=new numeric.T(h,g),d=new numeric.T(f,l);return v=v.mul(d),numeric.convpow2(v.x,v.y,numeric.clone(d.x),numeric.neg(d.y)),v=v.mul(d),v.x.length=u,v.y.length=u,v},numeric.T.prototype.ifft=function(){{var r,e,n=this.x,t=this.y,u=n.length,i=Math.log,a=i(2),o=Math.ceil(i(2*u-1)/a),s=Math.pow(2,o),f=numeric.rep([s],0),l=numeric.rep([s],0),c=Math.cos,m=Math.sin,p=3.141592653589793/u,h=numeric.rep([s],0),g=numeric.rep([s],0);Math.floor(u/2)}for(r=0;u>r;r++)h[r]=n[r];if("undefined"!=typeof t)for(r=0;u>r;r++)g[r]=t[r];for(f[0]=1,r=1;s/2>=r;r++)e=p*r*r,f[r]=c(e),l[r]=m(e),f[s-r]=c(e),l[s-r]=m(e);var v=new numeric.T(h,g),d=new numeric.T(f,l);return v=v.mul(d),numeric.convpow2(v.x,v.y,numeric.clone(d.x),numeric.neg(d.y)),v=v.mul(d),v.x.length=u,v.y.length=u,v.div(u)},numeric.gradient=function(r,e){var n=e.length,t=r(e);if(isNaN(t))throw new Error("gradient: f(x) is a NaN!");var u,i,a,o,s,f,l,c,m,p,h=Math.max,g=numeric.clone(e),v=Array(n),h=(numeric.div,numeric.sub,Math.max),d=.001,y=Math.abs,b=Math.min,N=0;for(u=0;n>u;u++)for(var E=h(1e-6*t,1e-8);;){if(++N,N>20)throw new Error("Numerical gradient fails");if(g[u]=e[u]+E,i=r(g),g[u]=e[u]-E,a=r(g),g[u]=e[u],isNaN(i)||isNaN(a))E/=16;else{if(v[u]=(i-a)/(2*E),s=e[u]-E,f=e[u],l=e[u]+E,c=(i-t)/E,m=(t-a)/E,p=h(y(v[u]),y(t),y(i),y(a),y(s),y(f),y(l),1e-8),o=b(h(y(c-v[u]),y(m-v[u]),y(c-m))/p,E/p),!(o>d))break;E/=16}}return v},numeric.uncmin=function(r,e,n,t,u,i,a){var o=numeric.gradient;"undefined"==typeof a&&(a={}),"undefined"==typeof n&&(n=1e-8),"undefined"==typeof t&&(t=function(e){return o(r,e)}),"undefined"==typeof u&&(u=1e3),e=numeric.clone(e);var s,f,l=e.length,c=r(e);if(isNaN(c))throw new Error("uncmin: f(x0) is a NaN!");var m=Math.max,p=numeric.norm2;n=m(n,numeric.epsilon);var h,g,v,d,y,b,N,E,x,M,I=a.Hinv||numeric.identity(l),A=numeric.dot,T=(numeric.inv,numeric.sub),w=numeric.add,S=numeric.tensor,R=numeric.div,O=numeric.mul,D=numeric.all,C=numeric.isFinite,L=numeric.neg,P=0,j="";for(g=t(e);u>P;){if("function"==typeof i&&i(P,e,c,g,I)){j="Callback returned true";break}if(!D(C(g))){j="Gradient has Infinity or NaN";break}if(h=L(A(I,g)),!D(C(h))){j="Search direction has Infinity or NaN";break}if(M=p(h),n>M){j="Newton step smaller than tol";break}for(x=1,f=A(g,h),y=e;u>P&&!(n>x*M)&&(d=O(h,x),y=w(e,d),s=r(y),s-c>=.1*x*f||isNaN(s));)x*=.5,++P;if(n>x*M){j="Line search step size smaller than tol";break}if(P===u){j="maxit reached during line search";break}v=t(y),b=T(v,g),E=A(b,d),N=A(I,b),I=T(w(I,O((E+A(b,N))/(E*E),S(d,d))),R(w(S(N,d),S(d,N)),E)),e=y,c=s,g=v,++P}return{solution:e,f:c,gradient:g,invHessian:I,iterations:P,message:j}},numeric.Dopri=function(r,e,n,t,u,i,a){this.x=r,this.y=e,this.f=n,this.ymid=t,this.iterations=u,this.events=a,this.message=i},numeric.Dopri.prototype._at=function(r,e){function n(r){return r*r}var t,u,i,a,o,s,r,f,l,c,m,p=this,h=p.x,g=p.y,v=p.f,d=p.ymid,y=(h.length,Math.floor,.5),b=numeric.add,N=numeric.mul,E=numeric.sub;return t=h[e],u=h[e+1],a=g[e],o=g[e+1],f=u-t,i=t+y*f,s=d[e],l=E(v[e],N(a,1/(t-i)+2/(t-u))),c=E(v[e+1],N(o,1/(u-i)+2/(u-t))),m=[n(r-u)*(r-i)/n(t-u)/(t-i),n(r-t)*n(r-u)/n(t-i)/n(u-i),n(r-t)*(r-i)/n(u-t)/(u-i),(r-t)*n(r-u)*(r-i)/n(t-u)/(t-i),(r-u)*n(r-t)*(r-i)/n(t-u)/(u-i)],b(b(b(b(N(a,m[0]),N(s,m[1])),N(o,m[2])),N(l,m[3])),N(c,m[4]))},numeric.Dopri.prototype.at=function(r){var e,n,t,u=Math.floor;if("number"!=typeof r){var i=r.length,a=Array(i);for(e=i-1;-1!==e;--e)a[e]=this.at(r[e]);return a}var o=this.x;for(e=0,n=o.length-1;n-e>1;)t=u(.5*(e+n)),o[t]<=r?e=t:n=t;return this._at(r,e)},numeric.dopri=function(r,e,n,t,u,i,a){"undefined"==typeof u&&(u=1e-6),"undefined"==typeof i&&(i=1e3);var o,s,f,l,c,m,p,h,g,v,d,y,b,N=[r],E=[n],x=[t(r,n)],M=[],I=.2,A=[.075,.225],T=[44/45,-56/15,32/9],w=[19372/6561,-25360/2187,64448/6561,-212/729],S=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],R=[35/384,0,500/1113,125/192,-2187/6784,11/84],O=[.10013431883002395,0,.3918321794184259,-0.02982460176594817,.05893268337240795,-0.04497888809104361,.023904308236133973],D=[.2,.3,.8,8/9,1,1],C=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],L=0,P=(e-r)/10,j=0,_=numeric.add,V=numeric.mul,F=(Math.max,Math.min),U=Math.abs,k=numeric.norminf,q=Math.pow,G=numeric.any,B=numeric.lt,Y=numeric.and,X=(numeric.sub,new numeric.Dopri(N,E,x,M,-1,""));for("function"==typeof a&&(d=a(r,n));e>r&&i>j;)if(++j,r+P>e&&(P=e-r),o=t(r+D[0]*P,_(n,V(I*P,x[L]))),s=t(r+D[1]*P,_(_(n,V(A[0]*P,x[L])),V(A[1]*P,o))),f=t(r+D[2]*P,_(_(_(n,V(T[0]*P,x[L])),V(T[1]*P,o)),V(T[2]*P,s))),l=t(r+D[3]*P,_(_(_(_(n,V(w[0]*P,x[L])),V(w[1]*P,o)),V(w[2]*P,s)),V(w[3]*P,f))),c=t(r+D[4]*P,_(_(_(_(_(n,V(S[0]*P,x[L])),V(S[1]*P,o)),V(S[2]*P,s)),V(S[3]*P,f)),V(S[4]*P,l))),g=_(_(_(_(_(n,V(x[L],P*R[0])),V(s,P*R[2])),V(f,P*R[3])),V(l,P*R[4])),V(c,P*R[5])),m=t(r+P,g),p=_(_(_(_(_(V(x[L],P*C[0]),V(s,P*C[2])),V(f,P*C[3])),V(l,P*C[4])),V(c,P*C[5])),V(m,P*C[6])),v="number"==typeof p?U(p):k(p),v>u){if(P=.2*P*q(u/v,.25),r+P===r){X.msg="Step size became too small";break}}else{if(M[L]=_(_(_(_(_(_(n,V(x[L],P*O[0])),V(s,P*O[2])),V(f,P*O[3])),V(l,P*O[4])),V(c,P*O[5])),V(m,P*O[6])),++L,N[L]=r+P,E[L]=g,x[L]=m,"function"==typeof a){var H,Q,K=r,W=r+.5*P;if(y=a(W,M[L-1]),b=Y(B(d,0),B(0,y)),G(b)||(K=W,W=r+P,d=y,y=a(W,g),b=Y(B(d,0),B(0,y))),G(b)){for(var z,Z,$=0,J=1,re=1;;){if("number"==typeof d)Q=(re*y*K-J*d*W)/(re*y-J*d);else for(Q=W,h=d.length-1;-1!==h;--h)d[h]<0&&y[h]>0&&(Q=F(Q,(re*y[h]*K-J*d[h]*W)/(re*y[h]-J*d[h])));if(K>=Q||Q>=W)break;H=X._at(Q,L-1),Z=a(Q,H),z=Y(B(d,0),B(0,Z)),G(z)?(W=Q,y=Z,b=z,re=1,-1===$?J*=.5:J=1,$=-1):(K=Q,d=Z,J=1,1===$?re*=.5:re=1,$=1)}return g=X._at(.5*(r+Q),L-1),X.f[L]=t(Q,H),X.x[L]=Q,X.y[L]=H,X.ymid[L-1]=g,X.events=b,X.iterations=j,X}}r+=P,n=g,d=y,P=F(.8*P*q(u/v,.25),4*P)}return X.iterations=j,X},numeric.LU=function(r,e){e=e||!1;var n,t,u,i,a,o,s,f,l,c=Math.abs,m=r.length,p=m-1,h=new Array(m);for(e||(r=numeric.clone(r)),u=0;m>u;++u){for(s=u,o=r[u],l=c(o[u]),t=u+1;m>t;++t)i=c(r[t][u]),i>l&&(l=i,s=t);for(h[u]=s,s!=u&&(r[u]=r[s],r[s]=o,o=r[u]),a=o[u],n=u+1;m>n;++n)r[n][u]/=a;for(n=u+1;m>n;++n){for(f=r[n],t=u+1;p>t;++t)f[t]-=f[u]*o[t],++t,f[t]-=f[u]*o[t];t===p&&(f[t]-=f[u]*o[t])}}return{LU:r,P:h}},numeric.LUsolve=function(r,e){var n,t,u,i,a,o=r.LU,s=o.length,f=numeric.clone(e),l=r.P;for(n=s-1;-1!==n;--n)f[n]=e[n];for(n=0;s>n;++n)for(u=l[n],l[n]!==n&&(a=f[n],f[n]=f[u],f[u]=a),i=o[n],t=0;n>t;++t)f[n]-=f[t]*i[t];for(n=s-1;n>=0;--n){for(i=o[n],t=n+1;s>t;++t)f[n]-=f[t]*i[t];f[n]/=i[n]}return f},numeric.solve=function(r,e,n){return numeric.LUsolve(numeric.LU(r,n),e)},numeric.echelonize=function(r){var e,n,t,u,i,a,o,s,f=numeric.dim(r),l=f[0],c=f[1],m=numeric.identity(l),p=Array(l),h=Math.abs,g=numeric.diveq;for(r=numeric.clone(r),e=0;l>e;++e){for(t=0,i=r[e],a=m[e],n=1;c>n;++n)h(i[t])<h(i[n])&&(t=n);for(p[e]=t,g(a,i[t]),g(i,i[t]),n=0;l>n;++n)if(n!==e){for(o=r[n],s=o[t],u=c-1;-1!==u;--u)o[u]-=i[u]*s;for(o=m[n],u=l-1;-1!==u;--u)o[u]-=a[u]*s}}return{I:m,A:r,P:p}},numeric.__solveLP=function(r,e,n,t,u,i,a){var o,s,f,l,c=numeric.sum,m=(numeric.log,numeric.mul),p=numeric.sub,h=numeric.dot,g=numeric.div,v=numeric.add,d=r.length,y=n.length,b=!1,N=0,E=1,x=(numeric.transpose(e),numeric.svd,numeric.transpose),M=(numeric.leq,Math.sqrt),I=Math.abs,A=(numeric.muleq,numeric.norminf,numeric.any,Math.min),T=numeric.all,w=numeric.gt,S=Array(d),R=Array(y),O=(numeric.rep([y],1),numeric.solve),D=p(n,h(e,i)),C=h(r,r);for(f=N;u>f;++f){var L,P;for(L=y-1;-1!==L;--L)R[L]=g(e[L],D[L]);var j=x(R);for(L=d-1;-1!==L;--L)S[L]=c(j[L]);E=.25*I(C/h(r,S));var _=100*M(C/h(S,S));for((!isFinite(E)||E>_)&&(E=_),l=v(r,m(E,S)),s=h(j,R),L=d-1;-1!==L;--L)s[L][L]+=1;P=O(s,g(l,E),!0);var V=g(D,h(e,P)),F=1;for(L=y-1;-1!==L;--L)V[L]<0&&(F=A(F,-.999*V[L]));if(o=p(i,m(P,F)),D=p(n,h(e,o)),!T(w(D,0)))return{solution:i,message:"",iterations:f};if(i=o,t>E)return{solution:o,message:"",iterations:f};if(a){var U=h(r,l),k=h(e,l);for(b=!0,L=y-1;-1!==L;--L)if(U*k[L]<0){b=!1;break}}else b=i[d-1]>=0?!1:!0;if(b)return{solution:o,message:"Unbounded",iterations:f}}return{solution:i,message:"maximum iteration count exceeded",iterations:f}},numeric._solveLP=function(r,e,n,t,u){var i,a=r.length,o=n.length,s=(numeric.sum,numeric.log,numeric.mul,numeric.sub),f=numeric.dot,l=(numeric.div,numeric.add,numeric.rep([a],0).concat([1])),c=numeric.rep([o,1],-1),m=numeric.blockMatrix([[e,c]]),p=n,i=numeric.rep([a],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),h=numeric.__solveLP(l,m,p,t,u,i,!1),g=numeric.clone(h.solution);g.length=a;var v=numeric.inf(s(n,f(e,g)));if(0>v)return{solution:0/0,message:"Infeasible",iterations:h.iterations};var d=numeric.__solveLP(r,e,n,t,u-h.iterations,g,!0);return d.iterations+=h.iterations,d},numeric.solveLP=function(r,e,n,t,u,i,a){if("undefined"==typeof a&&(a=1e3),"undefined"==typeof i&&(i=numeric.epsilon),"undefined"==typeof t)return numeric._solveLP(r,e,n,i,a);var o,s=t.length,f=t[0].length,l=e.length,c=numeric.echelonize(t),m=numeric.rep([f],0),p=c.P,h=[];for(o=p.length-1;-1!==o;--o)m[p[o]]=1;for(o=f-1;-1!==o;--o)0===m[o]&&h.push(o);var g=numeric.getRange,v=numeric.linspace(0,s-1),d=numeric.linspace(0,l-1),y=g(t,v,h),b=g(e,d,p),N=g(e,d,h),E=numeric.dot,x=numeric.sub,M=E(b,c.I),I=x(N,E(M,y)),A=x(n,E(M,u)),T=Array(p.length),w=Array(h.length);for(o=p.length-1;-1!==o;--o)T[o]=r[p[o]];for(o=h.length-1;-1!==o;--o)w[o]=r[h[o]];var S=x(w,E(T,E(c.I,y))),R=numeric._solveLP(S,I,A,i,a),O=R.solution;if(O!==O)return R;var D=E(c.I,x(u,E(y,O))),C=Array(r.length);for(o=p.length-1;-1!==o;--o)C[p[o]]=D[o];for(o=h.length-1;-1!==o;--o)C[h[o]]=O[o];return{solution:C,message:R.message,iterations:R.iterations}},numeric.MPStoLP=function(r){function e(e){throw new Error("MPStoLP: "+e+"\nLine "+n+": "+r[n]+"\nCurrent state: "+o[a]+"\n")}r instanceof String&&r.split("\n");var n,t,u,i,a=0,o=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],s=r.length,f=0,l={},c=[],m=0,p={},h=0,g=[],v=[],d=[];for(n=0;s>n;++n){u=r[n];var y=u.match(/\S*/g),b=[];for(t=0;t<y.length;++t)""!==y[t]&&b.push(y[t]);if(0!==b.length){for(t=0;t<o.length&&u.substr(0,o[t].length)!==o[t];++t);if(t<o.length){if(a=t,1===t&&(i=b[1]),6===t)return{name:i,c:g,A:numeric.transpose(v),b:d,rows:l,vars:p}}else switch(a){case 0:case 1:e("Unexpected line");case 2:switch(b[0]){case"N":0===f?f=b[1]:e("Two or more N rows");break;case"L":l[b[1]]=m,c[m]=1,d[m]=0,++m;break;case"G":l[b[1]]=m,c[m]=-1,d[m]=0,++m;break;case"E":l[b[1]]=m,c[m]=0,d[m]=0,++m;break;default:e("Parse error "+numeric.prettyPrint(b))
}break;case 3:p.hasOwnProperty(b[0])||(p[b[0]]=h,g[h]=0,v[h]=numeric.rep([m],0),++h);var N=p[b[0]];for(t=1;t<b.length;t+=2)if(b[t]!==f){var E=l[b[t]];v[N][E]=(c[E]<0?-1:1)*parseFloat(b[t+1])}else g[N]=parseFloat(b[t+1]);break;case 4:for(t=1;t<b.length;t+=2)d[l[b[t]]]=(c[l[b[t]]]<0?-1:1)*parseFloat(b[t+1]);break;case 5:break;case 6:e("Internal error")}}}e("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(r,e,n,t,u,i,a){function o(r){var e,t,u=this,i=r.length,a=0,o=u.i=u.j=u.m=0;for(u.S=[],u.c=[],i||(r=[i++]);n>a;)u.S[a]=a++;for(a=0;n>a;a++)e=u.S[a],o=l(o+e+r[a%i]),t=u.S[o],u.S[a]=t,u.S[o]=e;u.g=function(r){var e=u.S,t=l(u.i+1),i=e[t],a=l(u.j+i),o=e[a];e[t]=o,e[a]=i;for(var s=e[l(i+o)];--r;)t=l(t+1),i=e[t],a=l(a+i),o=e[a],e[t]=o,e[a]=i,s=s*n+e[l(i+o)];return u.i=t,u.j=a,s},u.g(n)}function s(r,e,n,t,u){if(n=[],u=typeof r,e&&"object"==u)for(t in r)if(t.indexOf("S")<5)try{n.push(s(r[t],e-1))}catch(i){}return n.length?n:r+("string"!=u?"\x00":"")}function f(r,e,n,t){for(r+="",n=0,t=0;t<r.length;t++)e[l(t)]=l((n^=19*e[l(t)])+r.charCodeAt(t));r="";for(t in e)r+=String.fromCharCode(e[t]);return r}function l(r){return r&n-1}e.seedrandom=function(l,c){var m,p=[];return l=f(s(c?[l,r]:arguments.length?l:[(new Date).getTime(),r,window],3),p),m=new o(p),f(m.S,r),e.random=function(){for(var r=m.g(t),e=a,o=0;u>r;)r=(r+o)*n,e*=n,o=m.g(1);for(;r>=i;)r/=2,e/=2,o>>>=1;return(r+o)/e},l},a=e.pow(n,t),u=e.pow(2,u),i=2*u,f(e.random(),r)}([],numeric.seedrandom,256,6,52),function(r){function e(r){if("object"!=typeof r)return r;var n,t=[],u=r.length;for(n=0;u>n;n++)t[n+1]=e(r[n]);return t}function n(r){if("object"!=typeof r)return r;var e,t=[],u=r.length;for(e=1;u>e;e++)t[e-1]=n(r[e]);return t}function t(r,e,n){var t,u,i,a,o;for(i=1;n>=i;i+=1){for(r[i][i]=1/r[i][i],o=-r[i][i],t=1;i>t;t+=1)r[t][i]=o*r[t][i];if(a=i+1,a>n)break;for(u=a;n>=u;u+=1)for(o=r[i][u],r[i][u]=0,t=1;i>=t;t+=1)r[t][u]=r[t][u]+o*r[t][i]}}function u(r,e,n,t){var u,i,a,o;for(i=1;n>=i;i+=1){for(o=0,u=1;i>u;u+=1)o+=r[u][i]*t[u];t[i]=(t[i]-o)/r[i][i]}for(a=1;n>=a;a+=1)for(i=n+1-a,t[i]=t[i]/r[i][i],o=-t[i],u=1;i>u;u+=1)t[u]=t[u]+o*r[u][i]}function i(r,e,n,t){var u,i,a,o,s,f;for(i=1;n>=i;i+=1){if(t[1]=i,f=0,a=i-1,1>a){if(f=r[i][i]-f,0>=f)break;r[i][i]=Math.sqrt(f)}else{for(o=1;a>=o;o+=1){for(s=r[o][i],u=1;o>u;u+=1)s-=r[u][i]*r[u][o];s/=r[o][o],r[o][i]=s,f+=s*s}if(f=r[i][i]-f,0>=f)break;r[i][i]=Math.sqrt(f)}t[1]=0}}function a(r,e,n,a,o,s,f,l,c,m,p,h,g,v,d,y){function b(){for(v[1]=v[1]+1,T=L,I=1;m>=I;I+=1){for(T+=1,U=-l[I],A=1;a>=A;A+=1)U+=f[A][I]*o[A];if(Math.abs(U)<Q&&(U=0),I>p)d[T]=U;else if(d[T]=-Math.abs(U),U>0){for(A=1;a>=A;A+=1)f[A][I]=-f[A][I];l[I]=-l[I]}}for(I=1;g>=I;I+=1)d[L+h[I]]=0;for(j=0,F=0,I=1;m>=I;I+=1)d[L+I]<F*d[V+I]&&(j=I,F=d[L+I]/d[V+I]);return 0===j?999:0}function N(){for(I=1;a>=I;I+=1){for(U=0,A=1;a>=A;A+=1)U+=r[A][I]*f[A][j];d[I]=U}for(w=O,I=1;a>=I;I+=1)d[w+I]=0;for(A=g+1;a>=A;A+=1)for(I=1;a>=I;I+=1)d[w+I]=d[w+I]+r[I][A]*d[A];for(X=!0,I=g;I>=1;I-=1){for(U=d[I],T=C+I*(I+3)/2,w=T-I,A=I+1;g>=A;A+=1)U-=d[T]*d[D+A],T+=A;if(U/=d[w],d[D+I]=U,h[I]<p)break;if(0>U)break;X=!1,R=I}if(!X)for(k=d[P+R]/d[D+R],I=1;g>=I&&!(h[I]<p)&&!(d[D+I]<0);I+=1)F=d[P+I]/d[D+I],k>F&&(k=F,R=I);for(U=0,I=O+1;O+a>=I;I+=1)U+=d[I]*d[I];if(Math.abs(U)<=Q){if(X)return y[1]=1,999;for(I=1;g>=I;I+=1)d[P+I]=d[P+I]-k*d[D+I];return d[P+g+1]=d[P+g+1]+k,700}for(U=0,I=1;a>=I;I+=1)U+=d[O+I]*f[I][j];for(q=-d[L+j]/U,H=!0,X||q>k&&(q=k,H=!1),I=1;a>=I;I+=1)o[I]=o[I]+q*d[O+I],Math.abs(o[I])<Q&&(o[I]=0);for(s[1]=s[1]+q*U*(q/2+d[P+g+1]),I=1;g>=I;I+=1)d[P+I]=d[P+I]-q*d[D+I];if(d[P+g+1]=d[P+g+1]+q,!H){for(U=-l[j],A=1;a>=A;A+=1)U+=o[A]*f[A][j];if(j>p)d[L+j]=U;else if(d[L+j]=-Math.abs(U),U>0){for(A=1;a>=A;A+=1)f[A][j]=-f[A][j];l[j]=-l[j]}return 700}for(g+=1,h[g]=j,T=C+(g-1)*g/2+1,I=1;g-1>=I;I+=1)d[T]=d[I],T+=1;if(g===a)d[T]=d[a];else{for(I=a;I>=g+1&&0!==d[I]&&(G=Math.max(Math.abs(d[I-1]),Math.abs(d[I])),B=Math.min(Math.abs(d[I-1]),Math.abs(d[I])),F=d[I-1]>=0?Math.abs(G*Math.sqrt(1+B*B/(G*G))):-Math.abs(G*Math.sqrt(1+B*B/(G*G))),G=d[I-1]/F,B=d[I]/F,1!==G);I-=1)if(0===G)for(d[I-1]=B*F,A=1;a>=A;A+=1)F=r[A][I-1],r[A][I-1]=r[A][I],r[A][I]=F;else for(d[I-1]=F,Y=B/(1+G),A=1;a>=A;A+=1)F=G*r[A][I-1]+B*r[A][I],r[A][I]=Y*(r[A][I-1]+F)-r[A][I],r[A][I-1]=F;d[T]=d[g]}return 0}function E(){if(T=C+R*(R+1)/2+1,w=T+R,0===d[w])return 798;if(G=Math.max(Math.abs(d[w-1]),Math.abs(d[w])),B=Math.min(Math.abs(d[w-1]),Math.abs(d[w])),F=d[w-1]>=0?Math.abs(G*Math.sqrt(1+B*B/(G*G))):-Math.abs(G*Math.sqrt(1+B*B/(G*G))),G=d[w-1]/F,B=d[w]/F,1===G)return 798;if(0===G){for(I=R+1;g>=I;I+=1)F=d[w-1],d[w-1]=d[w],d[w]=F,w+=I;for(I=1;a>=I;I+=1)F=r[I][R],r[I][R]=r[I][R+1],r[I][R+1]=F}else{for(Y=B/(1+G),I=R+1;g>=I;I+=1)F=G*d[w-1]+B*d[w],d[w]=Y*(d[w-1]+F)-d[w],d[w-1]=F,w+=I;for(I=1;a>=I;I+=1)F=G*r[I][R]+B*r[I][R+1],r[I][R+1]=Y*(r[I][R]+F)-r[I][R+1],r[I][R]=F}return 0}function x(){for(w=T-R,I=1;R>=I;I+=1)d[w]=d[T],T+=1,w+=1;return d[P+R]=d[P+R+1],h[R]=h[R+1],R+=1,g>R?797:0}function M(){return d[P+g]=d[P+g+1],d[P+g+1]=0,h[g]=0,g-=1,v[2]=v[2]+1,0}var I,A,T,w,S,R,O,D,C,L,P,j,_,V,F,U,k,q,G,B,Y,X,H,Q,K,W,z;_=Math.min(a,m),T=2*a+_*(_+5)/2+2*m+1,Q=1e-60;do Q+=Q,K=1+.1*Q,W=1+.2*Q;while(1>=K||1>=W);for(I=1;a>=I;I+=1)d[I]=e[I];for(I=a+1;T>=I;I+=1)d[I]=0;for(I=1;m>=I;I+=1)h[I]=0;if(S=[],0===y[1]){if(i(r,n,a,S),0!==S[1])return void(y[1]=2);u(r,n,a,e),t(r,n,a)}else{for(A=1;a>=A;A+=1)for(o[A]=0,I=1;A>=I;I+=1)o[A]=o[A]+r[I][A]*e[I];for(A=1;a>=A;A+=1)for(e[A]=0,I=A;a>=I;I+=1)e[A]=e[A]+r[A][I]*o[I]}for(s[1]=0,A=1;a>=A;A+=1)for(o[A]=e[A],s[1]=s[1]+d[A]*o[A],d[A]=0,I=A+1;a>=I;I+=1)r[I][A]=0;for(s[1]=-s[1]/2,y[1]=0,O=a,D=O+a,P=D+_,C=P+_+1,L=C+_*(_+1)/2,V=L+m,I=1;m>=I;I+=1){for(U=0,A=1;a>=A;A+=1)U+=f[A][I]*f[A][I];d[V+I]=Math.sqrt(U)}for(g=0,v[1]=0,v[2]=0,z=0;;){if(z=b(),999===z)return;for(;;){if(z=N(),0===z)break;if(999===z)return;if(700===z)if(R===g)M();else{for(;;)if(E(),z=x(),797!==z)break;M()}}}}function o(r,t,u,i,o,s){r=e(r),t=e(t),u=e(u);var f,l,c,m,p,h,g=[],v=[],d=[],y=[],b=[];if(o=o||0,s=s?e(s):[void 0,0],i=i?e(i):[],l=r.length-1,c=u[1].length-1,!i)for(f=1;c>=f;f+=1)i[f]=0;for(f=1;c>=f;f+=1)v[f]=0;for(m=0,p=Math.min(l,c),f=1;l>=f;f+=1)d[f]=0;for(g[1]=0,f=1;2*l+p*(p+5)/2+2*c+1>=f;f+=1)y[f]=0;for(f=1;2>=f;f+=1)b[f]=0;return a(r,t,l,l,d,g,u,i,l,c,o,v,m,b,y,s),h="",1===s[1]&&(h="constraints are inconsistent, no solution!"),2===s[1]&&(h="matrix D in quadratic function is not positive definite!"),{solution:n(d),value:n(g),unconstrained_solution:n(t),iterations:n(b),iact:n(v),message:h}}r.solveQP=o}(numeric),numeric.svd=function(r){function e(r,e){return r=Math.abs(r),e=Math.abs(e),r>e?r*Math.sqrt(1+e*e/r/r):0==e?r:e*Math.sqrt(1+r*r/e/e)}var n,t=numeric.epsilon,u=1e-64/t,i=50,a=0,o=0,s=0,f=0,l=0,c=numeric.clone(r),m=c.length,p=c[0].length;if(p>m)throw"Need more rows than columns";var h=new Array(p),g=new Array(p);for(o=0;p>o;o++)h[o]=g[o]=0;var v=numeric.rep([p,p],0),d=0,y=0,b=0,N=0,E=0,x=0,M=0;for(o=0;p>o;o++){for(h[o]=y,M=0,l=o+1,s=o;m>s;s++)M+=c[s][o]*c[s][o];if(u>=M)y=0;else for(d=c[o][o],y=Math.sqrt(M),d>=0&&(y=-y),b=d*y-M,c[o][o]=d-y,s=l;p>s;s++){for(M=0,f=o;m>f;f++)M+=c[f][o]*c[f][s];for(d=M/b,f=o;m>f;f++)c[f][s]+=d*c[f][o]}for(g[o]=y,M=0,s=l;p>s;s++)M+=c[o][s]*c[o][s];if(u>=M)y=0;else{for(d=c[o][o+1],y=Math.sqrt(M),d>=0&&(y=-y),b=d*y-M,c[o][o+1]=d-y,s=l;p>s;s++)h[s]=c[o][s]/b;for(s=l;m>s;s++){for(M=0,f=l;p>f;f++)M+=c[s][f]*c[o][f];for(f=l;p>f;f++)c[s][f]+=M*h[f]}}E=Math.abs(g[o])+Math.abs(h[o]),E>N&&(N=E)}for(o=p-1;-1!=o;o+=-1){if(0!=y){for(b=y*c[o][o+1],s=l;p>s;s++)v[s][o]=c[o][s]/b;for(s=l;p>s;s++){for(M=0,f=l;p>f;f++)M+=c[o][f]*v[f][s];for(f=l;p>f;f++)v[f][s]+=M*v[f][o]}}for(s=l;p>s;s++)v[o][s]=0,v[s][o]=0;v[o][o]=1,y=h[o],l=o}for(o=p-1;-1!=o;o+=-1){for(l=o+1,y=g[o],s=l;p>s;s++)c[o][s]=0;if(0!=y){for(b=c[o][o]*y,s=l;p>s;s++){for(M=0,f=l;m>f;f++)M+=c[f][o]*c[f][s];for(d=M/b,f=o;m>f;f++)c[f][s]+=d*c[f][o]}for(s=o;m>s;s++)c[s][o]=c[s][o]/y}else for(s=o;m>s;s++)c[s][o]=0;c[o][o]+=1}for(t*=N,f=p-1;-1!=f;f+=-1)for(var I=0;i>I;I++){var A=!1;for(l=f;-1!=l;l+=-1){if(Math.abs(h[l])<=t){A=!0;break}if(Math.abs(g[l-1])<=t)break}if(!A){a=0,M=1;var T=l-1;for(o=l;f+1>o&&(d=M*h[o],h[o]=a*h[o],!(Math.abs(d)<=t));o++)for(y=g[o],b=e(d,y),g[o]=b,a=y/b,M=-d/b,s=0;m>s;s++)E=c[s][T],x=c[s][o],c[s][T]=E*a+x*M,c[s][o]=-E*M+x*a}if(x=g[f],l==f){if(0>x)for(g[f]=-x,s=0;p>s;s++)v[s][f]=-v[s][f];break}if(I>=i-1)throw"Error: no convergence.";for(N=g[l],E=g[f-1],y=h[f-1],b=h[f],d=((E-x)*(E+x)+(y-b)*(y+b))/(2*b*E),y=e(d,1),d=0>d?((N-x)*(N+x)+b*(E/(d-y)-b))/N:((N-x)*(N+x)+b*(E/(d+y)-b))/N,a=1,M=1,o=l+1;f+1>o;o++){for(y=h[o],E=g[o],b=M*y,y=a*y,x=e(d,b),h[o-1]=x,a=d/x,M=b/x,d=N*a+y*M,y=-N*M+y*a,b=E*M,E*=a,s=0;p>s;s++)N=v[s][o-1],x=v[s][o],v[s][o-1]=N*a+x*M,v[s][o]=-N*M+x*a;for(x=e(d,b),g[o-1]=x,a=d/x,M=b/x,d=a*y+M*E,N=-M*y+a*E,s=0;m>s;s++)E=c[s][o-1],x=c[s][o],c[s][o-1]=E*a+x*M,c[s][o]=-E*M+x*a}h[l]=0,h[f]=d,g[f]=N}for(o=0;o<g.length;o++)g[o]<t&&(g[o]=0);for(o=0;p>o;o++)for(s=o-1;s>=0;s--)if(g[s]<g[o]){for(a=g[s],g[s]=g[o],g[o]=a,f=0;f<c.length;f++)n=c[f][o],c[f][o]=c[f][s],c[f][s]=n;for(f=0;f<v.length;f++)n=v[f][o],v[f][o]=v[f][s],v[f][s]=n;o=s}return{U:c,S:g,V:v}}}).call(exports,function(){return this}())},function(r,e){var n,t;/*!
	 * numeral.js
	 * version : 1.5.3
	 * author : Adam Draper
	 * license : MIT
	 * http://adamwdraper.github.com/Numeral-js/
	 */
(function(){function u(r){this._value=r}function i(r,e,n,t){var u,i,a=Math.pow(10,e);return i=(n(r*a)/a).toFixed(e),t&&(u=new RegExp("0{1,"+t+"}$"),i=i.replace(u,"")),i}function a(r,e,n){var t;return t=e.indexOf("$")>-1?s(r,e,n):e.indexOf("%")>-1?f(r,e,n):e.indexOf(":")>-1?l(r,e):m(r._value,e,n)}function o(r,e){var n,t,u,i,a,o=e,s=["KB","MB","GB","TB","PB","EB","ZB","YB"],f=!1;if(e.indexOf(":")>-1)r._value=c(e);else if(e===N)r._value=0;else{for("."!==y[b].delimiters.decimal&&(e=e.replace(/\./g,"").replace(y[b].delimiters.decimal,".")),n=new RegExp("[^a-zA-Z]"+y[b].abbreviations.thousand+"(?:\\)|(\\"+y[b].currency.symbol+")?(?:\\))?)?$"),t=new RegExp("[^a-zA-Z]"+y[b].abbreviations.million+"(?:\\)|(\\"+y[b].currency.symbol+")?(?:\\))?)?$"),u=new RegExp("[^a-zA-Z]"+y[b].abbreviations.billion+"(?:\\)|(\\"+y[b].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+y[b].abbreviations.trillion+"(?:\\)|(\\"+y[b].currency.symbol+")?(?:\\))?)?$"),a=0;a<=s.length&&!(f=e.indexOf(s[a])>-1?Math.pow(1024,a+1):!1);a++);r._value=(f?f:1)*(o.match(n)?Math.pow(10,3):1)*(o.match(t)?Math.pow(10,6):1)*(o.match(u)?Math.pow(10,9):1)*(o.match(i)?Math.pow(10,12):1)*(e.indexOf("%")>-1?.01:1)*((e.split("-").length+Math.min(e.split("(").length-1,e.split(")").length-1))%2?1:-1)*Number(e.replace(/[^0-9\.]+/g,"")),r._value=f?Math.ceil(r._value):r._value}return r._value}function s(r,e,n){var t,u,i=e.indexOf("$"),a=e.indexOf("("),o=e.indexOf("-"),s="";return e.indexOf(" $")>-1?(s=" ",e=e.replace(" $","")):e.indexOf("$ ")>-1?(s=" ",e=e.replace("$ ","")):e=e.replace("$",""),u=m(r._value,e,n),1>=i?u.indexOf("(")>-1||u.indexOf("-")>-1?(u=u.split(""),t=1,(a>i||o>i)&&(t=0),u.splice(t,0,y[b].currency.symbol+s),u=u.join("")):u=y[b].currency.symbol+s+u:u.indexOf(")")>-1?(u=u.split(""),u.splice(-1,0,s+y[b].currency.symbol),u=u.join("")):u=u+s+y[b].currency.symbol,u}function f(r,e,n){var t,u="",i=100*r._value;return e.indexOf(" %")>-1?(u=" ",e=e.replace(" %","")):e=e.replace("%",""),t=m(i,e,n),t.indexOf(")")>-1?(t=t.split(""),t.splice(-1,0,u+"%"),t=t.join("")):t=t+u+"%",t}function l(r){var e=Math.floor(r._value/60/60),n=Math.floor((r._value-60*e*60)/60),t=Math.round(r._value-60*e*60-60*n);return e+":"+(10>n?"0"+n:n)+":"+(10>t?"0"+t:t)}function c(r){var e=r.split(":"),n=0;return 3===e.length?(n+=60*Number(e[0])*60,n+=60*Number(e[1]),n+=Number(e[2])):2===e.length&&(n+=60*Number(e[0]),n+=Number(e[1])),Number(n)}function m(r,e,n){var t,u,a,o,s,f,l=!1,c=!1,m=!1,p="",h=!1,g=!1,v=!1,d=!1,E=!1,x="",M="",I=Math.abs(r),A=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],T="",w=!1;if(0===r&&null!==N)return N;if(e.indexOf("(")>-1?(l=!0,e=e.slice(1,-1)):e.indexOf("+")>-1&&(c=!0,e=e.replace(/\+/g,"")),e.indexOf("a")>-1&&(h=e.indexOf("aK")>=0,g=e.indexOf("aM")>=0,v=e.indexOf("aB")>=0,d=e.indexOf("aT")>=0,E=h||g||v||d,e.indexOf(" a")>-1?(p=" ",e=e.replace(" a","")):e=e.replace("a",""),I>=Math.pow(10,12)&&!E||d?(p+=y[b].abbreviations.trillion,r/=Math.pow(10,12)):I<Math.pow(10,12)&&I>=Math.pow(10,9)&&!E||v?(p+=y[b].abbreviations.billion,r/=Math.pow(10,9)):I<Math.pow(10,9)&&I>=Math.pow(10,6)&&!E||g?(p+=y[b].abbreviations.million,r/=Math.pow(10,6)):(I<Math.pow(10,6)&&I>=Math.pow(10,3)&&!E||h)&&(p+=y[b].abbreviations.thousand,r/=Math.pow(10,3))),e.indexOf("b")>-1)for(e.indexOf(" b")>-1?(x=" ",e=e.replace(" b","")):e=e.replace("b",""),a=0;a<=A.length;a++)if(t=Math.pow(1024,a),u=Math.pow(1024,a+1),r>=t&&u>r){x+=A[a],t>0&&(r/=t);break}return e.indexOf("o")>-1&&(e.indexOf(" o")>-1?(M=" ",e=e.replace(" o","")):e=e.replace("o",""),M+=y[b].ordinal(r)),e.indexOf("[.]")>-1&&(m=!0,e=e.replace("[.]",".")),o=r.toString().split(".")[0],s=e.split(".")[1],f=e.indexOf(","),s?(s.indexOf("[")>-1?(s=s.replace("]",""),s=s.split("["),T=i(r,s[0].length+s[1].length,n,s[1].length)):T=i(r,s.length,n),o=T.split(".")[0],T=T.split(".")[1].length?y[b].delimiters.decimal+T.split(".")[1]:"",m&&0===Number(T.slice(1))&&(T="")):o=i(r,null,n),o.indexOf("-")>-1&&(o=o.slice(1),w=!0),f>-1&&(o=o.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+y[b].delimiters.thousands)),0===e.indexOf(".")&&(o=""),(l&&w?"(":"")+(!l&&w?"-":"")+(!w&&c?"+":"")+o+T+(M?M:"")+(p?p:"")+(x?x:"")+(l&&w?")":"")}function p(r,e){y[r]=e}function h(r){var e=r.toString().split(".");return e.length<2?1:Math.pow(10,e[1].length)}function g(){var r=Array.prototype.slice.call(arguments);return r.reduce(function(r,e){var n=h(r),t=h(e);return n>t?n:t},-1/0)}var v,d="1.5.3",y={},b="en",N=null,E="0,0",x="undefined"!=typeof r&&r.exports;v=function(r){return v.isNumeral(r)?r=r.value():0===r||"undefined"==typeof r?r=0:Number(r)||(r=v.fn.unformat(r)),new u(Number(r))},v.version=d,v.isNumeral=function(r){return r instanceof u},v.language=function(r,e){if(!r)return b;if(r&&!e){if(!y[r])throw new Error("Unknown language : "+r);b=r}return(e||!y[r])&&p(r,e),v},v.languageData=function(r){if(!r)return y[b];if(!y[r])throw new Error("Unknown language : "+r);return y[r]},v.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(r){var e=r%10;return 1===~~(r%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$"}}),v.zeroFormat=function(r){N="string"==typeof r?r:null},v.defaultFormat=function(r){E="string"==typeof r?r:"0.0"},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(r,e){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof r)throw new TypeError(r+" is not a function");var n,t,u=this.length>>>0,i=!1;for(1<arguments.length&&(t=e,i=!0),n=0;u>n;++n)this.hasOwnProperty(n)&&(i?t=r(t,this[n],n,this):(t=this[n],i=!0));if(!i)throw new TypeError("Reduce of empty array with no initial value");return t}),v.fn=u.prototype={clone:function(){return v(this)},format:function(r,e){return a(this,r?r:E,void 0!==e?e:Math.round)},unformat:function(r){return"[object Number]"===Object.prototype.toString.call(r)?r:o(this,r?r:E)},value:function(){return this._value},valueOf:function(){return this._value},set:function(r){return this._value=Number(r),this},add:function(r){function e(r,e){return r+n*e}var n=g.call(null,this._value,r);return this._value=[this._value,r].reduce(e,0)/n,this},subtract:function(r){function e(r,e){return r-n*e}var n=g.call(null,this._value,r);return this._value=[r].reduce(e,this._value*n)/n,this},multiply:function(r){function e(r,e){var n=g(r,e);return r*n*e*n/(n*n)}return this._value=[this._value,r].reduce(e,1),this},divide:function(r){function e(r,e){var n=g(r,e);return r*n/(e*n)}return this._value=[this._value,r].reduce(e),this},difference:function(r){return Math.abs(v(this._value).subtract(r).value())}},x&&(r.exports=v),"undefined"==typeof ender&&(this.numeral=v),n=[],t=function(){return v}.apply(e,n),!(void 0!==t&&(r.exports=t))}).call(this)},function(){this.j$=this.jStat=function(r){function e(e,n){var t=e>n?e:n;return r.pow(10,17-~~(r.log(t>0?t:-t)*r.LOG10E))}function n(r){return"[object Function]"===c.call(r)}function t(r){return"number"==typeof r&&r===r}function u(r){return f.apply([],r)}function i(){return new i._init(arguments)}function a(){return 0}function o(){return 1}function s(r,e){return r===e?1:0}var f=Array.prototype.concat,l=Array.prototype.slice,c=Object.prototype.toString,m=Array.isArray||function(r){return"[object Array]"===c.call(r)};i.fn=i.prototype,i._init=function(r){var e;if(m(r[0]))if(m(r[0][0])){for(n(r[1])&&(r[0]=i.map(r[0],r[1])),e=0;e<r[0].length;e++)this[e]=r[0][e];this.length=r[0].length}else this[0]=n(r[1])?i.map(r[0],r[1]):r[0],this.length=1;else if(t(r[0]))this[0]=i.seq.apply(null,r),this.length=1;else{if(r[0]instanceof i)return i(r[0].toArray());this[0]=[],this.length=1}return this},i._init.prototype=i.prototype,i._init.constructor=i,i.utils={calcRdx:e,isArray:m,isFunction:n,isNumber:t,toVector:u},i.extend=function(r){var e,n;if(1===arguments.length){for(n in r)i[n]=r[n];return this}for(e=1;e<arguments.length;e++)for(n in arguments[e])r[n]=arguments[e][n];return r},i.rows=function(r){return r.length||1},i.cols=function(r){return r[0].length||1},i.dimensions=function(r){return{rows:i.rows(r),cols:i.cols(r)}},i.row=function(r,e){return r[e]},i.col=function(r,e){for(var n=new Array(r.length),t=0;t<r.length;t++)n[t]=[r[t][e]];return n},i.diag=function(r){for(var e=i.rows(r),n=new Array(e),t=0;e>t;t++)n[t]=[r[t][t]];return n},i.antidiag=function(r){for(var e=i.rows(r)-1,n=new Array(e),t=0;e>=0;e--,t++)n[t]=[r[t][e]];return n},i.transpose=function(r){var e,n,t,u,i,a=[];for(m(r[0])||(r=[r]),n=r.length,t=r[0].length,i=0;t>i;i++){for(e=new Array(n),u=0;n>u;u++)e[u]=r[u][i];a.push(e)}return 1===a.length?a[0]:a},i.map=function(r,e,n){var t,u,i,a,o;for(m(r[0])||(r=[r]),u=r.length,i=r[0].length,a=n?r:new Array(u),t=0;u>t;t++)for(a[t]||(a[t]=new Array(i)),o=0;i>o;o++)a[t][o]=e(r[t][o],t,o);return 1===a.length?a[0]:a},i.alter=function(r,e){return i.map(r,e,!0)},i.create=function(r,e,t){var u,i,a=new Array(r);for(n(e)&&(t=e,e=r),u=0;r>u;u++)for(a[u]=new Array(e),i=0;e>i;i++)a[u][i]=t(u,i);return a},i.zeros=function(r,e){return t(e)||(e=r),i.create(r,e,a)},i.ones=function(r,e){return t(e)||(e=r),i.create(r,e,o)},i.rand=function(e,n){return t(n)||(n=e),i.create(e,n,r.random)},i.identity=function(r,e){return t(e)||(e=r),i.create(r,e,s)},i.symmetric=function(r){var e,n,t=r.length;if(r.length!==r[0].length)return!1;for(e=0;t>e;e++)for(n=0;t>n;n++)if(r[n][e]!==r[e][n])return!1;return!0},i.clear=function(r){return i.alter(r,a)},i.seq=function(r,t,u,i){n(i)||(i=!1);var a,o=[],s=e(r,t),f=(t*s-r*s)/((u-1)*s),l=r;for(a=0;t>=l;a++,l=(r*s+f*s*a)/s)o.push(i?i(l,a):l);return o};var p=i.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return this.length>1?l.call(this):l.call(this)[0]},p.map=function(r,e){return i(i.map(this,r,e))},p.alter=function(r){return i.alter(this,r),this},function(r){for(var e=0;e<r.length;e++)(function(r){p[r]=function(e){var n,t=this;return e?(setTimeout(function(){e.call(t,p[r].call(t))}),this):(n=i[r](this),m(n)?i(n):n)}})(r[e])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(r){for(var e=0;e<r.length;e++)(function(r){p[r]=function(e,n){var t=this;return n?(setTimeout(function(){n.call(t,p[r].call(t,e))}),this):i(i[r](this,e))}})(r[e])}("row col".split(" ")),function(r){for(var e=0;e<r.length;e++)(function(r){p[r]=new Function("return jStat(jStat."+r+".apply(null, arguments));")})(r[e])}("create zeros ones rand identity".split(" ")),i}(Math),function(r,e){function n(r,e){return r-e}function t(r,n,t){return e.max(n,e.min(r,t))}var u=r.utils.isFunction;r.sum=function a(r){for(var a=0,e=r.length;--e>=0;)a+=r[e];return a},r.sumsqrd=function(r){for(var e=0,n=r.length;--n>=0;)e+=r[n]*r[n];return e},r.sumsqerr=function(e){for(var n,t=r.mean(e),u=0,i=e.length;--i>=0;)n=e[i]-t,u+=n*n;return u},r.product=function(r){for(var e=1,n=r.length;--n>=0;)e*=r[n];return e},r.min=function(r){for(var e=r[0],n=0;++n<r.length;)r[n]<e&&(e=r[n]);return e},r.max=function(r){for(var e=r[0],n=0;++n<r.length;)r[n]>e&&(e=r[n]);return e},r.mean=function(e){return r.sum(e)/e.length},r.meansqerr=function(e){return r.sumsqerr(e)/e.length},r.geomean=function(n){return e.pow(r.product(n),1/n.length)},r.median=function(r){var e=r.length,t=r.slice().sort(n);return 1&e?t[e/2|0]:(t[e/2-1]+t[e/2])/2},r.cumsum=function(r){var e,n=r.length,t=new Array(n);for(t[0]=r[0],e=1;n>e;e++)t[e]=t[e-1]+r[e];return t},r.diff=function(r){var e,n=[],t=r.length;for(e=1;t>e;e++)n.push(r[e]-r[e-1]);return n},r.mode=function(r){var e,t=r.length,u=r.slice().sort(n),i=1,a=0,o=0,s=[];for(e=0;t>e;e++)u[e]===u[e+1]?i++:(i>a?(s=[u[e]],a=i,o=0):i===a&&(s.push(u[e]),o++),i=1);return 0===o?s[0]:s},r.range=function(e){return r.max(e)-r.min(e)},r.variance=function(e,n){return r.sumsqerr(e)/(e.length-(n?1:0))},r.stdev=function(n,t){return e.sqrt(r.variance(n,t))},r.meandev=function(n){var t,u=0,i=r.mean(n);for(t=n.length-1;t>=0;t--)u+=e.abs(n[t]-i);return u/n.length},r.meddev=function(n){var t,u=0,i=r.median(n);for(t=n.length-1;t>=0;t--)u+=e.abs(n[t]-i);return u/n.length},r.coeffvar=function(e){return r.stdev(e)/r.mean(e)},r.quartiles=function(r){var t=r.length,u=r.slice().sort(n);return[u[e.round(t/4)-1],u[e.round(t/2)-1],u[e.round(3*t/4)-1]]},r.quantiles=function(r,u,i,a){var o,s,f,l,c,m,p=r.slice().sort(n),h=[u.length],g=r.length;for("undefined"==typeof i&&(i=3/8),"undefined"==typeof a&&(a=3/8),o=0;o<u.length;o++)s=u[o],f=i+s*(1-i-a),l=g*s+f,c=e.floor(t(l,1,g-1)),m=t(l-c,0,1),h[o]=(1-m)*p[c-1]+m*p[c];return h},r.percentileOfScore=function(r,e,n){var t,u,i=0,a=r.length,o=!1;for("strict"===n&&(o=!0),u=0;a>u;u++)t=r[u],(o&&e>t||!o&&e>=t)&&i++;return i/a},r.covariance=function(e,n){var t,u=r.mean(e),i=r.mean(n),a=e.length,o=new Array(a);for(t=0;a>t;t++)o[t]=(e[t]-u)*(n[t]-i);return r.sum(o)/(a-1)},r.corrcoeff=function(e,n){return r.covariance(e,n)/r.stdev(e,1)/r.stdev(n,1)};var i=r.prototype;i.cumsum=function(e,n){var t=[],a=0,o=this;if(u(e)&&(n=e,e=!1),n)return setTimeout(function(){n.call(o,i.cumsum.call(o,e))}),this;if(this.length>1){for(o=e===!0?this:this.transpose();a<o.length;a++)t[a]=r.cumsum(o[a]);return t}return r.cumsum(this[0],e)},function(e){for(var n=0;n<e.length;n++)(function(e){i[e]=function(n,t){var a=[],o=0,s=this;if(u(n)&&(t=n,n=!1),t)return setTimeout(function(){t.call(s,i[e].call(s,n))}),this;if(this.length>1){for(s=n===!0?this:this.transpose();o<s.length;o++)a[o]=r[e](s[o]);return n===!0?r[e](r.utils.toVector(a)):a}return r[e](this[0],n)}})(e[n])}("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles".split(" ")),function(e){for(var n=0;n<e.length;n++)(function(e){i[e]=function(){var n=[],t=0,a=this,o=Array.prototype.slice.call(arguments);if(u(o[o.length-1])){var s=o[o.length-1],f=o.slice(0,o.length-1);return setTimeout(function(){s.call(a,i[e].apply(a,f))}),this}var s=void 0,l=function(n){return r[e].apply(a,[n].concat(o))};if(this.length>1){for(a=a.transpose();t<a.length;t++)n[t]=l(a[t]);return n}return l(this[0])}})(e[n])}("quantiles percentileOfScore".split(" "))}(this.jStat,Math),function(r,e){r.gammaln=function(r){var n,t,u,i=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],o=1.000000000190015;for(u=(t=n=r)+5.5,u-=(n+.5)*e.log(u);6>i;i++)o+=a[i]/++t;return e.log(2.5066282746310007*o/n)-u},r.gammafn=function(r){var n,t,u,i,a=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],o=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],s=!1,f=0,l=0,c=0,m=r;if(0>=m){if(i=m%1+3.6e-16,!i)return 1/0;s=(1&m?-1:1)*e.PI/e.sin(e.PI*i),m=1-m}for(u=m,t=1>m?m++:(m-=f=(0|m)-1)-1,n=0;8>n;++n)c=(c+a[n])*t,l=l*t+o[n];if(i=c/l+1,m>u)i/=u;else if(u>m)for(n=0;f>n;++n)i*=m,m++;return s&&(i=s/i),i},r.gammap=function(n,t){var u,i=r.gammaln(n),a=n,o=1/n,s=o,f=t+1-n,l=1/1e-30,c=1/f,m=c,p=1,h=-~(8.5*e.log(n>=1?n:1/n)+.4*n+17);if(0>t||0>=n)return 0/0;if(n+1>t){for(;h>=p;p++)o+=s*=t/++a;return o*e.exp(-t+n*e.log(t)-i)}for(;h>=p;p++)u=-p*(p-n),f+=2,c=u*c+f,l=f+u/l,c=1/c,m*=c*l;return 1-m*e.exp(-t+n*e.log(t)-i)},r.factorialln=function(e){return 0>e?0/0:r.gammaln(e+1)},r.factorial=function(e){return 0>e?0/0:r.gammafn(e+1)},r.combination=function(n,t){return n>170||t>170?e.exp(r.combinationln(n,t)):r.factorial(n)/r.factorial(t)/r.factorial(n-t)},r.combinationln=function(e,n){return r.factorialln(e)-r.factorialln(n)-r.factorialln(e-n)},r.permutation=function(e,n){return r.factorial(e)/r.factorial(e-n)},r.betafn=function(n,t){return 0>=n||0>=t?void 0:n+t>170?e.exp(r.betaln(n,t)):r.gammafn(n)*r.gammafn(t)/r.gammafn(n+t)},r.betaln=function(e,n){return r.gammaln(e)+r.gammaln(n)-r.gammaln(e+n)},r.betacf=function(r,n,t){var u,i,a,o,s=1e-30,f=1,l=n+t,c=n+1,m=n-1,p=1,h=1-l*r/c;for(e.abs(h)<s&&(h=s),h=1/h,o=h;100>=f&&(u=2*f,i=f*(t-f)*r/((m+u)*(n+u)),h=1+i*h,e.abs(h)<s&&(h=s),p=1+i/p,e.abs(p)<s&&(p=s),h=1/h,o*=h*p,i=-(n+f)*(l+f)*r/((n+u)*(c+u)),h=1+i*h,e.abs(h)<s&&(h=s),p=1+i/p,e.abs(p)<s&&(p=s),h=1/h,a=h*p,o*=a,!(e.abs(a-1)<3e-7));f++);return o},r.gammapinv=function(n,t){var u,i,a,o,s,f,l,c=0,m=t-1,p=1e-8,h=r.gammaln(t);if(n>=1)return e.max(100,t+100*e.sqrt(t));if(0>=n)return 0;for(t>1?(f=e.log(m),l=e.exp(m*(f-1)-h),s=.5>n?n:1-n,a=e.sqrt(-2*e.log(s)),u=(2.30753+.27061*a)/(1+a*(.99229+.04481*a))-a,.5>n&&(u=-u),u=e.max(.001,t*e.pow(1-1/(9*t)-u/(3*e.sqrt(t)),3))):(a=1-t*(.253+.12*t),u=a>n?e.pow(n/a,1/t):1-e.log(1-(n-a)/(1-a)));12>c;c++){if(0>=u)return 0;if(i=r.gammap(t,u)-n,a=t>1?l*e.exp(-(u-m)+m*(e.log(u)-f)):e.exp(-u+m*e.log(u)-h),o=i/a,u-=a=o/(1-.5*e.min(1,o*((t-1)/u-1))),0>=u&&(u=.5*(u+a)),e.abs(a)<p*u)break}return u},r.erf=function(r){var n,t,u,i,a=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],o=a.length-1,s=!1,f=0,l=0;for(0>r&&(r=-r,s=!0),n=2/(2+r),t=4*n-2;o>0;o--)u=f,f=t*f-l+a[o],l=u;return i=n*e.exp(-r*r+.5*(a[0]+t*f)-l),s?i-1:1-i},r.erfc=function(e){return 1-r.erf(e)},r.erfcinv=function(n){var t,u,i,a,o=0;if(n>=2)return-100;if(0>=n)return 100;for(a=1>n?n:2-n,i=e.sqrt(-2*e.log(a/2)),t=-.70711*((2.30753+.27061*i)/(1+i*(.99229+.04481*i))-i);2>o;o++)u=r.erfc(t)-a,t+=u/(1.1283791670955126*e.exp(-t*t)-t*u);return 1>n?t:-t},r.ibetainv=function(n,t,u){var i,a,o,s,f,l,c,m,p,h,g,v=1e-8,d=t-1,y=u-1,b=0;if(0>=n)return 0;if(n>=1)return 1;for(t>=1&&u>=1?(o=.5>n?n:1-n,s=e.sqrt(-2*e.log(o)),c=(2.30753+.27061*s)/(1+s*(.99229+.04481*s))-s,.5>n&&(c=-c),m=(c*c-3)/6,p=2/(1/(2*t-1)+1/(2*u-1)),h=c*e.sqrt(m+p)/p-(1/(2*u-1)-1/(2*t-1))*(m+5/6-2/(3*p)),c=t/(t+u*e.exp(2*h))):(i=e.log(t/(t+u)),a=e.log(u/(t+u)),s=e.exp(t*i)/t,f=e.exp(u*a)/u,h=s+f,c=s/h>n?e.pow(t*h*n,1/t):1-e.pow(u*h*(1-n),1/u)),g=-r.gammaln(t)-r.gammaln(u)+r.gammaln(t+u);10>b;b++){if(0===c||1===c)return c;if(l=r.ibeta(c,t,u)-n,s=e.exp(d*e.log(c)+y*e.log(1-c)+g),f=l/s,c-=s=f/(1-.5*e.min(1,f*(d/c-y/(1-c)))),0>=c&&(c=.5*(c+s)),c>=1&&(c=.5*(c+s+1)),e.abs(s)<v*c&&b>0)break}return c},r.ibeta=function(n,t,u){var i=0===n||1===n?0:e.exp(r.gammaln(t+u)-r.gammaln(t)-r.gammaln(u)+t*e.log(n)+u*e.log(1-n));return 0>n||n>1?!1:(t+1)/(t+u+2)>n?i*r.betacf(n,t,u)/t:1-i*r.betacf(1-n,u,t)/u},r.randn=function(n,t){var u,i,a,o,s;if(t||(t=n),n)return r.create(n,t,function(){return r.randn()});do u=e.random(),i=1.7156*(e.random()-.5),a=u-.449871,o=e.abs(i)+.386595,s=a*a+o*(.196*o-.25472*a);while(s>.27597&&(s>.27846||i*i>-4*e.log(u)*u*u));return i/u},r.randg=function(n,t,u){var i,a,o,s,f,l,c=n;if(u||(u=t),n||(n=1),t)return l=r.zeros(t,u),l.alter(function(){return r.randg(n)}),l;1>n&&(n+=1),i=n-1/3,a=1/e.sqrt(9*i);do{do f=r.randn(),s=1+a*f;while(0>=s);s=s*s*s,o=e.random()}while(o>1-.331*e.pow(f,4)&&e.log(o)>.5*f*f+i*(1-s+e.log(s)));if(n==c)return i*s;do o=e.random();while(0===o);return e.pow(o,1/c)*i*s},function(e){for(var n=0;n<e.length;n++)(function(e){r.fn[e]=function(){return r(r.map(this,function(n){return r[e](n)}))}})(e[n])}("gammaln gammafn factorial factorialln".split(" ")),function(e){for(var n=0;n<e.length;n++)(function(e){r.fn[e]=function(){return r(r[e].apply(null,arguments))}})(e[n])}("randn".split(" "))}(this.jStat,Math),function(r,e){!function(e){for(var n=0;n<e.length;n++)(function(e){r[e]=function(r,e,n){return this instanceof arguments.callee?(this._a=r,this._b=e,this._c=n,this):new arguments.callee(r,e,n)},r.fn[e]=function(n,t,u){var i=r[e](n,t,u);return i.data=this,i},r[e].prototype.sample=function(n){var t=this._a,u=this._b,i=this._c;return n?r.alter(n,function(){return r[e].sample(t,u,i)}):r[e].sample(t,u,i)},function(n){for(var t=0;t<n.length;t++)(function(n){r[e].prototype[n]=function(t){var u=this._a,i=this._b,a=this._c;return t||0===t||(t=this.data),"number"!=typeof t?r.fn.map.call(t,function(t){return r[e][n](t,u,i,a)}):r[e][n](t,u,i,a)}})(n[t])}("pdf cdf inv".split(" ")),function(n){for(var t=0;t<n.length;t++)(function(n){r[e].prototype[n]=function(){return r[e][n](this._a,this._b,this._c)}})(n[t])}("mean median mode variance".split(" "))})(e[n])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" ")),r.extend(r.beta,{pdf:function(n,t,u){return n>1||0>n?0:1==t&&1==u?1:512>t||512>u?e.pow(n,t-1)*e.pow(1-n,u-1)/r.betafn(t,u):e.exp((t-1)*e.log(n)+(u-1)*e.log(1-n)-r.betaln(t,u))},cdf:function(e,n,t){return e>1||0>e?1*(e>1):r.ibeta(e,n,t)},inv:function(e,n,t){return r.ibetainv(e,n,t)},mean:function(r,e){return r/(r+e)},median:function(){throw new Error("median not yet implemented")},mode:function(r,n){return r*n/(e.pow(r+n,2)*(r+n+1))},sample:function(e,n){var t=r.randg(e);return t/(t+r.randg(n))},variance:function(r,n){return r*n/(e.pow(r+n,2)*(r+n+1))}}),r.extend(r.centralF,{pdf:function(n,t,u){return 0>n?void 0:e.sqrt(e.pow(t*n,t)*e.pow(u,u)/e.pow(t*n+u,t+u))/(n*r.betafn(t/2,u/2))},cdf:function(e,n,t){return r.ibeta(n*e/(n*e+t),n/2,t/2)},inv:function(e,n,t){return t/(n*(1/r.ibetainv(e,n/2,t/2)-1))},mean:function(r,e){return e>2?e/(e-2):void 0},mode:function(r,e){return r>2?e*(r-2)/(r*(e+2)):void 0},sample:function(e,n){var t=2*r.randg(e/2),u=2*r.randg(n/2);return t/e/(u/n)},variance:function(r,e){return 4>=e?void 0:2*e*e*(r+e-2)/(r*(e-2)*(e-2)*(e-4))}}),r.extend(r.cauchy,{pdf:function(r,n,t){return t/(e.pow(r-n,2)+e.pow(t,2))/e.PI},cdf:function(r,n,t){return e.atan((r-n)/t)/e.PI+.5},inv:function(r,n,t){return n+t*e.tan(e.PI*(r-.5))},median:function(r){return r},mode:function(r){return r},sample:function(n,t){return r.randn()*e.sqrt(1/(2*r.randg(.5)))*t+n}}),r.extend(r.chisquare,{pdf:function(n,t){return e.exp((t/2-1)*e.log(n)-n/2-t/2*e.log(2)-r.gammaln(t/2))},cdf:function(e,n){return r.gammap(n/2,e/2)},inv:function(e,n){return 2*r.gammapinv(e,.5*n)},mean:function(r){return r},median:function(r){return r*e.pow(1-2/(9*r),3)},mode:function(r){return r-2>0?r-2:0},sample:function(e){return 2*r.randg(e/2)},variance:function(r){return 2*r}}),r.extend(r.exponential,{pdf:function(r,n){return 0>r?0:n*e.exp(-n*r)},cdf:function(r,n){return 0>r?0:1-e.exp(-n*r)},inv:function(r,n){return-e.log(1-r)/n},mean:function(r){return 1/r},median:function(r){return 1/r*e.log(2)},mode:function(){return 0},sample:function(r){return-1/r*e.log(e.random())},variance:function(r){return e.pow(r,-2)}}),r.extend(r.gamma,{pdf:function(n,t,u){return e.exp((t-1)*e.log(n)-n/u-r.gammaln(t)-t*e.log(u))},cdf:function(e,n,t){return r.gammap(n,e/t)},inv:function(e,n,t){return r.gammapinv(e,n)*t},mean:function(r,e){return r*e},mode:function(r,e){return r>1?(r-1)*e:void 0},sample:function(e,n){return r.randg(e)*n},variance:function(r,e){return r*e*e}}),r.extend(r.invgamma,{pdf:function(n,t,u){return e.exp(-(t+1)*e.log(n)-u/n-r.gammaln(t)+t*e.log(u))},cdf:function(e,n,t){return 1-r.gammap(n,t/e)},inv:function(e,n,t){return t/r.gammapinv(1-e,n)},mean:function(r,e){return r>1?e/(r-1):void 0},mode:function(r,e){return e/(r+1)},sample:function(e,n){return n/r.randg(e)},variance:function(r,e){return 2>=r?void 0:e*e/((r-1)*(r-1)*(r-2))}}),r.extend(r.kumaraswamy,{pdf:function(r,n,t){return e.exp(e.log(n)+e.log(t)+(n-1)*e.log(r)+(t-1)*e.log(1-e.pow(r,n)))},cdf:function(r,n,t){return 1-e.pow(1-e.pow(r,n),t)},mean:function(e,n){return n*r.gammafn(1+1/e)*r.gammafn(n)/r.gammafn(1+1/e+n)},median:function(r,n){return e.pow(1-e.pow(2,-1/n),1/r)},mode:function(r,n){return r>=1&&n>=1&&1!==r&&1!==n?e.pow((r-1)/(r*n-1),1/r):void 0},variance:function(){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(r,n,t){return e.exp(-e.log(r)-.5*e.log(2*e.PI)-e.log(t)-e.pow(e.log(r)-n,2)/(2*t*t))},cdf:function(n,t,u){return.5+.5*r.erf((e.log(n)-t)/e.sqrt(2*u*u))},inv:function(n,t,u){return e.exp(-1.4142135623730951*u*r.erfcinv(2*n)+t)},mean:function(r,n){return e.exp(r+n*n/2)},median:function(r){return e.exp(r)},mode:function(r,n){return e.exp(r-n*n)},sample:function(n,t){return e.exp(r.randn()*t+n)},variance:function(r,n){return(e.exp(n*n)-1)*e.exp(2*r+n*n)}}),r.extend(r.normal,{pdf:function(r,n,t){return e.exp(-.5*e.log(2*e.PI)-e.log(t)-e.pow(r-n,2)/(2*t*t))},cdf:function(n,t,u){return.5*(1+r.erf((n-t)/e.sqrt(2*u*u)))},inv:function(e,n,t){return-1.4142135623730951*t*r.erfcinv(2*e)+n},mean:function(r){return r},median:function(r){return r},mode:function(r){return r},sample:function(e,n){return r.randn()*n+e},variance:function(r,e){return e*e}}),r.extend(r.pareto,{pdf:function(r,n,t){return n>=r?void 0:t*e.pow(n,t)/e.pow(r,t+1)},cdf:function(r,n,t){return 1-e.pow(n/r,t)},mean:function(r,n){return 1>=n?void 0:n*e.pow(r,n)/(n-1)},median:function(r,n){return r*n*e.SQRT2},mode:function(r){return r},variance:function(r,n){return 2>=n?void 0:r*r*n/(e.pow(n-1,2)*(n-2))}}),r.extend(r.studentt,{pdf:function(n,t){return r.gammafn((t+1)/2)/(e.sqrt(t*e.PI)*r.gammafn(t/2))*e.pow(1+n*n/t,-((t+1)/2))},cdf:function(n,t){var u=t/2;return r.ibeta((n+e.sqrt(n*n+t))/(2*e.sqrt(n*n+t)),u,u)},inv:function(n,t){var u=r.ibetainv(2*e.min(n,1-n),.5*t,.5);return u=e.sqrt(t*(1-u)/u),n>.5?u:-u},mean:function(r){return r>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(n){return r.randn()*e.sqrt(n/(2*r.randg(n/2)))},variance:function(r){return r>2?r/(r-2):r>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(r,n,t){return 0>r?0:t/n*e.pow(r/n,t-1)*e.exp(-e.pow(r/n,t))},cdf:function(r,n,t){return 0>r?0:1-e.exp(-e.pow(r/n,t))},inv:function(r,n,t){return n*e.pow(-e.log(1-r),1/t)},mean:function(e,n){return e*r.gammafn(1+1/n)},median:function(r,n){return r*e.pow(e.log(2),1/n)},mode:function(r,n){return 1>=n?void 0:r*e.pow((n-1)/n,1/n)},sample:function(r,n){return r*e.pow(-e.log(e.random()),1/n)},variance:function(n,t){return n*n*r.gammafn(1+2/t)-e.pow(this.mean(n,t),2)}}),r.extend(r.uniform,{pdf:function(r,e,n){return e>r||r>n?0:1/(n-e)},cdf:function(r,e,n){return e>r?0:n>r?(r-e)/(n-e):1},mean:function(r,e){return.5*(r+e)},median:function(e,n){return r.mean(e,n)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(r,n){return r/2+n/2+(n/2-r/2)*(2*e.random()-1)},variance:function(r,n){return e.pow(n-r,2)/12}}),r.extend(r.binomial,{pdf:function(n,t,u){return 0===u||1===u?t*u===n?1:0:r.combination(t,n)*e.pow(u,n)*e.pow(1-u,t-n)},cdf:function(e,n,t){var u=[],i=0;if(0>e)return 0;if(n>e){for(;e>=i;i++)u[i]=r.binomial.pdf(i,n,t);return r.sum(u)}return 1}}),r.extend(r.negbin,{pdf:function(n,t,u){return n!==n|0?!1:0>n?0:r.combination(n+t-1,t-1)*e.pow(1-u,n)*e.pow(u,t)},cdf:function(e,n,t){var u=0,i=0;if(0>e)return 0;for(;e>=i;i++)u+=r.negbin.pdf(i,n,t);return u}}),r.extend(r.hypgeom,{pdf:function(n,t,u,i){if(n!==n|0)return!1;if(0>n||u-(t-i)>n)return 0;if(n>i||n>u)return 0;if(2*u>t)return 2*i>t?r.hypgeom.pdf(t-u-i+n,t,t-u,t-i):r.hypgeom.pdf(i-n,t,t-u,i);if(2*i>t)return r.hypgeom.pdf(u-n,t,u,t-i);if(i>u)return r.hypgeom.pdf(n,t,i,u);for(var a=1,o=0,s=0;n>s;s++){for(;a>1&&i>o;)a*=1-u/(t-o),o++;a*=(i-s)*(u-s)/((s+1)*(t-u-i+s+1))}for(;i>o;o++)a*=1-u/(t-o);return e.min(1,e.max(0,a))},cdf:function(n,t,u,i){if(0>n||u-(t-i)>n)return 0;if(n>=i||n>=u)return 1;if(2*u>t)return 2*i>t?r.hypgeom.cdf(t-u-i+n,t,t-u,t-i):1-r.hypgeom.cdf(i-n-1,t,t-u,i);if(2*i>t)return 1-r.hypgeom.cdf(u-n-1,t,u,t-i);if(i>u)return r.hypgeom.cdf(n,t,i,u);for(var a=1,o=1,s=0,f=0;n>f;f++){for(;a>1&&i>s;){var l=1-u/(t-s);o*=l,a*=l,s++}o*=(i-f)*(u-f)/((f+1)*(t-u-i+f+1)),a+=o}for(;i>s;s++)a*=1-u/(t-s);return e.min(1,e.max(0,a))}}),r.extend(r.poisson,{pdf:function(n,t){return e.pow(t,n)*e.exp(-t)/r.factorial(n)},cdf:function(e,n){var t=[],u=0;if(0>e)return 0;for(;e>=u;u++)t.push(r.poisson.pdf(u,n));return r.sum(t)},mean:function(r){return r},variance:function(r){return r},sample:function(r){var n=1,t=0,u=e.exp(-r);do t++,n*=e.random();while(n>u);return t-1}}),r.extend(r.triangular,{pdf:function(r,e,n,t){return e>=n||e>t||t>n?void 0:e>r||r>n?0:t>=r?2*(r-e)/((n-e)*(t-e)):2*(n-r)/((n-e)*(n-t))},cdf:function(r,n,t,u){return n>=t||n>u||u>t?void 0:n>r?0:u>=r?e.pow(r-n,2)/((t-n)*(u-n)):1-e.pow(t-r,2)/((t-n)*(t-u))},mean:function(r,e,n){return(r+e+n)/3},median:function(r,n,t){return(r+n)/2>=t?n-e.sqrt((n-r)*(n-t))/e.sqrt(2):t>(r+n)/2?r+e.sqrt((n-r)*(t-r))/e.sqrt(2):void 0},mode:function(r,e,n){return n},sample:function(r,n,t){var u=e.random();return(t-r)/(n-r)>u?r+e.sqrt(u*(n-r)*(t-r)):n-e.sqrt((1-u)*(n-r)*(n-t))},variance:function(r,e,n){return(r*r+e*e+n*n-r*e-r*n-e*n)/18}})}(this.jStat,Math),function(r,e){var n=Array.prototype.push,t=r.utils.isArray;r.extend({add:function(e,n){return t(n)?(t(n[0])||(n=[n]),r.map(e,function(r,e,t){return r+n[e][t]})):r.map(e,function(r){return r+n})},subtract:function(e,n){return t(n)?(t(n[0])||(n=[n]),r.map(e,function(r,e,t){return r-n[e][t]||0})):r.map(e,function(r){return r-n})},divide:function(e,n){return t(n)?(t(n[0])||(n=[n]),r.multiply(e,r.inv(n))):r.map(e,function(r){return r/n})},multiply:function(e,n){var u,i,a,o,s=e.length,f=e[0].length,l=r.zeros(s,a=t(n)?n[0].length:f),c=0;if(t(n)){for(;a>c;c++)for(u=0;s>u;u++){for(o=0,i=0;f>i;i++)o+=e[u][i]*n[i][c];l[u][c]=o}return 1===s&&1===c?l[0][0]:l}return r.map(e,function(r){return r*n})},dot:function(e,n){t(e[0])||(e=[e]),t(n[0])||(n=[n]);for(var u,i,a=1===e[0].length&&1!==e.length?r.transpose(e):e,o=1===n[0].length&&1!==n.length?r.transpose(n):n,s=[],f=0,l=a.length,c=a[0].length;l>f;f++){for(s[f]=[],u=0,i=0;c>i;i++)u+=a[f][i]*o[f][i];s[f]=u}return 1===s.length?s[0]:s},pow:function(n,t){return r.map(n,function(r){return e.pow(r,t)})},abs:function(n){return r.map(n,function(r){return e.abs(r)})},norm:function(r,n){var u=0,i=0;for(isNaN(n)&&(n=2),t(r[0])&&(r=r[0]);i<r.length;i++)u+=e.pow(e.abs(r[i]),n);return e.pow(u,1/n)},angle:function(n,t){return e.acos(r.dot(n,t)/(r.norm(n)*r.norm(t)))},aug:function(r,e){for(var t=r.slice(),u=0;u<t.length;u++)n.apply(t[u],e[u]);return t},inv:function(e){for(var n,t=e.length,u=e[0].length,i=r.identity(t,u),a=r.gauss_jordan(e,i),o=[],s=0;t>s;s++)for(o[s]=[],n=u-1;n<a[0].length;n++)o[s][n-u]=a[s][n];return o},det:function(r){var e,n=r.length,t=2*n,u=new Array(t),i=n-1,a=t-1,o=i-n+1,s=a,f=0,l=0;if(2===n)return r[0][0]*r[1][1]-r[0][1]*r[1][0];for(;t>f;f++)u[f]=1;for(f=0;n>f;f++){for(e=0;n>e;e++)u[0>o?o+n:o]*=r[f][e],u[n>s?s+n:s]*=r[f][e],o++,s--;o=--i-n+1,s=--a}for(f=0;n>f;f++)l+=u[f];for(;t>f;f++)l-=u[f];return l},gauss_elimination:function(n,t){var u,i,a,o,s=0,f=0,l=n.length,c=n[0].length,m=1,p=0,h=[];for(n=r.aug(n,t),u=n[0].length;l>s;s++){for(i=n[s][s],f=s,o=s+1;c>o;o++)i<e.abs(n[o][s])&&(i=n[o][s],f=o);if(f!=s)for(o=0;u>o;o++)a=n[s][o],n[s][o]=n[f][o],n[f][o]=a;for(f=s+1;l>f;f++)for(m=n[f][s]/n[s][s],o=s;u>o;o++)n[f][o]=n[f][o]-m*n[s][o]}for(s=l-1;s>=0;s--){for(p=0,f=s+1;l-1>=f;f++)p=h[f]*n[s][f];h[s]=(n[s][u-1]-p)/n[s][s]}return h},gauss_jordan:function(n,t){for(var u=r.aug(n,t),i=u.length,a=u[0].length,o=0;i>o;o++){for(var s=o,f=o+1;i>f;f++)e.abs(u[f][o])>e.abs(u[s][o])&&(s=f);var l=u[o];u[o]=u[s],u[s]=l;for(var f=o+1;i>f;f++){c=u[f][o]/u[o][o];for(var m=o;a>m;m++)u[f][m]-=u[o][m]*c}}for(var o=i-1;o>=0;o--){c=u[o][o];for(var f=0;o>f;f++)for(var m=a-1;m>o-1;m--)u[f][m]-=u[o][m]*u[f][o]/c;u[o][o]/=c;for(var m=i;a>m;m++)u[o][m]/=c}return u},lu:function(){throw new Error("lu not yet implemented")},cholesky:function(){throw new Error("cholesky not yet implemented")},gauss_jacobi:function(n,t,u,i){for(var a,o,s,f,l=0,c=0,m=n.length,p=[],h=[],g=[];m>l;l++)for(p[l]=[],h[l]=[],g[l]=[],c=0;m>c;c++)l>c?(p[l][c]=n[l][c],h[l][c]=g[l][c]=0):c>l?(h[l][c]=n[l][c],p[l][c]=g[l][c]=0):(g[l][c]=n[l][c],p[l][c]=h[l][c]=0);
for(s=r.multiply(r.multiply(r.inv(g),r.add(p,h)),-1),o=r.multiply(r.inv(g),t),a=u,f=r.add(r.multiply(s,u),o),l=2;e.abs(r.norm(r.subtract(f,a)))>i;)a=f,f=r.add(r.multiply(s,a),o),l++;return f},gauss_seidel:function(n,t,u,i){for(var a,o,s,f,l,c=0,m=n.length,p=[],h=[],g=[];m>c;c++)for(p[c]=[],h[c]=[],g[c]=[],a=0;m>a;a++)c>a?(p[c][a]=n[c][a],h[c][a]=g[c][a]=0):a>c?(h[c][a]=n[c][a],p[c][a]=g[c][a]=0):(g[c][a]=n[c][a],p[c][a]=h[c][a]=0);for(f=r.multiply(r.multiply(r.inv(r.add(g,p)),h),-1),s=r.multiply(r.inv(r.add(g,p)),t),o=u,l=r.add(r.multiply(f,u),s),c=2;e.abs(r.norm(r.subtract(l,o)))>i;)o=l,l=r.add(r.multiply(f,o),s),c+=1;return l},SOR:function(n,t,u,i,a){for(var o,s,f,l,c,m=0,p=n.length,h=[],g=[],v=[];p>m;m++)for(h[m]=[],g[m]=[],v[m]=[],o=0;p>o;o++)m>o?(h[m][o]=n[m][o],g[m][o]=v[m][o]=0):o>m?(g[m][o]=n[m][o],h[m][o]=v[m][o]=0):(v[m][o]=n[m][o],h[m][o]=g[m][o]=0);for(l=r.multiply(r.inv(r.add(v,r.multiply(h,a))),r.subtract(r.multiply(v,1-a),r.multiply(g,a))),f=r.multiply(r.multiply(r.inv(r.add(v,r.multiply(h,a))),t),a),s=u,c=r.add(r.multiply(l,u),f),m=2;e.abs(r.norm(r.subtract(c,s)))>i;)s=c,c=r.add(r.multiply(l,s),f),m++;return c},householder:function(n){for(var t,u,i,a,o,s=n.length,f=n[0].length,l=0,c=[],m=[];s-1>l;l++){for(t=0,a=l+1;f>a;a++)t+=n[a][l]*n[a][l];for(o=n[l+1][l]>0?-1:1,t=o*e.sqrt(t),u=e.sqrt((t*t-n[l+1][l]*t)/2),c=r.zeros(s,1),c[l+1][0]=(n[l+1][l]-t)/(2*u),i=l+2;s>i;i++)c[i][0]=n[i][l]/(2*u);m=r.subtract(r.identity(s,f),r.multiply(r.multiply(c,r.transpose(c)),2)),n=r.multiply(m,r.multiply(n,m))}return n},QR:function(n,t){for(var u,i,a,o,s,f,l=n.length,c=n[0].length,m=0,p=[],h=[],g=[];l-1>m;m++){for(i=0,u=m+1;c>u;u++)i+=n[u][m]*n[u][m];for(s=n[m+1][m]>0?-1:1,i=s*e.sqrt(i),a=e.sqrt((i*i-n[m+1][m]*i)/2),p=r.zeros(l,1),p[m+1][0]=(n[m+1][m]-i)/(2*a),o=m+2;l>o;o++)p[o][0]=n[o][m]/(2*a);h=r.subtract(r.identity(l,c),r.multiply(r.multiply(p,r.transpose(p)),2)),n=r.multiply(h,n),t=r.multiply(h,t)}for(m=l-1;m>=0;m--){for(f=0,u=m+1;c-1>=u;u++)f=g[u]*n[m][u];g[m]=t[m][0]/n[m][m]}return g},jacobi:function(n){for(var t,u,i,a,o,s,f,l,c=1,m=0,p=n.length,h=r.identity(p,p),g=[];1===c;){for(m++,s=n[0][1],a=0,o=1,u=0;p>u;u++)for(i=0;p>i;i++)u!=i&&s<e.abs(n[u][i])&&(s=e.abs(n[u][i]),a=u,o=i);for(f=n[a][a]===n[o][o]?n[a][o]>0?e.PI/4:-e.PI/4:e.atan(2*n[a][o]/(n[a][a]-n[o][o]))/2,l=r.identity(p,p),l[a][a]=e.cos(f),l[a][o]=-e.sin(f),l[o][a]=e.sin(f),l[o][o]=e.cos(f),h=r.multiply(h,l),t=r.multiply(r.multiply(r.inv(l),n),l),n=t,c=0,u=1;p>u;u++)for(i=1;p>i;i++)u!=i&&e.abs(n[u][i])>.001&&(c=1)}for(u=0;p>u;u++)g.push(n[u][u]);return[h,g]},rungekutta:function(r,e,n,t,u,i){var a,o,s,f,l;if(2===i)for(;n>=t;)a=e*r(t,u),o=e*r(t+e,u+a),s=u+(a+o)/2,u=s,t+=e;if(4===i)for(;n>=t;)a=e*r(t,u),o=e*r(t+e/2,u+a/2),f=e*r(t+e/2,u+o/2),l=e*r(t+e,u+f),s=u+(a+2*o+2*f+l)/6,u=s,t+=e;return u},romberg:function(r,n,t,u){for(var i,a,o,s,f,l=0,c=(t-n)/2,m=[],p=[],h=[];u/2>l;){for(f=r(n),o=n,s=0;t>=o;o+=c,s++)m[s]=o;for(i=m.length,o=1;i-1>o;o++)f+=(o%2!==0?4:2)*r(m[o]);f=c/3*(f+r(t)),h[l]=f,c/=2,l++}for(a=h.length,i=1;1!==a;){for(o=0;a-1>o;o++)p[o]=(e.pow(4,i)*h[o+1]-h[o])/(e.pow(4,i)-1);a=p.length,h=p,p=[],i++}return h},richardson:function(r,n,t,u){function i(r,e){for(var n,t=0,u=r.length;u>t;t++)r[t]===e&&(n=t);return n}for(var a,o,s,f,l,c=(r.length,e.abs(t-r[i(r,t)+1])),m=0,p=[],h=[];u>=c;)a=i(r,t+u),o=i(r,t),p[m]=(n[a]-2*n[o]+n[2*o-a])/(u*u),u/=2,m++;for(f=p.length,s=1;1!=f;){for(l=0;f-1>l;l++)h[l]=(e.pow(4,s)*p[l+1]-p[l])/(e.pow(4,s)-1);f=h.length,p=h,h=[],s++}return p},simpson:function(r,e,n,t){for(var u,i=(n-e)/t,a=r(e),o=[],s=e,f=0,l=1;n>=s;s+=i,f++)o[f]=s;for(u=o.length;u-1>l;l++)a+=(l%2!==0?4:2)*r(o[l]);return i/3*(a+r(n))},hermite:function(r,e,n,t){for(var u,i=r.length,a=0,o=0,s=[],f=[],l=[],c=[];i>o;o++){for(s[o]=1,u=0;i>u;u++)o!=u&&(s[o]*=(t-r[u])/(r[o]-r[u]));for(f[o]=0,u=0;i>u;u++)o!=u&&(f[o]+=1/(r[o]-r[u]));l[o]=(1-2*(t-r[o])*f[o])*s[o]*s[o],c[o]=(t-r[o])*s[o]*s[o],a+=l[o]*e[o]+c[o]*n[o]}return a},lagrange:function(r,e,n){for(var t,u,i=0,a=0,o=r.length;o>a;a++){for(u=e[a],t=0;o>t;t++)a!=t&&(u*=(n-r[t])/(r[a]-r[t]));i+=u}return i},cubic_spline:function(e,n,t){for(var u,i=e.length,a=0,o=[],s=[],f=[],l=[],c=[],m=[],p=[];i-1>a;a++)c[a]=e[a+1]-e[a];for(f[0]=0,a=1;i-1>a;a++)f[a]=3/c[a]*(n[a+1]-n[a])-3/c[a-1]*(n[a]-n[a-1]);for(a=1;i-1>a;a++)o[a]=[],s[a]=[],o[a][a-1]=c[a-1],o[a][a]=2*(c[a-1]+c[a]),o[a][a+1]=c[a],s[a][0]=f[a];for(l=r.multiply(r.inv(o),s),u=0;i-1>u;u++)m[u]=(n[u+1]-n[u])/c[u]-c[u]*(l[u+1][0]+2*l[u][0])/3,p[u]=(l[u+1][0]-l[u][0])/(3*c[u]);for(u=0;i>u&&!(e[u]>t);u++);return u-=1,n[u]+(t-e[u])*m[u]+r.sq(t-e[u])*l[u]+(t-e[u])*r.sq(t-e[u])*p[u]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(e){var n,t,u=e.length,i=e[0].length,a=0,o=[],s=[],f=[],l=[],c=[],m=[],p=[],h=[],g=[],v=[];for(a=0;u>a;a++)o[a]=r.sum(e[a])/i;for(a=0;i>a;a++)for(p[a]=[],n=0;u>n;n++)p[a][n]=e[n][a]-o[n];for(p=r.transpose(p),a=0;u>a;a++)for(h[a]=[],n=0;u>n;n++)h[a][n]=r.dot([p[a]],[p[n]])/(i-1);for(f=r.jacobi(h),g=f[0],s=f[1],v=r.transpose(g),a=0;a<s.length;a++)for(n=a;n<s.length;n++)s[a]<s[n]&&(t=s[a],s[a]=s[n],s[n]=t,l=v[a],v[a]=v[n],v[n]=l);for(m=r.transpose(p),a=0;u>a;a++)for(c[a]=[],n=0;n<m.length;n++)c[a][n]=r.dot([v[a]],[m[n]]);return[e,s,v,c]}}),function(e){for(var n=0;n<e.length;n++)(function(e){r.fn[e]=function(n,t){var u=this;return t?(setTimeout(function(){t.call(u,r.fn[e].call(u,n))},15),this):"number"==typeof r[e](this,n)?r[e](this,n):r(r[e](this,n))}})(e[n])}("add divide multiply subtract dot pow abs norm angle".split(" "))}(this.jStat,Math),function(r,e){var n=[].slice,t=r.utils.isNumber;r.extend({zscore:function(){var e=n.call(arguments);return t(e[1])?(e[0]-e[1])/e[2]:(e[0]-r.mean(e[1]))/r.stdev(e[1],e[2])},ztest:function(){var u=n.call(arguments);if(4===u.length){if(t(u[1])){var i=r.zscore(u[0],u[1],u[2]);return 1===u[3]?r.normal.cdf(-e.abs(i),0,1):2*r.normal.cdf(-e.abs(i),0,1)}var i=u[0];return 1===u[2]?r.normal.cdf(-e.abs(i),0,1):2*r.normal.cdf(-e.abs(i),0,1)}var i=r.zscore(u[0],u[1],u[3]);return 1===u[1]?r.normal.cdf(-e.abs(i),0,1):2*r.normal.cdf(-e.abs(i),0,1)}}),r.extend(r.fn,{zscore:function(r,e){return(r-this.mean())/this.stdev(e)},ztest:function(n,t,u){var i=e.abs(this.zscore(n,u));return 1===t?r.normal.cdf(-i,0,1):2*r.normal.cdf(-i,0,1)}}),r.extend({tscore:function(){var t=n.call(arguments);return 4===t.length?(t[0]-t[1])/(t[2]/e.sqrt(t[3])):(t[0]-r.mean(t[1]))/(r.stdev(t[1],!0)/e.sqrt(t[1].length))},ttest:function(){var u,i=n.call(arguments);return 5===i.length?(u=e.abs(r.tscore(i[0],i[1],i[2],i[3])),1===i[4]?r.studentt.cdf(-u,i[3]-1):2*r.studentt.cdf(-u,i[3]-1)):t(i[1])?(u=e.abs(i[0]),1==i[2]?r.studentt.cdf(-u,i[1]-1):2*r.studentt.cdf(-u,i[1]-1)):(u=e.abs(r.tscore(i[0],i[1])),1==i[2]?r.studentt.cdf(-u,i[1].length-1):2*r.studentt.cdf(-u,i[1].length-1))}}),r.extend(r.fn,{tscore:function(r){return(r-this.mean())/(this.stdev(!0)/e.sqrt(this.cols()))},ttest:function(n,t){return 1===t?1-r.studentt.cdf(e.abs(this.tscore(n)),this.cols()-1):2*r.studentt.cdf(-e.abs(this.tscore(n)),this.cols()-1)}}),r.extend({anovafscore:function(){var t,u,i,a,o,s,f,l,c=n.call(arguments);if(1===c.length){for(o=new Array(c[0].length),f=0;f<c[0].length;f++)o[f]=c[0][f];c=o}if(2===c.length)return r.variance(c[0])/r.variance(c[1]);for(u=new Array,f=0;f<c.length;f++)u=u.concat(c[f]);for(i=r.mean(u),t=0,f=0;f<c.length;f++)t+=c[f].length*e.pow(r.mean(c[f])-i,2);for(t/=c.length-1,s=0,f=0;f<c.length;f++)for(a=r.mean(c[f]),l=0;l<c[f].length;l++)s+=e.pow(c[f][l]-a,2);return s/=u.length-c.length,t/s},anovaftest:function(){var e,u,i,a,o=n.call(arguments);if(t(o[0]))return 1-r.centralF.cdf(o[0],o[1],o[2]);for(anovafscore=r.anovafscore(o),e=o.length-1,i=0,a=0;a<o.length;a++)i+=o[a].length;return u=i-e-1,1-r.centralF.cdf(anovafscore,e,u)},ftest:function(e,n,t){return 1-r.centralF.cdf(e,n,t)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var e,n=0;for(e=0;e<this.length;e++)n+=this[e].length;return r.ftest(this.anovafscore(),this.length-1,n-this.length)}}),r.extend({normalci:function(){var t,u=n.call(arguments),i=new Array(2);return t=e.abs(4===u.length?r.normal.inv(u[1]/2,0,1)*u[2]/e.sqrt(u[3]):r.normal.inv(u[1]/2,0,1)*r.stdev(u[2])/e.sqrt(u[2].length)),i[0]=u[0]-t,i[1]=u[0]+t,i},tci:function(){var t,u=n.call(arguments),i=new Array(2);return t=e.abs(4===u.length?r.studentt.inv(u[1]/2,u[3]-1)*u[2]/e.sqrt(u[3]):r.studentt.inv(u[1]/2,u[2].length-1)*r.stdev(u[2],!0)/e.sqrt(u[2].length)),i[0]=u[0]-t,i[1]=u[0]+t,i},significant:function(r,e){return e>r}}),r.extend(r.fn,{normalci:function(e,n){return r.normalci(e,n,this.toArray())},tci:function(e,n){return r.tci(e,n,this.toArray())}})}(this.jStat,Math)}])});;
(function(sheetCalc) {
  sheetCalc.Cell = function (val)
  {
    this.hasFormula = false;
    this.isNumber = false;
    this.set(val);
    return this;
  };

  sheetCalc.Cell.prototype.value = function(val){
    if( arguments.length > 0){
      //return this.set(val);
      this.set(val);
    }else{
      return this.get();
    }
  };

  sheetCalc.Cell.prototype.get = function(){
    if(this.hasFormula){
      return this.content();
    } else {
      return this.content;
    }
  };

  sheetCalc.Cell.prototype.set = function(val){
    this.hasFormula = typeof(val) == 'function' ? true : false;
    var parsed = parseFloat(val);
    if(!isNaN(parsed))
      this.content = parsed;
    else
      this.content = val;

  };

}( window.sheetCalc = window.sheetCalc || {}));
