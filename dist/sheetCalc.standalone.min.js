/*! sheetCalc 2015-01-06 */
function _horner(a,b){return a.reduce(function(a,c){return b*a+c},0)}function _bessel_iter(a,b,c,d,e){e||(e=-1);var f,g=2/a;if(0===b)return c;if(1===b)return d;for(var h=1;h!=b;++h)f=d*h*g+e*c,c=d,d=f;return d}function _bessel_wrap(a,b,c,d,e){return function(f,g){if(0===g)return a(f);if(1===g)return b(f);if(0>g)throw c+": Order ("+g+") must be nonnegative";if(1==d&&0===f)throw c+": Undefined when x == 0";if(2==d&&0>=f)throw c+": Undefined when x <= 0";var h=a(f),i=b(f);return _bessel_iter(f,g,h,i,e)}}this.j$=this.jStat=function(a){function b(b,c){var d=b>c?b:c;return a.pow(10,17-~~(a.log(d>0?d:-d)*a.LOG10E))}function c(a){return"[object Function]"===l.call(a)}function d(a){return"number"==typeof a&&a===a}function e(a){return j.apply([],a)}function f(){return new f._init(arguments)}function g(){return 0}function h(){return 1}function i(a,b){return a===b?1:0}var j=Array.prototype.concat,k=Array.prototype.slice,l=Object.prototype.toString,m=Array.isArray||function(a){return"[object Array]"===l.call(a)};f.fn=f.prototype,f._init=function(a){var b;if(m(a[0]))if(m(a[0][0])){for(c(a[1])&&(a[0]=f.map(a[0],a[1])),b=0;b<a[0].length;b++)this[b]=a[0][b];this.length=a[0].length}else this[0]=c(a[1])?f.map(a[0],a[1]):a[0],this.length=1;else if(d(a[0]))this[0]=f.seq.apply(null,a),this.length=1;else{if(a[0]instanceof f)return f(a[0].toArray());this[0]=[],this.length=1}return this},f._init.prototype=f.prototype,f._init.constructor=f,f.utils={calcRdx:b,isArray:m,isFunction:c,isNumber:d,toVector:e},f.extend=function(a){var b,c;if(1===arguments.length){for(c in a)f[c]=a[c];return this}for(b=1;b<arguments.length;b++)for(c in arguments[b])a[c]=arguments[b][c];return a},f.rows=function(a){return a.length||1},f.cols=function(a){return a[0].length||1},f.dimensions=function(a){return{rows:f.rows(a),cols:f.cols(a)}},f.row=function(a,b){return a[b]},f.col=function(a,b){for(var c=new Array(a.length),d=0;d<a.length;d++)c[d]=[a[d][b]];return c},f.diag=function(a){for(var b=f.rows(a),c=new Array(b),d=0;b>d;d++)c[d]=[a[d][d]];return c},f.antidiag=function(a){for(var b=f.rows(a)-1,c=new Array(b),d=0;b>=0;b--,d++)c[d]=[a[d][b]];return c},f.transpose=function(a){var b,c,d,e,f,g=[];for(m(a[0])||(a=[a]),c=a.length,d=a[0].length,f=0;d>f;f++){for(b=new Array(c),e=0;c>e;e++)b[e]=a[e][f];g.push(b)}return 1===g.length?g[0]:g},f.map=function(a,b,c){var d,e,f,g,h;for(m(a[0])||(a=[a]),e=a.length,f=a[0].length,g=c?a:new Array(e),d=0;e>d;d++)for(g[d]||(g[d]=new Array(f)),h=0;f>h;h++)g[d][h]=b(a[d][h],d,h);return 1===g.length?g[0]:g},f.alter=function(a,b){return f.map(a,b,!0)},f.create=function(a,b,d){var e,f,g=new Array(a);for(c(b)&&(d=b,b=a),e=0;a>e;e++)for(g[e]=new Array(b),f=0;b>f;f++)g[e][f]=d(e,f);return g},f.zeros=function(a,b){return d(b)||(b=a),f.create(a,b,g)},f.ones=function(a,b){return d(b)||(b=a),f.create(a,b,h)},f.rand=function(b,c){return d(c)||(c=b),f.create(b,c,a.random)},f.identity=function(a,b){return d(b)||(b=a),f.create(a,b,i)},f.symmetric=function(a){var b,c,d=a.length;if(a.length!==a[0].length)return!1;for(b=0;d>b;b++)for(c=0;d>c;c++)if(a[c][b]!==a[b][c])return!1;return!0},f.clear=function(a){return f.alter(a,g)},f.seq=function(a,d,e,f){c(f)||(f=!1);var g,h=[],i=b(a,d),j=(d*i-a*i)/((e-1)*i),k=a;for(g=0;d>=k;g++,k=(a*i+j*i*g)/i)h.push(f?f(k,g):k);return h};var n=f.prototype;return n.length=0,n.push=Array.prototype.push,n.sort=Array.prototype.sort,n.splice=Array.prototype.splice,n.slice=Array.prototype.slice,n.toArray=function(){return this.length>1?k.call(this):k.call(this)[0]},n.map=function(a,b){return f(f.map(this,a,b))},n.alter=function(a){return f.alter(this,a),this},function(a){for(var b=0;b<a.length;b++)(function(a){n[a]=function(b){var c,d=this;return b?(setTimeout(function(){b.call(d,n[a].call(d))}),this):(c=f[a](this),m(c)?f(c):c)}})(a[b])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(a){for(var b=0;b<a.length;b++)(function(a){n[a]=function(b,c){var d=this;return c?(setTimeout(function(){c.call(d,n[a].call(d,b))}),this):f(f[a](this,b))}})(a[b])}("row col".split(" ")),function(a){for(var b=0;b<a.length;b++)(function(a){n[a]=new Function("return jStat(jStat."+a+".apply(null, arguments));")})(a[b])}("create zeros ones rand identity".split(" ")),f}(Math),function(a,b){function c(a,b){return a-b}function d(a,c,d){return b.max(c,b.min(a,d))}var e=a.utils.isFunction;a.sum=function g(a){for(var g=0,b=a.length;--b>=0;)g+=a[b];return g},a.sumsqrd=function(a){for(var b=0,c=a.length;--c>=0;)b+=a[c]*a[c];return b},a.sumsqerr=function(b){for(var c,d=a.mean(b),e=0,f=b.length;--f>=0;)c=b[f]-d,e+=c*c;return e},a.product=function(a){for(var b=1,c=a.length;--c>=0;)b*=a[c];return b},a.min=function(a){for(var b=a[0],c=0;++c<a.length;)a[c]<b&&(b=a[c]);return b},a.max=function(a){for(var b=a[0],c=0;++c<a.length;)a[c]>b&&(b=a[c]);return b},a.mean=function(b){return a.sum(b)/b.length},a.meansqerr=function(b){return a.sumsqerr(b)/b.length},a.geomean=function(c){return b.pow(a.product(c),1/c.length)},a.median=function(a){var b=a.length,d=a.slice().sort(c);return 1&b?d[b/2|0]:(d[b/2-1]+d[b/2])/2},a.cumsum=function(a){var b,c=a.length,d=new Array(c);for(d[0]=a[0],b=1;c>b;b++)d[b]=d[b-1]+a[b];return d},a.diff=function(a){var b,c=[],d=a.length;for(b=1;d>b;b++)c.push(a[b]-a[b-1]);return c},a.mode=function(a){var b,d=a.length,e=a.slice().sort(c),f=1,g=0,h=0,i=[];for(b=0;d>b;b++)e[b]===e[b+1]?f++:(f>g?(i=[e[b]],g=f,h=0):f===g&&(i.push(e[b]),h++),f=1);return 0===h?i[0]:i},a.range=function(b){return a.max(b)-a.min(b)},a.variance=function(b,c){return a.sumsqerr(b)/(b.length-(c?1:0))},a.stdev=function(c,d){return b.sqrt(a.variance(c,d))},a.meandev=function(c){var d,e=0,f=a.mean(c);for(d=c.length-1;d>=0;d--)e+=b.abs(c[d]-f);return e/c.length},a.meddev=function(c){var d,e=0,f=a.median(c);for(d=c.length-1;d>=0;d--)e+=b.abs(c[d]-f);return e/c.length},a.coeffvar=function(b){return a.stdev(b)/a.mean(b)},a.quartiles=function(a){var d=a.length,e=a.slice().sort(c);return[e[b.round(d/4)-1],e[b.round(d/2)-1],e[b.round(3*d/4)-1]]},a.quantiles=function(a,e,f,g){var h,i,j,k,l,m,n=a.slice().sort(c),o=[e.length],p=a.length;for("undefined"==typeof f&&(f=3/8),"undefined"==typeof g&&(g=3/8),h=0;h<e.length;h++)i=e[h],j=f+i*(1-f-g),k=p*i+j,l=b.floor(d(k,1,p-1)),m=d(k-l,0,1),o[h]=(1-m)*n[l-1]+m*n[l];return o},a.percentileOfScore=function(a,b,c){var d,e,f=0,g=a.length,h=!1;for("strict"===c&&(h=!0),e=0;g>e;e++)d=a[e],(h&&b>d||!h&&b>=d)&&f++;return f/g},a.covariance=function(b,c){var d,e=a.mean(b),f=a.mean(c),g=b.length,h=new Array(g);for(d=0;g>d;d++)h[d]=(b[d]-e)*(c[d]-f);return a.sum(h)/(g-1)},a.corrcoeff=function(b,c){return a.covariance(b,c)/a.stdev(b,1)/a.stdev(c,1)};var f=a.prototype;f.cumsum=function(b,c){var d=[],g=0,h=this;if(e(b)&&(c=b,b=!1),c)return setTimeout(function(){c.call(h,f.cumsum.call(h,b))}),this;if(this.length>1){for(h=b===!0?this:this.transpose();g<h.length;g++)d[g]=a.cumsum(h[g]);return d}return a.cumsum(this[0],b)},function(b){for(var c=0;c<b.length;c++)(function(b){f[b]=function(c,d){var g=[],h=0,i=this;if(e(c)&&(d=c,c=!1),d)return setTimeout(function(){d.call(i,f[b].call(i,c))}),this;if(this.length>1){for(i=c===!0?this:this.transpose();h<i.length;h++)g[h]=a[b](i[h]);return c===!0?a[b](a.utils.toVector(g)):g}return a[b](this[0],c)}})(b[c])}("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles".split(" ")),function(b){for(var c=0;c<b.length;c++)(function(b){f[b]=function(){var c=[],d=0,g=this,h=Array.prototype.slice.call(arguments);if(e(h[h.length-1])){var i=h[h.length-1],j=h.slice(0,h.length-1);return setTimeout(function(){i.call(g,f[b].apply(g,j))}),this}var i=void 0,k=function(c){return a[b].apply(g,[c].concat(h))};if(this.length>1){for(g=g.transpose();d<g.length;d++)c[d]=k(g[d]);return c}return k(this[0])}})(b[c])}("quantiles percentileOfScore".split(" "))}(this.jStat,Math),function(a,b){a.gammaln=function(a){var c,d,e,f=0,g=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],h=1.000000000190015;for(e=(d=c=a)+5.5,e-=(c+.5)*b.log(e);6>f;f++)h+=g[f]/++d;return b.log(2.5066282746310007*h/c)-e},a.gammafn=function(a){var c,d,e,f,g=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],h=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],i=!1,j=0,k=0,l=0,m=a;if(0>=m){if(f=m%1+3.6e-16,!f)return 1/0;i=(1&m?-1:1)*b.PI/b.sin(b.PI*f),m=1-m}for(e=m,d=1>m?m++:(m-=j=(0|m)-1)-1,c=0;8>c;++c)l=(l+g[c])*d,k=k*d+h[c];if(f=l/k+1,m>e)f/=e;else if(e>m)for(c=0;j>c;++c)f*=m,m++;return i&&(f=i/f),f},a.gammap=function(c,d){var e,f=a.gammaln(c),g=c,h=1/c,i=h,j=d+1-c,k=1/1e-30,l=1/j,m=l,n=1,o=-~(8.5*b.log(c>=1?c:1/c)+.4*c+17);if(0>d||0>=c)return 0/0;if(c+1>d){for(;o>=n;n++)h+=i*=d/++g;return h*b.exp(-d+c*b.log(d)-f)}for(;o>=n;n++)e=-n*(n-c),j+=2,l=e*l+j,k=j+e/k,l=1/l,m*=l*k;return 1-m*b.exp(-d+c*b.log(d)-f)},a.factorialln=function(b){return 0>b?0/0:a.gammaln(b+1)},a.factorial=function(b){return 0>b?0/0:a.gammafn(b+1)},a.combination=function(c,d){return c>170||d>170?b.exp(a.combinationln(c,d)):a.factorial(c)/a.factorial(d)/a.factorial(c-d)},a.combinationln=function(b,c){return a.factorialln(b)-a.factorialln(c)-a.factorialln(b-c)},a.permutation=function(b,c){return a.factorial(b)/a.factorial(b-c)},a.betafn=function(c,d){return 0>=c||0>=d?void 0:c+d>170?b.exp(a.betaln(c,d)):a.gammafn(c)*a.gammafn(d)/a.gammafn(c+d)},a.betaln=function(b,c){return a.gammaln(b)+a.gammaln(c)-a.gammaln(b+c)},a.betacf=function(a,c,d){var e,f,g,h,i=1e-30,j=1,k=c+d,l=c+1,m=c-1,n=1,o=1-k*a/l;for(b.abs(o)<i&&(o=i),o=1/o,h=o;100>=j&&(e=2*j,f=j*(d-j)*a/((m+e)*(c+e)),o=1+f*o,b.abs(o)<i&&(o=i),n=1+f/n,b.abs(n)<i&&(n=i),o=1/o,h*=o*n,f=-(c+j)*(k+j)*a/((c+e)*(l+e)),o=1+f*o,b.abs(o)<i&&(o=i),n=1+f/n,b.abs(n)<i&&(n=i),o=1/o,g=o*n,h*=g,!(b.abs(g-1)<3e-7));j++);return h},a.gammapinv=function(c,d){var e,f,g,h,i,j,k,l=0,m=d-1,n=1e-8,o=a.gammaln(d);if(c>=1)return b.max(100,d+100*b.sqrt(d));if(0>=c)return 0;for(d>1?(j=b.log(m),k=b.exp(m*(j-1)-o),i=.5>c?c:1-c,g=b.sqrt(-2*b.log(i)),e=(2.30753+.27061*g)/(1+g*(.99229+.04481*g))-g,.5>c&&(e=-e),e=b.max(.001,d*b.pow(1-1/(9*d)-e/(3*b.sqrt(d)),3))):(g=1-d*(.253+.12*d),e=g>c?b.pow(c/g,1/d):1-b.log(1-(c-g)/(1-g)));12>l;l++){if(0>=e)return 0;if(f=a.gammap(d,e)-c,g=d>1?k*b.exp(-(e-m)+m*(b.log(e)-j)):b.exp(-e+m*b.log(e)-o),h=f/g,e-=g=h/(1-.5*b.min(1,h*((d-1)/e-1))),0>=e&&(e=.5*(e+g)),b.abs(g)<n*e)break}return e},a.erf=function(a){var c,d,e,f,g=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],h=g.length-1,i=!1,j=0,k=0;for(0>a&&(a=-a,i=!0),c=2/(2+a),d=4*c-2;h>0;h--)e=j,j=d*j-k+g[h],k=e;return f=c*b.exp(-a*a+.5*(g[0]+d*j)-k),i?f-1:1-f},a.erfc=function(b){return 1-a.erf(b)},a.erfcinv=function(c){var d,e,f,g,h=0;if(c>=2)return-100;if(0>=c)return 100;for(g=1>c?c:2-c,f=b.sqrt(-2*b.log(g/2)),d=-.70711*((2.30753+.27061*f)/(1+f*(.99229+.04481*f))-f);2>h;h++)e=a.erfc(d)-g,d+=e/(1.1283791670955126*b.exp(-d*d)-d*e);return 1>c?d:-d},a.ibetainv=function(c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=1e-8,r=d-1,s=e-1,t=0;if(0>=c)return 0;if(c>=1)return 1;for(d>=1&&e>=1?(h=.5>c?c:1-c,i=b.sqrt(-2*b.log(h)),l=(2.30753+.27061*i)/(1+i*(.99229+.04481*i))-i,.5>c&&(l=-l),m=(l*l-3)/6,n=2/(1/(2*d-1)+1/(2*e-1)),o=l*b.sqrt(m+n)/n-(1/(2*e-1)-1/(2*d-1))*(m+5/6-2/(3*n)),l=d/(d+e*b.exp(2*o))):(f=b.log(d/(d+e)),g=b.log(e/(d+e)),i=b.exp(d*f)/d,j=b.exp(e*g)/e,o=i+j,l=i/o>c?b.pow(d*o*c,1/d):1-b.pow(e*o*(1-c),1/e)),p=-a.gammaln(d)-a.gammaln(e)+a.gammaln(d+e);10>t;t++){if(0===l||1===l)return l;if(k=a.ibeta(l,d,e)-c,i=b.exp(r*b.log(l)+s*b.log(1-l)+p),j=k/i,l-=i=j/(1-.5*b.min(1,j*(r/l-s/(1-l)))),0>=l&&(l=.5*(l+i)),l>=1&&(l=.5*(l+i+1)),b.abs(i)<q*l&&t>0)break}return l},a.ibeta=function(c,d,e){var f=0===c||1===c?0:b.exp(a.gammaln(d+e)-a.gammaln(d)-a.gammaln(e)+d*b.log(c)+e*b.log(1-c));return 0>c||c>1?!1:(d+1)/(d+e+2)>c?f*a.betacf(c,d,e)/d:1-f*a.betacf(1-c,e,d)/e},a.randn=function(c,d){var e,f,g,h,i;if(d||(d=c),c)return a.create(c,d,function(){return a.randn()});do e=b.random(),f=1.7156*(b.random()-.5),g=e-.449871,h=b.abs(f)+.386595,i=g*g+h*(.196*h-.25472*g);while(i>.27597&&(i>.27846||f*f>-4*b.log(e)*e*e));return f/e},a.randg=function(c,d,e){var f,g,h,i,j,k,l=c;if(e||(e=d),c||(c=1),d)return k=a.zeros(d,e),k.alter(function(){return a.randg(c)}),k;1>c&&(c+=1),f=c-1/3,g=1/b.sqrt(9*f);do{do j=a.randn(),i=1+g*j;while(0>=i);i=i*i*i,h=b.random()}while(h>1-.331*b.pow(j,4)&&b.log(h)>.5*j*j+f*(1-i+b.log(i)));if(c==l)return f*i;do h=b.random();while(0===h);return b.pow(h,1/l)*f*i},function(b){for(var c=0;c<b.length;c++)(function(b){a.fn[b]=function(){return a(a.map(this,function(c){return a[b](c)}))}})(b[c])}("gammaln gammafn factorial factorialln".split(" ")),function(b){for(var c=0;c<b.length;c++)(function(b){a.fn[b]=function(){return a(a[b].apply(null,arguments))}})(b[c])}("randn".split(" "))}(this.jStat,Math),function(a,b){!function(b){for(var c=0;c<b.length;c++)(function(b){a[b]=function(a,b,c){return this instanceof arguments.callee?(this._a=a,this._b=b,this._c=c,this):new arguments.callee(a,b,c)},a.fn[b]=function(c,d,e){var f=a[b](c,d,e);return f.data=this,f},a[b].prototype.sample=function(c){var d=this._a,e=this._b,f=this._c;return c?a.alter(c,function(){return a[b].sample(d,e,f)}):a[b].sample(d,e,f)},function(c){for(var d=0;d<c.length;d++)(function(c){a[b].prototype[c]=function(d){var e=this._a,f=this._b,g=this._c;return!d&&0!==d&&(d=this.data),"number"!=typeof d?a.fn.map.call(d,function(d){return a[b][c](d,e,f,g)}):a[b][c](d,e,f,g)}})(c[d])}("pdf cdf inv".split(" ")),function(c){for(var d=0;d<c.length;d++)(function(c){a[b].prototype[c]=function(){return a[b][c](this._a,this._b,this._c)}})(c[d])}("mean median mode variance".split(" "))})(b[c])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" ")),a.extend(a.beta,{pdf:function(c,d,e){return c>1||0>c?0:1==d&&1==e?1:512>d||512>e?b.pow(c,d-1)*b.pow(1-c,e-1)/a.betafn(d,e):b.exp((d-1)*b.log(c)+(e-1)*b.log(1-c)-a.betaln(d,e))},cdf:function(b,c,d){return b>1||0>b?1*(b>1):a.ibeta(b,c,d)},inv:function(b,c,d){return a.ibetainv(b,c,d)},mean:function(a,b){return a/(a+b)},median:function(){throw new Error("median not yet implemented")},mode:function(a,c){return a*c/(b.pow(a+c,2)*(a+c+1))},sample:function(b,c){var d=a.randg(b);return d/(d+a.randg(c))},variance:function(a,c){return a*c/(b.pow(a+c,2)*(a+c+1))}}),a.extend(a.centralF,{pdf:function(c,d,e){return 0>c?void 0:b.sqrt(b.pow(d*c,d)*b.pow(e,e)/b.pow(d*c+e,d+e))/(c*a.betafn(d/2,e/2))},cdf:function(b,c,d){return a.ibeta(c*b/(c*b+d),c/2,d/2)},inv:function(b,c,d){return d/(c*(1/a.ibetainv(b,c/2,d/2)-1))},mean:function(a,b){return b>2?b/(b-2):void 0},mode:function(a,b){return a>2?b*(a-2)/(a*(b+2)):void 0},sample:function(b,c){var d=2*a.randg(b/2),e=2*a.randg(c/2);return d/b/(e/c)},variance:function(a,b){return 4>=b?void 0:2*b*b*(a+b-2)/(a*(b-2)*(b-2)*(b-4))}}),a.extend(a.cauchy,{pdf:function(a,c,d){return d/(b.pow(a-c,2)+b.pow(d,2))/b.PI},cdf:function(a,c,d){return b.atan((a-c)/d)/b.PI+.5},inv:function(a,c,d){return c+d*b.tan(b.PI*(a-.5))},median:function(a){return a},mode:function(a){return a},sample:function(c,d){return a.randn()*b.sqrt(1/(2*a.randg(.5)))*d+c}}),a.extend(a.chisquare,{pdf:function(c,d){return b.exp((d/2-1)*b.log(c)-c/2-d/2*b.log(2)-a.gammaln(d/2))},cdf:function(b,c){return a.gammap(c/2,b/2)},inv:function(b,c){return 2*a.gammapinv(b,.5*c)},mean:function(a){return a},median:function(a){return a*b.pow(1-2/(9*a),3)},mode:function(a){return a-2>0?a-2:0},sample:function(b){return 2*a.randg(b/2)},variance:function(a){return 2*a}}),a.extend(a.exponential,{pdf:function(a,c){return 0>a?0:c*b.exp(-c*a)},cdf:function(a,c){return 0>a?0:1-b.exp(-c*a)},inv:function(a,c){return-b.log(1-a)/c},mean:function(a){return 1/a},median:function(a){return 1/a*b.log(2)},mode:function(){return 0},sample:function(a){return-1/a*b.log(b.random())},variance:function(a){return b.pow(a,-2)}}),a.extend(a.gamma,{pdf:function(c,d,e){return b.exp((d-1)*b.log(c)-c/e-a.gammaln(d)-d*b.log(e))},cdf:function(b,c,d){return a.gammap(c,b/d)},inv:function(b,c,d){return a.gammapinv(b,c)*d},mean:function(a,b){return a*b},mode:function(a,b){return a>1?(a-1)*b:void 0},sample:function(b,c){return a.randg(b)*c},variance:function(a,b){return a*b*b}}),a.extend(a.invgamma,{pdf:function(c,d,e){return b.exp(-(d+1)*b.log(c)-e/c-a.gammaln(d)+d*b.log(e))},cdf:function(b,c,d){return 1-a.gammap(c,d/b)},inv:function(b,c,d){return d/a.gammapinv(1-b,c)},mean:function(a,b){return a>1?b/(a-1):void 0},mode:function(a,b){return b/(a+1)},sample:function(b,c){return c/a.randg(b)},variance:function(a,b){return 2>=a?void 0:b*b/((a-1)*(a-1)*(a-2))}}),a.extend(a.kumaraswamy,{pdf:function(a,c,d){return b.exp(b.log(c)+b.log(d)+(c-1)*b.log(a)+(d-1)*b.log(1-b.pow(a,c)))},cdf:function(a,c,d){return 1-b.pow(1-b.pow(a,c),d)},mean:function(b,c){return c*a.gammafn(1+1/b)*a.gammafn(c)/a.gammafn(1+1/b+c)},median:function(a,c){return b.pow(1-b.pow(2,-1/c),1/a)},mode:function(a,c){return a>=1&&c>=1&&1!==a&&1!==c?b.pow((a-1)/(a*c-1),1/a):void 0},variance:function(){throw new Error("variance not yet implemented")}}),a.extend(a.lognormal,{pdf:function(a,c,d){return b.exp(-b.log(a)-.5*b.log(2*b.PI)-b.log(d)-b.pow(b.log(a)-c,2)/(2*d*d))},cdf:function(c,d,e){return.5+.5*a.erf((b.log(c)-d)/b.sqrt(2*e*e))},inv:function(c,d,e){return b.exp(-1.4142135623730951*e*a.erfcinv(2*c)+d)},mean:function(a,c){return b.exp(a+c*c/2)},median:function(a){return b.exp(a)},mode:function(a,c){return b.exp(a-c*c)},sample:function(c,d){return b.exp(a.randn()*d+c)},variance:function(a,c){return(b.exp(c*c)-1)*b.exp(2*a+c*c)}}),a.extend(a.normal,{pdf:function(a,c,d){return b.exp(-.5*b.log(2*b.PI)-b.log(d)-b.pow(a-c,2)/(2*d*d))},cdf:function(c,d,e){return.5*(1+a.erf((c-d)/b.sqrt(2*e*e)))},inv:function(b,c,d){return-1.4142135623730951*d*a.erfcinv(2*b)+c},mean:function(a){return a},median:function(a){return a},mode:function(a){return a},sample:function(b,c){return a.randn()*c+b},variance:function(a,b){return b*b}}),a.extend(a.pareto,{pdf:function(a,c,d){return c>=a?void 0:d*b.pow(c,d)/b.pow(a,d+1)},cdf:function(a,c,d){return 1-b.pow(c/a,d)},mean:function(a,c){return 1>=c?void 0:c*b.pow(a,c)/(c-1)},median:function(a,c){return a*c*b.SQRT2},mode:function(a){return a},variance:function(a,c){return 2>=c?void 0:a*a*c/(b.pow(c-1,2)*(c-2))}}),a.extend(a.studentt,{pdf:function(c,d){return a.gammafn((d+1)/2)/(b.sqrt(d*b.PI)*a.gammafn(d/2))*b.pow(1+c*c/d,-((d+1)/2))},cdf:function(c,d){var e=d/2;return a.ibeta((c+b.sqrt(c*c+d))/(2*b.sqrt(c*c+d)),e,e)},inv:function(c,d){var e=a.ibetainv(2*b.min(c,1-c),.5*d,.5);return e=b.sqrt(d*(1-e)/e),c>.5?e:-e},mean:function(a){return a>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(c){return a.randn()*b.sqrt(c/(2*a.randg(c/2)))},variance:function(a){return a>2?a/(a-2):a>1?1/0:void 0}}),a.extend(a.weibull,{pdf:function(a,c,d){return 0>a?0:d/c*b.pow(a/c,d-1)*b.exp(-b.pow(a/c,d))},cdf:function(a,c,d){return 0>a?0:1-b.exp(-b.pow(a/c,d))},inv:function(a,c,d){return c*b.pow(-b.log(1-a),1/d)},mean:function(b,c){return b*a.gammafn(1+1/c)},median:function(a,c){return a*b.pow(b.log(2),1/c)},mode:function(a,c){return 1>=c?void 0:a*b.pow((c-1)/c,1/c)},sample:function(a,c){return a*b.pow(-b.log(b.random()),1/c)},variance:function(c,d){return c*c*a.gammafn(1+2/d)-b.pow(this.mean(c,d),2)}}),a.extend(a.uniform,{pdf:function(a,b,c){return b>a||a>c?0:1/(c-b)},cdf:function(a,b,c){return b>a?0:c>a?(a-b)/(c-b):1},mean:function(a,b){return.5*(a+b)},median:function(b,c){return a.mean(b,c)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(a,c){return a/2+c/2+(c/2-a/2)*(2*b.random()-1)},variance:function(a,c){return b.pow(c-a,2)/12}}),a.extend(a.binomial,{pdf:function(c,d,e){return 0===e||1===e?d*e===c?1:0:a.combination(d,c)*b.pow(e,c)*b.pow(1-e,d-c)},cdf:function(b,c,d){var e=[],f=0;if(0>b)return 0;if(c>b){for(;b>=f;f++)e[f]=a.binomial.pdf(f,c,d);return a.sum(e)}return 1}}),a.extend(a.negbin,{pdf:function(c,d,e){return c!==c|0?!1:0>c?0:a.combination(c+d-1,d-1)*b.pow(1-e,c)*b.pow(e,d)},cdf:function(b,c,d){var e=0,f=0;if(0>b)return 0;for(;b>=f;f++)e+=a.negbin.pdf(f,c,d);return e}}),a.extend(a.hypgeom,{pdf:function(c,d,e,f){if(c!==c|0)return!1;if(0>c||e-(d-f)>c)return 0;if(c>f||c>e)return 0;if(2*e>d)return 2*f>d?a.hypgeom.pdf(d-e-f+c,d,d-e,d-f):a.hypgeom.pdf(f-c,d,d-e,f);if(2*f>d)return a.hypgeom.pdf(e-c,d,e,d-f);if(f>e)return a.hypgeom.pdf(c,d,f,e);for(var g=1,h=0,i=0;c>i;i++){for(;g>1&&f>h;)g*=1-e/(d-h),h++;g*=(f-i)*(e-i)/((i+1)*(d-e-f+i+1))}for(;f>h;h++)g*=1-e/(d-h);return b.min(1,b.max(0,g))},cdf:function(c,d,e,f){if(0>c||e-(d-f)>c)return 0;if(c>=f||c>=e)return 1;if(2*e>d)return 2*f>d?a.hypgeom.cdf(d-e-f+c,d,d-e,d-f):1-a.hypgeom.cdf(f-c-1,d,d-e,f);if(2*f>d)return 1-a.hypgeom.cdf(e-c-1,d,e,d-f);if(f>e)return a.hypgeom.cdf(c,d,f,e);for(var g=1,h=1,i=0,j=0;c>j;j++){for(;g>1&&f>i;){var k=1-e/(d-i);h*=k,g*=k,i++}h*=(f-j)*(e-j)/((j+1)*(d-e-f+j+1)),g+=h}for(;f>i;i++)g*=1-e/(d-i);return b.min(1,b.max(0,g))}}),a.extend(a.poisson,{pdf:function(c,d){return b.pow(d,c)*b.exp(-d)/a.factorial(c)},cdf:function(b,c){var d=[],e=0;if(0>b)return 0;for(;b>=e;e++)d.push(a.poisson.pdf(e,c));return a.sum(d)},mean:function(a){return a},variance:function(a){return a},sample:function(a){var c=1,d=0,e=b.exp(-a);do d++,c*=b.random();while(c>e);return d-1}}),a.extend(a.triangular,{pdf:function(a,b,c,d){return b>=c||b>d||d>c?void 0:b>a||a>c?0:d>=a?2*(a-b)/((c-b)*(d-b)):2*(c-a)/((c-b)*(c-d))},cdf:function(a,c,d,e){return c>=d||c>e||e>d?void 0:c>a?0:e>=a?b.pow(a-c,2)/((d-c)*(e-c)):1-b.pow(d-a,2)/((d-c)*(d-e))},mean:function(a,b,c){return(a+b+c)/3},median:function(a,c,d){return(a+c)/2>=d?c-b.sqrt((c-a)*(c-d))/b.sqrt(2):d>(a+c)/2?a+b.sqrt((c-a)*(d-a))/b.sqrt(2):void 0},mode:function(a,b,c){return c},sample:function(a,c,d){var e=b.random();return(d-a)/(c-a)>e?a+b.sqrt(e*(c-a)*(d-a)):c-b.sqrt((1-e)*(c-a)*(c-d))},variance:function(a,b,c){return(a*a+b*b+c*c-a*b-a*c-b*c)/18}})}(this.jStat,Math),function(a,b){var d=Array.prototype.push,e=a.utils.isArray;a.extend({add:function(b,c){return e(c)?(e(c[0])||(c=[c]),a.map(b,function(a,b,d){return a+c[b][d]})):a.map(b,function(a){return a+c})},subtract:function(b,c){return e(c)?(e(c[0])||(c=[c]),a.map(b,function(a,b,d){return a-c[b][d]||0})):a.map(b,function(a){return a-c})},divide:function(b,c){return e(c)?(e(c[0])||(c=[c]),a.multiply(b,a.inv(c))):a.map(b,function(a){return a/c})},multiply:function(b,c){var d,f,g,h,i=b.length,j=b[0].length,k=a.zeros(i,g=e(c)?c[0].length:j),l=0;if(e(c)){for(;g>l;l++)for(d=0;i>d;d++){for(h=0,f=0;j>f;f++)h+=b[d][f]*c[f][l];k[d][l]=h}return 1===i&&1===l?k[0][0]:k}return a.map(b,function(a){return a*c})},dot:function(b,c){e(b[0])||(b=[b]),e(c[0])||(c=[c]);for(var d,f,g=1===b[0].length&&1!==b.length?a.transpose(b):b,h=1===c[0].length&&1!==c.length?a.transpose(c):c,i=[],j=0,k=g.length,l=g[0].length;k>j;j++){for(i[j]=[],d=0,f=0;l>f;f++)d+=g[j][f]*h[j][f];i[j]=d}return 1===i.length?i[0]:i},pow:function(c,d){return a.map(c,function(a){return b.pow(a,d)})},abs:function(c){return a.map(c,function(a){return b.abs(a)})},norm:function(a,c){var d=0,f=0;for(isNaN(c)&&(c=2),e(a[0])&&(a=a[0]);f<a.length;f++)d+=b.pow(b.abs(a[f]),c);return b.pow(d,1/c)},angle:function(c,d){return b.acos(a.dot(c,d)/(a.norm(c)*a.norm(d)))},aug:function(a,b){for(var c=a.slice(),e=0;e<c.length;e++)d.apply(c[e],b[e]);return c},inv:function(b){for(var c,d=b.length,e=b[0].length,f=a.identity(d,e),g=a.gauss_jordan(b,f),h=[],i=0;d>i;i++)for(h[i]=[],c=e-1;c<g[0].length;c++)h[i][c-e]=g[i][c];return h},det:function(a){var b,c=a.length,d=2*c,e=new Array(d),f=c-1,g=d-1,h=f-c+1,i=g,j=0,k=0;if(2===c)return a[0][0]*a[1][1]-a[0][1]*a[1][0];for(;d>j;j++)e[j]=1;for(j=0;c>j;j++){for(b=0;c>b;b++)e[0>h?h+c:h]*=a[j][b],e[c>i?i+c:i]*=a[j][b],h++,i--;h=--f-c+1,i=--g}for(j=0;c>j;j++)k+=e[j];for(;d>j;j++)k-=e[j];return k},gauss_elimination:function(c,d){var e,f,g,h,i=0,j=0,k=c.length,l=c[0].length,m=1,n=0,o=[];for(c=a.aug(c,d),e=c[0].length;k>i;i++){for(f=c[i][i],j=i,h=i+1;l>h;h++)f<b.abs(c[h][i])&&(f=c[h][i],j=h);if(j!=i)for(h=0;e>h;h++)g=c[i][h],c[i][h]=c[j][h],c[j][h]=g;for(j=i+1;k>j;j++)for(m=c[j][i]/c[i][i],h=i;e>h;h++)c[j][h]=c[j][h]-m*c[i][h]}for(i=k-1;i>=0;i--){for(n=0,j=i+1;k-1>=j;j++)n=o[j]*c[i][j];o[i]=(c[i][e-1]-n)/c[i][i]}return o},gauss_jordan:function(d,e){for(var f=a.aug(d,e),g=f.length,h=f[0].length,i=0;g>i;i++){for(var j=i,k=i+1;g>k;k++)b.abs(f[k][i])>b.abs(f[j][i])&&(j=k);var l=f[i];f[i]=f[j],f[j]=l;for(var k=i+1;g>k;k++){c=f[k][i]/f[i][i];for(var m=i;h>m;m++)f[k][m]-=f[i][m]*c}}for(var i=g-1;i>=0;i--){c=f[i][i];for(var k=0;i>k;k++)for(var m=h-1;m>i-1;m--)f[k][m]-=f[i][m]*f[k][i]/c;f[i][i]/=c;for(var m=g;h>m;m++)f[i][m]/=c}return f},lu:function(){throw new Error("lu not yet implemented")},cholesky:function(){throw new Error("cholesky not yet implemented")},gauss_jacobi:function(c,d,e,f){for(var g,h,i,j,k=0,l=0,m=c.length,n=[],o=[],p=[];m>k;k++)for(n[k]=[],o[k]=[],p[k]=[],l=0;m>l;l++)k>l?(n[k][l]=c[k][l],o[k][l]=p[k][l]=0):l>k?(o[k][l]=c[k][l],n[k][l]=p[k][l]=0):(p[k][l]=c[k][l],n[k][l]=o[k][l]=0);for(i=a.multiply(a.multiply(a.inv(p),a.add(n,o)),-1),h=a.multiply(a.inv(p),d),g=e,j=a.add(a.multiply(i,e),h),k=2;b.abs(a.norm(a.subtract(j,g)))>f;)g=j,j=a.add(a.multiply(i,g),h),k++;return j},gauss_seidel:function(c,d,e,f){for(var g,h,i,j,k,l=0,m=c.length,n=[],o=[],p=[];m>l;l++)for(n[l]=[],o[l]=[],p[l]=[],g=0;m>g;g++)l>g?(n[l][g]=c[l][g],o[l][g]=p[l][g]=0):g>l?(o[l][g]=c[l][g],n[l][g]=p[l][g]=0):(p[l][g]=c[l][g],n[l][g]=o[l][g]=0);for(j=a.multiply(a.multiply(a.inv(a.add(p,n)),o),-1),i=a.multiply(a.inv(a.add(p,n)),d),h=e,k=a.add(a.multiply(j,e),i),l=2;b.abs(a.norm(a.subtract(k,h)))>f;)h=k,k=a.add(a.multiply(j,h),i),l+=1;return k},SOR:function(c,d,e,f,g){for(var h,i,j,k,l,m=0,n=c.length,o=[],p=[],q=[];n>m;m++)for(o[m]=[],p[m]=[],q[m]=[],h=0;n>h;h++)m>h?(o[m][h]=c[m][h],p[m][h]=q[m][h]=0):h>m?(p[m][h]=c[m][h],o[m][h]=q[m][h]=0):(q[m][h]=c[m][h],o[m][h]=p[m][h]=0);for(k=a.multiply(a.inv(a.add(q,a.multiply(o,g))),a.subtract(a.multiply(q,1-g),a.multiply(p,g))),j=a.multiply(a.multiply(a.inv(a.add(q,a.multiply(o,g))),d),g),i=e,l=a.add(a.multiply(k,e),j),m=2;b.abs(a.norm(a.subtract(l,i)))>f;)i=l,l=a.add(a.multiply(k,i),j),m++;return l},householder:function(c){for(var d,e,f,g,h,i=c.length,j=c[0].length,k=0,l=[],m=[];i-1>k;k++){for(d=0,g=k+1;j>g;g++)d+=c[g][k]*c[g][k];for(h=c[k+1][k]>0?-1:1,d=h*b.sqrt(d),e=b.sqrt((d*d-c[k+1][k]*d)/2),l=a.zeros(i,1),l[k+1][0]=(c[k+1][k]-d)/(2*e),f=k+2;i>f;f++)l[f][0]=c[f][k]/(2*e);m=a.subtract(a.identity(i,j),a.multiply(a.multiply(l,a.transpose(l)),2)),c=a.multiply(m,a.multiply(c,m))}return c},QR:function(c,d){for(var e,f,g,h,i,j,k=c.length,l=c[0].length,m=0,n=[],o=[],p=[];k-1>m;m++){for(f=0,e=m+1;l>e;e++)f+=c[e][m]*c[e][m];for(i=c[m+1][m]>0?-1:1,f=i*b.sqrt(f),g=b.sqrt((f*f-c[m+1][m]*f)/2),n=a.zeros(k,1),n[m+1][0]=(c[m+1][m]-f)/(2*g),h=m+2;k>h;h++)n[h][0]=c[h][m]/(2*g);o=a.subtract(a.identity(k,l),a.multiply(a.multiply(n,a.transpose(n)),2)),c=a.multiply(o,c),d=a.multiply(o,d)}for(m=k-1;m>=0;m--){for(j=0,e=m+1;l-1>=e;e++)j=p[e]*c[m][e];p[m]=d[m][0]/c[m][m]}return p},jacobi:function(c){for(var d,e,f,g,h,i,j,k,l=1,m=0,n=c.length,o=a.identity(n,n),p=[];1===l;){for(m++,i=c[0][1],g=0,h=1,e=0;n>e;e++)for(f=0;n>f;f++)e!=f&&i<b.abs(c[e][f])&&(i=b.abs(c[e][f]),g=e,h=f);for(j=c[g][g]===c[h][h]?c[g][h]>0?b.PI/4:-b.PI/4:b.atan(2*c[g][h]/(c[g][g]-c[h][h]))/2,k=a.identity(n,n),k[g][g]=b.cos(j),k[g][h]=-b.sin(j),k[h][g]=b.sin(j),k[h][h]=b.cos(j),o=a.multiply(o,k),d=a.multiply(a.multiply(a.inv(k),c),k),c=d,l=0,e=1;n>e;e++)for(f=1;n>f;f++)e!=f&&b.abs(c[e][f])>.001&&(l=1)}for(e=0;n>e;e++)p.push(c[e][e]);return[o,p]},rungekutta:function(a,b,c,d,e,f){var g,h,i,j,k;if(2===f)for(;c>=d;)g=b*a(d,e),h=b*a(d+b,e+g),i=e+(g+h)/2,e=i,d+=b;if(4===f)for(;c>=d;)g=b*a(d,e),h=b*a(d+b/2,e+g/2),j=b*a(d+b/2,e+h/2),k=b*a(d+b,e+j),i=e+(g+2*h+2*j+k)/6,e=i,d+=b;return e},romberg:function(a,c,d,e){for(var f,g,h,i,j,k=0,l=(d-c)/2,m=[],n=[],o=[];e/2>k;){for(j=a(c),h=c,i=0;d>=h;h+=l,i++)m[i]=h;for(f=m.length,h=1;f-1>h;h++)j+=(h%2!==0?4:2)*a(m[h]);j=l/3*(j+a(d)),o[k]=j,l/=2,k++}for(g=o.length,f=1;1!==g;){for(h=0;g-1>h;h++)n[h]=(b.pow(4,f)*o[h+1]-o[h])/(b.pow(4,f)-1);g=n.length,o=n,n=[],f++}return o},richardson:function(a,c,d,e){function f(a,b){for(var c,d=0,e=a.length;e>d;d++)a[d]===b&&(c=d);return c}for(var g,h,i,j,k,l=(a.length,b.abs(d-a[f(a,d)+1])),m=0,n=[],o=[];e>=l;)g=f(a,d+e),h=f(a,d),n[m]=(c[g]-2*c[h]+c[2*h-g])/(e*e),e/=2,m++;for(j=n.length,i=1;1!=j;){for(k=0;j-1>k;k++)o[k]=(b.pow(4,i)*n[k+1]-n[k])/(b.pow(4,i)-1);j=o.length,n=o,o=[],i++}return n},simpson:function(a,b,c,d){for(var e,f=(c-b)/d,g=a(b),h=[],i=b,j=0,k=1;c>=i;i+=f,j++)h[j]=i;for(e=h.length;e-1>k;k++)g+=(k%2!==0?4:2)*a(h[k]);return f/3*(g+a(c))},hermite:function(a,b,c,d){for(var e,f=a.length,g=0,h=0,i=[],j=[],k=[],l=[];f>h;h++){for(i[h]=1,e=0;f>e;e++)h!=e&&(i[h]*=(d-a[e])/(a[h]-a[e]));for(j[h]=0,e=0;f>e;e++)h!=e&&(j[h]+=1/(a[h]-a[e]));k[h]=(1-2*(d-a[h])*j[h])*i[h]*i[h],l[h]=(d-a[h])*i[h]*i[h],g+=k[h]*b[h]+l[h]*c[h]}return g},lagrange:function(a,b,c){for(var d,e,f=0,g=0,h=a.length;h>g;g++){for(e=b[g],d=0;h>d;d++)g!=d&&(e*=(c-a[d])/(a[g]-a[d]));f+=e}return f},cubic_spline:function(b,c,d){for(var e,f=b.length,g=0,h=[],i=[],j=[],k=[],l=[],m=[],n=[];f-1>g;g++)l[g]=b[g+1]-b[g];for(j[0]=0,g=1;f-1>g;g++)j[g]=3/l[g]*(c[g+1]-c[g])-3/l[g-1]*(c[g]-c[g-1]);for(g=1;f-1>g;g++)h[g]=[],i[g]=[],h[g][g-1]=l[g-1],h[g][g]=2*(l[g-1]+l[g]),h[g][g+1]=l[g],i[g][0]=j[g];for(k=a.multiply(a.inv(h),i),e=0;f-1>e;e++)m[e]=(c[e+1]-c[e])/l[e]-l[e]*(k[e+1][0]+2*k[e][0])/3,n[e]=(k[e+1][0]-k[e][0])/(3*l[e]);for(e=0;f>e&&!(b[e]>d);e++);return e-=1,c[e]+(d-b[e])*m[e]+a.sq(d-b[e])*k[e]+(d-b[e])*a.sq(d-b[e])*n[e]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(b){var c,d,e=b.length,f=b[0].length,g=0,h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[],q=[];for(g=0;e>g;g++)h[g]=a.sum(b[g])/f;for(g=0;f>g;g++)for(n[g]=[],c=0;e>c;c++)n[g][c]=b[c][g]-h[c];for(n=a.transpose(n),g=0;e>g;g++)for(o[g]=[],c=0;e>c;c++)o[g][c]=a.dot([n[g]],[n[c]])/(f-1);for(j=a.jacobi(o),p=j[0],i=j[1],q=a.transpose(p),g=0;g<i.length;g++)for(c=g;c<i.length;c++)i[g]<i[c]&&(d=i[g],i[g]=i[c],i[c]=d,k=q[g],q[g]=q[c],q[c]=k);for(m=a.transpose(n),g=0;e>g;g++)for(l[g]=[],c=0;c<m.length;c++)l[g][c]=a.dot([q[g]],[m[c]]);return[b,i,q,l]}}),function(b){for(var c=0;c<b.length;c++)(function(b){a.fn[b]=function(c,d){var e=this;return d?(setTimeout(function(){d.call(e,a.fn[b].call(e,c))},15),this):"number"==typeof a[b](this,c)?a[b](this,c):a(a[b](this,c))}})(b[c])}("add divide multiply subtract dot pow abs norm angle".split(" "))}(this.jStat,Math),function(a,b){var c=[].slice,d=a.utils.isNumber;a.extend({zscore:function(){var b=c.call(arguments);return d(b[1])?(b[0]-b[1])/b[2]:(b[0]-a.mean(b[1]))/a.stdev(b[1],b[2])},ztest:function(){var e=c.call(arguments);if(4===e.length){if(d(e[1])){var f=a.zscore(e[0],e[1],e[2]);return 1===e[3]?a.normal.cdf(-b.abs(f),0,1):2*a.normal.cdf(-b.abs(f),0,1)}var f=e[0];return 1===e[2]?a.normal.cdf(-b.abs(f),0,1):2*a.normal.cdf(-b.abs(f),0,1)}var f=a.zscore(e[0],e[1],e[3]);return 1===e[1]?a.normal.cdf(-b.abs(f),0,1):2*a.normal.cdf(-b.abs(f),0,1)}}),a.extend(a.fn,{zscore:function(a,b){return(a-this.mean())/this.stdev(b)},ztest:function(c,d,e){var f=b.abs(this.zscore(c,e));return 1===d?a.normal.cdf(-f,0,1):2*a.normal.cdf(-f,0,1)}}),a.extend({tscore:function(){var d=c.call(arguments);return 4===d.length?(d[0]-d[1])/(d[2]/b.sqrt(d[3])):(d[0]-a.mean(d[1]))/(a.stdev(d[1],!0)/b.sqrt(d[1].length))
},ttest:function(){var e,f=c.call(arguments);return 5===f.length?(e=b.abs(a.tscore(f[0],f[1],f[2],f[3])),1===f[4]?a.studentt.cdf(-e,f[3]-1):2*a.studentt.cdf(-e,f[3]-1)):d(f[1])?(e=b.abs(f[0]),1==f[2]?a.studentt.cdf(-e,f[1]-1):2*a.studentt.cdf(-e,f[1]-1)):(e=b.abs(a.tscore(f[0],f[1])),1==f[2]?a.studentt.cdf(-e,f[1].length-1):2*a.studentt.cdf(-e,f[1].length-1))}}),a.extend(a.fn,{tscore:function(a){return(a-this.mean())/(this.stdev(!0)/b.sqrt(this.cols()))},ttest:function(c,d){return 1===d?1-a.studentt.cdf(b.abs(this.tscore(c)),this.cols()-1):2*a.studentt.cdf(-b.abs(this.tscore(c)),this.cols()-1)}}),a.extend({anovafscore:function(){var d,e,f,g,h,i,j,k,l=c.call(arguments);if(1===l.length){for(h=new Array(l[0].length),j=0;j<l[0].length;j++)h[j]=l[0][j];l=h}if(2===l.length)return a.variance(l[0])/a.variance(l[1]);for(e=new Array,j=0;j<l.length;j++)e=e.concat(l[j]);for(f=a.mean(e),d=0,j=0;j<l.length;j++)d+=l[j].length*b.pow(a.mean(l[j])-f,2);for(d/=l.length-1,i=0,j=0;j<l.length;j++)for(g=a.mean(l[j]),k=0;k<l[j].length;k++)i+=b.pow(l[j][k]-g,2);return i/=e.length-l.length,d/i},anovaftest:function(){var b,e,f,g,h=c.call(arguments);if(d(h[0]))return 1-a.centralF.cdf(h[0],h[1],h[2]);for(anovafscore=a.anovafscore(h),b=h.length-1,f=0,g=0;g<h.length;g++)f+=h[g].length;return e=f-b-1,1-a.centralF.cdf(anovafscore,b,e)},ftest:function(b,c,d){return 1-a.centralF.cdf(b,c,d)}}),a.extend(a.fn,{anovafscore:function(){return a.anovafscore(this.toArray())},anovaftes:function(){var b,c=0;for(b=0;b<this.length;b++)c+=this[b].length;return a.ftest(this.anovafscore(),this.length-1,c-this.length)}}),a.extend({normalci:function(){var d,e=c.call(arguments),f=new Array(2);return d=b.abs(4===e.length?a.normal.inv(e[1]/2,0,1)*e[2]/b.sqrt(e[3]):a.normal.inv(e[1]/2,0,1)*a.stdev(e[2])/b.sqrt(e[2].length)),f[0]=e[0]-d,f[1]=e[0]+d,f},tci:function(){var d,e=c.call(arguments),f=new Array(2);return d=b.abs(4===e.length?a.studentt.inv(e[1]/2,e[3]-1)*e[2]/b.sqrt(e[3]):a.studentt.inv(e[1]/2,e[2].length-1)*a.stdev(e[2],!0)/b.sqrt(e[2].length)),f[0]=e[0]-d,f[1]=e[0]+d,f},significant:function(a,b){return b>a}}),a.extend(a.fn,{normalci:function(b,c){return a.normalci(b,c,this.toArray())},tci:function(b,c){return a.tci(b,c,this.toArray())}})}(this.jStat,Math),function(){function a(a){this._value=a}function b(a,b,c,d){var e,f,g=Math.pow(10,b);return f=(c(a*g)/g).toFixed(b),d&&(e=new RegExp("0{1,"+d+"}$"),f=f.replace(e,"")),f}function c(a,b,c){var d;return d=b.indexOf("$")>-1?e(a,b,c):b.indexOf("%")>-1?f(a,b,c):b.indexOf(":")>-1?g(a,b):i(a._value,b,c)}function d(a,b){var c,d,e,f,g,i=b,j=["KB","MB","GB","TB","PB","EB","ZB","YB"],k=!1;if(b.indexOf(":")>-1)a._value=h(b);else if(b===q)a._value=0;else{for("."!==o[p].delimiters.decimal&&(b=b.replace(/\./g,"").replace(o[p].delimiters.decimal,".")),c=new RegExp("[^a-zA-Z]"+o[p].abbreviations.thousand+"(?:\\)|(\\"+o[p].currency.symbol+")?(?:\\))?)?$"),d=new RegExp("[^a-zA-Z]"+o[p].abbreviations.million+"(?:\\)|(\\"+o[p].currency.symbol+")?(?:\\))?)?$"),e=new RegExp("[^a-zA-Z]"+o[p].abbreviations.billion+"(?:\\)|(\\"+o[p].currency.symbol+")?(?:\\))?)?$"),f=new RegExp("[^a-zA-Z]"+o[p].abbreviations.trillion+"(?:\\)|(\\"+o[p].currency.symbol+")?(?:\\))?)?$"),g=0;g<=j.length&&!(k=b.indexOf(j[g])>-1?Math.pow(1024,g+1):!1);g++);a._value=(k?k:1)*(i.match(c)?Math.pow(10,3):1)*(i.match(d)?Math.pow(10,6):1)*(i.match(e)?Math.pow(10,9):1)*(i.match(f)?Math.pow(10,12):1)*(b.indexOf("%")>-1?.01:1)*((b.split("-").length+Math.min(b.split("(").length-1,b.split(")").length-1))%2?1:-1)*Number(b.replace(/[^0-9\.]+/g,"")),a._value=k?Math.ceil(a._value):a._value}return a._value}function e(a,b,c){var d,e,f=b.indexOf("$"),g=b.indexOf("("),h=b.indexOf("-"),j="";return b.indexOf(" $")>-1?(j=" ",b=b.replace(" $","")):b.indexOf("$ ")>-1?(j=" ",b=b.replace("$ ","")):b=b.replace("$",""),e=i(a._value,b,c),1>=f?e.indexOf("(")>-1||e.indexOf("-")>-1?(e=e.split(""),d=1,(g>f||h>f)&&(d=0),e.splice(d,0,o[p].currency.symbol+j),e=e.join("")):e=o[p].currency.symbol+j+e:e.indexOf(")")>-1?(e=e.split(""),e.splice(-1,0,j+o[p].currency.symbol),e=e.join("")):e=e+j+o[p].currency.symbol,e}function f(a,b,c){var d,e="",f=100*a._value;return b.indexOf(" %")>-1?(e=" ",b=b.replace(" %","")):b=b.replace("%",""),d=i(f,b,c),d.indexOf(")")>-1?(d=d.split(""),d.splice(-1,0,e+"%"),d=d.join("")):d=d+e+"%",d}function g(a){var b=Math.floor(a._value/60/60),c=Math.floor((a._value-60*b*60)/60),d=Math.round(a._value-60*b*60-60*c);return b+":"+(10>c?"0"+c:c)+":"+(10>d?"0"+d:d)}function h(a){var b=a.split(":"),c=0;return 3===b.length?(c+=60*Number(b[0])*60,c+=60*Number(b[1]),c+=Number(b[2])):2===b.length&&(c+=60*Number(b[0]),c+=Number(b[1])),Number(c)}function i(a,c,d){var e,f,g,h,i,j,k=!1,l=!1,m=!1,n="",r=!1,s=!1,t=!1,u=!1,v=!1,w="",x="",y=Math.abs(a),z=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],A="",B=!1;if(0===a&&null!==q)return q;if(c.indexOf("(")>-1?(k=!0,c=c.slice(1,-1)):c.indexOf("+")>-1&&(l=!0,c=c.replace(/\+/g,"")),c.indexOf("a")>-1&&(r=c.indexOf("aK")>=0,s=c.indexOf("aM")>=0,t=c.indexOf("aB")>=0,u=c.indexOf("aT")>=0,v=r||s||t||u,c.indexOf(" a")>-1?(n=" ",c=c.replace(" a","")):c=c.replace("a",""),y>=Math.pow(10,12)&&!v||u?(n+=o[p].abbreviations.trillion,a/=Math.pow(10,12)):y<Math.pow(10,12)&&y>=Math.pow(10,9)&&!v||t?(n+=o[p].abbreviations.billion,a/=Math.pow(10,9)):y<Math.pow(10,9)&&y>=Math.pow(10,6)&&!v||s?(n+=o[p].abbreviations.million,a/=Math.pow(10,6)):(y<Math.pow(10,6)&&y>=Math.pow(10,3)&&!v||r)&&(n+=o[p].abbreviations.thousand,a/=Math.pow(10,3))),c.indexOf("b")>-1)for(c.indexOf(" b")>-1?(w=" ",c=c.replace(" b","")):c=c.replace("b",""),g=0;g<=z.length;g++)if(e=Math.pow(1024,g),f=Math.pow(1024,g+1),a>=e&&f>a){w+=z[g],e>0&&(a/=e);break}return c.indexOf("o")>-1&&(c.indexOf(" o")>-1?(x=" ",c=c.replace(" o","")):c=c.replace("o",""),x+=o[p].ordinal(a)),c.indexOf("[.]")>-1&&(m=!0,c=c.replace("[.]",".")),h=a.toString().split(".")[0],i=c.split(".")[1],j=c.indexOf(","),i?(i.indexOf("[")>-1?(i=i.replace("]",""),i=i.split("["),A=b(a,i[0].length+i[1].length,d,i[1].length)):A=b(a,i.length,d),h=A.split(".")[0],A=A.split(".")[1].length?o[p].delimiters.decimal+A.split(".")[1]:"",m&&0===Number(A.slice(1))&&(A="")):h=b(a,null,d),h.indexOf("-")>-1&&(h=h.slice(1),B=!0),j>-1&&(h=h.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+o[p].delimiters.thousands)),0===c.indexOf(".")&&(h=""),(k&&B?"(":"")+(!k&&B?"-":"")+(!B&&l?"+":"")+h+A+(x?x:"")+(n?n:"")+(w?w:"")+(k&&B?")":"")}function j(a,b){o[a]=b}function k(a){var b=a.toString().split(".");return b.length<2?1:Math.pow(10,b[1].length)}function l(){var a=Array.prototype.slice.call(arguments);return a.reduce(function(a,b){var c=k(a),d=k(b);return c>d?c:d},-1/0)}var m,n="1.5.3",o={},p="en",q=null,r="0,0",s="undefined"!=typeof module&&module.exports;m=function(b){return m.isNumeral(b)?b=b.value():0===b||"undefined"==typeof b?b=0:Number(b)||(b=m.fn.unformat(b)),new a(Number(b))},m.version=n,m.isNumeral=function(b){return b instanceof a},m.language=function(a,b){if(!a)return p;if(a&&!b){if(!o[a])throw new Error("Unknown language : "+a);p=a}return(b||!o[a])&&j(a,b),m},m.languageData=function(a){if(!a)return o[p];if(!o[a])throw new Error("Unknown language : "+a);return o[a]},m.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"$"}}),m.zeroFormat=function(a){q="string"==typeof a?a:null},m.defaultFormat=function(a){r="string"==typeof a?a:"0.0"},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(a,b){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof a)throw new TypeError(a+" is not a function");var c,d,e=this.length>>>0,f=!1;for(1<arguments.length&&(d=b,f=!0),c=0;e>c;++c)this.hasOwnProperty(c)&&(f?d=a(d,this[c],c,this):(d=this[c],f=!0));if(!f)throw new TypeError("Reduce of empty array with no initial value");return d}),m.fn=a.prototype={clone:function(){return m(this)},format:function(a,b){return c(this,a?a:r,void 0!==b?b:Math.round)},unformat:function(a){return"[object Number]"===Object.prototype.toString.call(a)?a:d(this,a?a:r)},value:function(){return this._value},valueOf:function(){return this._value},set:function(a){return this._value=Number(a),this},add:function(a){function b(a,b){return a+c*b}var c=l.call(null,this._value,a);return this._value=[this._value,a].reduce(b,0)/c,this},subtract:function(a){function b(a,b){return a-c*b}var c=l.call(null,this._value,a);return this._value=[a].reduce(b,this._value*c)/c,this},multiply:function(a){function b(a,b){var c=l(a,b);return a*c*b*c/(c*c)}return this._value=[this._value,a].reduce(b,1),this},divide:function(a){function b(a,b){var c=l(a,b);return a*c/(b*c)}return this._value=[this._value,a].reduce(b),this},difference:function(a){return Math.abs(m(this._value).subtract(a).value())}},s&&(module.exports=m),"undefined"==typeof ender&&(this.numeral=m),"function"==typeof define&&define.amd&&define([],function(){return m})}.call(this);var numeric="undefined"==typeof exports?function(){}:exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(a,b){var c,d,e,f;for("undefined"==typeof b&&(b=15),e=.5,c=new Date;;){for(e*=2,f=e;f>3;f-=4)a(),a(),a(),a();for(;f>0;)a(),f--;if(d=new Date,d-c>b)break}for(f=e;f>3;f-=4)a(),a(),a(),a();for(;f>0;)a(),f--;return d=new Date,1e3*(3*e-1)/(d-c)},numeric._myIndexOf=function(a){var b,c=this.length;for(b=0;c>b;++b)if(this[b]===a)return b;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(a){function b(a){if(0===a)return"0";if(isNaN(a))return"NaN";if(0>a)return"-"+b(-a);if(isFinite(a)){var c=Math.floor(Math.log(a)/Math.log(10)),d=a/Math.pow(10,c),e=d.toPrecision(numeric.precision);return 10===parseFloat(e)&&(c++,d=1,e=d.toPrecision(numeric.precision)),parseFloat(e).toString()+"e"+c.toString()}return"Infinity"}function c(a){var e;if("undefined"==typeof a)return d.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof a)return d.push('"'+a+'"'),!1;if("boolean"==typeof a)return d.push(a.toString()),!1;if("number"==typeof a){var f=b(a),g=a.toPrecision(numeric.precision),h=parseFloat(a.toString()).toString(),i=[f,g,h,parseFloat(g).toString(),parseFloat(h).toString()];for(e=1;e<i.length;e++)i[e].length<f.length&&(f=i[e]);return d.push(Array(numeric.precision+8-f.length).join(" ")+f),!1}if(null===a)return d.push("null"),!1;if("function"==typeof a){d.push(a.toString());var j=!1;for(e in a)a.hasOwnProperty(e)&&(d.push(j?",\n":"\n{"),j=!0,d.push(e),d.push(": \n"),c(a[e]));return j&&d.push("}\n"),!0}if(a instanceof Array){if(a.length>numeric.largeArray)return d.push("...Large Array..."),!0;var j=!1;for(d.push("["),e=0;e<a.length;e++)e>0&&(d.push(","),j&&d.push("\n ")),j=c(a[e]);return d.push("]"),!0}d.push("{");var j=!1;for(e in a)a.hasOwnProperty(e)&&(j&&d.push(",\n"),j=!0,d.push(e),d.push(": \n"),c(a[e]));return d.push("}"),!0}var d=[];return c(a),d.join("")},numeric.parseDate=function(a){function b(a){if("string"==typeof a)return Date.parse(a.replace(/-/g,"/"));if(a instanceof Array){var c,d=[];for(c=0;c<a.length;c++)d[c]=b(a[c]);return d}throw new Error("parseDate: parameter must be arrays of strings")}return b(a)},numeric.parseFloat=function(a){function b(a){if("string"==typeof a)return parseFloat(a);if(a instanceof Array){var c,d=[];for(c=0;c<a.length;c++)d[c]=b(a[c]);return d}throw new Error("parseFloat: parameter must be arrays of strings")}return b(a)},numeric.parseCSV=function(a){var b,c,d=a.split("\n"),e=[],f=/(([^'",]*)|('[^']*')|("[^"]*")),/g,g=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,h=function(a){return a.substr(0,a.length-1)},i=0;for(c=0;c<d.length;c++){var j,k=(d[c]+",").match(f);if(k.length>0){for(e[i]=[],b=0;b<k.length;b++)j=h(k[b]),e[i][b]=g.test(j)?parseFloat(j):j;i++}}return e},numeric.toCSV=function(a){var b,c,d,e,f,g,h=numeric.dim(a);for(d=h[0],e=h[1],g=[],b=0;d>b;b++){for(f=[],c=0;d>c;c++)f[c]=a[b][c].toString();g[b]=f.join(", ")}return g.join("\n")+"\n"},numeric.getURL=function(a){var b=new XMLHttpRequest;return b.open("GET",a,!1),b.send(),b},numeric.imageURL=function(a){function b(a){var b,c,d,e,f,g,h,i,j=a.length,k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="";for(b=0;j>b;b+=3)c=a[b],d=a[b+1],e=a[b+2],f=c>>2,g=((3&c)<<4)+(d>>4),h=((15&d)<<2)+(e>>6),i=63&e,b+1>=j?h=i=64:b+2>=j&&(i=64),l+=k.charAt(f)+k.charAt(g)+k.charAt(h)+k.charAt(i);return l}function c(a,b,c){"undefined"==typeof b&&(b=0),"undefined"==typeof c&&(c=a.length);{var d,e=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],f=-1,g=0;a.length}for(d=b;c>d;d++)g=255&(f^a[d]),f=f>>>8^e[g];return-1^f}var d,e,f,g,h,i,j,k,l,m,n=a[0].length,o=a[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,o>>24&255,o>>16&255,o>>8&255,255&o,n>>24&255,n>>16&255,n>>8&255,255&n,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(m=c(p,12,29),p[29]=m>>24&255,p[30]=m>>16&255,p[31]=m>>8&255,p[32]=255&m,d=1,e=0,j=0;n>j;j++){for(p.push(n-1>j?0:1),h=3*o+1+(0===j)&255,i=3*o+1+(0===j)>>8&255,p.push(h),p.push(i),p.push(255&~h),p.push(255&~i),0===j&&p.push(0),k=0;o>k;k++)for(f=0;3>f;f++)h=a[f][j][k],h=h>255?255:0>h?0:Math.round(h),d=(d+h)%65521,e=(e+d)%65521,p.push(h);p.push(0)}return l=(e<<16)+d,p.push(l>>24&255),p.push(l>>16&255),p.push(l>>8&255),p.push(255&l),g=p.length-41,p[33]=g>>24&255,p[34]=g>>16&255,p[35]=g>>8&255,p[36]=255&g,m=c(p,37),p.push(m>>24&255),p.push(m>>16&255),p.push(m>>8&255),p.push(255&m),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+b(p)},numeric._dim=function(a){for(var b=[];"object"==typeof a;)b.push(a.length),a=a[0];return b},numeric.dim=function(a){var b,c;return"object"==typeof a?(b=a[0],"object"==typeof b?(c=b[0],"object"==typeof c?numeric._dim(a):[a.length,b.length]):[a.length]):[]},numeric.mapreduce=function(a,b){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+b+';\nif(typeof x === "number") { var xi = x; '+a+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+a+";\n    xi = x[i-1];\n    "+a+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+a+"\n}\nreturn accum;")},numeric.mapreduce2=function(a,b){return Function("x","var n = x.length;\nvar i,xi;\n"+b+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+a+";\n}\nreturn accum;")},numeric.same=function a(b,c){var d,e;if(b instanceof Array&&c instanceof Array){if(e=b.length,e!==c.length)return!1;for(d=0;e>d;d++)if(b[d]!==c[d]){if("object"!=typeof b[d])return!1;if(!a(b[d],c[d]))return!1}return!0}return!1},numeric.rep=function(a,b,c){"undefined"==typeof c&&(c=0);var d,e=a[c],f=Array(e);if(c===a.length-1){for(d=e-2;d>=0;d-=2)f[d+1]=b,f[d]=b;return-1===d&&(f[0]=b),f}for(d=e-1;d>=0;d--)f[d]=numeric.rep(a,b,c+1);return f},numeric.dotMMsmall=function(a,b){var c,d,e,f,g,h,i,j,k,l,m;for(f=a.length,g=b.length,h=b[0].length,i=Array(f),c=f-1;c>=0;c--){for(j=Array(h),k=a[c],e=h-1;e>=0;e--){for(l=k[g-1]*b[g-1][e],d=g-2;d>=1;d-=2)m=d-1,l+=k[d]*b[d][e]+k[m]*b[m][e];0===d&&(l+=k[0]*b[0][e]),j[e]=l}i[c]=j}return i},numeric._getCol=function(a,b,c){var d,e=a.length;for(d=e-1;d>0;--d)c[d]=a[d][b],--d,c[d]=a[d][b];0===d&&(c[0]=a[0][b])},numeric.dotMMbig=function(a,b){var c,d,e,f,g=numeric._getCol,h=b.length,i=Array(h),j=a.length,k=b[0].length,l=new Array(j),m=numeric.dotVV;for(--h,--j,d=j;-1!==d;--d)l[d]=Array(k);for(--k,d=k;-1!==d;--d)for(g(b,d,i),e=j;-1!==e;--e)f=0,c=a[e],l[e][d]=m(c,i);return l},numeric.dotMV=function(a,b){var c,d=a.length,e=(b.length,Array(d)),f=numeric.dotVV;for(c=d-1;c>=0;c--)e[c]=f(a[c],b);return e},numeric.dotVM=function(a,b){var c,d,e,f,g,h,i;for(e=a.length,f=b[0].length,g=Array(f),d=f-1;d>=0;d--){for(h=a[e-1]*b[e-1][d],c=e-2;c>=1;c-=2)i=c-1,h+=a[c]*b[c][d]+a[i]*b[i][d];0===c&&(h+=a[0]*b[0][d]),g[d]=h}return g},numeric.dotVV=function(a,b){var c,d,e=a.length,f=a[e-1]*b[e-1];for(c=e-2;c>=1;c-=2)d=c-1,f+=a[c]*b[c]+a[d]*b[d];return 0===c&&(f+=a[0]*b[0]),f},numeric.dot=function(a,b){var c=numeric.dim;switch(1e3*c(a).length+c(b).length){case 2002:return b.length<10?numeric.dotMMsmall(a,b):numeric.dotMMbig(a,b);case 2001:return numeric.dotMV(a,b);case 1002:return numeric.dotVM(a,b);case 1001:return numeric.dotVV(a,b);case 1e3:return numeric.mulVS(a,b);case 1:return numeric.mulSV(a,b);case 0:return a*b;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(a){var b,c,d,e,f=a.length,g=Array(f);for(b=f-1;b>=0;b--){for(e=Array(f),c=b+2,d=f-1;d>=c;d-=2)e[d]=0,e[d-1]=0;for(d>b&&(e[d]=0),e[b]=a[b],d=b-1;d>=1;d-=2)e[d]=0,e[d-1]=0;0===d&&(e[0]=0),g[b]=e}return g},numeric.getDiag=function(a){var b,c=Math.min(a.length,a[0].length),d=Array(c);for(b=c-1;b>=1;--b)d[b]=a[b][b],--b,d[b]=a[b][b];return 0===b&&(d[0]=a[0][0]),d},numeric.identity=function(a){return numeric.diag(numeric.rep([a],1))},numeric.pointwise=function(a,b,c){"undefined"==typeof c&&(c="");var d,e,f=[],g=/\[i\]$/,h="",i=!1;for(d=0;d<a.length;d++)g.test(a[d])?(e=a[d].substring(0,a[d].length-3),h=e):e=a[d],"ret"===e&&(i=!0),f.push(e);return f[a.length]="_s",f[a.length+1]="_k",f[a.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+h+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(i?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+a.join(",")+",_s,_k+1);\n    return ret;\n}\n"+c+"\nfor(i=_n-1;i!==-1;--i) {\n    "+b+"\n}\nreturn ret;",Function.apply(null,f)},numeric.pointwise2=function(a,b,c){"undefined"==typeof c&&(c="");var d,e,f=[],g=/\[i\]$/,h="",i=!1;for(d=0;d<a.length;d++)g.test(a[d])?(e=a[d].substring(0,a[d].length-3),h=e):e=a[d],"ret"===e&&(i=!0),f.push(e);return f[a.length]="var _n = "+h+".length;\nvar i"+(i?"":", ret = Array(_n)")+";\n"+c+"\nfor(i=_n-1;i!==-1;--i) {\n"+b+"\n}\nreturn ret;",Function.apply(null,f)},numeric._biforeach=function b(a,c,d,e,f){if(e===d.length-1)return void f(a,c);var g,h=d[e];for(g=h-1;g>=0;g--)b("object"==typeof a?a[g]:a,"object"==typeof c?c[g]:c,d,e+1,f)},numeric._biforeach2=function d(a,b,c,e,f){if(e===c.length-1)return f(a,b);var g,h=c[e],i=Array(h);for(g=h-1;g>=0;--g)i[g]=d("object"==typeof a?a[g]:a,"object"==typeof b?b[g]:b,c,e+1,f);return i},numeric._foreach=function e(a,b,c,d){if(c===b.length-1)return void d(a);var f,g=b[c];for(f=g-1;f>=0;f--)e(a[f],b,c+1,d)},numeric._foreach2=function f(a,b,c,d){if(c===b.length-1)return d(a);var e,g=b[c],h=Array(g);for(e=g-1;e>=0;e--)h[e]=f(a[e],b,c+1,d);return h},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var a,b;for(a=0;a<numeric.mathfuns2.length;++a)b=numeric.mathfuns2[a],numeric.ops2[b]=b;for(a in numeric.ops2)if(numeric.ops2.hasOwnProperty(a)){b=numeric.ops2[a];var c,d,e="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,a)?(e="var "+b+" = Math."+b+";\n",c=function(a,c,d){return a+" = "+b+"("+c+","+d+")"},d=function(a,c){return a+" = "+b+"("+a+","+c+")"}):(c=function(a,c,d){return a+" = "+c+" "+b+" "+d},d=numeric.opseq.hasOwnProperty(a+"eq")?function(a,c){return a+" "+b+"= "+c}:function(a,c){return a+" = "+a+" "+b+" "+c}),numeric[a+"VV"]=numeric.pointwise2(["x[i]","y[i]"],c("ret[i]","x[i]","y[i]"),e),numeric[a+"SV"]=numeric.pointwise2(["x","y[i]"],c("ret[i]","x","y[i]"),e),numeric[a+"VS"]=numeric.pointwise2(["x[i]","y"],c("ret[i]","x[i]","y"),e),numeric[a]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+a+"VV, VS = numeric."+a+"VS, SV = numeric."+a+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+d("x","y")+"\n}\nreturn x;\n"),numeric[b]=numeric[a],numeric[a+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],d("ret[i]","x[i]"),e),numeric[a+"eqS"]=numeric.pointwise2(["ret[i]","x"],d("ret[i]","x"),e),numeric[a+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+a+"eqV, S = numeric."+a+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(a=0;a<numeric.mathfuns2.length;++a)b=numeric.mathfuns2[a],delete numeric.ops2[b];for(a=0;a<numeric.mathfuns.length;++a)b=numeric.mathfuns[a],numeric.ops1[b]=b;for(a in numeric.ops1)numeric.ops1.hasOwnProperty(a)&&(e="",b=numeric.ops1[a],-1!==numeric.myIndexOf.call(numeric.mathfuns,a)&&Math.hasOwnProperty(b)&&(e="var "+b+" = Math."+b+";\n"),numeric[a+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+b+"(ret[i]);",e),numeric[a+"eq"]=Function("x",'if(typeof x !== "object") return '+b+"x\nvar i;\nvar V = numeric."+a+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[a+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+b+"(x[i]);",e),numeric[a]=Function("x",'if(typeof x !== "object") return '+b+"(x)\nvar i;\nvar V = numeric."+a+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(a=0;a<numeric.mathfuns.length;++a)b=numeric.mathfuns[a],delete numeric.ops1[b];for(a in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(a)&&(b=numeric.mapreducers[a],numeric[a+"V"]=numeric.mapreduce2(b[0],b[1]),numeric[a]=Function("x","s","k",b[1]+'if(typeof x !== "object") {    xi = x;\n'+b[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+a+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+b[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(a,b){return"object"==typeof a?"object"==typeof b?numeric.truncVV(a,b):numeric.truncVS(a,b):"object"==typeof b?numeric.truncSV(a,b):Math.round(a/b)*b},numeric.inv=function(a){var b,c,d,e,f,g,h,a,i=numeric.dim(a),j=Math.abs,k=i[0],l=i[1],m=numeric.clone(a),n=numeric.identity(k);for(g=0;l>g;++g){var o=-1,p=-1;for(f=g;f!==k;++f)h=j(m[f][g]),h>p&&(o=f,p=h);for(c=m[o],m[o]=m[g],m[g]=c,e=n[o],n[o]=n[g],n[g]=e,a=c[g],h=g;h!==l;++h)c[h]/=a;for(h=l-1;-1!==h;--h)e[h]/=a;for(f=k-1;-1!==f;--f)if(f!==g){for(b=m[f],d=n[f],a=b[g],h=g+1;h!==l;++h)b[h]-=c[h]*a;for(h=l-1;h>0;--h)d[h]-=e[h]*a,--h,d[h]-=e[h]*a;0===h&&(d[0]-=e[0]*a)}}return n},numeric.det=function(a){var b=numeric.dim(a);if(2!==b.length||b[0]!==b[1])throw new Error("numeric: det() only works on square matrices");var c,d,e,f,g,h,i,j,k=b[0],l=1,m=numeric.clone(a);for(d=0;k-1>d;d++){for(e=d,c=d+1;k>c;c++)Math.abs(m[c][d])>Math.abs(m[e][d])&&(e=c);for(e!==d&&(i=m[e],m[e]=m[d],m[d]=i,l*=-1),f=m[d],c=d+1;k>c;c++){for(g=m[c],h=g[d]/f[d],e=d+1;k-1>e;e+=2)j=e+1,g[e]-=f[e]*h,g[j]-=f[j]*h;e!==k&&(g[e]-=f[e]*h)}if(0===f[d])return 0;l*=f[d]}return l*m[d][d]},numeric.transpose=function(a){var b,c,d,e,f,g=a.length,h=a[0].length,i=Array(h);for(c=0;h>c;c++)i[c]=Array(g);for(b=g-1;b>=1;b-=2){for(e=a[b],d=a[b-1],c=h-1;c>=1;--c)f=i[c],f[b]=e[c],f[b-1]=d[c],--c,f=i[c],f[b]=e[c],f[b-1]=d[c];0===c&&(f=i[0],f[b]=e[0],f[b-1]=d[0])}if(0===b){for(d=a[0],c=h-1;c>=1;--c)i[c][0]=d[c],--c,i[c][0]=d[c];0===c&&(i[0][0]=d[0])}return i},numeric.negtranspose=function(a){var b,c,d,e,f,g=a.length,h=a[0].length,i=Array(h);for(c=0;h>c;c++)i[c]=Array(g);for(b=g-1;b>=1;b-=2){for(e=a[b],d=a[b-1],c=h-1;c>=1;--c)f=i[c],f[b]=-e[c],f[b-1]=-d[c],--c,f=i[c],f[b]=-e[c],f[b-1]=-d[c];0===c&&(f=i[0],f[b]=-e[0],f[b-1]=-d[0])}if(0===b){for(d=a[0],c=h-1;c>=1;--c)i[c][0]=-d[c],--c,i[c][0]=-d[c];0===c&&(i[0][0]=-d[0])}return i},numeric._random=function g(a,b){var c,d,e=a[b],f=Array(e);if(b===a.length-1){for(d=Math.random,c=e-1;c>=1;c-=2)f[c]=d(),f[c-1]=d();return 0===c&&(f[0]=d()),f}for(c=e-1;c>=0;c--)f[c]=g(a,b+1);return f},numeric.random=function(a){return numeric._random(a,0)},numeric.norm2=function(a){return Math.sqrt(numeric.norm2Squared(a))},numeric.linspace=function(a,b,c){if("undefined"==typeof c&&(c=Math.max(Math.round(b-a)+1,1)),2>c)return 1===c?[a]:[];var d,e=Array(c);for(c--,d=c;d>=0;d--)e[d]=(d*b+(c-d)*a)/c;return e},numeric.getBlock=function(a,b,c){function d(a,f){var g,h=b[f],i=c[f]-h,j=Array(i);if(f===e.length-1){for(g=i;g>=0;g--)j[g]=a[g+h];return j}for(g=i;g>=0;g--)j[g]=d(a[g+h],f+1);return j}var e=numeric.dim(a);return d(a,0)},numeric.setBlock=function(a,b,c,d){function e(a,d,g){var h,i=b[g],j=c[g]-i;if(g===f.length-1)for(h=j;h>=0;h--)a[h+i]=d[h];for(h=j;h>=0;h--)e(a[h+i],d[h],g+1)}var f=numeric.dim(a);return e(a,d,0),a},numeric.getRange=function(a,b,c){var d,e,f,g,h=b.length,i=c.length,j=Array(h);for(d=h-1;-1!==d;--d)for(j[d]=Array(i),f=j[d],g=a[b[d]],e=i-1;-1!==e;--e)f[e]=g[c[e]];return j},numeric.blockMatrix=function(a){var b=numeric.dim(a);if(b.length<4)return numeric.blockMatrix([a]);var c,d,e,f,g,h=b[0],i=b[1];for(c=0,d=0,e=0;h>e;++e)c+=a[e][0].length;for(f=0;i>f;++f)d+=a[0][f][0].length;var j=Array(c);for(e=0;c>e;++e)j[e]=Array(d);var k,l,m,n,o,p=0;for(e=0;h>e;++e){for(k=d,f=i-1;-1!==f;--f)for(g=a[e][f],k-=g[0].length,m=g.length-1;-1!==m;--m)for(o=g[m],l=j[p+m],n=o.length-1;-1!==n;--n)l[k+n]=o[n];p+=a[e][0].length}return j},numeric.tensor=function(a,b){if("number"==typeof a||"number"==typeof b)return numeric.mul(a,b);var c=numeric.dim(a),d=numeric.dim(b);if(1!==c.length||1!==d.length)throw new Error("numeric: tensor product is only defined for vectors");var e,f,g,h,i=c[0],j=d[0],k=Array(i);for(f=i-1;f>=0;f--){for(e=Array(j),h=a[f],g=j-1;g>=3;--g)e[g]=h*b[g],--g,e[g]=h*b[g],--g,e[g]=h*b[g],--g,e[g]=h*b[g];for(;g>=0;)e[g]=h*b[g],--g;k[f]=e}return k},numeric.T=function(a,b){this.x=a,this.y=b},numeric.t=function(a,b){return new numeric.T(a,b)},numeric.Tbinop=function(a,b,c,d,e){numeric.indexOf;if("string"!=typeof e){var f;e="";for(f in numeric)numeric.hasOwnProperty(f)&&(a.indexOf(f)>=0||b.indexOf(f)>=0||c.indexOf(f)>=0||d.indexOf(f)>=0)&&f.length>1&&(e+="var "+f+" = numeric."+f+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+e+"\nif(x.y) {  if(y.y) {    return new numeric.T("+d+");\n  }\n  return new numeric.T("+c+");\n}\nif(y.y) {\n  return new numeric.T("+b+");\n}\nreturn new numeric.T("+a+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var a=numeric.mul,b=numeric.div;if(this.y){var c=numeric.add(a(this.x,this.x),a(this.y,this.y));return new numeric.T(b(this.x,c),b(numeric.neg(this.y),c))}return new T(b(1,this.x))},numeric.T.prototype.div=function h(a){if(a instanceof numeric.T||(a=new numeric.T(a)),a.y)return this.mul(a.reciprocal());var h=numeric.div;return this.y?new numeric.T(h(this.x,a.x),h(this.y,a.x)):new numeric.T(h(this.x,a.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var a=numeric.transpose,b=this.x,c=this.y;return c?new numeric.T(a(b),a(c)):new numeric.T(a(b))},numeric.T.prototype.transjugate=function(){var a=numeric.transpose,b=this.x,c=this.y;
return c?new numeric.T(a(b),numeric.negtranspose(c)):new numeric.T(a(b))},numeric.Tunop=function(a,b,c){return"string"!=typeof c&&(c=""),Function("var x = this;\n"+c+"\nif(x.y) {  "+b+";\n}\n"+a+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var a=this;if("undefined"==typeof a.y)return new numeric.T(numeric.inv(a.x));var b,c,d,e,f,g,h,i,j,k,l,b,c,d,m,n,o,p,q,r,s,t=a.x.length,u=numeric.identity(t),v=numeric.rep([t,t],0),w=numeric.clone(a.x),x=numeric.clone(a.y);for(b=0;t>b;b++){for(o=w[b][b],p=x[b][b],m=o*o+p*p,d=b,c=b+1;t>c;c++)o=w[c][b],p=x[c][b],n=o*o+p*p,n>m&&(d=c,m=n);for(d!==b&&(s=w[b],w[b]=w[d],w[d]=s,s=x[b],x[b]=x[d],x[d]=s,s=u[b],u[b]=u[d],u[d]=s,s=v[b],v[b]=v[d],v[d]=s),e=w[b],f=x[b],i=u[b],j=v[b],o=e[b],p=f[b],c=b+1;t>c;c++)q=e[c],r=f[c],e[c]=(q*o+r*p)/m,f[c]=(r*o-q*p)/m;for(c=0;t>c;c++)q=i[c],r=j[c],i[c]=(q*o+r*p)/m,j[c]=(r*o-q*p)/m;for(c=b+1;t>c;c++){for(g=w[c],h=x[c],k=u[c],l=v[c],o=g[b],p=h[b],d=b+1;t>d;d++)q=e[d],r=f[d],g[d]-=q*o-r*p,h[d]-=r*o+q*p;for(d=0;t>d;d++)q=i[d],r=j[d],k[d]-=q*o-r*p,l[d]-=r*o+q*p}}for(b=t-1;b>0;b--)for(i=u[b],j=v[b],c=b-1;c>=0;c--)for(k=u[c],l=v[c],o=w[c][b],p=x[c][b],d=t-1;d>=0;d--)q=i[d],r=j[d],k[d]-=o*q-p*r,l[d]-=o*r+p*q;return new numeric.T(u,v)},numeric.T.prototype.get=function(a){var b,c=this.x,d=this.y,e=0,f=a.length;if(d){for(;f>e;)b=a[e],c=c[b],d=d[b],e++;return new numeric.T(c,d)}for(;f>e;)b=a[e],c=c[b],e++;return new numeric.T(c)},numeric.T.prototype.set=function(a,b){var c,d=this.x,e=this.y,f=0,g=a.length,h=b.x,i=b.y;if(0===g)return i?this.y=i:e&&(this.y=void 0),this.x=d,this;if(i){for(e||(e=numeric.rep(numeric.dim(d),0),this.y=e);g-1>f;)c=a[f],d=d[c],e=e[c],f++;return c=a[f],d[c]=h,e[c]=i,this}if(e){for(;g-1>f;)c=a[f],d=d[c],e=e[c],f++;return c=a[f],d[c]=h,e[c]=h instanceof Array?numeric.rep(numeric.dim(h),0):0,this}for(;g-1>f;)c=a[f],d=d[c],f++;return c=a[f],d[c]=h,this},numeric.T.prototype.getRows=function(a,b){var c,d,e=b-a+1,f=Array(e),g=this.x,h=this.y;for(c=a;b>=c;c++)f[c-a]=g[c];if(h){for(d=Array(e),c=a;b>=c;c++)d[c-a]=h[c];return new numeric.T(f,d)}return new numeric.T(f)},numeric.T.prototype.setRows=function(a,b,c){var d,e=this.x,f=this.y,g=c.x,h=c.y;for(d=a;b>=d;d++)e[d]=g[d-a];if(h)for(f||(f=numeric.rep(numeric.dim(e),0),this.y=f),d=a;b>=d;d++)f[d]=h[d-a];else if(f)for(d=a;b>=d;d++)f[d]=numeric.rep([g[d-a].length],0);return this},numeric.T.prototype.getRow=function(a){var b=this.x,c=this.y;return c?new numeric.T(b[a],c[a]):new numeric.T(b[a])},numeric.T.prototype.setRow=function(a,b){var c=this.x,d=this.y,e=b.x,f=b.y;return c[a]=e,f?(d||(d=numeric.rep(numeric.dim(c),0),this.y=d),d[a]=f):d&&(d=numeric.rep([e.length],0)),this},numeric.T.prototype.getBlock=function(a,b){var c=this.x,d=this.y,e=numeric.getBlock;return d?new numeric.T(e(c,a,b),e(d,a,b)):new numeric.T(e(c,a,b))},numeric.T.prototype.setBlock=function(a,b,c){c instanceof numeric.T||(c=new numeric.T(c));var d=this.x,e=this.y,f=numeric.setBlock,g=c.x,h=c.y;return h?(e||(this.y=numeric.rep(numeric.dim(this),0),e=this.y),f(d,a,b,g),f(e,a,b,h),this):(f(d,a,b,g),void(e&&f(e,a,b,numeric.rep(numeric.dim(g),0))))},numeric.T.rep=function(a,b){var c=numeric.T;b instanceof c||(b=new c(b));var d=b.x,e=b.y,f=numeric.rep;return e?new c(f(a,d),f(a,e)):new c(f(a,d))},numeric.T.diag=function i(a){a instanceof numeric.T||(a=new numeric.T(a));var b=a.x,c=a.y,i=numeric.diag;return c?new numeric.T(i(b),i(c)):new numeric.T(i(b))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(a){return new numeric.T(numeric.identity(a))},numeric.T.prototype.getDiag=function(){var a=numeric,b=this.x,c=this.y;return c?new a.T(a.getDiag(b),a.getDiag(c)):new a.T(a.getDiag(b))},numeric.house=function(a){var b=numeric.clone(a),c=a[0]>=0?1:-1,d=c*numeric.norm2(a);b[0]+=d;var e=numeric.norm2(b);if(0===e)throw new Error("eig: internal error");return numeric.div(b,e)},numeric.toUpperHessenberg=function(a){var b=numeric.dim(a);if(2!==b.length||b[0]!==b[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var c,d,e,f,g,h,i,j,k,l,m=b[0],n=numeric.clone(a),o=numeric.identity(m);for(d=0;m-2>d;d++){for(f=Array(m-d-1),c=d+1;m>c;c++)f[c-d-1]=n[c][d];if(numeric.norm2(f)>0){for(g=numeric.house(f),h=numeric.getBlock(n,[d+1,d],[m-1,m-1]),i=numeric.tensor(g,numeric.dot(g,h)),c=d+1;m>c;c++)for(j=n[c],k=i[c-d-1],e=d;m>e;e++)j[e]-=2*k[e-d];for(h=numeric.getBlock(n,[0,d+1],[m-1,m-1]),i=numeric.tensor(numeric.dot(h,g),g),c=0;m>c;c++)for(j=n[c],k=i[c],e=d+1;m>e;e++)j[e]-=2*k[e-d-1];for(h=Array(m-d-1),c=d+1;m>c;c++)h[c-d-1]=o[c];for(i=numeric.tensor(g,numeric.dot(g,h)),c=d+1;m>c;c++)for(l=o[c],k=i[c-d-1],e=0;m>e;e++)l[e]-=2*k[e]}}return{H:n,Q:o}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(a,b){"undefined"==typeof b&&(b=1e4),a=numeric.clone(a);var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=(numeric.clone(a),numeric.dim(a)),v=u[0],w=numeric.identity(v);if(3>v)return{Q:w,B:[[0,v-1]]};var x=numeric.epsilon;for(t=0;b>t;t++){for(r=0;v-1>r;r++)if(Math.abs(a[r+1][r])<x*(Math.abs(a[r][r])+Math.abs(a[r+1][r+1]))){var y=numeric.QRFrancis(numeric.getBlock(a,[0,0],[r,r]),b),z=numeric.QRFrancis(numeric.getBlock(a,[r+1,r+1],[v-1,v-1]),b);for(n=Array(r+1),q=0;r>=q;q++)n[q]=w[q];for(o=numeric.dot(y.Q,n),q=0;r>=q;q++)w[q]=o[q];for(n=Array(v-r-1),q=r+1;v>q;q++)n[q-r-1]=w[q];for(o=numeric.dot(z.Q,n),q=r+1;v>q;q++)w[q]=o[q-r-1];return{Q:w,B:y.B.concat(numeric.add(z.B,r+1))}}if(e=a[v-2][v-2],f=a[v-2][v-1],g=a[v-1][v-2],h=a[v-1][v-1],j=e+h,i=e*h-f*g,k=numeric.getBlock(a,[0,0],[2,2]),j*j>=4*i){var A,B;A=.5*(j+Math.sqrt(j*j-4*i)),B=.5*(j-Math.sqrt(j*j-4*i)),k=numeric.add(numeric.sub(numeric.dot(k,k),numeric.mul(k,A+B)),numeric.diag(numeric.rep([3],A*B)))}else k=numeric.add(numeric.sub(numeric.dot(k,k),numeric.mul(k,j)),numeric.diag(numeric.rep([3],i)));for(c=[k[0][0],k[1][0],k[2][0]],d=numeric.house(c),n=[a[0],a[1],a[2]],o=numeric.tensor(d,numeric.dot(d,n)),q=0;3>q;q++)for(m=a[q],p=o[q],s=0;v>s;s++)m[s]-=2*p[s];for(n=numeric.getBlock(a,[0,0],[v-1,2]),o=numeric.tensor(numeric.dot(n,d),d),q=0;v>q;q++)for(m=a[q],p=o[q],s=0;3>s;s++)m[s]-=2*p[s];for(n=[w[0],w[1],w[2]],o=numeric.tensor(d,numeric.dot(d,n)),q=0;3>q;q++)for(l=w[q],p=o[q],s=0;v>s;s++)l[s]-=2*p[s];var C;for(r=0;v-2>r;r++){for(s=r;r+1>=s;s++)if(Math.abs(a[s+1][s])<x*(Math.abs(a[s][s])+Math.abs(a[s+1][s+1]))){var y=numeric.QRFrancis(numeric.getBlock(a,[0,0],[s,s]),b),z=numeric.QRFrancis(numeric.getBlock(a,[s+1,s+1],[v-1,v-1]),b);for(n=Array(s+1),q=0;s>=q;q++)n[q]=w[q];for(o=numeric.dot(y.Q,n),q=0;s>=q;q++)w[q]=o[q];for(n=Array(v-s-1),q=s+1;v>q;q++)n[q-s-1]=w[q];for(o=numeric.dot(z.Q,n),q=s+1;v>q;q++)w[q]=o[q-s-1];return{Q:w,B:y.B.concat(numeric.add(z.B,s+1))}}for(C=Math.min(v-1,r+3),c=Array(C-r),q=r+1;C>=q;q++)c[q-r-1]=a[q][r];for(d=numeric.house(c),n=numeric.getBlock(a,[r+1,r],[C,v-1]),o=numeric.tensor(d,numeric.dot(d,n)),q=r+1;C>=q;q++)for(m=a[q],p=o[q-r-1],s=r;v>s;s++)m[s]-=2*p[s-r];for(n=numeric.getBlock(a,[0,r+1],[v-1,C]),o=numeric.tensor(numeric.dot(n,d),d),q=0;v>q;q++)for(m=a[q],p=o[q],s=r+1;C>=s;s++)m[s]-=2*p[s-r-1];for(n=Array(C-r),q=r+1;C>=q;q++)n[q-r-1]=w[q];for(o=numeric.tensor(d,numeric.dot(d,n)),q=r+1;C>=q;q++)for(l=w[q],p=o[q-r-1],s=0;v>s;s++)l[s]-=2*p[s]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=numeric.toUpperHessenberg(a),u=numeric.QRFrancis(t.H,b),v=numeric.T,w=a.length,x=u.B,y=numeric.dot(u.Q,numeric.dot(t.H,numeric.transpose(u.Q))),z=new v(numeric.dot(u.Q,t.Q)),A=x.length,B=Math.sqrt;for(d=0;A>d;d++)if(c=x[d][0],c!==x[d][1]){if(f=c+1,g=y[c][c],h=y[c][f],i=y[f][c],j=y[f][f],0===h&&0===i)continue;k=-g-j,l=g*j-h*i,m=k*k-4*l,m>=0?(n=0>k?-.5*(k-B(m)):-.5*(k+B(m)),r=(g-n)*(g-n)+h*h,s=i*i+(j-n)*(j-n),r>s?(r=B(r),p=(g-n)/r,q=h/r):(s=B(s),p=i/s,q=(j-n)/s),e=new v([[q,-p],[p,q]]),z.setRows(c,f,e.dot(z.getRows(c,f)))):(n=-.5*k,o=.5*B(-m),r=(g-n)*(g-n)+h*h,s=i*i+(j-n)*(j-n),r>s?(r=B(r+o*o),p=(g-n)/r,q=h/r,n=0,o/=r):(s=B(s+o*o),p=i/s,q=(j-n)/s,n=o/s,o=0),e=new v([[q,-p],[p,q]],[[n,o],[o,-n]]),z.setRows(c,f,e.dot(z.getRows(c,f))))}var C=z.dot(a).dot(z.transjugate()),w=a.length,D=numeric.T.identity(w);for(f=0;w>f;f++)if(f>0)for(d=f-1;d>=0;d--){var E=C.get([d,d]),F=C.get([f,f]);numeric.neq(E.x,F.x)||numeric.neq(E.y,F.y)?(n=C.getRow(d).getBlock([d],[f-1]),o=D.getRow(f).getBlock([d],[f-1]),D.set([f,d],C.get([d,f]).neg().sub(n.dot(o)).div(E.sub(F)))):D.setRow(f,D.getRow(d))}for(f=0;w>f;f++)n=D.getRow(f),D.setRow(f,n.div(n.norm2()));return D=D.transpose(),D=z.transjugate().dot(D),{lambda:C.getDiag(),E:D}},numeric.ccsSparse=function(a){var b,c,d,e,f=a.length,g=[];for(d=f-1;-1!==d;--d){c=a[d];for(e in c){for(e=parseInt(e);e>=g.length;)g[g.length]=0;0!==c[e]&&g[e]++}}var b=g.length,h=Array(b+1);for(h[0]=0,d=0;b>d;++d)h[d+1]=h[d]+g[d];var i=Array(h[b]),j=Array(h[b]);for(d=f-1;-1!==d;--d){c=a[d];for(e in c)0!==c[e]&&(g[e]--,i[h[e]+g[e]]=d,j[h[e]+g[e]]=c[e])}return[h,i,j]},numeric.ccsFull=function(a){var b,c,d,e,f=a[0],g=a[1],h=a[2],i=numeric.ccsDim(a),j=i[0],k=i[1],l=numeric.rep([j,k],0);for(b=0;k>b;b++)for(d=f[b],e=f[b+1],c=d;e>c;++c)l[g[c]][b]=h[c];return l},numeric.ccsTSolve=function(a,b,c,d,e){function f(a){var b;if(0===c[a]){for(c[a]=1,b=g[a];b<g[a+1];++b)f(h[b]);e[l]=a,++l}}var g=a[0],h=a[1],i=a[2],j=g.length-1,k=Math.max,l=0;"undefined"==typeof d&&(c=numeric.rep([j],0)),"undefined"==typeof d&&(d=numeric.linspace(0,c.length-1)),"undefined"==typeof e&&(e=[]);var m,n,o,p,q,r,s;for(m=d.length-1;-1!==m;--m)f(d[m]);for(e.length=l,m=e.length-1;-1!==m;--m)c[e[m]]=0;for(m=d.length-1;-1!==m;--m)n=d[m],c[n]=b[n];for(m=e.length-1;-1!==m;--m){for(n=e[m],o=g[n],p=k(g[n+1],o),q=o;q!==p;++q)if(h[q]===n){c[n]/=i[q];break}for(s=c[n],q=o;q!==p;++q)r=h[q],r!==n&&(c[r]-=s*i[q])}return c},numeric.ccsDFS=function(a){this.k=Array(a),this.k1=Array(a),this.j=Array(a)},numeric.ccsDFS.prototype.dfs=function(a,b,c,d,e,f){var g,h,i,j=0,k=e.length,l=this.k,m=this.k1,n=this.j;if(0===d[a])for(d[a]=1,n[0]=a,l[0]=h=b[a],m[0]=i=b[a+1];;)if(h>=i){if(e[k]=n[j],0===j)return;++k,--j,h=l[j],i=m[j]}else g=f[c[h]],0===d[g]?(d[g]=1,l[j]=h,++j,n[j]=g,h=b[g],m[j]=i=b[g+1]):++h},numeric.ccsLPSolve=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q=a[0],r=a[1],s=a[2],t=(q.length-1,b[0]),u=b[1],v=b[2];for(i=t[e],j=t[e+1],d.length=0,h=i;j>h;++h)g.dfs(f[u[h]],q,r,c,d,f);for(h=d.length-1;-1!==h;--h)c[d[h]]=0;for(h=i;h!==j;++h)k=f[u[h]],c[k]=v[h];for(h=d.length-1;-1!==h;--h){for(k=d[h],l=q[k],m=q[k+1],n=l;m>n;++n)if(f[r[n]]===k){c[k]/=s[n];break}for(p=c[k],n=l;m>n;++n)o=f[r[n]],o!==k&&(c[o]-=p*s[n])}return c},numeric.ccsLUP1=function(a,b){var c,d,e,f,g,h,i,j=a[0].length-1,k=[numeric.rep([j+1],0),[],[]],l=[numeric.rep([j+1],0),[],[]],m=k[0],n=k[1],o=k[2],p=l[0],q=l[1],r=l[2],s=numeric.rep([j],0),t=numeric.rep([j],0),u=numeric.ccsLPSolve,v=(Math.max,Math.abs),w=numeric.linspace(0,j-1),x=numeric.linspace(0,j-1),y=new numeric.ccsDFS(j);for("undefined"==typeof b&&(b=1),c=0;j>c;++c){for(u(k,a,s,t,c,x,y),f=-1,g=-1,d=t.length-1;-1!==d;--d)e=t[d],c>=e||(h=v(s[e]),h>f&&(g=e,f=h));for(v(s[c])<b*f&&(d=w[c],f=w[g],w[c]=f,x[f]=c,w[g]=d,x[d]=g,f=s[c],s[c]=s[g],s[g]=f),f=m[c],g=p[c],i=s[c],n[f]=w[c],o[f]=1,++f,d=t.length-1;-1!==d;--d)e=t[d],h=s[e],t[d]=0,s[e]=0,c>=e?(q[g]=e,r[g]=h,++g):(n[f]=w[e],o[f]=h/i,++f);m[c+1]=f,p[c+1]=g}for(d=n.length-1;-1!==d;--d)n[d]=x[n[d]];return{L:k,U:l,P:w,Pinv:x}},numeric.ccsDFS0=function(a){this.k=Array(a),this.k1=Array(a),this.j=Array(a)},numeric.ccsDFS0.prototype.dfs=function(a,b,c,d,e,f){var g,h,i,j=0,k=e.length,l=this.k,m=this.k1,n=this.j;if(0===d[a])for(d[a]=1,n[0]=a,l[0]=h=b[f[a]],m[0]=i=b[f[a]+1];;){if(isNaN(h))throw new Error("Ow!");if(h>=i){if(e[k]=f[n[j]],0===j)return;++k,--j,h=l[j],i=m[j]}else g=c[h],0===d[g]?(d[g]=1,l[j]=h,++j,n[j]=g,g=f[g],h=b[g],m[j]=i=b[g+1]):++h}},numeric.ccsLPSolve0=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r=a[0],s=a[1],t=a[2],u=(r.length-1,b[0]),v=b[1],w=b[2];for(j=u[e],k=u[e+1],d.length=0,i=j;k>i;++i)h.dfs(v[i],r,s,c,d,f,g);for(i=d.length-1;-1!==i;--i)l=d[i],c[g[l]]=0;for(i=j;i!==k;++i)l=v[i],c[l]=w[i];for(i=d.length-1;-1!==i;--i){for(l=d[i],p=g[l],m=r[l],n=r[l+1],o=m;n>o;++o)if(s[o]===p){c[p]/=t[o];break}for(q=c[p],o=m;n>o;++o)c[s[o]]-=q*t[o];c[p]=q}},numeric.ccsLUP0=function(a,b){var c,d,e,f,g,h,i,j=a[0].length-1,k=[numeric.rep([j+1],0),[],[]],l=[numeric.rep([j+1],0),[],[]],m=k[0],n=k[1],o=k[2],p=l[0],q=l[1],r=l[2],s=numeric.rep([j],0),t=numeric.rep([j],0),u=numeric.ccsLPSolve0,v=(Math.max,Math.abs),w=numeric.linspace(0,j-1),x=numeric.linspace(0,j-1),y=new numeric.ccsDFS0(j);for("undefined"==typeof b&&(b=1),c=0;j>c;++c){for(u(k,a,s,t,c,x,w,y),f=-1,g=-1,d=t.length-1;-1!==d;--d)e=t[d],c>=e||(h=v(s[w[e]]),h>f&&(g=e,f=h));for(v(s[w[c]])<b*f&&(d=w[c],f=w[g],w[c]=f,x[f]=c,w[g]=d,x[d]=g),f=m[c],g=p[c],i=s[w[c]],n[f]=w[c],o[f]=1,++f,d=t.length-1;-1!==d;--d)e=t[d],h=s[w[e]],t[d]=0,s[w[e]]=0,c>=e?(q[g]=e,r[g]=h,++g):(n[f]=w[e],o[f]=h/i,++f);m[c+1]=f,p[c+1]=g}for(d=n.length-1;-1!==d;--d)n[d]=x[n[d]];return{L:k,U:l,P:w,Pinv:x}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(a){return[numeric.sup(a[1])+1,a[0].length-1]},numeric.ccsGetBlock=function(a,b,c){var d=numeric.ccsDim(a),e=d[0],f=d[1];"undefined"==typeof b?b=numeric.linspace(0,e-1):"number"==typeof b&&(b=[b]),"undefined"==typeof c?c=numeric.linspace(0,f-1):"number"==typeof c&&(c=[c]);var g,h,i,j,k,l=b.length,m=c.length,n=numeric.rep([f],0),o=[],p=[],q=[n,o,p],r=a[0],s=a[1],t=a[2],u=numeric.rep([e],0),v=0,w=numeric.rep([e],0);for(h=0;m>h;++h){j=c[h];var x=r[j],y=r[j+1];for(g=x;y>g;++g)i=s[g],w[i]=1,u[i]=t[g];for(g=0;l>g;++g)k=b[g],w[k]&&(o[v]=g,p[v]=u[b[g]],++v);for(g=x;y>g;++g)i=s[g],w[i]=0;n[h+1]=v}return q},numeric.ccsDot=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=a[0],o=a[1],p=a[2],q=b[0],r=b[1],s=b[2],t=numeric.ccsDim(a),u=numeric.ccsDim(b),v=t[0],w=(t[1],u[1]),x=numeric.rep([v],0),y=numeric.rep([v],0),z=Array(v),A=numeric.rep([w],0),B=[],C=[],D=[A,B,C];for(e=0;e!==w;++e){for(f=q[e],g=q[e+1],k=0,d=f;g>d;++d)for(l=r[d],m=s[d],h=n[l],i=n[l+1],c=h;i>c;++c)j=o[c],0===y[j]&&(z[k]=j,y[j]=1,k+=1),x[j]=x[j]+p[c]*m;for(f=A[e],g=f+k,A[e+1]=g,d=k-1;-1!==d;--d)m=f+d,c=z[d],B[m]=c,C[m]=x[c],y[c]=0,x[c]=0;A[e+1]=A[e]+k}return D},numeric.ccsLUPSolve=function(a,b){var c=a.L,d=a.U,e=(a.P,b[0]),f=!1;"object"!=typeof e&&(b=[[0,b.length],numeric.linspace(0,b.length-1),b],e=b[0],f=!0);var g,h,i,j,k,l,m=b[1],n=b[2],o=c[0].length-1,p=e.length-1,q=numeric.rep([o],0),r=Array(o),s=numeric.rep([o],0),t=Array(o),u=numeric.rep([p+1],0),v=[],w=[],x=numeric.ccsTSolve,y=0;for(g=0;p>g;++g){for(k=0,i=e[g],j=e[g+1],h=i;j>h;++h)l=a.Pinv[m[h]],t[k]=l,s[l]=n[h],++k;for(t.length=k,x(c,s,q,t,r),h=t.length-1;-1!==h;--h)s[t[h]]=0;if(x(d,q,s,r,t),f)return s;for(h=r.length-1;-1!==h;--h)q[r[h]]=0;for(h=t.length-1;-1!==h;--h)l=t[h],v[y]=l,w[y]=s[l],s[l]=0,++y;u[g+1]=y}return[u,v,w]},numeric.ccsbinop=function(a,b){return"undefined"==typeof b&&(b=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+b+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+a+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(a){var b,c=a[0],d=a[1],e=a[2],f=numeric.sup(d)+1,g=c.length,h=numeric.rep([f],0),i=Array(g),j=Array(g),k=numeric.rep([f],0);for(b=0;g>b;++b)k[d[b]]++;for(b=0;f>b;++b)h[b+1]=h[b]+k[b];var l,m,n=h.slice(0);for(b=0;g>b;++b)m=d[b],l=n[m],i[l]=c[b],j[l]=e[b],n[m]=n[m]+1;return[h,i,j]},numeric.ccsGather=function(a){var b,c,d,e,f,g=a[0],h=a[1],i=a[2],j=g.length-1,k=h.length,l=Array(k),m=Array(k),n=Array(k);for(f=0,b=0;j>b;++b)for(d=g[b],e=g[b+1],c=d;c!==e;++c)m[f]=b,l[f]=h[c],n[f]=i[c],++f;return[l,m,n]},numeric.sdim=function j(a,b,c){if("undefined"==typeof b&&(b=[]),"object"!=typeof a)return b;"undefined"==typeof c&&(c=0),c in b||(b[c]=0),a.length>b[c]&&(b[c]=a.length);var d;for(d in a)a.hasOwnProperty(d)&&j(a[d],b,c+1);return b},numeric.sclone=function k(a,b,c){"undefined"==typeof b&&(b=0),"undefined"==typeof c&&(c=numeric.sdim(a).length);var d,e=Array(a.length);if(b===c-1){for(d in a)a.hasOwnProperty(d)&&(e[d]=a[d]);return e}for(d in a)a.hasOwnProperty(d)&&(e[d]=k(a[d],b+1,c));return e},numeric.sdiag=function(a){var b,c,d=a.length,e=Array(d);for(b=d-1;b>=1;b-=2)c=b-1,e[b]=[],e[b][b]=a[b],e[c]=[],e[c][c]=a[c];return 0===b&&(e[0]=[],e[0][0]=a[b]),e},numeric.sidentity=function(a){return numeric.sdiag(numeric.rep([a],1))},numeric.stranspose=function(a){{var b,c,d,e=[];a.length}for(b in a)if(a.hasOwnProperty(b)){d=a[b];for(c in d)d.hasOwnProperty(c)&&("object"!=typeof e[c]&&(e[c]=[]),e[c][b]=d[c])}return e},numeric.sLUP=function(){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(a,b){var c,d,e,f,g,h,i,j=a.length,k=(b.length,numeric.stranspose(b)),l=k.length,m=Array(j);for(e=j-1;e>=0;e--){for(i=[],c=a[e],g=l-1;g>=0;g--){h=0,d=k[g];for(f in c)c.hasOwnProperty(f)&&f in d&&(h+=c[f]*d[f]);h&&(i[g]=h)}m[e]=i}return m},numeric.sdotMV=function(a,b){var c,d,e,f,g=a.length,h=Array(g);for(d=g-1;d>=0;d--){c=a[d],f=0;for(e in c)c.hasOwnProperty(e)&&b[e]&&(f+=c[e]*b[e]);f&&(h[d]=f)}return h},numeric.sdotVM=function(a,b){var c,d,e,f,g=[];for(c in a)if(a.hasOwnProperty(c)){e=b[c],f=a[c];for(d in e)e.hasOwnProperty(d)&&(g[d]||(g[d]=0),g[d]+=f*e[d])}return g},numeric.sdotVV=function(a,b){var c,d=0;for(c in a)a[c]&&b[c]&&(d+=a[c]*b[c]);return d},numeric.sdot=function(a,b){var c=numeric.sdim(a).length,d=numeric.sdim(b).length,e=1e3*c+d;switch(e){case 0:return a*b;case 1001:return numeric.sdotVV(a,b);case 2001:return numeric.sdotMV(a,b);case 1002:return numeric.sdotVM(a,b);case 2002:return numeric.sdotMM(a,b);default:throw new Error("numeric.sdot not implemented for tensors of order "+c+" and "+d)}},numeric.sscatter=function(a){var b,c,d,e,f=a[0].length,g=a.length,h=[];for(c=f-1;c>=0;--c)if(a[g-1][c]){for(e=h,d=0;g-2>d;d++)b=a[d][c],e[b]||(e[b]=[]),e=e[b];e[a[d][c]]=a[d+1][c]}return h},numeric.sgather=function l(a,b,c){"undefined"==typeof b&&(b=[]),"undefined"==typeof c&&(c=[]);var d,e,f;d=c.length;for(e in a)if(a.hasOwnProperty(e))if(c[d]=parseInt(e),f=a[e],"number"==typeof f){if(f){if(0===b.length)for(e=d+1;e>=0;--e)b[e]=[];for(e=d;e>=0;--e)b[e].push(c[e]);b[d+1].push(f)}}else l(f,b,c);return c.length>d&&c.pop(),b},numeric.cLU=function(a){var b,c,d,e,f,g,h=a[0],i=a[1],j=a[2],k=h.length,l=0;for(b=0;k>b;b++)h[b]>l&&(l=h[b]);l++;var m,n,o,p=Array(l),q=Array(l),r=numeric.rep([l],1/0),s=numeric.rep([l],-1/0);for(d=0;k>d;d++)b=h[d],c=i[d],c<r[b]&&(r[b]=c),c>s[b]&&(s[b]=c);for(b=0;l-1>b;b++)s[b]>s[b+1]&&(s[b+1]=s[b]);for(b=l-1;b>=1;b--)r[b]<r[b-1]&&(r[b-1]=r[b]);var t=0,u=0;for(b=0;l>b;b++)q[b]=numeric.rep([s[b]-r[b]+1],0),p[b]=numeric.rep([b-r[b]],0),t+=b-r[b]+1,u+=s[b]-b+1;for(d=0;k>d;d++)b=h[d],q[b][i[d]-r[b]]=j[d];for(b=0;l-1>b;b++)for(e=b-r[b],m=q[b],c=b+1;r[c]<=b&&l>c;c++)if(f=b-r[c],g=s[b]-b,n=q[c],o=n[f]/m[e],o){for(d=1;g>=d;d++)n[d+f]-=o*m[d+e];p[c][b-r[c]]=o}var k,v,w,m=[],n=[],x=[],y=[],z=[],A=[];for(k=0,v=0,b=0;l>b;b++){for(e=r[b],f=s[b],w=q[b],c=b;f>=c;c++)w[c-e]&&(m[k]=b,n[k]=c,x[k]=w[c-e],k++);for(w=p[b],c=e;b>c;c++)w[c-e]&&(y[v]=b,z[v]=c,A[v]=w[c-e],v++);y[v]=b,z[v]=b,A[v]=1,v++}return{U:[m,n,x],L:[y,z,A]}},numeric.cLUsolve=function(a,b){var c,d,e=a.L,f=a.U,g=numeric.clone(b),h=e[0],i=e[1],j=e[2],k=f[0],l=f[1],m=f[2],n=k.length,o=(h.length,g.length);for(d=0,c=0;o>c;c++){for(;i[d]<c;)g[c]-=j[d]*g[i[d]],d++;d++}for(d=n-1,c=o-1;c>=0;c--){for(;l[d]>c;)g[c]-=m[d]*g[l[d]],d--;g[c]/=m[d],d--}return g},numeric.cgrid=function(a,b){"number"==typeof a&&(a=[a,a]);var c,d,e,f=numeric.rep(a,-1);if("function"!=typeof b)switch(b){case"L":b=function(b,c){return b>=a[0]/2||c<a[1]/2};break;default:b=function(){return!0}}for(e=0,c=1;c<a[0]-1;c++)for(d=1;d<a[1]-1;d++)b(c,d)&&(f[c][d]=e,e++);return f},numeric.cdelsq=function(a){var b,c,d,e,f,g=[[-1,0],[0,-1],[0,1],[1,0]],h=numeric.dim(a),i=h[0],j=h[1],k=[],l=[],m=[];for(b=1;i-1>b;b++)for(c=1;j-1>c;c++)if(!(a[b][c]<0)){for(d=0;4>d;d++)e=b+g[d][0],f=c+g[d][1],a[e][f]<0||(k.push(a[b][c]),l.push(a[e][f]),m.push(-1));k.push(a[b][c]),l.push(a[b][c]),m.push(4)}return[k,l,m]},numeric.cdotMV=function(a,b){var c,d,e,f=a[0],g=a[1],h=a[2],i=f.length;for(e=0,d=0;i>d;d++)f[d]>e&&(e=f[d]);for(e++,c=numeric.rep([e],0),d=0;i>d;d++)c[f[d]]+=h[d]*b[g[d]];return c},numeric.Spline=function(a,b,c,d,e){this.x=a,this.yl=b,this.yr=c,this.kl=d,this.kr=e},numeric.Spline.prototype._at=function(a,b){var a,c,d,e,f=this.x,g=this.yl,h=this.yr,i=this.kl,j=this.kr,k=numeric.add,l=numeric.sub,m=numeric.mul;c=l(m(i[b],f[b+1]-f[b]),l(h[b+1],g[b])),d=k(m(j[b+1],f[b]-f[b+1]),l(h[b+1],g[b])),e=(a-f[b])/(f[b+1]-f[b]);var n=e*(1-e);return k(k(k(m(1-e,g[b]),m(e,h[b+1])),m(c,n*(1-e))),m(d,n*e))},numeric.Spline.prototype.at=function(a){if("number"==typeof a){var b,c,d,e=this.x,f=e.length,g=Math.floor;for(b=0,c=f-1;c-b>1;)d=g((b+c)/2),e[d]<=a?b=d:c=d;return this._at(a,b)}var h,f=a.length,i=Array(f);for(h=f-1;-1!==h;--h)i[h]=this.at(a[h]);return i},numeric.Spline.prototype.diff=function(){var a,b,c,d=this.x,e=this.yl,f=this.yr,g=this.kl,h=this.kr,i=e.length,j=g,k=h,l=Array(i),m=Array(i),n=numeric.add,o=numeric.mul,p=numeric.div,q=numeric.sub;for(a=i-1;-1!==a;--a)b=d[a+1]-d[a],c=q(f[a+1],e[a]),l[a]=p(n(o(c,6),o(g[a],-4*b),o(h[a+1],-2*b)),b*b),m[a+1]=p(n(o(c,-6),o(g[a],2*b),o(h[a+1],4*b)),b*b);return new numeric.Spline(d,j,k,l,m)},numeric.Spline.prototype.roots=function(){function a(a){return a*a}var b=[],c=this.x,d=this.yl,e=this.yr,f=this.kl,g=this.kr;"number"==typeof d[0]&&(d=[d],e=[e],f=[f],g=[g]);var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=d.length,G=c.length-1,b=Array(F),H=Math.sqrt;for(h=0;h!==F;++h){for(k=d[h],l=e[h],m=f[h],n=g[h],o=[],i=0;i!==G;i++){for(i>0&&l[i]*k[i]<0&&o.push(c[i]),w=c[i+1]-c[i],x=c[i],r=k[i],s=l[i+1],p=m[i]/w,q=n[i+1]/w,v=a(p-q+3*(r-s))+12*q*r,t=q+3*r+2*p-3*s,u=3*(q+p+2*(r-s)),0>=v?(z=t/u,y=z>c[i]&&z<c[i+1]?[c[i],z,c[i+1]]:[c[i],c[i+1]]):(z=(t-H(v))/u,A=(t+H(v))/u,y=[c[i]],z>c[i]&&z<c[i+1]&&y.push(z),A>c[i]&&A<c[i+1]&&y.push(A),y.push(c[i+1])),C=y[0],z=this._at(C,i),j=0;j<y.length-1;j++)if(D=y[j+1],A=this._at(D,i),0!==z)if(0===A||z*A>0)C=D,z=A;else{for(var I=0;E=(z*D-A*C)/(z-A),!(C>=E||E>=D);)if(B=this._at(E,i),B*A>0)D=E,A=B,-1===I&&(z*=.5),I=-1;else{if(!(B*z>0))break;C=E,z=B,1===I&&(A*=.5),I=1}o.push(E),C=y[j+1],z=this._at(C,i)}else o.push(C),C=D,z=A;0===A&&o.push(D)}b[h]=o}return"number"==typeof this.yl[0]?b[0]:b},numeric.spline=function(a,b,c,d){var e,f=a.length,g=[],h=[],i=[],j=numeric.sub,k=numeric.mul,l=numeric.add;for(e=f-2;e>=0;e--)h[e]=a[e+1]-a[e],i[e]=j(b[e+1],b[e]);("string"==typeof c||"string"==typeof d)&&(c=d="periodic");var m=[[],[],[]];switch(typeof c){case"undefined":g[0]=k(3/(h[0]*h[0]),i[0]),m[0].push(0,0),m[1].push(0,1),m[2].push(2/h[0],1/h[0]);break;case"string":g[0]=l(k(3/(h[f-2]*h[f-2]),i[f-2]),k(3/(h[0]*h[0]),i[0])),m[0].push(0,0,0),m[1].push(f-2,0,1),m[2].push(1/h[f-2],2/h[f-2]+2/h[0],1/h[0]);break;default:g[0]=c,m[0].push(0),m[1].push(0),m[2].push(1)}for(e=1;f-1>e;e++)g[e]=l(k(3/(h[e-1]*h[e-1]),i[e-1]),k(3/(h[e]*h[e]),i[e])),m[0].push(e,e,e),m[1].push(e-1,e,e+1),m[2].push(1/h[e-1],2/h[e-1]+2/h[e],1/h[e]);switch(typeof d){case"undefined":g[f-1]=k(3/(h[f-2]*h[f-2]),i[f-2]),m[0].push(f-1,f-1),m[1].push(f-2,f-1),m[2].push(1/h[f-2],2/h[f-2]);break;case"string":m[1][m[1].length-1]=0;break;default:g[f-1]=d,m[0].push(f-1),m[1].push(f-1),m[2].push(1)}g="number"!=typeof g[0]?numeric.transpose(g):[g];var n=Array(g.length);if("string"==typeof c)for(e=n.length-1;-1!==e;--e)n[e]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(m)),g[e]),n[e][f-1]=n[e][0];else for(e=n.length-1;-1!==e;--e)n[e]=numeric.cLUsolve(numeric.cLU(m),g[e]);return n="number"==typeof b[0]?n[0]:numeric.transpose(n),new numeric.Spline(a,b,b,n,n)},numeric.fftpow2=function m(a,b){var c=a.length;if(1!==c){var d,e,f=Math.cos,g=Math.sin,h=Array(c/2),i=Array(c/2),j=Array(c/2),k=Array(c/2);for(e=c/2,d=c-1;-1!==d;--d)--e,j[e]=a[d],k[e]=b[d],--d,h[e]=a[d],i[e]=b[d];m(h,i),m(j,k),e=c/2;var l,n,o,p=-6.283185307179586/c;for(d=c-1;-1!==d;--d)--e,-1===e&&(e=c/2-1),l=p*d,n=f(l),o=g(l),a[d]=h[e]+n*j[e]-o*k[e],b[d]=i[e]+n*k[e]+o*j[e]}},numeric._ifftpow2=function n(a,b){var c=a.length;if(1!==c){var d,e,f=Math.cos,g=Math.sin,h=Array(c/2),i=Array(c/2),j=Array(c/2),k=Array(c/2);for(e=c/2,d=c-1;-1!==d;--d)--e,j[e]=a[d],k[e]=b[d],--d,h[e]=a[d],i[e]=b[d];n(h,i),n(j,k),e=c/2;var l,m,o,p=6.283185307179586/c;for(d=c-1;-1!==d;--d)--e,-1===e&&(e=c/2-1),l=p*d,m=f(l),o=g(l),a[d]=h[e]+m*j[e]-o*k[e],b[d]=i[e]+m*k[e]+o*j[e]}},numeric.ifftpow2=function(a,b){numeric._ifftpow2(a,b),numeric.diveq(a,a.length),numeric.diveq(b,b.length)},numeric.convpow2=function(a,b,c,d){numeric.fftpow2(a,b),numeric.fftpow2(c,d);var e,f,g,h,i,j=a.length;for(e=j-1;-1!==e;--e)f=a[e],h=b[e],g=c[e],i=d[e],a[e]=f*g-h*i,b[e]=f*i+h*g;numeric.ifftpow2(a,b)},numeric.T.prototype.fft=function(){{var a,b,c=this.x,d=this.y,e=c.length,f=Math.log,g=f(2),h=Math.ceil(f(2*e-1)/g),i=Math.pow(2,h),j=numeric.rep([i],0),k=numeric.rep([i],0),l=Math.cos,m=Math.sin,n=-3.141592653589793/e,o=numeric.rep([i],0),p=numeric.rep([i],0);Math.floor(e/2)}for(a=0;e>a;a++)o[a]=c[a];if("undefined"!=typeof d)for(a=0;e>a;a++)p[a]=d[a];for(j[0]=1,a=1;i/2>=a;a++)b=n*a*a,j[a]=l(b),k[a]=m(b),j[i-a]=l(b),k[i-a]=m(b);var q=new numeric.T(o,p),r=new numeric.T(j,k);return q=q.mul(r),numeric.convpow2(q.x,q.y,numeric.clone(r.x),numeric.neg(r.y)),q=q.mul(r),q.x.length=e,q.y.length=e,q},numeric.T.prototype.ifft=function(){{var a,b,c=this.x,d=this.y,e=c.length,f=Math.log,g=f(2),h=Math.ceil(f(2*e-1)/g),i=Math.pow(2,h),j=numeric.rep([i],0),k=numeric.rep([i],0),l=Math.cos,m=Math.sin,n=3.141592653589793/e,o=numeric.rep([i],0),p=numeric.rep([i],0);Math.floor(e/2)}for(a=0;e>a;a++)o[a]=c[a];if("undefined"!=typeof d)for(a=0;e>a;a++)p[a]=d[a];for(j[0]=1,a=1;i/2>=a;a++)b=n*a*a,j[a]=l(b),k[a]=m(b),j[i-a]=l(b),k[i-a]=m(b);var q=new numeric.T(o,p),r=new numeric.T(j,k);return q=q.mul(r),numeric.convpow2(q.x,q.y,numeric.clone(r.x),numeric.neg(r.y)),q=q.mul(r),q.x.length=e,q.y.length=e,q.div(e)},numeric.gradient=function(a,b){var c=b.length,d=a(b);if(isNaN(d))throw new Error("gradient: f(x) is a NaN!");var e,f,g,h,i,j,k,l,m,n,o=Math.max,p=numeric.clone(b),q=Array(c),o=(numeric.div,numeric.sub,Math.max),r=.001,s=Math.abs,t=Math.min,u=0;for(e=0;c>e;e++)for(var v=o(1e-6*d,1e-8);;){if(++u,u>20)throw new Error("Numerical gradient fails");if(p[e]=b[e]+v,f=a(p),p[e]=b[e]-v,g=a(p),p[e]=b[e],isNaN(f)||isNaN(g))v/=16;else{if(q[e]=(f-g)/(2*v),i=b[e]-v,j=b[e],k=b[e]+v,l=(f-d)/v,m=(d-g)/v,n=o(s(q[e]),s(d),s(f),s(g),s(i),s(j),s(k),1e-8),h=t(o(s(l-q[e]),s(m-q[e]),s(l-m))/n,v/n),!(h>r))break;v/=16}}return q},numeric.uncmin=function(a,b,c,d,e,f,g){var h=numeric.gradient;"undefined"==typeof g&&(g={}),"undefined"==typeof c&&(c=1e-8),"undefined"==typeof d&&(d=function(b){return h(a,b)}),"undefined"==typeof e&&(e=1e3),b=numeric.clone(b);var i,j,k=b.length,l=a(b);if(isNaN(l))throw new Error("uncmin: f(x0) is a NaN!");var m=Math.max,n=numeric.norm2;c=m(c,numeric.epsilon);var o,p,q,r,s,t,u,v,w,x,y=g.Hinv||numeric.identity(k),z=numeric.dot,A=(numeric.inv,numeric.sub),B=numeric.add,C=numeric.tensor,D=numeric.div,E=numeric.mul,F=numeric.all,G=numeric.isFinite,H=numeric.neg,I=0,J="";for(p=d(b);e>I;){if("function"==typeof f&&f(I,b,l,p,y)){J="Callback returned true";break}if(!F(G(p))){J="Gradient has Infinity or NaN";break}if(o=H(z(y,p)),!F(G(o))){J="Search direction has Infinity or NaN";break}if(x=n(o),c>x){J="Newton step smaller than tol";break}for(w=1,j=z(p,o),s=b;e>I&&!(c>w*x)&&(r=E(o,w),s=B(b,r),i=a(s),i-l>=.1*w*j||isNaN(i));)w*=.5,++I;if(c>w*x){J="Line search step size smaller than tol";break}if(I===e){J="maxit reached during line search";break}q=d(s),t=A(q,p),v=z(t,r),u=z(y,t),y=A(B(y,E((v+z(t,u))/(v*v),C(r,r))),D(B(C(u,r),C(r,u)),v)),b=s,l=i,p=q,++I}return{solution:b,f:l,gradient:p,invHessian:y,iterations:I,message:J}},numeric.Dopri=function(a,b,c,d,e,f,g){this.x=a,this.y=b,this.f=c,this.ymid=d,this.iterations=e,this.events=g,this.message=f},numeric.Dopri.prototype._at=function(a,b){function c(a){return a*a}var d,e,f,g,h,i,a,j,k,l,m,n=this,o=n.x,p=n.y,q=n.f,r=n.ymid,s=(o.length,Math.floor,.5),t=numeric.add,u=numeric.mul,v=numeric.sub;return d=o[b],e=o[b+1],g=p[b],h=p[b+1],j=e-d,f=d+s*j,i=r[b],k=v(q[b],u(g,1/(d-f)+2/(d-e))),l=v(q[b+1],u(h,1/(e-f)+2/(e-d))),m=[c(a-e)*(a-f)/c(d-e)/(d-f),c(a-d)*c(a-e)/c(d-f)/c(e-f),c(a-d)*(a-f)/c(e-d)/(e-f),(a-d)*c(a-e)*(a-f)/c(d-e)/(d-f),(a-e)*c(a-d)*(a-f)/c(d-e)/(e-f)],t(t(t(t(u(g,m[0]),u(i,m[1])),u(h,m[2])),u(k,m[3])),u(l,m[4]))},numeric.Dopri.prototype.at=function(a){var b,c,d,e=Math.floor;if("number"!=typeof a){var f=a.length,g=Array(f);for(b=f-1;-1!==b;--b)g[b]=this.at(a[b]);return g}var h=this.x;for(b=0,c=h.length-1;c-b>1;)d=e(.5*(b+c)),h[d]<=a?b=d:c=d;return this._at(a,b)},numeric.dopri=function(a,b,c,d,e,f,g){"undefined"==typeof e&&(e=1e-6),"undefined"==typeof f&&(f=1e3);var h,i,j,k,l,m,n,o,p,q,r,s,t,u=[a],v=[c],w=[d(a,c)],x=[],y=.2,z=[.075,.225],A=[44/45,-56/15,32/9],B=[19372/6561,-25360/2187,64448/6561,-212/729],C=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],D=[35/384,0,500/1113,125/192,-2187/6784,11/84],E=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],F=[.2,.3,.8,8/9,1,1],G=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],H=0,I=(b-a)/10,J=0,K=numeric.add,L=numeric.mul,M=(Math.max,Math.min),N=Math.abs,O=numeric.norminf,P=Math.pow,Q=numeric.any,R=numeric.lt,S=numeric.and,T=(numeric.sub,new numeric.Dopri(u,v,w,x,-1,""));
for("function"==typeof g&&(r=g(a,c));b>a&&f>J;)if(++J,a+I>b&&(I=b-a),h=d(a+F[0]*I,K(c,L(y*I,w[H]))),i=d(a+F[1]*I,K(K(c,L(z[0]*I,w[H])),L(z[1]*I,h))),j=d(a+F[2]*I,K(K(K(c,L(A[0]*I,w[H])),L(A[1]*I,h)),L(A[2]*I,i))),k=d(a+F[3]*I,K(K(K(K(c,L(B[0]*I,w[H])),L(B[1]*I,h)),L(B[2]*I,i)),L(B[3]*I,j))),l=d(a+F[4]*I,K(K(K(K(K(c,L(C[0]*I,w[H])),L(C[1]*I,h)),L(C[2]*I,i)),L(C[3]*I,j)),L(C[4]*I,k))),p=K(K(K(K(K(c,L(w[H],I*D[0])),L(i,I*D[2])),L(j,I*D[3])),L(k,I*D[4])),L(l,I*D[5])),m=d(a+I,p),n=K(K(K(K(K(L(w[H],I*G[0]),L(i,I*G[2])),L(j,I*G[3])),L(k,I*G[4])),L(l,I*G[5])),L(m,I*G[6])),q="number"==typeof n?N(n):O(n),q>e){if(I=.2*I*P(e/q,.25),a+I===a){T.msg="Step size became too small";break}}else{if(x[H]=K(K(K(K(K(K(c,L(w[H],I*E[0])),L(i,I*E[2])),L(j,I*E[3])),L(k,I*E[4])),L(l,I*E[5])),L(m,I*E[6])),++H,u[H]=a+I,v[H]=p,w[H]=m,"function"==typeof g){var U,V,W=a,X=a+.5*I;if(s=g(X,x[H-1]),t=S(R(r,0),R(0,s)),Q(t)||(W=X,X=a+I,r=s,s=g(X,p),t=S(R(r,0),R(0,s))),Q(t)){for(var Y,Z,$=0,_=1,ab=1;;){if("number"==typeof r)V=(ab*s*W-_*r*X)/(ab*s-_*r);else for(V=X,o=r.length-1;-1!==o;--o)r[o]<0&&s[o]>0&&(V=M(V,(ab*s[o]*W-_*r[o]*X)/(ab*s[o]-_*r[o])));if(W>=V||V>=X)break;U=T._at(V,H-1),Z=g(V,U),Y=S(R(r,0),R(0,Z)),Q(Y)?(X=V,s=Z,t=Y,ab=1,-1===$?_*=.5:_=1,$=-1):(W=V,r=Z,_=1,1===$?ab*=.5:ab=1,$=1)}return p=T._at(.5*(a+V),H-1),T.f[H]=d(V,U),T.x[H]=V,T.y[H]=U,T.ymid[H-1]=p,T.events=t,T.iterations=J,T}}a+=I,c=p,r=s,I=M(.8*I*P(e/q,.25),4*I)}return T.iterations=J,T},numeric.LU=function(a,b){b=b||!1;var c,d,e,f,g,h,i,j,k,l=Math.abs,m=a.length,n=m-1,o=new Array(m);for(b||(a=numeric.clone(a)),e=0;m>e;++e){for(i=e,h=a[e],k=l(h[e]),d=e+1;m>d;++d)f=l(a[d][e]),f>k&&(k=f,i=d);for(o[e]=i,i!=e&&(a[e]=a[i],a[i]=h,h=a[e]),g=h[e],c=e+1;m>c;++c)a[c][e]/=g;for(c=e+1;m>c;++c){for(j=a[c],d=e+1;n>d;++d)j[d]-=j[e]*h[d],++d,j[d]-=j[e]*h[d];d===n&&(j[d]-=j[e]*h[d])}}return{LU:a,P:o}},numeric.LUsolve=function(a,b){var c,d,e,f,g,h=a.LU,i=h.length,j=numeric.clone(b),k=a.P;for(c=i-1;-1!==c;--c)j[c]=b[c];for(c=0;i>c;++c)for(e=k[c],k[c]!==c&&(g=j[c],j[c]=j[e],j[e]=g),f=h[c],d=0;c>d;++d)j[c]-=j[d]*f[d];for(c=i-1;c>=0;--c){for(f=h[c],d=c+1;i>d;++d)j[c]-=j[d]*f[d];j[c]/=f[c]}return j},numeric.solve=function(a,b,c){return numeric.LUsolve(numeric.LU(a,c),b)},numeric.echelonize=function(a){var b,c,d,e,f,g,h,i,j=numeric.dim(a),k=j[0],l=j[1],m=numeric.identity(k),n=Array(k),o=Math.abs,p=numeric.diveq;for(a=numeric.clone(a),b=0;k>b;++b){for(d=0,f=a[b],g=m[b],c=1;l>c;++c)o(f[d])<o(f[c])&&(d=c);for(n[b]=d,p(g,f[d]),p(f,f[d]),c=0;k>c;++c)if(c!==b){for(h=a[c],i=h[d],e=l-1;-1!==e;--e)h[e]-=f[e]*i;for(h=m[c],e=k-1;-1!==e;--e)h[e]-=g[e]*i}}return{I:m,A:a,P:n}},numeric.__solveLP=function(a,b,c,d,e,f,g){var h,i,j,k,l=numeric.sum,m=(numeric.log,numeric.mul),n=numeric.sub,o=numeric.dot,p=numeric.div,q=numeric.add,r=a.length,s=c.length,t=!1,u=0,v=1,w=(numeric.transpose(b),numeric.svd,numeric.transpose),x=(numeric.leq,Math.sqrt),y=Math.abs,z=(numeric.muleq,numeric.norminf,numeric.any,Math.min),A=numeric.all,B=numeric.gt,C=Array(r),D=Array(s),E=(numeric.rep([s],1),numeric.solve),F=n(c,o(b,f)),G=o(a,a);for(j=u;e>j;++j){var H,I;for(H=s-1;-1!==H;--H)D[H]=p(b[H],F[H]);var J=w(D);for(H=r-1;-1!==H;--H)C[H]=l(J[H]);v=.25*y(G/o(a,C));var K=100*x(G/o(C,C));for((!isFinite(v)||v>K)&&(v=K),k=q(a,m(v,C)),i=o(J,D),H=r-1;-1!==H;--H)i[H][H]+=1;I=E(i,p(k,v),!0);var L=p(F,o(b,I)),M=1;for(H=s-1;-1!==H;--H)L[H]<0&&(M=z(M,-.999*L[H]));if(h=n(f,m(I,M)),F=n(c,o(b,h)),!A(B(F,0)))return{solution:f,message:"",iterations:j};if(f=h,d>v)return{solution:h,message:"",iterations:j};if(g){var N=o(a,k),O=o(b,k);for(t=!0,H=s-1;-1!==H;--H)if(N*O[H]<0){t=!1;break}}else t=f[r-1]>=0?!1:!0;if(t)return{solution:h,message:"Unbounded",iterations:j}}return{solution:f,message:"maximum iteration count exceeded",iterations:j}},numeric._solveLP=function(a,b,c,d,e){var f,g=a.length,h=c.length,i=(numeric.sum,numeric.log,numeric.mul,numeric.sub),j=numeric.dot,k=(numeric.div,numeric.add,numeric.rep([g],0).concat([1])),l=numeric.rep([h,1],-1),m=numeric.blockMatrix([[b,l]]),n=c,f=numeric.rep([g],0).concat(Math.max(0,numeric.sup(numeric.neg(c)))+1),o=numeric.__solveLP(k,m,n,d,e,f,!1),p=numeric.clone(o.solution);p.length=g;var q=numeric.inf(i(c,j(b,p)));if(0>q)return{solution:0/0,message:"Infeasible",iterations:o.iterations};var r=numeric.__solveLP(a,b,c,d,e-o.iterations,p,!0);return r.iterations+=o.iterations,r},numeric.solveLP=function(a,b,c,d,e,f,g){if("undefined"==typeof g&&(g=1e3),"undefined"==typeof f&&(f=numeric.epsilon),"undefined"==typeof d)return numeric._solveLP(a,b,c,f,g);var h,i=d.length,j=d[0].length,k=b.length,l=numeric.echelonize(d),m=numeric.rep([j],0),n=l.P,o=[];for(h=n.length-1;-1!==h;--h)m[n[h]]=1;for(h=j-1;-1!==h;--h)0===m[h]&&o.push(h);var p=numeric.getRange,q=numeric.linspace(0,i-1),r=numeric.linspace(0,k-1),s=p(d,q,o),t=p(b,r,n),u=p(b,r,o),v=numeric.dot,w=numeric.sub,x=v(t,l.I),y=w(u,v(x,s)),z=w(c,v(x,e)),A=Array(n.length),B=Array(o.length);for(h=n.length-1;-1!==h;--h)A[h]=a[n[h]];for(h=o.length-1;-1!==h;--h)B[h]=a[o[h]];var C=w(B,v(A,v(l.I,s))),D=numeric._solveLP(C,y,z,f,g),E=D.solution;if(E!==E)return D;var F=v(l.I,w(e,v(s,E))),G=Array(a.length);for(h=n.length-1;-1!==h;--h)G[n[h]]=F[h];for(h=o.length-1;-1!==h;--h)G[o[h]]=E[h];return{solution:G,message:D.message,iterations:D.iterations}},numeric.MPStoLP=function(a){function b(b){throw new Error("MPStoLP: "+b+"\nLine "+c+": "+a[c]+"\nCurrent state: "+h[g]+"\n")}a instanceof String&&a.split("\n");var c,d,e,f,g=0,h=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],i=a.length,j=0,k={},l=[],m=0,n={},o=0,p=[],q=[],r=[];for(c=0;i>c;++c){e=a[c];var s=e.match(/\S*/g),t=[];for(d=0;d<s.length;++d)""!==s[d]&&t.push(s[d]);if(0!==t.length){for(d=0;d<h.length&&e.substr(0,h[d].length)!==h[d];++d);if(d<h.length){if(g=d,1===d&&(f=t[1]),6===d)return{name:f,c:p,A:numeric.transpose(q),b:r,rows:k,vars:n}}else switch(g){case 0:case 1:b("Unexpected line");case 2:switch(t[0]){case"N":0===j?j=t[1]:b("Two or more N rows");break;case"L":k[t[1]]=m,l[m]=1,r[m]=0,++m;break;case"G":k[t[1]]=m,l[m]=-1,r[m]=0,++m;break;case"E":k[t[1]]=m,l[m]=0,r[m]=0,++m;break;default:b("Parse error "+numeric.prettyPrint(t))}break;case 3:n.hasOwnProperty(t[0])||(n[t[0]]=o,p[o]=0,q[o]=numeric.rep([m],0),++o);var u=n[t[0]];for(d=1;d<t.length;d+=2)if(t[d]!==j){var v=k[t[d]];q[u][v]=(l[v]<0?-1:1)*parseFloat(t[d+1])}else p[u]=parseFloat(t[d+1]);break;case 4:for(d=1;d<t.length;d+=2)r[k[t[d]]]=(l[k[t[d]]]<0?-1:1)*parseFloat(t[d+1]);break;case 5:break;case 6:b("Internal error")}}}b("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(a,b,c,d,e,f,g){function h(a){var b,d,e=this,f=a.length,g=0,h=e.i=e.j=e.m=0;for(e.S=[],e.c=[],f||(a=[f++]);c>g;)e.S[g]=g++;for(g=0;c>g;g++)b=e.S[g],h=k(h+b+a[g%f]),d=e.S[h],e.S[g]=d,e.S[h]=b;e.g=function(a){var b=e.S,d=k(e.i+1),f=b[d],g=k(e.j+f),h=b[g];b[d]=h,b[g]=f;for(var i=b[k(f+h)];--a;)d=k(d+1),f=b[d],g=k(g+f),h=b[g],b[d]=h,b[g]=f,i=i*c+b[k(f+h)];return e.i=d,e.j=g,i},e.g(c)}function i(a,b,c,d,e){if(c=[],e=typeof a,b&&"object"==e)for(d in a)if(d.indexOf("S")<5)try{c.push(i(a[d],b-1))}catch(f){}return c.length?c:a+("string"!=e?"\x00":"")}function j(a,b,c,d){for(a+="",c=0,d=0;d<a.length;d++)b[k(d)]=k((c^=19*b[k(d)])+a.charCodeAt(d));a="";for(d in b)a+=String.fromCharCode(b[d]);return a}function k(a){return a&c-1}b.seedrandom=function(k,l){var m,n=[];return k=j(i(l?[k,a]:arguments.length?k:[(new Date).getTime(),a,window],3),n),m=new h(n),j(m.S,a),b.random=function(){for(var a=m.g(d),b=g,h=0;e>a;)a=(a+h)*c,b*=c,h=m.g(1);for(;a>=f;)a/=2,b/=2,h>>>=1;return(a+h)/b},k},g=b.pow(c,d),e=b.pow(2,e),f=2*e,j(b.random(),a)}([],numeric.seedrandom,256,6,52),function(a){function b(a){if("object"!=typeof a)return a;var c,d=[],e=a.length;for(c=0;e>c;c++)d[c+1]=b(a[c]);return d}function c(a){if("object"!=typeof a)return a;var b,d=[],e=a.length;for(b=1;e>b;b++)d[b-1]=c(a[b]);return d}function d(a,b,c){var d,e,f,g,h;for(f=1;c>=f;f+=1){for(a[f][f]=1/a[f][f],h=-a[f][f],d=1;f>d;d+=1)a[d][f]=h*a[d][f];if(g=f+1,g>c)break;for(e=g;c>=e;e+=1)for(h=a[f][e],a[f][e]=0,d=1;f>=d;d+=1)a[d][e]=a[d][e]+h*a[d][f]}}function e(a,b,c,d){var e,f,g,h;for(f=1;c>=f;f+=1){for(h=0,e=1;f>e;e+=1)h+=a[e][f]*d[e];d[f]=(d[f]-h)/a[f][f]}for(g=1;c>=g;g+=1)for(f=c+1-g,d[f]=d[f]/a[f][f],h=-d[f],e=1;f>e;e+=1)d[e]=d[e]+h*a[e][f]}function f(a,b,c,d){var e,f,g,h,i,j;for(f=1;c>=f;f+=1){if(d[1]=f,j=0,g=f-1,1>g){if(j=a[f][f]-j,0>=j)break;a[f][f]=Math.sqrt(j)}else{for(h=1;g>=h;h+=1){for(i=a[h][f],e=1;h>e;e+=1)i-=a[e][f]*a[e][h];i/=a[h][h],a[h][f]=i,j+=i*i}if(j=a[f][f]-j,0>=j)break;a[f][f]=Math.sqrt(j)}d[1]=0}}function g(a,b,c,g,h,i,j,k,l,m,n,o,p,q,r,s){function t(){for(q[1]=q[1]+1,A=H,y=1;m>=y;y+=1){for(A+=1,N=-k[y],z=1;g>=z;z+=1)N+=j[z][y]*h[z];if(Math.abs(N)<V&&(N=0),y>n)r[A]=N;else if(r[A]=-Math.abs(N),N>0){for(z=1;g>=z;z+=1)j[z][y]=-j[z][y];k[y]=-k[y]}}for(y=1;p>=y;y+=1)r[H+o[y]]=0;for(J=0,M=0,y=1;m>=y;y+=1)r[H+y]<M*r[L+y]&&(J=y,M=r[H+y]/r[L+y]);return 0===J?999:0}function u(){for(y=1;g>=y;y+=1){for(N=0,z=1;g>=z;z+=1)N+=a[z][y]*j[z][J];r[y]=N}for(B=E,y=1;g>=y;y+=1)r[B+y]=0;for(z=p+1;g>=z;z+=1)for(y=1;g>=y;y+=1)r[B+y]=r[B+y]+a[y][z]*r[z];for(T=!0,y=p;y>=1;y-=1){for(N=r[y],A=G+y*(y+3)/2,B=A-y,z=y+1;p>=z;z+=1)N-=r[A]*r[F+z],A+=z;if(N/=r[B],r[F+y]=N,o[y]<n)break;if(0>N)break;T=!1,D=y}if(!T)for(O=r[I+D]/r[F+D],y=1;p>=y&&!(o[y]<n)&&!(r[F+y]<0);y+=1)M=r[I+y]/r[F+y],O>M&&(O=M,D=y);for(N=0,y=E+1;E+g>=y;y+=1)N+=r[y]*r[y];if(Math.abs(N)<=V){if(T)return s[1]=1,999;for(y=1;p>=y;y+=1)r[I+y]=r[I+y]-O*r[F+y];return r[I+p+1]=r[I+p+1]+O,700}for(N=0,y=1;g>=y;y+=1)N+=r[E+y]*j[y][J];for(P=-r[H+J]/N,U=!0,T||P>O&&(P=O,U=!1),y=1;g>=y;y+=1)h[y]=h[y]+P*r[E+y],Math.abs(h[y])<V&&(h[y]=0);for(i[1]=i[1]+P*N*(P/2+r[I+p+1]),y=1;p>=y;y+=1)r[I+y]=r[I+y]-P*r[F+y];if(r[I+p+1]=r[I+p+1]+P,!U){for(N=-k[J],z=1;g>=z;z+=1)N+=h[z]*j[z][J];if(J>n)r[H+J]=N;else if(r[H+J]=-Math.abs(N),N>0){for(z=1;g>=z;z+=1)j[z][J]=-j[z][J];k[J]=-k[J]}return 700}for(p+=1,o[p]=J,A=G+(p-1)*p/2+1,y=1;p-1>=y;y+=1)r[A]=r[y],A+=1;if(p===g)r[A]=r[g];else{for(y=g;y>=p+1&&0!==r[y]&&(Q=Math.max(Math.abs(r[y-1]),Math.abs(r[y])),R=Math.min(Math.abs(r[y-1]),Math.abs(r[y])),M=r[y-1]>=0?Math.abs(Q*Math.sqrt(1+R*R/(Q*Q))):-Math.abs(Q*Math.sqrt(1+R*R/(Q*Q))),Q=r[y-1]/M,R=r[y]/M,1!==Q);y-=1)if(0===Q)for(r[y-1]=R*M,z=1;g>=z;z+=1)M=a[z][y-1],a[z][y-1]=a[z][y],a[z][y]=M;else for(r[y-1]=M,S=R/(1+Q),z=1;g>=z;z+=1)M=Q*a[z][y-1]+R*a[z][y],a[z][y]=S*(a[z][y-1]+M)-a[z][y],a[z][y-1]=M;r[A]=r[p]}return 0}function v(){if(A=G+D*(D+1)/2+1,B=A+D,0===r[B])return 798;if(Q=Math.max(Math.abs(r[B-1]),Math.abs(r[B])),R=Math.min(Math.abs(r[B-1]),Math.abs(r[B])),M=r[B-1]>=0?Math.abs(Q*Math.sqrt(1+R*R/(Q*Q))):-Math.abs(Q*Math.sqrt(1+R*R/(Q*Q))),Q=r[B-1]/M,R=r[B]/M,1===Q)return 798;if(0===Q){for(y=D+1;p>=y;y+=1)M=r[B-1],r[B-1]=r[B],r[B]=M,B+=y;for(y=1;g>=y;y+=1)M=a[y][D],a[y][D]=a[y][D+1],a[y][D+1]=M}else{for(S=R/(1+Q),y=D+1;p>=y;y+=1)M=Q*r[B-1]+R*r[B],r[B]=S*(r[B-1]+M)-r[B],r[B-1]=M,B+=y;for(y=1;g>=y;y+=1)M=Q*a[y][D]+R*a[y][D+1],a[y][D+1]=S*(a[y][D]+M)-a[y][D+1],a[y][D]=M}return 0}function w(){for(B=A-D,y=1;D>=y;y+=1)r[B]=r[A],A+=1,B+=1;return r[I+D]=r[I+D+1],o[D]=o[D+1],D+=1,p>D?797:0}function x(){return r[I+p]=r[I+p+1],r[I+p+1]=0,o[p]=0,p-=1,q[2]=q[2]+1,0}var y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y;K=Math.min(g,m),A=2*g+K*(K+5)/2+2*m+1,V=1e-60;do V+=V,W=1+.1*V,X=1+.2*V;while(1>=W||1>=X);for(y=1;g>=y;y+=1)r[y]=b[y];for(y=g+1;A>=y;y+=1)r[y]=0;for(y=1;m>=y;y+=1)o[y]=0;if(C=[],0===s[1]){if(f(a,c,g,C),0!==C[1])return void(s[1]=2);e(a,c,g,b),d(a,c,g)}else{for(z=1;g>=z;z+=1)for(h[z]=0,y=1;z>=y;y+=1)h[z]=h[z]+a[y][z]*b[y];for(z=1;g>=z;z+=1)for(b[z]=0,y=z;g>=y;y+=1)b[z]=b[z]+a[z][y]*h[y]}for(i[1]=0,z=1;g>=z;z+=1)for(h[z]=b[z],i[1]=i[1]+r[z]*h[z],r[z]=0,y=z+1;g>=y;y+=1)a[y][z]=0;for(i[1]=-i[1]/2,s[1]=0,E=g,F=E+g,I=F+K,G=I+K+1,H=G+K*(K+1)/2,L=H+m,y=1;m>=y;y+=1){for(N=0,z=1;g>=z;z+=1)N+=j[z][y]*j[z][y];r[L+y]=Math.sqrt(N)}for(p=0,q[1]=0,q[2]=0,Y=0;;){if(Y=t(),999===Y)return;for(;Y=u(),0!==Y;){if(999===Y)return;if(700===Y)if(D===p)x();else{for(;v(),Y=w(),797===Y;);x()}}}}function h(a,d,e,f,h,i){a=b(a),d=b(d),e=b(e);var j,k,l,m,n,o,p=[],q=[],r=[],s=[],t=[];if(h=h||0,i=i?b(i):[void 0,0],f=f?b(f):[],k=a.length-1,l=e[1].length-1,!f)for(j=1;l>=j;j+=1)f[j]=0;for(j=1;l>=j;j+=1)q[j]=0;for(m=0,n=Math.min(k,l),j=1;k>=j;j+=1)r[j]=0;for(p[1]=0,j=1;2*k+n*(n+5)/2+2*l+1>=j;j+=1)s[j]=0;for(j=1;2>=j;j+=1)t[j]=0;return g(a,d,k,k,r,p,e,f,k,l,h,q,m,t,s,i),o="",1===i[1]&&(o="constraints are inconsistent, no solution!"),2===i[1]&&(o="matrix D in quadratic function is not positive definite!"),{solution:c(r),value:c(p),unconstrained_solution:c(d),iterations:c(t),iact:c(q),message:o}}a.solveQP=h}(numeric),numeric.svd=function(a){function b(a,b){return a=Math.abs(a),b=Math.abs(b),a>b?a*Math.sqrt(1+b*b/a/a):0==b?a:b*Math.sqrt(1+a*a/b/b)}var c,d=numeric.epsilon,e=1e-64/d,f=50,g=0,h=0,i=0,j=0,k=0,l=numeric.clone(a),m=l.length,n=l[0].length;if(n>m)throw"Need more rows than columns";var o=new Array(n),p=new Array(n);for(h=0;n>h;h++)o[h]=p[h]=0;var q=numeric.rep([n,n],0),r=0,s=0,t=0,u=0,v=0,w=0,x=0;for(h=0;n>h;h++){for(o[h]=s,x=0,k=h+1,i=h;m>i;i++)x+=l[i][h]*l[i][h];if(e>=x)s=0;else for(r=l[h][h],s=Math.sqrt(x),r>=0&&(s=-s),t=r*s-x,l[h][h]=r-s,i=k;n>i;i++){for(x=0,j=h;m>j;j++)x+=l[j][h]*l[j][i];for(r=x/t,j=h;m>j;j++)l[j][i]+=r*l[j][h]}for(p[h]=s,x=0,i=k;n>i;i++)x+=l[h][i]*l[h][i];if(e>=x)s=0;else{for(r=l[h][h+1],s=Math.sqrt(x),r>=0&&(s=-s),t=r*s-x,l[h][h+1]=r-s,i=k;n>i;i++)o[i]=l[h][i]/t;for(i=k;m>i;i++){for(x=0,j=k;n>j;j++)x+=l[i][j]*l[h][j];for(j=k;n>j;j++)l[i][j]+=x*o[j]}}v=Math.abs(p[h])+Math.abs(o[h]),v>u&&(u=v)}for(h=n-1;-1!=h;h+=-1){if(0!=s){for(t=s*l[h][h+1],i=k;n>i;i++)q[i][h]=l[h][i]/t;for(i=k;n>i;i++){for(x=0,j=k;n>j;j++)x+=l[h][j]*q[j][i];for(j=k;n>j;j++)q[j][i]+=x*q[j][h]}}for(i=k;n>i;i++)q[h][i]=0,q[i][h]=0;q[h][h]=1,s=o[h],k=h}for(h=n-1;-1!=h;h+=-1){for(k=h+1,s=p[h],i=k;n>i;i++)l[h][i]=0;if(0!=s){for(t=l[h][h]*s,i=k;n>i;i++){for(x=0,j=k;m>j;j++)x+=l[j][h]*l[j][i];for(r=x/t,j=h;m>j;j++)l[j][i]+=r*l[j][h]}for(i=h;m>i;i++)l[i][h]=l[i][h]/s}else for(i=h;m>i;i++)l[i][h]=0;l[h][h]+=1}for(d*=u,j=n-1;-1!=j;j+=-1)for(var y=0;f>y;y++){var z=!1;for(k=j;-1!=k;k+=-1){if(Math.abs(o[k])<=d){z=!0;break}if(Math.abs(p[k-1])<=d)break}if(!z){g=0,x=1;var A=k-1;for(h=k;j+1>h&&(r=x*o[h],o[h]=g*o[h],!(Math.abs(r)<=d));h++)for(s=p[h],t=b(r,s),p[h]=t,g=s/t,x=-r/t,i=0;m>i;i++)v=l[i][A],w=l[i][h],l[i][A]=v*g+w*x,l[i][h]=-v*x+w*g}if(w=p[j],k==j){if(0>w)for(p[j]=-w,i=0;n>i;i++)q[i][j]=-q[i][j];break}if(y>=f-1)throw"Error: no convergence.";for(u=p[k],v=p[j-1],s=o[j-1],t=o[j],r=((v-w)*(v+w)+(s-t)*(s+t))/(2*t*v),s=b(r,1),r=0>r?((u-w)*(u+w)+t*(v/(r-s)-t))/u:((u-w)*(u+w)+t*(v/(r+s)-t))/u,g=1,x=1,h=k+1;j+1>h;h++){for(s=o[h],v=p[h],t=x*s,s=g*s,w=b(r,t),o[h-1]=w,g=r/w,x=t/w,r=u*g+s*x,s=-u*x+s*g,t=v*x,v*=g,i=0;n>i;i++)u=q[i][h-1],w=q[i][h],q[i][h-1]=u*g+w*x,q[i][h]=-u*x+w*g;for(w=b(r,t),p[h-1]=w,g=r/w,x=t/w,r=g*s+x*v,u=-x*s+g*v,i=0;m>i;i++)v=l[i][h-1],w=l[i][h],l[i][h-1]=v*g+w*x,l[i][h]=-v*x+w*g}o[k]=0,o[j]=r,p[j]=u}for(h=0;h<p.length;h++)p[h]<d&&(p[h]=0);for(h=0;n>h;h++)for(i=h-1;i>=0;i--)if(p[i]<p[h]){for(g=p[i],p[i]=p[h],p[h]=g,j=0;j<l.length;j++)c=l[j][h],l[j][h]=l[j][i],l[j][i]=c;for(j=0;j<q.length;j++)c=q[j][h],q[j][h]=q[j][i],q[j][i]=c;h=i}return{U:l,S:p,V:q}};var M=Math,besselj=function(){function a(a){var b,h,i,j=a*a,k=M.abs(a)-.785398164;return M.abs(a)<8?(h=_horner(c,j),i=_horner(d,j),b=h/i):(j=64/j,h=_horner(e,j),i=_horner(f,j),b=M.sqrt(g/M.abs(a))*(M.cos(k)*h-M.sin(k)*i*8/M.abs(a))),b}function b(a){var b,c,d,e=a*a,f=M.abs(a)-2.356194491;return Math.abs(a)<8?(c=a*_horner(h,e),d=_horner(i,e),b=c/d):(e=64/e,c=_horner(j,e),d=_horner(k,e),b=M.sqrt(g/M.abs(a))*(M.cos(f)*c-M.sin(f)*d*8/M.abs(a)),0>a&&(b=-b)),b}var c=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),d=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),e=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),f=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),g=.636619772,h=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),i=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),j=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),k=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return function(c,d){if(d=Math.round(d),0===d)return a(M.abs(c));if(1===d)return b(M.abs(c));if(0>d)throw"BESSELJ: Order ("+d+") must be nonnegative";if(0===M.abs(c))return 0;var e,f,g,h,i,j,k,l,m=2/M.abs(c);if(M.abs(c)>d)e=_bessel_iter(c,d,a(M.abs(c)),b(M.abs(c)),-1);else{for(g=2*M.floor((d+M.floor(M.sqrt(40*d)))/2),h=0,j=e=i=0,k=1,f=g;f>0;f--)l=f*m*k-j,j=k,k=l,M.abs(k)>1e10&&(k*=1e-10,j*=1e-10,e*=1e-10,i*=1e-10),h&&(i+=k),h=!h,f==d&&(e=j);i=2*i-k,e/=i}return 0>c&&d%2?-e:e}}(),bessely=function(){function a(a){var b,h,i,j=a*a,k=a-.785398164;return 8>a?(h=_horner(c,j),i=_horner(d,j),b=h/i+g*besselj(a,0)*M.log(a)):(j=64/j,h=_horner(e,j),i=_horner(f,j),b=M.sqrt(g/a)*(M.sin(k)*h+M.cos(k)*i*8/a)),b}function b(a){var b,c,d,e=a*a,f=a-2.356194491;return 8>a?(c=a*_horner(h,e),d=_horner(i,e),b=c/d+g*(besselj(a,1)*M.log(a)-1/a)):(e=64/e,c=_horner(j,e),d=_horner(k,e),b=M.sqrt(g/a)*(M.sin(f)*c+M.cos(f)*d*8/a)),b}var c=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),d=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),e=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),f=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),g=.636619772,h=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),i=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),j=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),k=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return _bessel_wrap(a,b,"BESSELY",1,-1)}(),besseli=function(){function a(a){return 3.75>=a?_horner(c,a*a/14.0625):M.exp(M.abs(a))/M.sqrt(M.abs(a))*_horner(d,3.75/M.abs(a))}function b(a){return 3.75>a?a*_horner(e,a*a/14.0625):(0>a?-1:1)*M.exp(M.abs(a))/M.sqrt(M.abs(a))*_horner(f,3.75/M.abs(a))}var c=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),d=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),e=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),f=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();return function g(c,d){if(d=Math.round(d),0===d)return a(c);if(1==d)return b(c);if(0>d)throw"BESSELI Order ("+d+") must be nonnegative";if(0===M.abs(c))return 0;var e,f,h,i,j,k,l=2/M.abs(c);for(h=2*M.round((d+M.round(M.sqrt(40*d)))/2),i=e=0,j=1,f=h;f>0;f--)k=f*l*j+i,i=j,j=k,M.abs(j)>1e10&&(j*=1e-10,i*=1e-10,e*=1e-10),f==d&&(e=i);return e*=g(c,0)/j,0>c&&d%2?-e:e}}(),besselk=function(){function a(a){return 2>=a?-M.log(a/2)*besseli(a,0)+_horner(c,a*a/4):M.exp(-a)/M.sqrt(a)*_horner(d,2/a)}function b(a){return 2>=a?M.log(a/2)*besseli(a,1)+1/a*_horner(e,a*a/4):M.exp(-a)/M.sqrt(a)*_horner(f,2/a)}var c=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),d=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),e=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),f=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return _bessel_wrap(a,b,"BESSELK",2,1)}();"undefined"!=typeof exports&&(exports.besselj=besselj,exports.bessely=bessely,exports.besseli=besseli,exports.besselk=besselk),!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):"object"==typeof exports?exports.formulajs=b():a.formulajs=b()}(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){var d=[c(1),c(2),c(3),c(4),c(5),c(6),c(7),c(8),c(9),c(10),c(11),c(12)];for(var e in d){var f=d[e];for(var g in f)b[g]=b[g]||f[g]}},function(a,b,c){function d(a,b){if(b)for(var c in b)a[c]=b[c];return a}var e=c(5),f=c(11),g=c(3),h=c(7);b.BETADIST=f.BETA.DIST,b.BETAINV=f.BETA.INV,b.BINOMDIST=f.BINOM.DIST,b.CEILING=b.ISOCEILING=d(e.CEILING.MATH,e.CEILING),b.CEILINGMATH=e.CEILING.MATH,b.CEILINGPRECISE=e.CEILING.PRECISE,b.CHIDIST=f.CHISQ.DIST,b.CHIDISTRT=f.CHISQ.DIST.RT,b.CHIINV=f.CHISQ.INV,b.CHIINVRT=f.CHISQ.INV.RT,b.CHITEST=f.CHISQ.TEST,b.CONFIDENCE=d(f.CONFIDENCE.NORM,f.CONFIDENCE),b.COVAR=f.COVARIANCE.P,b.COVARIANCEP=f.COVARIANCE.P,b.COVARIANCES=f.COVARIANCE.S,b.CRITBINOM=f.BINOM.INV,b.EXPONDIST=f.EXPON.DIST,b.ERFCPRECISE=g.ERFC.PRECISE,b.ERFPRECISE=g.ERF.PRECISE,b.FDIST=f.F.DIST,b.FDISTRT=f.F.DIST.RT,b.FINVRT=f.F.INV.RT,b.FINV=f.F.INV,b.FLOOR=d(e.FLOOR.MATH,e.FLOOR),b.FLOORMATH=e.FLOOR.MATH,b.FLOORPRECISE=e.FLOOR.PRECISE,b.FTEST=f.F.TEST,b.GAMMADIST=f.GAMMA.DIST,b.GAMMAINV=f.GAMMA.INV,b.GAMMALNPRECISE=f.GAMMALN.PRECISE,b.HYPGEOMDIST=f.HYPGEOM.DIST,b.LOGINV=f.LOGNORM.INV,b.LOGNORMINV=f.LOGNORM.INV,b.LOGNORMDIST=f.LOGNORM.DIST,b.MODE=d(f.MODE.SNGL,f.MODE),b.MODEMULT=f.MODE.MULT,b.MODESNGL=f.MODE.SNGL,b.NEGBINOMDIST=f.NEGBINOM.DIST,b.NETWORKDAYSINTL=h.NETWORKDAYS.INTL,b.NORMDIST=f.NORM.DIST,b.NORMINV=f.NORM.INV,b.NORMSDIST=f.NORM.S.DIST,b.NORMSINV=f.NORM.S.INV,b.PERCENTILE=d(f.PERCENTILE.EXC,f.PERCENTILE),b.PERCENTILEEXC=f.PERCENTILE.EXC,b.PERCENTILEINC=f.PERCENTILE.INC,b.PERCENTRANK=d(f.PERCENTRANK.INC,f.PERCENTRANK),b.PERCENTRANKEXC=f.PERCENTRANK.EXC,b.PERCENTRANKINC=f.PERCENTRANK.INC,b.POISSON=d(f.POISSON.DIST,f.POISSON),b.POISSONDIST=f.POISSON.DIST,b.QUARTILE=d(f.QUARTILE.INC,f.QUARTILE),b.QUARTILEEXC=f.QUARTILE.EXC,b.QUARTILEINC=f.QUARTILE.INC,b.RANK=d(f.RANK.EQ,f.RANK),b.RANKAVG=f.RANK.AVG,b.RANKEQ=f.RANK.EQ,b.SKEWP=f.SKEW.P,b.STDEV=d(f.STDEV.S,f.STDEV),b.STDEVP=f.STDEV.P,b.STDEVS=f.STDEV.S,b.TDIST=f.T.DIST,b.TDISTRT=f.T.DIST.RT,b.TINV=f.T.INV,b.TTEST=f.T.TEST,b.VAR=d(f.VAR.S,f.VAR),b.VARP=f.VAR.P,b.VARS=f.VAR.S,b.WEIBULL=d(f.WEIBULL.DIST,f.WEIBULL),b.WEIBULLDIST=f.WEIBULL.DIST,b.WORKDAYINTL=h.WORKDAY.INTL,b.ZTEST=f.Z.TEST},function(module,exports,__webpack_require__){function compact(a){if(!a)return a;for(var b=[],c=0;c<a.length;++c)a[c]&&b.push(a[c]);return b}function findResultIndex(database,criterias){for(var matches={},i=1;i<database[0].length;++i)matches[i]=!0;var maxCriteriaLength=criterias[0].length;for(i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(var k=1;k<database.length;++k)for(var l=1;l<database[k].length;++l){for(var currentCriteriaResult=!1,hasMatchingCriteria=!1,j=0;j<criterias.length;++j){var criteria=criterias[j];if(!(criteria.length<maxCriteriaLength)){var criteriaField=criteria[0];if(database[k][0]===criteriaField){hasMatchingCriteria=!0;for(var p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}}hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}for(var result=[],n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result}var error=__webpack_require__(13),stats=__webpack_require__(11),maths=__webpack_require__(5),utils=__webpack_require__(14);exports.FINDFIELD=function(a,b){for(var c=null,d=0;d<a.length;d++)if(a[d][0]===b){c=d;break}return null==c?error.value:c},exports.DAVERAGE=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);for(var g=0,h=0;h<d.length;h++)g+=e[d[h]];return 0===d.length?error.div0:g/d.length},exports.DCOUNT=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);for(var g=[],h=0;h<d.length;h++)g[h]=e[d[h]];return stats.COUNT(g)},exports.DCOUNTA=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);for(var g=[],h=0;h<d.length;h++)g[h]=e[d[h]];return stats.COUNTA(g)},exports.DGET=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);return 0===d.length?error.value:d.length>1?error.num:e[d[0]]},exports.DMAX=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);for(var g=e[d[0]],h=1;h<d.length;h++)g<e[d[h]]&&(g=e[d[h]]);return g},exports.DMIN=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);for(var g=e[d[0]],h=1;h<d.length;h++)g>e[d[h]]&&(g=e[d[h]]);return g},exports.DPRODUCT=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);for(var g=[],h=0;h<d.length;h++)g[h]=e[d[h]];g=compact(g);var i=1;for(h=0;h<g.length;h++)i*=g[h];return i},exports.DSTDEV=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);for(var g=[],h=0;h<d.length;h++)g[h]=e[d[h]];return g=compact(g),stats.STDEV.S(g)},exports.DSTDEVP=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);for(var g=[],h=0;h<d.length;h++)g[h]=e[d[h]];return g=compact(g),stats.STDEV.P(g)},exports.DSUM=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);for(var g=[],h=0;h<d.length;h++)g[h]=e[d[h]];return maths.SUM(g)},exports.DVAR=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);for(var g=[],h=0;h<d.length;h++)g[h]=e[d[h]];return stats.VAR.S(g)},exports.DVARP=function(a,b,c){if(isNaN(b)&&"string"!=typeof b)return error.value;var d=findResultIndex(a,c),e=[];if("string"==typeof b){var f=exports.FINDFIELD(a,b);e=utils.rest(a[f])}else e=utils.rest(a[b]);for(var g=[],h=0;h<d.length;h++)g[h]=e[d[h]];return stats.VAR.P(g)}},function(a,b,c){function d(a){return/^[01]{1,10}$/.test(a)}var e=c(13),f=c(18).jStat,g=c(6),h=c(14),i=c(15);b.BESSELI=function(a,b){return a=h.parseNumber(a),b=h.parseNumber(b),h.anyIsError(a,b)?e.value:i.besseli(a,b)},b.BESSELJ=function(a,b){return a=h.parseNumber(a),b=h.parseNumber(b),h.anyIsError(a,b)?e.value:i.besselj(a,b)},b.BESSELK=function(a,b){return a=h.parseNumber(a),b=h.parseNumber(b),h.anyIsError(a,b)?e.value:i.besselk(a,b)},b.BESSELY=function(a,b){return a=h.parseNumber(a),b=h.parseNumber(b),h.anyIsError(a,b)?e.value:i.bessely(a,b)},b.BIN2DEC=function(a){if(!d(a))return e.num;var b=parseInt(a,2),c=a.toString();return 10===c.length&&"1"===c.substring(0,1)?parseInt(c.substring(1),2)-512:b},b.BIN2HEX=function(a,b){if(!d(a))return e.num;var c=a.toString();if(10===c.length&&"1"===c.substring(0,1))return(0xfffffffe00+parseInt(c.substring(1),2)).toString(16);var f=parseInt(a,2).toString(16);return void 0===b?f:isNaN(b)?e.value:0>b?e.num:(b=Math.floor(b),b>=f.length?g.REPT("0",b-f.length)+f:e.num)},b.BIN2OCT=function(a,b){if(!d(a))return e.num;var c=a.toString();if(10===c.length&&"1"===c.substring(0,1))return(1073741312+parseInt(c.substring(1),2)).toString(8);var f=parseInt(a,2).toString(8);return void 0===b?f:isNaN(b)?e.value:0>b?e.num:(b=Math.floor(b),b>=f.length?g.REPT("0",b-f.length)+f:e.num)},b.BITAND=function(a,b){return a=h.parseNumber(a),b=h.parseNumber(b),h.anyIsError(a,b)?e.value:0>a||0>b?e.num:Math.floor(a)!==a||Math.floor(b)!==b?e.num:a>0xffffffffffff||b>0xffffffffffff?e.num:a&b},b.BITLSHIFT=function(a,b){return a=h.parseNumber(a),b=h.parseNumber(b),h.anyIsError(a,b)?e.value:0>a?e.num:Math.floor(a)!==a?e.num:a>0xffffffffffff?e.num:Math.abs(b)>53?e.num:b>=0?a<<b:a>>-b},b.BITOR=function(a,b){return a=h.parseNumber(a),b=h.parseNumber(b),h.anyIsError(a,b)?e.value:0>a||0>b?e.num:Math.floor(a)!==a||Math.floor(b)!==b?e.num:a>0xffffffffffff||b>0xffffffffffff?e.num:a|b},b.BITRSHIFT=function(a,b){return a=h.parseNumber(a),b=h.parseNumber(b),h.anyIsError(a,b)?e.value:0>a?e.num:Math.floor(a)!==a?e.num:a>0xffffffffffff?e.num:Math.abs(b)>53?e.num:b>=0?a>>b:a<<-b},b.BITXOR=function(a,b){return a=h.parseNumber(a),b=h.parseNumber(b),h.anyIsError(a,b)?e.value:0>a||0>b?e.num:Math.floor(a)!==a||Math.floor(b)!==b?e.num:a>0xffffffffffff||b>0xffffffffffff?e.num:a^b},b.COMPLEX=function(a,b,c){if(a=h.parseNumber(a),b=h.parseNumber(b),h.anyIsError(a,b))return a;if(c=void 0===c?"i":c,"i"!==c&&"j"!==c)return e.value;if(0===a&&0===b)return 0;if(0===a)return 1===b?c:b.toString()+c;if(0===b)return a.toString();var d=b>0?"+":"";return a.toString()+d+(1===b?c:b.toString()+c)},b.CONVERT=function(a,b,c){if(a=h.parseNumber(a),a instanceof Error)return a;for(var d,f=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576e-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182e-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667e-11],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715e-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828e-27],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189e31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],g={Yi:["yobi",80,1.2089258196146292e24,"Yi","yotta"],Zi:["zebi",70,0x400000000000000000,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},i={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},j=null,k=null,l=b,m=c,n=1,o=1,p=0;p<f.length;p++)d=null===f[p][2]?[]:f[p][2],(f[p][1]===l||d.indexOf(l)>=0)&&(j=f[p]),(f[p][1]===m||d.indexOf(m)>=0)&&(k=f[p]);
if(null===j){var q=g[b.substring(0,2)],r=i[b.substring(0,1)];"da"===b.substring(0,2)&&(r=["dekao",10,"da"]),q?(n=q[2],l=b.substring(2)):r&&(n=r[1],l=b.substring(r[2].length));for(var s=0;s<f.length;s++)d=null===f[s][2]?[]:f[s][2],(f[s][1]===l||d.indexOf(l)>=0)&&(j=f[s])}if(null===k){var t=g[c.substring(0,2)],u=i[c.substring(0,1)];"da"===c.substring(0,2)&&(u=["dekao",10,"da"]),t?(o=t[2],m=c.substring(2)):u&&(o=u[1],m=c.substring(u[2].length));for(var v=0;v<f.length;v++)d=null===f[v][2]?[]:f[v][2],(f[v][1]===m||d.indexOf(m)>=0)&&(k=f[v])}return null===j||null===k?e.na:j[3]!==k[3]?e.na:a*j[6]*n/(k[6]*o)},b.DEC2BIN=function(a,b){if(a=h.parseNumber(a),a instanceof Error)return a;if(!/^-?[0-9]{1,3}$/.test(a)||-512>a||a>511)return e.num;if(0>a)return"1"+g.REPT("0",9-(512+a).toString(2).length)+(512+a).toString(2);var c=parseInt(a,10).toString(2);return"undefined"==typeof b?c:isNaN(b)?e.value:0>b?e.num:(b=Math.floor(b),b>=c.length?g.REPT("0",b-c.length)+c:e.num)},b.DEC2HEX=function(a,b){if(a=h.parseNumber(a),a instanceof Error)return a;if(!/^-?[0-9]{1,12}$/.test(a)||-549755813888>a||a>549755813887)return e.num;if(0>a)return(1099511627776+a).toString(16);var c=parseInt(a,10).toString(16);return"undefined"==typeof b?c:isNaN(b)?e.value:0>b?e.num:(b=Math.floor(b),b>=c.length?g.REPT("0",b-c.length)+c:e.num)},b.DEC2OCT=function(a,b){if(a=h.parseNumber(a),a instanceof Error)return a;if(!/^-?[0-9]{1,9}$/.test(a)||-536870912>a||a>536870911)return e.num;if(0>a)return(1073741824+a).toString(8);var c=parseInt(a,10).toString(8);return"undefined"==typeof b?c:isNaN(b)?e.value:0>b?e.num:(b=Math.floor(b),b>=c.length?g.REPT("0",b-c.length)+c:e.num)},b.DELTA=function(a,b){return b=void 0===b?0:b,a=h.parseNumber(a),b=h.parseNumber(b),h.anyIsError(a,b)?e.value:a===b?1:0},b.ERF=function(a,b){return b=void 0===b?0:b,a=h.parseNumber(a),b=h.parseNumber(b),h.anyIsError(a,b)?e.value:f.erf(a)},b.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")},b.ERFC=function(a){return isNaN(a)?e.value:f.erfc(a)},b.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")},b.GESTEP=function(a,b){return b=b||0,a=h.parseNumber(a),h.anyIsError(b,a)?a:a>=b?1:0},b.HEX2BIN=function(a,b){if(!/^[0-9A-Fa-f]{1,10}$/.test(a))return e.num;var c=10===a.length&&"f"===a.substring(0,1).toLowerCase()?!0:!1,d=c?parseInt(a,16)-1099511627776:parseInt(a,16);if(-512>d||d>511)return e.num;if(c)return"1"+g.REPT("0",9-(512+d).toString(2).length)+(512+d).toString(2);var f=d.toString(2);return void 0===b?f:isNaN(b)?e.value:0>b?e.num:(b=Math.floor(b),b>=f.length?g.REPT("0",b-f.length)+f:e.num)},b.HEX2DEC=function(a){if(!/^[0-9A-Fa-f]{1,10}$/.test(a))return e.num;var b=parseInt(a,16);return b>=549755813888?b-1099511627776:b},b.HEX2OCT=function(a,b){if(!/^[0-9A-Fa-f]{1,10}$/.test(a))return e.num;var c=parseInt(a,16);if(c>536870911&&0xffe0000000>c)return e.num;if(c>=0xffe0000000)return(c-0xffc0000000).toString(8);var d=c.toString(8);return void 0===b?d:isNaN(b)?e.value:0>b?e.num:(b=Math.floor(b),b>=d.length?g.REPT("0",b-d.length)+d:e.num)},b.IMABS=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);return h.anyIsError(c,d)?e.value:Math.sqrt(Math.pow(c,2)+Math.pow(d,2))},b.IMAGINARY=function(a){if(void 0===a||a===!0||a===!1)return e.value;if(0===a||"0"===a)return 0;if(["i","j"].indexOf(a)>=0)return 1;a=a.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var b=a.indexOf("+"),c=a.indexOf("-");0===b&&(b=a.indexOf("+",1)),0===c&&(c=a.indexOf("-",1));var d=a.substring(a.length-1,a.length),f="i"===d||"j"===d;return b>=0||c>=0?f?b>=0?isNaN(a.substring(0,b))||isNaN(a.substring(b+1,a.length-1))?e.num:Number(a.substring(b+1,a.length-1)):isNaN(a.substring(0,c))||isNaN(a.substring(c+1,a.length-1))?e.num:-Number(a.substring(c+1,a.length-1)):e.num:f?isNaN(a.substring(0,a.length-1))?e.num:a.substring(0,a.length-1):isNaN(a)?e.num:0},b.IMARGUMENT=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);return h.anyIsError(c,d)?e.value:0===c&&0===d?e.div0:0===c&&d>0?Math.PI/2:0===c&&0>d?-Math.PI/2:0===d&&c>0?0:0===d&&0>c?-Math.PI:c>0?Math.atan(d/c):0>c&&d>=0?Math.atan(d/c)+Math.PI:Math.atan(d/c)-Math.PI},b.IMCONJUGATE=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);if(h.anyIsError(c,d))return e.value;var f=a.substring(a.length-1);return f="i"===f||"j"===f?f:"i",0!==d?b.COMPLEX(c,-d,f):a},b.IMCOS=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);if(h.anyIsError(c,d))return e.value;var f=a.substring(a.length-1);return f="i"===f||"j"===f?f:"i",b.COMPLEX(Math.cos(c)*(Math.exp(d)+Math.exp(-d))/2,-Math.sin(c)*(Math.exp(d)-Math.exp(-d))/2,f)},b.IMCOSH=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);if(h.anyIsError(c,d))return e.value;var f=a.substring(a.length-1);return f="i"===f||"j"===f?f:"i",b.COMPLEX(Math.cos(d)*(Math.exp(c)+Math.exp(-c))/2,Math.sin(d)*(Math.exp(c)-Math.exp(-c))/2,f)},b.IMCOT=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);return h.anyIsError(c,d)?e.value:b.IMDIV(b.IMCOS(a),b.IMSIN(a))},b.IMDIV=function(a,c){var d=b.IMREAL(a),f=b.IMAGINARY(a),g=b.IMREAL(c),i=b.IMAGINARY(c);if(h.anyIsError(d,f,g,i))return e.value;var j=a.substring(a.length-1),k=c.substring(c.length-1),l="i";if("j"===j?l="j":"j"===k&&(l="j"),0===g&&0===i)return e.num;var m=g*g+i*i;return b.COMPLEX((d*g+f*i)/m,(f*g-d*i)/m,l)},b.IMEXP=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);if(h.anyIsError(c,d))return e.value;var f=a.substring(a.length-1);f="i"===f||"j"===f?f:"i";var g=Math.exp(c);return b.COMPLEX(g*Math.cos(d),g*Math.sin(d),f)},b.IMLN=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);if(h.anyIsError(c,d))return e.value;var f=a.substring(a.length-1);return f="i"===f||"j"===f?f:"i",b.COMPLEX(Math.log(Math.sqrt(c*c+d*d)),Math.atan(d/c),f)},b.IMLOG10=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);if(h.anyIsError(c,d))return e.value;var f=a.substring(a.length-1);return f="i"===f||"j"===f?f:"i",b.COMPLEX(Math.log(Math.sqrt(c*c+d*d))/Math.log(10),Math.atan(d/c)/Math.log(10),f)},b.IMLOG2=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);if(h.anyIsError(c,d))return e.value;var f=a.substring(a.length-1);return f="i"===f||"j"===f?f:"i",b.COMPLEX(Math.log(Math.sqrt(c*c+d*d))/Math.log(2),Math.atan(d/c)/Math.log(2),f)},b.IMPOWER=function(a,c){c=h.parseNumber(c);var d=b.IMREAL(a),f=b.IMAGINARY(a);if(h.anyIsError(c,d,f))return e.value;var g=a.substring(a.length-1);g="i"===g||"j"===g?g:"i";var i=Math.pow(b.IMABS(a),c),j=b.IMARGUMENT(a);return b.COMPLEX(i*Math.cos(c*j),i*Math.sin(c*j),g)},b.IMPRODUCT=function(){for(var a=arguments[0],c=1;c<arguments.length;c++){var d=b.IMREAL(a),f=b.IMAGINARY(a),g=b.IMREAL(arguments[c]),i=b.IMAGINARY(arguments[c]);if(h.anyIsError(d,f,g,i))return e.value;a=b.COMPLEX(d*g-f*i,d*i+f*g)}return a},b.IMREAL=function(a){if(void 0===a||a===!0||a===!1)return e.value;if(0===a||"0"===a)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(a)>=0)return 0;var b=a.indexOf("+"),c=a.indexOf("-");0===b&&(b=a.indexOf("+",1)),0===c&&(c=a.indexOf("-",1));var d=a.substring(a.length-1,a.length),f="i"===d||"j"===d;return b>=0||c>=0?f?b>=0?isNaN(a.substring(0,b))||isNaN(a.substring(b+1,a.length-1))?e.num:Number(a.substring(0,b)):isNaN(a.substring(0,c))||isNaN(a.substring(c+1,a.length-1))?e.num:Number(a.substring(0,c)):e.num:f?isNaN(a.substring(0,a.length-1))?e.num:0:isNaN(a)?e.num:a},b.IMSEC=function(a){if(a===!0||a===!1)return e.value;var c=b.IMREAL(a),d=b.IMAGINARY(a);return h.anyIsError(c,d)?e.value:b.IMDIV("1",b.IMCOS(a))},b.IMSECH=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);return h.anyIsError(c,d)?e.value:b.IMDIV("1",b.IMCOSH(a))},b.IMSIN=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);if(h.anyIsError(c,d))return e.value;var f=a.substring(a.length-1);return f="i"===f||"j"===f?f:"i",b.COMPLEX(Math.sin(c)*(Math.exp(d)+Math.exp(-d))/2,Math.cos(c)*(Math.exp(d)-Math.exp(-d))/2,f)},b.IMSINH=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);if(h.anyIsError(c,d))return e.value;var f=a.substring(a.length-1);return f="i"===f||"j"===f?f:"i",b.COMPLEX(Math.cos(d)*(Math.exp(c)-Math.exp(-c))/2,Math.sin(d)*(Math.exp(c)+Math.exp(-c))/2,f)},b.IMSQRT=function(a){var c=b.IMREAL(a),d=b.IMAGINARY(a);if(h.anyIsError(c,d))return e.value;var f=a.substring(a.length-1);f="i"===f||"j"===f?f:"i";var g=Math.sqrt(b.IMABS(a)),i=b.IMARGUMENT(a);return b.COMPLEX(g*Math.cos(i/2),g*Math.sin(i/2),f)},b.IMCSC=function(a){if(a===!0||a===!1)return e.value;var c=b.IMREAL(a),d=b.IMAGINARY(a);return h.anyIsError(c,d)?e.num:b.IMDIV("1",b.IMSIN(a))},b.IMCSCH=function(a){if(a===!0||a===!1)return e.value;var c=b.IMREAL(a),d=b.IMAGINARY(a);return h.anyIsError(c,d)?e.num:b.IMDIV("1",b.IMSINH(a))},b.IMSUB=function(a,b){var c=this.IMREAL(a),d=this.IMAGINARY(a),f=this.IMREAL(b),g=this.IMAGINARY(b);if(h.anyIsError(c,d,f,g))return e.value;var i=a.substring(a.length-1),j=b.substring(b.length-1),k="i";return"j"===i?k="j":"j"===j&&(k="j"),this.COMPLEX(c-f,d-g,k)},b.IMSUM=function(){for(var a=h.flatten(arguments),b=a[0],c=1;c<a.length;c++){var d=this.IMREAL(b),f=this.IMAGINARY(b),g=this.IMREAL(a[c]),i=this.IMAGINARY(a[c]);if(h.anyIsError(d,f,g,i))return e.value;b=this.COMPLEX(d+g,f+i)}return b},b.IMTAN=function(a){if(a===!0||a===!1)return e.value;var c=b.IMREAL(a),d=b.IMAGINARY(a);return h.anyIsError(c,d)?e.value:this.IMDIV(this.IMSIN(a),this.IMCOS(a))},b.OCT2BIN=function(a,b){if(!/^[0-7]{1,10}$/.test(a))return e.num;var c=10===a.length&&"7"===a.substring(0,1)?!0:!1,d=c?parseInt(a,8)-1073741824:parseInt(a,8);if(-512>d||d>511)return e.num;if(c)return"1"+g.REPT("0",9-(512+d).toString(2).length)+(512+d).toString(2);var f=d.toString(2);return"undefined"==typeof b?f:isNaN(b)?e.value:0>b?e.num:(b=Math.floor(b),b>=f.length?g.REPT("0",b-f.length)+f:e.num)},b.OCT2DEC=function(a){if(!/^[0-7]{1,10}$/.test(a))return e.num;var b=parseInt(a,8);return b>=536870912?b-1073741824:b},b.OCT2HEX=function(a,b){if(!/^[0-7]{1,10}$/.test(a))return e.num;var c=parseInt(a,8);if(c>=536870912)return"ff"+(c+3221225472).toString(16);var d=c.toString(16);return void 0===b?d:isNaN(b)?e.value:0>b?e.num:(b=Math.floor(b),b>=d.length?g.REPT("0",b-d.length)+d:e.num)}},function(a,b,c){var d=c(13),e=c(14),f=c(9);b.AND=function(){for(var a=e.flatten(arguments),b=!0,c=0;c<a.length;c++)a[c]||(b=!1);return b},b.CHOOSE=function(){if(arguments.length<2)return d.na;var a=arguments[0];return 1>a||a>254?d.value:arguments.length<a+1?d.value:arguments[a]},b.FALSE=function(){return!1},b.IF=function(a,b,c){return a?b:c},b.IFERROR=function(a,b){return f.ISERROR(a)?b:a},b.IFNA=function(a,b){return a===d.na?b:a},b.NOT=function(a){return!a},b.OR=function(){for(var a=e.flatten(arguments),b=!1,c=0;c<a.length;c++)a[c]&&(b=!0);return b},b.TRUE=function(){return!0},b.XOR=function(){for(var a=e.flatten(arguments),b=0,c=0;c<a.length;c++)a[c]&&b++;return 1&Math.floor(Math.abs(b))?!0:!1},b.SWITCH=function(){var a;if(arguments.length>0){var b=arguments[0],c=arguments.length-1,d=Math.floor(c/2),e=!1,f=c%2===0?null:arguments[arguments.length-1];if(d)for(var g=0;d>g;g++)if(b===arguments[2*g+1]){a=arguments[2*g+2],e=!0;break}!e&&f&&(a=f)}return a}},function(module,exports,__webpack_require__){var numeric=__webpack_require__(16),utils=__webpack_require__(14),error=__webpack_require__(13),statistical=__webpack_require__(11),information=__webpack_require__(9);exports.ABS=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.abs(utils.parseNumber(a))},exports.ACOS=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.acos(a)},exports.ACOSH=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.log(a+Math.sqrt(a*a-1))},exports.ACOT=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.atan(1/a)},exports.ACOTH=function(a){return a=utils.parseNumber(a),a instanceof Error?a:.5*Math.log((a+1)/(a-1))},exports.AGGREGATE=function(a,b,c,d){if(a=utils.parseNumber(a),b=utils.parseNumber(a),utils.anyIsError(a,b))return error.value;switch(a){case 1:return statistical.AVERAGE(c);case 2:return statistical.COUNT(c);case 3:return statistical.COUNTA(c);case 4:return statistical.MAX(c);case 5:return statistical.MIN(c);case 6:return exports.PRODUCT(c);case 7:return statistical.STDEV.S(c);case 8:return statistical.STDEV.P(c);case 9:return exports.SUM(c);case 10:return statistical.VAR.S(c);case 11:return statistical.VAR.P(c);case 12:return statistical.MEDIAN(c);case 13:return statistical.MODE.SNGL(c);case 14:return statistical.LARGE(c,d);case 15:return statistical.SMALL(c,d);case 16:return statistical.PERCENTILE.INC(c,d);case 17:return statistical.QUARTILE.INC(c,d);case 18:return statistical.PERCENTILE.EXC(c,d);case 19:return statistical.QUARTILE.EXC(c,d)}},exports.ARABIC=function(a){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(a))return error.value;var b=0;return a.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(a){b+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[a]}),b},exports.ASIN=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.asin(a)},exports.ASINH=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.log(a+Math.sqrt(a*a+1))},exports.ATAN=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.atan(a)},exports.ATAN2=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:Math.atan2(a,b)},exports.ATANH=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.log((1+a)/(1-a))/2},exports.BASE=function(a,b,c){if(c=c||0,a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c))return error.value;c=void 0===c?0:c;var d=a.toString(b);return new Array(Math.max(c+1-d.length,0)).join("0")+d},exports.CEILING=function(a,b,c){if(b=void 0===b?1:Math.abs(b),c=c||0,a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c))return error.value;if(0===b)return 0;var d=-Math.floor(Math.log(b)/Math.log(10));return a>=0?exports.ROUND(Math.ceil(a/b)*b,d):0===c?-exports.ROUND(Math.floor(Math.abs(a)/b)*b,d):-exports.ROUND(Math.ceil(Math.abs(a)/b)*b,d)},exports.CEILING.MATH=exports.CEILING,exports.CEILING.PRECISE=exports.CEILING,exports.COMBIN=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:exports.FACT(a)/(exports.FACT(b)*exports.FACT(a-b))},exports.COMBINA=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:0===a&&0===b?1:exports.COMBIN(a+b-1,a-1)},exports.COS=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.cos(a)},exports.COSH=function(a){return a=utils.parseNumber(a),a instanceof Error?a:(Math.exp(a)+Math.exp(-a))/2},exports.COT=function(a){return a=utils.parseNumber(a),a instanceof Error?a:1/Math.tan(a)},exports.COTH=function(a){if(a=utils.parseNumber(a),a instanceof Error)return a;var b=Math.exp(2*a);return(b+1)/(b-1)},exports.CSC=function(a){return a=utils.parseNumber(a),a instanceof Error?a:1/Math.sin(a)},exports.CSCH=function(a){return a=utils.parseNumber(a),a instanceof Error?a:2/(Math.exp(a)-Math.exp(-a))},exports.DECIMAL=function(a,b){return arguments.length<1?error.value:parseInt(a,b)},exports.DEGREES=function(a){return a=utils.parseNumber(a),a instanceof Error?a:180*a/Math.PI},exports.EVEN=function(a){return a=utils.parseNumber(a),a instanceof Error?a:exports.CEILING(a,-2,-1)},exports.EXP=Math.exp;var MEMOIZED_FACT=[];exports.FACT=function(a){if(a=utils.parseNumber(a),a instanceof Error)return a;var b=Math.floor(a);return 0===b||1===b?1:MEMOIZED_FACT[b]>0?MEMOIZED_FACT[b]:(MEMOIZED_FACT[b]=exports.FACT(b-1)*b,MEMOIZED_FACT[b])},exports.FACTDOUBLE=function(a){if(a=utils.parseNumber(a),a instanceof Error)return a;var b=Math.floor(a);return 0>=b?1:b*exports.FACTDOUBLE(b-2)},exports.FLOOR=function(a,b){if(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;if(0===b)return 0;if(!(a>0&&b>0||0>a&&0>b))return error.num;b=Math.abs(b);var c=-Math.floor(Math.log(b)/Math.log(10));return a>=0?exports.ROUND(Math.floor(a/b)*b,c):-exports.ROUND(Math.ceil(Math.abs(a)/b),c)},exports.FLOOR.MATH=function(a,b,c){if(b=void 0===b?1:b,c=void 0===c?0:c,a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c))return error.value;if(0===b)return 0;b=b?Math.abs(b):1;var d=-Math.floor(Math.log(b)/Math.log(10));return a>=0?exports.ROUND(Math.floor(a/b)*b,d):0===c||void 0===c?-exports.ROUND(Math.ceil(Math.abs(a)/b)*b,d):-exports.ROUND(Math.floor(Math.abs(a)/b)*b,d)},exports.FLOOR.PRECISE=exports.FLOOR.MATH,exports.GCD=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=a.length,c=a[0],d=0>c?-c:c,e=1;b>e;e++){for(var f=a[e],g=0>f?-f:f;d&&g;)d>g?d%=g:g%=d;d+=g}return d},exports.INT=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.floor(a)},exports.ISO={CEILING:exports.CEILING},exports.LCM=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b,c,d,e,f=1;void 0!==(d=a.pop());)for(;d>1;){if(d%2){for(b=3,c=Math.floor(Math.sqrt(d));c>=b&&d%b;b+=2);e=c>=b?b:d}else e=2;for(d/=e,f*=e,b=a.length;b;a[--b]%e===0&&1===(a[b]/=e)&&a.splice(b,1));}return f},exports.LN=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.log(a)},exports.LOG=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:(b=void 0===b?10:b,Math.log(a)/Math.log(b))},exports.LOG10=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.log(a)/Math.log(10)},exports.MDETERM=function(a){return a=utils.parseMatrix(a),a instanceof Error?a:numeric.det(a)},exports.MINVERSE=function(a){return a=utils.parseMatrix(a),a instanceof Error?a:numeric.inv(a)},exports.MMULT=function(a,b){return a=utils.parseMatrix(a),b=utils.parseMatrix(b),utils.anyIsError(a,b)?error.value:numeric.dot(a,b)},exports.MOD=function(a,b){if(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;if(0===b)return error.div0;var c=Math.abs(a%b);return b>0?c:-c},exports.MROUND=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:0>a*b?error.num:Math.round(a/b)*b},exports.MULTINOMIAL=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=0,c=1,d=0;d<a.length;d++)b+=a[d],c*=exports.FACT(a[d]);return exports.FACT(b)/c},exports.MUNIT=function(a){return a=utils.parseNumber(a),a instanceof Error?a:numeric.identity(a)},exports.ODD=function(a){if(a=utils.parseNumber(a),a instanceof Error)return a;var b=Math.ceil(Math.abs(a));return b=1&b?b:b+1,a>0?b:-b},exports.PI=function(){return Math.PI},exports.POWER=function(a,b){if(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;var c=Math.pow(a,b);return isNaN(c)?error.num:c},exports.PRODUCT=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=1,c=0;c<a.length;c++)b*=a[c];return b},exports.QUOTIENT=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:parseInt(a/b,10)},exports.RADIANS=function(a){return a=utils.parseNumber(a),a instanceof Error?a:a*Math.PI/180},exports.RAND=function(){return Math.random()},exports.RANDBETWEEN=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:a+Math.ceil((b-a+1)*Math.random())-1},exports.ROMAN=function(a){if(a=utils.parseNumber(a),a instanceof Error)return a;for(var b=String(a).split(""),c=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],d="",e=3;e--;)d=(c[+b.pop()+10*e]||"")+d;return new Array(+b.join("")+1).join("M")+d},exports.ROUND=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:Math.round(a*Math.pow(10,b))/Math.pow(10,b)},exports.ROUNDDOWN=function(a,b){if(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;var c=a>0?1:-1;return c*Math.floor(Math.abs(a)*Math.pow(10,b))/Math.pow(10,b)},exports.ROUNDUP=function(a,b){if(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;var c=a>0?1:-1;return c*Math.ceil(Math.abs(a)*Math.pow(10,b))/Math.pow(10,b)},exports.SEC=function(a){return a=utils.parseNumber(a),a instanceof Error?a:1/Math.cos(a)},exports.SECH=function(a){return a=utils.parseNumber(a),a instanceof Error?a:2/(Math.exp(a)+Math.exp(-a))},exports.SERIESSUM=function(a,b,c,d){a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c);var d=utils.parseNumberArray(d);if(utils.anyIsError(a,b,c,d))return error.value;for(var e=d[0]*Math.pow(a,b),f=1;f<d.length;f++)e+=d[f]*Math.pow(a,b+f*c);return e},exports.SIGN=function(a){return a=utils.parseNumber(a),a instanceof Error?a:0>a?-1:0===a?0:1},exports.SIN=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.sin(a)},exports.SINH=function(a){return a=utils.parseNumber(a),a instanceof Error?a:(Math.exp(a)-Math.exp(-a))/2},exports.SQRT=function(a){return a=utils.parseNumber(a),a instanceof Error?a:0>a?error.num:Math.sqrt(a)},exports.SQRTPI=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.sqrt(a*Math.PI)},exports.SUBTOTAL=function(a,b){if(a=utils.parseNumber(a),a instanceof Error)return a;switch(a){case 1:return statistical.AVERAGE(b);case 2:return statistical.COUNT(b);case 3:return statistical.COUNTA(b);case 4:return statistical.MAX(b);case 5:return statistical.MIN(b);case 6:return exports.PRODUCT(b);case 7:return statistical.STDEV.S(b);case 8:return statistical.STDEV.P(b);case 9:return exports.SUM(b);case 10:return statistical.VAR.S(b);case 11:return statistical.VAR.P(b);case 101:return statistical.AVERAGE(b);case 102:return statistical.COUNT(b);case 103:return statistical.COUNTA(b);case 104:return statistical.MAX(b);case 105:return statistical.MIN(b);case 106:return exports.PRODUCT(b);case 107:return statistical.STDEV.S(b);case 108:return statistical.STDEV.P(b);case 109:return exports.SUM(b);case 110:return statistical.VAR.S(b);case 111:return statistical.VAR.P(b)}},exports.ADD=function(a,b){return 2!==arguments.length?error.na:(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:a+b)},exports.MINUS=function(a,b){return 2!==arguments.length?error.na:(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:a-b)},exports.DIVIDE=function(a,b){return 2!==arguments.length?error.na:(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:0===b?error.div0:a/b)},exports.MULTIPLY=function(a,b){return 2!==arguments.length?error.na:(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:a*b)},exports.GTE=function(a,b){return 2!==arguments.length?error.na:(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.error:a>=b)},exports.LT=function(a,b){return 2!==arguments.length?error.na:(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.error:b>a)},exports.LTE=function(a,b){return 2!==arguments.length?error.na:(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.error:b>=a)},exports.EQ=function(a,b){return 2!==arguments.length?error.na:a===b},exports.NE=function(a,b){return 2!==arguments.length?error.na:a!==b},exports.POW=function(a,b){return 2!==arguments.length?error.na:(a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.error:exports.POWER(a,b))},exports.SUM=function(){for(var a=utils.numbers(utils.flatten(arguments)),b=0,c=a.length;c--;)b+=a[c];return b},exports.SUMIF=function(range,criteria){var range=utils.parseNumberArray(utils.flatten(range));if(range instanceof Error)return range;for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},exports.SUMIFS=function(){var args=utils.argsToArray(arguments),range=utils.parseNumberArray(utils.flatten(args.shift()));if(range instanceof Error)return range;for(var criteria=args,n_range_elements=range.length,n_criterias=criteria.length,result=0,i=0;n_range_elements>i;i++){for(var el=range[i],condition="",c=0;n_criterias>c;c++)condition+=el+criteria[c],c!==n_criterias-1&&(condition+="&&");eval(condition)&&(result+=el)}return result},exports.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return error.value;for(var a,b,c,d,e=arguments.length+1,f=0,g=0;g<arguments[0].length;g++)if(arguments[0][g]instanceof Array)for(var h=0;h<arguments[0][g].length;h++){for(a=1,b=1;e>b;b++){if(d=utils.parseNumber(arguments[b-1][g][h]),d instanceof Error)return d;a*=d}f+=a}else{for(a=1,b=1;e>b;b++){if(c=utils.parseNumber(arguments[b-1][g]),c instanceof Error)return c;a*=c}f+=a}return f},exports.SUMSQ=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=0,c=a.length,d=0;c>d;d++)b+=information.ISNUMBER(a[d])?a[d]*a[d]:0;return b},exports.SUMX2MY2=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;for(var c=0,d=0;d<a.length;d++)c+=a[d]*a[d]-b[d]*b[d];return c},exports.SUMX2PY2=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;var c=0;a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b));for(var d=0;d<a.length;d++)c+=a[d]*a[d]+b[d]*b[d];return c},exports.SUMXMY2=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;var c=0;a=utils.flatten(a),b=utils.flatten(b);for(var d=0;d<a.length;d++)c+=Math.pow(a[d]-b[d],2);return c},exports.TAN=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.tan(a)},exports.TANH=function(a){if(a=utils.parseNumber(a),a instanceof Error)return a;var b=Math.exp(2*a);return(b-1)/(b+1)},exports.TRUNC=function(a,b){if(b=void 0===b?0:b,a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;var c=a>0?1:-1;return c*Math.floor(Math.abs(a)*Math.pow(10,b))/Math.pow(10,b)}},function(a,b,c){var d=c(14),e=c(13),f=c(17);b.ASC=function(){throw new Error("ASC is not implemented")},b.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},b.CHAR=function(a){return a=d.parseNumber(a),a instanceof Error?a:String.fromCharCode(a)},b.CLEAN=function(a){a=a||"";var b=/[\0-\x1F]/g;return a.replace(b,"")},b.CODE=function(a){return a=a||"",a.charCodeAt(0)},b.CONCATENATE=function(){for(var a=d.flatten(arguments),b=0;(b=a.indexOf(!0))>-1;)a[b]="TRUE";for(var c=0;(c=a.indexOf(!1))>-1;)a[c]="FALSE";return a.join("")},b.DBCS=function(){throw new Error("DBCS is not implemented")},b.DOLLAR=function(a,b){if(b=void 0===b?2:b,a=d.parseNumber(a),b=d.parseNumber(b),d.anyIsError(a,b))return e.value;var c="";return 0>=b?(a=Math.round(a*Math.pow(10,b))/Math.pow(10,b),c="($0,0)"):b>0&&(c="($0,0."+new Array(b+1).join("0")+")"),f(a).format(c)},b.EXACT=function(a,b){return a===b},b.FIND=function(a,b,c){return c=void 0===c?0:c,b?b.indexOf(a,c-1)+1:null},b.FIXED=function(a,b,c){if(b=void 0===b?2:b,c=void 0===c?!1:c,a=d.parseNumber(a),b=d.parseNumber(b),d.anyIsError(a,b))return e.value;var g=c?"0":"0,0";return 0>=b?a=Math.round(a*Math.pow(10,b))/Math.pow(10,b):b>0&&(g+="."+new Array(b+1).join("0")),f(a).format(g)},b.HTML2TEXT=function(a){var b="";return a&&(a instanceof Array?a.forEach(function(a){""!==b&&(b+="\n"),b+=a.replace(/<(?:.|\n)*?>/gm,"")}):b=a.replace(/<(?:.|\n)*?>/gm,"")),b},b.LEFT=function(a,b){return b=void 0===b?1:b,b=d.parseNumber(b),b instanceof Error||"string"!=typeof a?e.value:a?a.substring(0,b):null},b.LEN=function(a){return 0===arguments.length?e.error:"string"==typeof a?a?a.length:0:a.length?a.length:e.value},b.LOWER=function(a){return"string"!=typeof a?e.value:a?a.toLowerCase():a},b.MID=function(a,b,c){return b=d.parseNumber(b),c=d.parseNumber(c),d.anyIsError(b,c)||"string"!=typeof a?c:a.substring(b-1,c)},b.NUMBERVALUE=function(a,b,c){return b="undefined"==typeof b?".":b,c="undefined"==typeof c?",":c,Number(a.replace(b,".").replace(c,""))},b.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},b.PROPER=function(a){return void 0===a||0===a.length?e.value:(a===!0&&(a="TRUE"),a===!1&&(a="FALSE"),isNaN(a)&&"number"==typeof a?e.value:("number"==typeof a&&(a=""+a),a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})))},b.REGEXEXTRACT=function(a,b){var c=a.match(new RegExp(b));return c?c[c.length>1?c.length-1:0]:null},b.REGEXMATCH=function(a,b,c){var d=a.match(new RegExp(b));return c?d:!!d},b.REGEXREPLACE=function(a,b,c){return a.replace(new RegExp(b),c)},b.REPLACE=function(a,b,c,f){return b=d.parseNumber(b),c=d.parseNumber(c),d.anyIsError(b,c)||"string"!=typeof a||"string"!=typeof f?e.value:a.substr(0,b-1)+f+a.substr(b-1+c)},b.REPT=function(a,b){return b=d.parseNumber(b),b instanceof Error?b:new Array(b+1).join(a)},b.RIGHT=function(a,b){return b=void 0===b?1:b,b=d.parseNumber(b),b instanceof Error?b:a?a.substring(a.length-b):null},b.SEARCH=function(a,b,c){return"string"!=typeof a||"string"!=typeof b?e.value:(c=void 0===c?0:c,b.toLowerCase().indexOf(a.toLowerCase(),c-1)+1)},b.SPLIT=function(a,b){return a.split(b)},b.SUBSTITUTE=function(a,b,c,d){if(!(a&&b&&c))return a;if(void 0===d)return a.replace(new RegExp(b,"g"),c);for(var e=0,f=0;a.indexOf(b,e)>0;)if(e=a.indexOf(b,e+1),f++,f===d)return a.substring(0,e)+c+a.substring(e+b.length)},b.T=function(a){return"string"==typeof a?a:""},b.TEXT=function(a,b){return a=d.parseNumber(a),d.anyIsError(a)?e.na:f(a).format(b)},b.TRIM=function(a){return"string"!=typeof a?e.value:a.replace(/ +/g," ").trim()},b.UNICHAR=this.CHAR,b.UNICODE=this.CODE,b.UPPER=function(a){return"string"!=typeof a?e.value:a.toUpperCase()},b.VALUE=function(a){return"string"!=typeof a?e.value:f().unformat(a)}},function(a,b,c){function d(a){return 1===new Date(a,1,29).getMonth()}function e(a,b){return Math.ceil((b-a)/1e3/60/60/24)}function f(a){var b=a>-22038912e5?2:1;return(a-i)/864e5+b}var g=c(13),h=c(14),i=new Date(1900,0,1),j=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],k=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],l=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];b.DATE=function(a,b,c){if(a=h.parseNumber(a),b=h.parseNumber(b),c=h.parseNumber(c),h.anyIsError(a,b,c))return g.value;if(0>a||0>b||0>c)return g.num;var d=new Date(a,b-1,c);return d},b.DATEVALUE=function(a){if("string"!=typeof a)return g.value;var b=Date.parse(a);return isNaN(b)?g.value:-22038912e5>=b?(b-i)/864e5+1:(b-i)/864e5+2},b.DAY=function(a){var b=h.parseDate(a);return b instanceof Error?b:b.getDate()},b.DAYS=function(a,b){return a=h.parseDate(a),b=h.parseDate(b),a instanceof Error?a:b instanceof Error?b:f(a)-f(b)},b.DAYS360=function(a,b,c){if(c=h.parseBool(c),a=h.parseDate(a),b=h.parseDate(b),a instanceof Error)return a;if(b instanceof Error)return b;if(c instanceof Error)return c;var d,e,f=a.getMonth(),g=b.getMonth();if(c)d=31===a.getDate()?30:a.getDate(),e=31===b.getDate()?30:b.getDate();else{var i=new Date(a.getFullYear(),f+1,0).getDate(),j=new Date(b.getFullYear(),g+1,0).getDate();d=a.getDate()===i?30:a.getDate(),b.getDate()===j?30>d?(g++,e=1):e=30:e=b.getDate()}return 360*(b.getFullYear()-a.getFullYear())+30*(g-f)+(e-d)},b.EDATE=function(a,b){return a=h.parseDate(a),a instanceof Error?a:isNaN(b)?g.value:(b=parseInt(b,10),a.setMonth(a.getMonth()+b),f(a))},b.EOMONTH=function(a,b){return a=h.parseDate(a),a instanceof Error?a:isNaN(b)?g.value:(b=parseInt(b,10),f(new Date(a.getFullYear(),a.getMonth()+b+1,0)))},b.HOUR=function(a){return a=h.parseDate(a),a instanceof Error?a:a.getHours()},b.INTERVAL=function(a){if("number"!=typeof a&&"string"!=typeof a)return g.value;
a=parseInt(a,10);var b=Math.floor(a/94608e4);a%=94608e4;var c=Math.floor(a/2592e3);a%=2592e3;var d=Math.floor(a/86400);a%=86400;var e=Math.floor(a/3600);a%=3600;var f=Math.floor(a/60);a%=60;var h=a;return b=b>0?b+"Y":"",c=c>0?c+"M":"",d=d>0?d+"D":"",e=e>0?e+"H":"",f=f>0?f+"M":"",h=h>0?h+"S":"","P"+b+c+d+"T"+e+f+h},b.ISOWEEKNUM=function(a){if(a=h.parseDate(a),a instanceof Error)return a;a.setHours(0,0,0),a.setDate(a.getDate()+4-(a.getDay()||7));var b=new Date(a.getFullYear(),0,1);return Math.ceil(((a-b)/864e5+1)/7)},b.MINUTE=function(a){return a=h.parseDate(a),a instanceof Error?a:a.getMinutes()},b.MONTH=function(a){return a=h.parseDate(a),a instanceof Error?a:a.getMonth()+1},b.NETWORKDAYS=function(a,b,c){return this.NETWORKDAYS.INTL(a,b,1,c)},b.NETWORKDAYS.INTL=function(a,b,c,d){if(a=h.parseDate(a),a instanceof Error)return a;if(b=h.parseDate(b),b instanceof Error)return b;if(c=void 0===c?l[1]:l[c],!(c instanceof Array))return g.value;void 0===d?d=[]:d instanceof Array||(d=[d]);for(var e=0;e<d.length;e++){var f=h.parseDate(d[e]);if(f instanceof Error)return f;d[e]=f}var i=(b-a)/864e5+1,j=i,k=a;for(e=0;i>e;e++){var m=(new Date).getTimezoneOffset()>0?k.getUTCDay():k.getDay(),n=!1;(m===c[0]||m===c[1])&&(n=!0);for(var o=0;o<d.length;o++){var p=d[o];if(p.getDate()===k.getDate()&&p.getMonth()===k.getMonth()&&p.getFullYear()===k.getFullYear()){n=!0;break}}n&&j--,k.setDate(k.getDate()+1)}return j},b.NOW=function(){return new Date},b.SECOND=function(a){return a=h.parseDate(a),a instanceof Error?a:a.getSeconds()},b.TIME=function(a,b,c){return a=h.parseNumber(a),b=h.parseNumber(b),c=h.parseNumber(c),h.anyIsError(a,b,c)?g.value:0>a||0>b||0>c?g.num:(3600*a+60*b+c)/86400},b.TIMEVALUE=function(a){return a=h.parseDate(a),a instanceof Error?a:(3600*a.getHours()+60*a.getMinutes()+a.getSeconds())/86400},b.TODAY=function(){return new Date},b.WEEKDAY=function(a,b){if(a=h.parseDate(a),a instanceof Error)return a;void 0===b&&(b=1);var c=a.getDay();return k[b][c]},b.WEEKNUM=function(a,b){if(a=h.parseDate(a),a instanceof Error)return a;if(void 0===b&&(b=1),21===b)return this.ISOWEEKNUM(a);var c=j[b],d=new Date(a.getFullYear(),0,1),e=d.getDay()<c?1:0;return d-=24*Math.abs(d.getDay()-c)*60*60*1e3,Math.floor((a-d)/864e5/7+1)+e},b.WORKDAY=function(a,b,c){return this.WORKDAY.INTL(a,b,1,c)},b.WORKDAY.INTL=function(a,b,c,d){if(a=h.parseDate(a),a instanceof Error)return a;if(b=h.parseNumber(b),b instanceof Error)return b;if(0>b)return g.num;if(c=void 0===c?l[1]:l[c],!(c instanceof Array))return g.value;void 0===d?d=[]:d instanceof Array||(d=[d]);for(var e=0;e<d.length;e++){var f=h.parseDate(d[e]);if(f instanceof Error)return f;d[e]=f}for(var i=0;b>i;){a.setDate(a.getDate()+1);var j=a.getDay();if(j!==c[0]&&j!==c[1]){for(var k=0;k<d.length;k++){var m=d[k];if(m.getDate()===a.getDate()&&m.getMonth()===a.getMonth()&&m.getFullYear()===a.getFullYear()){i--;break}}i++}}return a},b.YEAR=function(a){return a=h.parseDate(a),a instanceof Error?a:a.getFullYear()},b.YEARFRAC=function(a,b,c){if(a=h.parseDate(a),a instanceof Error)return a;if(b=h.parseDate(b),b instanceof Error)return b;c=c||0;var f=a.getDate(),g=a.getMonth()+1,i=a.getFullYear(),j=b.getDate(),k=b.getMonth()+1,l=b.getFullYear();switch(c){case 0:return 31===f&&31===j?(f=30,j=30):31===f?f=30:30===f&&31===j&&(j=30),(j+30*k+360*l-(f+30*g+360*i))/360;case 1:var m=function(a,b){var c=a.getFullYear(),e=new Date(c,2,1);if(d(c)&&e>a&&b>=e)return!0;var f=b.getFullYear(),g=new Date(f,2,1);return d(f)&&b>=g&&g>a},n=365;if(i===l||i+1===l&&(g>k||g===k&&f>=j))return(i===l&&d(i)||m(a,b)||1===k&&29===j)&&(n=366),e(a,b)/n;var o=l-i+1,p=(new Date(l+1,0,1)-new Date(i,0,1))/1e3/60/60/24,q=p/o;return e(a,b)/q;case 2:return e(a,b)/360;case 3:return e(a,b)/365;case 4:return(j+30*k+360*l-(f+30*g+360*i))/360}}},function(a,b,c){function d(a){return a&&a.getTime&&!isNaN(a.getTime())}function e(a){return a instanceof Date?a:new Date(a)}var f=c(13),g=c(7),h=c(14);b.ACCRINT=function(a,b,c,f,h,i,j){return a=e(a),b=e(b),c=e(c),d(a)&&d(b)&&d(c)?0>=f||0>=h?"#NUM!":-1===[1,2,4].indexOf(i)?"#NUM!":-1===[0,1,2,3,4].indexOf(j)?"#NUM!":a>=c?"#NUM!":(h=h||0,j=j||0,h*f*g.YEARFRAC(a,c,j)):"#VALUE!"},b.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},b.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},b.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},b.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},b.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},b.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},b.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},b.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},b.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},b.CUMIPMT=function(a,c,d,e,g,i){if(a=h.parseNumber(a),c=h.parseNumber(c),d=h.parseNumber(d),h.anyIsError(a,c,d))return f.value;if(0>=a||0>=c||0>=d)return f.num;if(1>e||1>g||e>g)return f.num;if(0!==i&&1!==i)return f.num;var j=b.PMT(a,c,d,0,i),k=0;1===e&&0===i&&(k=-d,e++);for(var l=e;g>=l;l++)k+=1===i?b.FV(a,l-2,j,d,1)-j:b.FV(a,l-1,j,d,0);return k*=a},b.CUMPRINC=function(a,c,d,e,g,i){if(a=h.parseNumber(a),c=h.parseNumber(c),d=h.parseNumber(d),h.anyIsError(a,c,d))return f.value;if(0>=a||0>=c||0>=d)return f.num;if(1>e||1>g||e>g)return f.num;if(0!==i&&1!==i)return f.num;var j=b.PMT(a,c,d,0,i),k=0;1===e&&(k=0===i?j+d*a:j,e++);for(var l=e;g>=l;l++)k+=i>0?j-(b.FV(a,l-2,j,d,1)-j)*a:j-b.FV(a,l-1,j,d,0)*a;return k},b.DB=function(a,b,c,d,e){if(e=void 0===e?12:e,a=h.parseNumber(a),b=h.parseNumber(b),c=h.parseNumber(c),d=h.parseNumber(d),e=h.parseNumber(e),h.anyIsError(a,b,c,d,e))return f.value;if(0>a||0>b||0>c||0>d)return f.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(e))return f.num;if(d>c)return f.num;if(b>=a)return 0;for(var g=(1-Math.pow(b/a,1/c)).toFixed(3),i=a*g*e/12,j=i,k=0,l=d===c?c-1:d,m=2;l>=m;m++)k=(a-j)*g,j+=k;return 1===d?i:d===c?(a-j)*g:k},b.DDB=function(a,b,c,d,e){if(e=void 0===e?2:e,a=h.parseNumber(a),b=h.parseNumber(b),c=h.parseNumber(c),d=h.parseNumber(d),e=h.parseNumber(e),h.anyIsError(a,b,c,d,e))return f.value;if(0>a||0>b||0>c||0>d||0>=e)return f.num;if(d>c)return f.num;if(b>=a)return 0;for(var g=0,i=0,j=1;d>=j;j++)i=Math.min((a-g)*(e/c),a-b-g),g+=i;return i},b.DISC=function(){throw new Error("DISC is not implemented")},b.DOLLARDE=function(a,b){if(a=h.parseNumber(a),b=h.parseNumber(b),h.anyIsError(a,b))return f.value;if(0>b)return f.num;if(b>=0&&1>b)return f.div0;b=parseInt(b,10);var c=parseInt(a,10);c+=a%1*Math.pow(10,Math.ceil(Math.log(b)/Math.LN10))/b;var d=Math.pow(10,Math.ceil(Math.log(b)/Math.LN2)+1);return c=Math.round(c*d)/d},b.DOLLARFR=function(a,b){if(a=h.parseNumber(a),b=h.parseNumber(b),h.anyIsError(a,b))return f.value;if(0>b)return f.num;if(b>=0&&1>b)return f.div0;b=parseInt(b,10);var c=parseInt(a,10);return c+=a%1*Math.pow(10,-Math.ceil(Math.log(b)/Math.LN10))*b},b.DURATION=function(){throw new Error("DURATION is not implemented")},b.EFFECT=function(a,b){return a=h.parseNumber(a),b=h.parseNumber(b),h.anyIsError(a,b)?f.value:0>=a||1>b?f.num:(b=parseInt(b,10),Math.pow(1+a/b,b)-1)},b.FV=function(a,b,c,d,e){if(d=d||0,e=e||0,a=h.parseNumber(a),b=h.parseNumber(b),c=h.parseNumber(c),d=h.parseNumber(d),e=h.parseNumber(e),h.anyIsError(a,b,c,d,e))return f.value;var g;if(0===a)g=d+c*b;else{var i=Math.pow(1+a,b);g=1===e?d*i+c*(1+a)*(i-1)/a:d*i+c*(i-1)/a}return-g},b.FVSCHEDULE=function(a,b){if(a=h.parseNumber(a),b=h.parseNumberArray(h.flatten(b)),h.anyIsError(a,b))return f.value;for(var c=b.length,d=a,e=0;c>e;e++)d*=1+b[e];return d},b.INTRATE=function(){throw new Error("INTRATE is not implemented")},b.IPMT=function(a,c,d,e,g,i){if(g=g||0,i=i||0,a=h.parseNumber(a),c=h.parseNumber(c),d=h.parseNumber(d),e=h.parseNumber(e),g=h.parseNumber(g),i=h.parseNumber(i),h.anyIsError(a,c,d,e,g,i))return f.value;var j,k=b.PMT(a,d,e,g,i);return j=1===c?1===i?0:-e:1===i?b.FV(a,c-2,k,e,1)-k:b.FV(a,c-1,k,e,0),j*a},b.IRR=function(a,b){if(b=b||0,a=h.parseNumberArray(h.flatten(a)),b=h.parseNumber(b),h.anyIsError(a,b))return f.value;for(var c=function(a,b,c){for(var d=c+1,e=a[0],f=1;f<a.length;f++)e+=a[f]/Math.pow(d,(b[f]-b[0])/365);return e},d=function(a,b,c){for(var d=c+1,e=0,f=1;f<a.length;f++){var g=(b[f]-b[0])/365;e-=g*a[f]/Math.pow(d,g+1)}return e},e=[],g=!1,i=!1,j=0;j<a.length;j++)e[j]=0===j?0:e[j-1]+365,a[j]>0&&(g=!0),a[j]<0&&(i=!0);if(!g||!i)return f.num;b=void 0===b?.1:b;var k,l,m,n=b,o=1e-10,p=!0;do m=c(a,e,n),k=n-m/d(a,e,n),l=Math.abs(k-n),n=k,p=l>o&&Math.abs(m)>o;while(p);return n},b.ISPMT=function(a,b,c,d){return a=h.parseNumber(a),b=h.parseNumber(b),c=h.parseNumber(c),d=h.parseNumber(d),h.anyIsError(a,b,c,d)?f.value:d*a*(b/c-1)},b.MDURATION=function(){throw new Error("MDURATION is not implemented")},b.MIRR=function(a,c,d){if(a=h.parseNumberArray(h.flatten(a)),c=h.parseNumber(c),d=h.parseNumber(d),h.anyIsError(a,c,d))return f.value;for(var e=a.length,g=[],i=[],j=0;e>j;j++)a[j]<0?g.push(a[j]):i.push(a[j]);var k=-b.NPV(d,i)*Math.pow(1+d,e-1),l=b.NPV(c,g)*(1+c);return Math.pow(k/l,1/(e-1))-1},b.NOMINAL=function(a,b){return a=h.parseNumber(a),b=h.parseNumber(b),h.anyIsError(a,b)?f.value:0>=a||1>b?f.num:(b=parseInt(b,10),(Math.pow(a+1,1/b)-1)*b)},b.NPER=function(a,b,c,d,e){if(e=void 0===e?0:e,d=void 0===d?0:d,a=h.parseNumber(a),b=h.parseNumber(b),c=h.parseNumber(c),d=h.parseNumber(d),e=h.parseNumber(e),h.anyIsError(a,b,c,d,e))return f.value;var g=b*(1+a*e)-d*a,i=c*a+b*(1+a*e);return Math.log(g/i)/Math.log(1+a)},b.NPV=function(){var a=h.parseNumberArray(h.flatten(arguments));if(a instanceof Error)return a;for(var b=a[0],c=0,d=1;d<a.length;d++)c+=a[d]/Math.pow(1+b,d);return c},b.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},b.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},b.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},b.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},b.PDURATION=function(a,b,c){return a=h.parseNumber(a),b=h.parseNumber(b),c=h.parseNumber(c),h.anyIsError(a,b,c)?f.value:0>=a?f.num:(Math.log(c)-Math.log(b))/Math.log(1+a)},b.PMT=function(a,b,c,d,e){if(d=d||0,e=e||0,a=h.parseNumber(a),b=h.parseNumber(b),c=h.parseNumber(c),d=h.parseNumber(d),e=h.parseNumber(e),h.anyIsError(a,b,c,d,e))return f.value;var g;if(0===a)g=(c+d)/b;else{var i=Math.pow(1+a,b);g=1===e?(d*a/(i-1)+c*a/(1-1/i))/(1+a):d*a/(i-1)+c*a/(1-1/i)}return-g},b.PPMT=function(a,c,d,e,g,i){return g=g||0,i=i||0,a=h.parseNumber(a),d=h.parseNumber(d),e=h.parseNumber(e),g=h.parseNumber(g),i=h.parseNumber(i),h.anyIsError(a,d,e,g,i)?f.value:b.PMT(a,d,e,g,i)-b.IPMT(a,c,d,e,g,i)},b.PRICE=function(){throw new Error("PRICE is not implemented")},b.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")},b.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},b.PV=function(a,b,c,d,e){return d=d||0,e=e||0,a=h.parseNumber(a),b=h.parseNumber(b),c=h.parseNumber(c),d=h.parseNumber(d),e=h.parseNumber(e),h.anyIsError(a,b,c,d,e)?f.value:0===a?-c*b-d:((1-Math.pow(1+a,b))/a*c*(1+a*e)-d)/Math.pow(1+a,b)},b.RATE=function(a,b,c,d,e,g){if(g=void 0===g?.01:g,d=void 0===d?0:d,e=void 0===e?0:e,a=h.parseNumber(a),b=h.parseNumber(b),c=h.parseNumber(c),d=h.parseNumber(d),e=h.parseNumber(e),g=h.parseNumber(g),h.anyIsError(a,b,c,d,e,g))return f.value;var i,j,k,l,m=1e-10,n=50,o=0,p=0,q=0,r=g;for(Math.abs(r)<m?i=c*(1+a*r)+b*(1+r*e)*a+d:(p=Math.exp(a*Math.log(1+r)),i=c*p+b*(1/r+e)*(p-1)+d),j=c+b*a+d,k=c*p+b*(1/r+e)*(p-1)+d,q=l=0,o=r;Math.abs(j-k)>m&&n>q;)r=(k*l-j*o)/(k-j),l=o,o=r,Math.abs(r)<m?i=c*(1+a*r)+b*(1+r*e)*a+d:(p=Math.exp(a*Math.log(1+r)),i=c*p+b*(1/r+e)*(p-1)+d),j=k,k=i,++q;return r},b.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},b.RRI=function(a,b,c){return a=h.parseNumber(a),b=h.parseNumber(b),c=h.parseNumber(c),h.anyIsError(a,b,c)?f.value:0===a||0===b?f.num:Math.pow(c/b,1/a)-1},b.SLN=function(a,b,c){return a=h.parseNumber(a),b=h.parseNumber(b),c=h.parseNumber(c),h.anyIsError(a,b,c)?f.value:0===c?f.num:(a-b)/c},b.SYD=function(a,b,c,d){return a=h.parseNumber(a),b=h.parseNumber(b),c=h.parseNumber(c),d=h.parseNumber(d),h.anyIsError(a,b,c,d)?f.value:0===c?f.num:1>d||d>c?f.num:(d=parseInt(d,10),(a-b)*(c-d+1)*2/(c*(c+1)))},b.TBILLEQ=function(a,b,c){return a=h.parseDate(a),b=h.parseDate(b),c=h.parseNumber(c),h.anyIsError(a,b,c)?f.value:0>=c?f.num:a>b?f.num:b-a>31536e6?f.num:365*c/(360-c*g.DAYS360(a,b,!1))},b.TBILLPRICE=function(a,b,c){return a=h.parseDate(a),b=h.parseDate(b),c=h.parseNumber(c),h.anyIsError(a,b,c)?f.value:0>=c?f.num:a>b?f.num:b-a>31536e6?f.num:100*(1-c*g.DAYS360(a,b,!1)/360)},b.TBILLYIELD=function(a,b,c){return a=h.parseDate(a),b=h.parseDate(b),c=h.parseNumber(c),h.anyIsError(a,b,c)?f.value:0>=c?f.num:a>b?f.num:b-a>31536e6?f.num:360*(100-c)/(c*g.DAYS360(a,b,!1))},b.VDB=function(){throw new Error("VDB is not implemented")},b.XIRR=function(a,b,c){if(a=h.parseNumberArray(h.flatten(a)),b=h.parseDateArray(h.flatten(b)),c=h.parseNumber(c),h.anyIsError(a,b,c))return f.value;for(var d=function(a,b,c){for(var d=c+1,e=a[0],f=1;f<a.length;f++)e+=a[f]/Math.pow(d,g.DAYS(b[f],b[0])/365);return e},e=function(a,b,c){for(var d=c+1,e=0,f=1;f<a.length;f++){var h=g.DAYS(b[f],b[0])/365;e-=h*a[f]/Math.pow(d,h+1)}return e},i=!1,j=!1,k=0;k<a.length;k++)a[k]>0&&(i=!0),a[k]<0&&(j=!0);if(!i||!j)return f.num;c=c||.1;var l,m,n,o=c,p=1e-10,q=!0;do n=d(a,b,o),l=o-n/e(a,b,o),m=Math.abs(l-o),o=l,q=m>p&&Math.abs(n)>p;while(q);return o},b.XNPV=function(a,b,c){if(a=h.parseNumber(a),b=h.parseNumberArray(h.flatten(b)),c=h.parseDateArray(h.flatten(c)),h.anyIsError(a,b,c))return f.value;for(var d=0,e=0;e<b.length;e++)d+=b[e]/Math.pow(1+a,g.DAYS(c[e],c[0])/365);return d},b.YIELD=function(){throw new Error("YIELD is not implemented")},b.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},b.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}},function(a,b,c){var d=c(13);b.CELL=function(){throw new Error("CELL is not implemented")},b.ERROR={},b.ERROR.TYPE=function(a){switch(a){case d.nil:return 1;case d.div0:return 2;case d.value:return 3;case d.ref:return 4;case d.name:return 5;case d.num:return 6;case d.na:return 7;case d.data:return 8}return d.na},b.INFO=function(){throw new Error("INFO is not implemented")},b.ISBLANK=function(a){return null===a},b.ISBINARY=function(a){return/^[01]{1,10}$/.test(a)},b.ISERR=function(a){return[d.value,d.ref,d.div0,d.num,d.name,d.nil].indexOf(a)>=0||"number"==typeof a&&(isNaN(a)||!isFinite(a))},b.ISERROR=function(a){return b.ISERR(a)||a===d.na},b.ISEVEN=function(a){return 1&Math.floor(Math.abs(a))?!1:!0},b.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},b.ISLOGICAL=function(a){return a===!0||a===!1},b.ISNA=function(a){return a===d.na},b.ISNONTEXT=function(a){return"string"!=typeof a},b.ISNUMBER=function(a){return"number"==typeof a&&!isNaN(a)&&isFinite(a)},b.ISODD=function(a){return 1&Math.floor(Math.abs(a))?!0:!1},b.ISREF=function(){throw new Error("ISREF is not implemented")},b.ISTEXT=function(a){return"string"==typeof a},b.N=function(a){return this.ISNUMBER(a)?a:a instanceof Date?a.getTime():a===!0?1:a===!1?0:this.ISERROR(a)?a:0},b.NA=function(){return d.na},b.SHEET=function(){throw new Error("SHEET is not implemented")},b.SHEETS=function(){throw new Error("SHEETS is not implemented")},b.TYPE=function(a){return this.ISNUMBER(a)?1:this.ISTEXT(a)?2:this.ISLOGICAL(a)?4:this.ISERROR(a)?16:Array.isArray(a)?64:void 0}},function(a,b,c){var d=c(13);b.MATCH=function(a,b,c){if(!a&&!b)return d.na;if(2===arguments.length&&(c=1),!(b instanceof Array))return d.na;if(-1!==c&&0!==c&&1!==c)return d.na;for(var e,f,g=0;g<b.length;g++)if(1===c){if(b[g]===a)return g+1;b[g]<a&&(f?b[g]>f&&(e=g+1,f=b[g]):(e=g+1,f=b[g]))}else if(0===c){if("string"==typeof a){if(a=a.replace(/\?/g,"."),b[g].toLowerCase().match(a.toLowerCase()))return g+1}else if(b[g]===a)return g+1}else if(-1===c){if(b[g]===a)return g+1;b[g]>a&&(f?b[g]<f&&(e=g+1,f=b[g]):(e=g+1,f=b[g]))}return e?e:d.na}},function(module,exports,__webpack_require__){var mathTrig=__webpack_require__(5),text=__webpack_require__(6),jStat=__webpack_require__(18).jStat,utils=__webpack_require__(14),error=__webpack_require__(13),misc=__webpack_require__(12),SQRT2PI=2.5066282746310002;exports.AVEDEV=function(){var a=utils.parseNumberArray(utils.flatten(arguments));return a instanceof Error?a:jStat.sum(jStat(a).subtract(jStat.mean(a)).abs()[0])/a.length},exports.AVERAGE=function(){for(var a=utils.numbers(utils.flatten(arguments)),b=a.length,c=0,d=0,e=0;b>e;e++)c+=a[e],d+=1;return c/d},exports.AVERAGEA=function(){for(var a=utils.flatten(arguments),b=a.length,c=0,d=0,e=0;b>e;e++){var f=a[e];"number"==typeof f&&(c+=f),f===!0&&c++,null!==f&&d++}return c/d},exports.AVERAGEIF=function(range,criteria,average_range){if(average_range=average_range||range,range=utils.flatten(range),average_range=utils.parseNumberArray(utils.flatten(average_range)),average_range instanceof Error)return average_range;for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},exports.AVERAGEIFS=function(){for(var args=utils.argsToArray(arguments),criteria=(args.length-1)/2,range=utils.flatten(args[0]),count=0,result=0,i=0;i<range.length;i++){for(var condition="",j=0;criteria>j;j++)condition+=args[2*j+1][i]+args[2*j+2],j!==criteria-1&&(condition+="&&");eval(condition)&&(result+=range[i],count++)}var average=result/count;return isNaN(average)?0:average},exports.BETA={},exports.BETA.DIST=function(a,b,c,d,e,f){return e=void 0===e?0:e,f=void 0===f?1:f,a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),e=utils.parseNumber(e),f=utils.parseNumber(f),utils.anyIsError(a,b,c,e,f)?error.value:(a=(a-e)/(f-e),d?jStat.beta.cdf(a,b,c):jStat.beta.pdf(a,b,c))},exports.BETA.INV=function(a,b,c,d,e){return d=void 0===d?0:d,e=void 0===e?1:e,a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),d=utils.parseNumber(d),e=utils.parseNumber(e),utils.anyIsError(a,b,c,d,e)?error.value:jStat.beta.inv(a,b,c)*(e-d)+d},exports.BINOM={},exports.BINOM.DIST=function(a,b,c,d){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),d=utils.parseNumber(d),utils.anyIsError(a,b,c,d)?error.value:d?jStat.binomial.cdf(a,b,c):jStat.binomial.pdf(a,b,c)},exports.BINOM.DIST.RANGE=function(a,b,c,d){if(d=void 0===d?c:d,a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),d=utils.parseNumber(d),utils.anyIsError(a,b,c,d))return error.value;for(var e=0,f=c;d>=f;f++)e+=mathTrig.COMBIN(a,f)*Math.pow(b,f)*Math.pow(1-b,a-f);return e},exports.BINOM.INV=function(a,b,c){if(a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c))return error.value;for(var d=0;a>=d;){if(jStat.binomial.cdf(d,a,b)>=c)return d;d++}},exports.CHISQ={},exports.CHISQ.DIST=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:c?jStat.chisquare.cdf(a,b):jStat.chisquare.pdf(a,b)},exports.CHISQ.DIST.RT=function(a,b){return!a|!b?error.na:1>a||b>Math.pow(10,10)?error.num:"number"!=typeof a||"number"!=typeof b?error.value:1-jStat.chisquare.cdf(a,b)},exports.CHISQ.INV=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:jStat.chisquare.inv(a,b)},exports.CHISQ.INV.RT=function(a,b){return!a|!b?error.na:0>a||a>1||1>b||b>Math.pow(10,10)?error.num:"number"!=typeof a||"number"!=typeof b?error.value:jStat.chisquare.inv(1-a,b)},exports.CHISQ.TEST=function(a,b){function c(a,b){var c=Math.exp(-.5*a);b%2===1&&(c*=Math.sqrt(2*a/k));for(var d=b;d>=2;)c=c*a/d,d-=2;for(var e=c,f=b;e>1e-10*c;)f+=2,e=e*a/f,c+=e;return 1-c}if(2!==arguments.length)return error.na;if(!(a instanceof Array&&b instanceof Array))return error.value;if(a.length!==b.length)return error.value;if(a[0]&&b[0]&&a[0].length!==b[0].length)return error.value;var d,e,f,g=a.length;for(e=0;g>e;e++)a[e]instanceof Array||(d=a[e],a[e]=[],a[e].push(d)),b[e]instanceof Array||(d=b[e],b[e]=[],b[e].push(d));var h=a[0].length,i=1===h?g-1:(g-1)*(h-1),j=0,k=Math.PI;for(e=0;g>e;e++)for(f=0;h>f;f++)j+=Math.pow(a[e][f]-b[e][f],2)/b[e][f];return Math.round(1e6*c(j,i))/1e6},exports.COLUMN=function(a,b){return 2!==arguments.length?error.na:0>b?error.num:a instanceof Array&&"number"==typeof b?0===a.length?void 0:jStat.col(a,b):error.value},exports.COLUMNS=function(a){return 1!==arguments.length?error.na:a instanceof Array?0===a.length?0:jStat.cols(a):error.value},exports.CONFIDENCE={},exports.CONFIDENCE.NORM=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:jStat.normalci(1,a,b,c)[1]-1},exports.CONFIDENCE.T=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:jStat.tci(1,a,b,c)[1]-1},exports.CORREL=function(a,b){return a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b)?error.value:jStat.corrcoeff(a,b)},exports.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length},exports.COUNTA=function(){var a=utils.flatten(arguments);return a.length-exports.COUNTBLANK(a)},exports.COUNTIN=function(a,b){for(var c=0,d=0;d<a.length;d++)a[d]===b&&c++;return c},exports.COUNTBLANK=function(){for(var a,b=utils.flatten(arguments),c=0,d=0;d<b.length;d++)a=b[d],(null===a||""===a)&&c++;return c},exports.COUNTIF=function(range,criteria){range=utils.flatten(range),/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var matches=0,i=0;i<range.length;i++)"string"!=typeof range[i]?eval(range[i]+criteria)&&matches++:eval('"'+range[i]+'"'+criteria)&&matches++;return matches},exports.COUNTIFS=function(){for(var args=utils.argsToArray(arguments),results=new Array(utils.flatten(args[0]).length),i=0;i<results.length;i++)results[i]=!0;for(i=0;i<args.length;i+=2){var range=utils.flatten(args[i]),criteria=args[i+1];/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var j=0;j<range.length;j++)results[j]="string"!=typeof range[j]?results[j]&&eval(range[j]+criteria):results[j]&&eval('"'+range[j]+'"'+criteria)}var result=0;for(i=0;i<results.length;i++)results[i]&&result++;return result},exports.COUNTUNIQUE=function(){return misc.UNIQUE.apply(null,utils.flatten(arguments)).length},exports.COVARIANCE={},exports.COVARIANCE.P=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;for(var c=jStat.mean(a),d=jStat.mean(b),e=0,f=a.length,g=0;f>g;g++)e+=(a[g]-c)*(b[g]-d);return e/f},exports.COVARIANCE.S=function(a,b){return a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b)?error.value:jStat.covariance(a,b)},exports.DEVSQ=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=jStat.mean(a),c=0,d=0;d<a.length;d++)c+=Math.pow(a[d]-b,2);return c},exports.EXPON={},exports.EXPON.DIST=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:c?jStat.exponential.cdf(a,b):jStat.exponential.pdf(a,b)},exports.F={},exports.F.DIST=function(a,b,c,d){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:d?jStat.centralF.cdf(a,b,c):jStat.centralF.pdf(a,b,c)},exports.F.DIST.RT=function(a,b,c){return 3!==arguments.length?error.na:0>a||1>b||1>c?error.num:"number"!=typeof a||"number"!=typeof b||"number"!=typeof c?error.value:1-jStat.centralF.cdf(a,b,c)},exports.F.INV=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:0>=a||a>1?error.num:jStat.centralF.inv(a,b,c)},exports.F.INV.RT=function(a,b,c){return 3!==arguments.length?error.na:0>a||a>1||1>b||b>Math.pow(10,10)||1>c||c>Math.pow(10,10)?error.num:"number"!=typeof a||"number"!=typeof b||"number"!=typeof c?error.value:jStat.centralF.inv(1-a,b,c)},exports.F.TEST=function(a,b){if(!a||!b)return error.na;if(!(a instanceof Array&&b instanceof Array))return error.na;if(a.length<2||b.length<2)return error.div0;var c=function(a,b){for(var c=0,d=0;d<a.length;d++)c+=Math.pow(a[d]-b,2);return c},d=mathTrig.SUM(a)/a.length,e=mathTrig.SUM(b)/b.length,f=c(a,d)/(a.length-1),g=c(b,e)/(b.length-1);return f/g},exports.FISHER=function(a){return a=utils.parseNumber(a),a instanceof Error?a:Math.log((1+a)/(1-a))/2},exports.FISHERINV=function(a){if(a=utils.parseNumber(a),a instanceof Error)return a;var b=Math.exp(2*a);return(b-1)/(b+1)},exports.FORECAST=function(a,b,c){if(a=utils.parseNumber(a),b=utils.parseNumberArray(utils.flatten(b)),c=utils.parseNumberArray(utils.flatten(c)),utils.anyIsError(a,b,c))return error.value;for(var d=jStat.mean(c),e=jStat.mean(b),f=c.length,g=0,h=0,i=0;f>i;i++)g+=(c[i]-d)*(b[i]-e),h+=Math.pow(c[i]-d,2);var j=g/h,k=e-j*d;return k+j*a},exports.FREQUENCY=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;for(var c=a.length,d=b.length,e=[],f=0;d>=f;f++){e[f]=0;for(var g=0;c>g;g++)0===f?a[g]<=b[0]&&(e[0]+=1):d>f?a[g]>b[f-1]&&a[g]<=b[f]&&(e[f]+=1):f===d&&a[g]>b[d-1]&&(e[d]+=1)}return e},exports.GAMMA=function(a){return a=utils.parseNumber(a),a instanceof Error?a:0===a?error.num:parseInt(a,10)===a&&0>a?error.num:jStat.gammafn(a)},exports.GAMMA.DIST=function(a,b,c,d){return 4!==arguments.length?error.na:0>a||0>=b||0>=c?error.value:"number"!=typeof a||"number"!=typeof b||"number"!=typeof c?error.value:d?jStat.gamma.cdf(a,b,c,!0):jStat.gamma.pdf(a,b,c,!1)},exports.GAMMA.INV=function(a,b,c){return 3!==arguments.length?error.na:0>a||a>1||0>=b||0>=c?error.num:"number"!=typeof a||"number"!=typeof b||"number"!=typeof c?error.value:jStat.gamma.inv(a,b,c)},exports.GAMMALN=function(a){return a=utils.parseNumber(a),a instanceof Error?a:jStat.gammaln(a)},exports.GAMMALN.PRECISE=function(a){return 1!==arguments.length?error.na:0>=a?error.num:"number"!=typeof a?error.value:jStat.gammaln(a)},exports.GAUSS=function(a){return a=utils.parseNumber(a),a instanceof Error?a:jStat.normal.cdf(a,0,1)-.5},exports.GEOMEAN=function(){var a=utils.parseNumberArray(utils.flatten(arguments));return a instanceof Error?a:jStat.geomean(a)},exports.GROWTH=function(a,b,c,d){if(a=utils.parseNumberArray(a),a instanceof Error)return a;var e;if(void 0===b)for(b=[],e=1;e<=a.length;e++)b.push(e);if(void 0===c)for(c=[],e=1;e<=a.length;e++)c.push(e);if(b=utils.parseNumberArray(b),c=utils.parseNumberArray(c),utils.anyIsError(b,c))return error.value;void 0===d&&(d=!0);var f=a.length,g=0,h=0,i=0,j=0;for(e=0;f>e;e++){var k=b[e],l=Math.log(a[e]);g+=k,h+=l,i+=k*l,j+=k*k}g/=f,h/=f,i/=f,j/=f;var m,n;d?(m=(i-g*h)/(j-g*g),n=h-m*g):(m=i/j,n=0);var o=[];for(e=0;e<c.length;e++)o.push(Math.exp(n+m*c[e]));return o},exports.HARMEAN=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=a.length,c=0,d=0;b>d;d++)c+=1/a[d];return b/c},exports.HYPGEOM={},exports.HYPGEOM.DIST=function(a,b,c,d,e){function f(a,b,c,d){return mathTrig.COMBIN(c,a)*mathTrig.COMBIN(d-c,b-a)/mathTrig.COMBIN(d,b)}function g(a,b,c,d){for(var e=0,g=0;a>=g;g++)e+=f(g,b,c,d);return e}return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),d=utils.parseNumber(d),utils.anyIsError(a,b,c,d)?error.value:e?g(a,b,c,d):f(a,b,c,d)},exports.INTERCEPT=function(a,b){return a=utils.parseNumberArray(a),b=utils.parseNumberArray(b),utils.anyIsError(a,b)?error.value:a.length!==b.length?error.na:exports.FORECAST(0,a,b)},exports.KURT=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=jStat.mean(a),c=a.length,d=0,e=0;c>e;e++)d+=Math.pow(a[e]-b,4);return d/=Math.pow(jStat.stdev(a,!0),4),c*(c+1)/((c-1)*(c-2)*(c-3))*d-3*(c-1)*(c-1)/((c-2)*(c-3))},exports.LARGE=function(a,b){return a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),utils.anyIsError(a,b)?a:a.sort(function(a,b){return b-a})[b-1]},exports.LINEST=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;for(var c=jStat.mean(a),d=jStat.mean(b),e=b.length,f=0,g=0,h=0;e>h;h++)f+=(b[h]-d)*(a[h]-c),g+=Math.pow(b[h]-d,2);var i=f/g,j=c-i*d;return[i,j]},exports.LOGEST=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;for(var c=0;c<a.length;c++)a[c]=Math.log(a[c]);var d=exports.LINEST(a,b);return d[0]=Math.round(1e6*Math.exp(d[0]))/1e6,d[1]=Math.round(1e6*Math.exp(d[1]))/1e6,d},exports.LOGNORM={},exports.LOGNORM.DIST=function(a,b,c,d){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:d?jStat.lognormal.cdf(a,b,c):jStat.lognormal.pdf(a,b,c)},exports.LOGNORM.INV=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:jStat.lognormal.inv(a,b,c)},exports.MAX=function(){var a=utils.numbers(utils.flatten(arguments));return 0===a.length?0:Math.max.apply(Math,a)},exports.MAXA=function(){var a=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===a.length?0:Math.max.apply(Math,a)},exports.MEDIAN=function(){var a=utils.arrayValuesToNumbers(utils.flatten(arguments));return jStat.median(a)},exports.MIN=function(){var a=utils.numbers(utils.flatten(arguments));return 0===a.length?0:Math.min.apply(Math,a)},exports.MINA=function(){var a=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===a.length?0:Math.min.apply(Math,a)},exports.MODE={},exports.MODE.MULT=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b,c=a.length,d={},e=[],f=0,g=0;c>g;g++)b=a[g],d[b]=d[b]?d[b]+1:1,d[b]>f&&(f=d[b],e=[]),d[b]===f&&(e[e.length]=b);return e},exports.MODE.SNGL=function(){var a=utils.parseNumberArray(utils.flatten(arguments));return a instanceof Error?a:exports.MODE.MULT(a).sort(function(a,b){return a-b})[0]},exports.NEGBINOM={},exports.NEGBINOM.DIST=function(a,b,c,d){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:d?jStat.negbin.cdf(a,b,c):jStat.negbin.pdf(a,b,c)},exports.NORM={},exports.NORM.DIST=function(a,b,c,d){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:0>=c?error.num:d?jStat.normal.cdf(a,b,c):jStat.normal.pdf(a,b,c)},exports.NORM.INV=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:jStat.normal.inv(a,b,c)},exports.NORM.S={},exports.NORM.S.DIST=function(a,b){return a=utils.parseNumber(a),a instanceof Error?error.value:b?jStat.normal.cdf(a,0,1):jStat.normal.pdf(a,0,1)},exports.NORM.S.INV=function(a){return a=utils.parseNumber(a),a instanceof Error?error.value:jStat.normal.inv(a,0,1)},exports.PEARSON=function(a,b){if(b=utils.parseNumberArray(utils.flatten(b)),a=utils.parseNumberArray(utils.flatten(a)),utils.anyIsError(b,a))return error.value;for(var c=jStat.mean(a),d=jStat.mean(b),e=a.length,f=0,g=0,h=0,i=0;e>i;i++)f+=(a[i]-c)*(b[i]-d),g+=Math.pow(a[i]-c,2),h+=Math.pow(b[i]-d,2);return f/Math.sqrt(g*h)},exports.PERCENTILE={},exports.PERCENTILE.EXC=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;a=a.sort(function(a,b){return a-b});var c=a.length;if(1/(c+1)>b||b>1-1/(c+1))return error.num;var d=b*(c+1)-1,e=Math.floor(d);return utils.cleanFloat(d===e?a[d]:a[e]+(d-e)*(a[e+1]-a[e]))},exports.PERCENTILE.INC=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;a=a.sort(function(a,b){return a-b});var c=a.length,d=b*(c-1),e=Math.floor(d);return utils.cleanFloat(d===e?a[d]:a[e]+(d-e)*(a[e+1]-a[e]))
},exports.PERCENTRANK={},exports.PERCENTRANK.EXC=function(a,b,c){if(c=void 0===c?3:c,a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c))return error.value;a=a.sort(function(a,b){return a-b});for(var d=misc.UNIQUE.apply(null,a),e=a.length,f=d.length,g=Math.pow(10,c),h=0,i=!1,j=0;!i&&f>j;)b===d[j]?(h=(a.indexOf(d[j])+1)/(e+1),i=!0):b>=d[j]&&(b<d[j+1]||j===f-1)&&(h=(a.indexOf(d[j])+1+(b-d[j])/(d[j+1]-d[j]))/(e+1),i=!0),j++;return Math.floor(h*g)/g},exports.PERCENTRANK.INC=function(a,b,c){if(c=void 0===c?3:c,a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c))return error.value;a=a.sort(function(a,b){return a-b});for(var d=misc.UNIQUE.apply(null,a),e=a.length,f=d.length,g=Math.pow(10,c),h=0,i=!1,j=0;!i&&f>j;)b===d[j]?(h=a.indexOf(d[j])/(e-1),i=!0):b>=d[j]&&(b<d[j+1]||j===f-1)&&(h=(a.indexOf(d[j])+(b-d[j])/(d[j+1]-d[j]))/(e-1),i=!0),j++;return Math.floor(h*g)/g},exports.PERMUT=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:mathTrig.FACT(a)/mathTrig.FACT(a-b)},exports.PERMUTATIONA=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:Math.pow(a,b)},exports.PHI=function(a){return a=utils.parseNumber(a),a instanceof Error?error.value:Math.exp(-.5*a*a)/SQRT2PI},exports.POISSON={},exports.POISSON.DIST=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:c?jStat.poisson.cdf(a,b):jStat.poisson.pdf(a,b)},exports.PROB=function(a,b,c,d){if(void 0===c)return 0;if(d=void 0===d?c:d,a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),c=utils.parseNumber(c),d=utils.parseNumber(d),utils.anyIsError(a,b,c,d))return error.value;if(c===d)return a.indexOf(c)>=0?b[a.indexOf(c)]:0;for(var e=a.sort(function(a,b){return a-b}),f=e.length,g=0,h=0;f>h;h++)e[h]>=c&&e[h]<=d&&(g+=b[a.indexOf(e[h])]);return g},exports.QUARTILE={},exports.QUARTILE.EXC=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;switch(b){case 1:return exports.PERCENTILE.EXC(a,.25);case 2:return exports.PERCENTILE.EXC(a,.5);case 3:return exports.PERCENTILE.EXC(a,.75);default:return error.num}},exports.QUARTILE.INC=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;switch(b){case 1:return exports.PERCENTILE.INC(a,.25);case 2:return exports.PERCENTILE.INC(a,.5);case 3:return exports.PERCENTILE.INC(a,.75);default:return error.num}},exports.RANK={},exports.RANK.AVG=function(a,b,c){if(a=utils.parseNumber(a),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;b=utils.flatten(b),c=c||!1;var d=c?function(a,b){return a-b}:function(a,b){return b-a};b=b.sort(d);for(var e=b.length,f=0,g=0;e>g;g++)b[g]===a&&f++;return f>1?(2*b.indexOf(a)+f+1)/2:b.indexOf(a)+1},exports.RANK.EQ=function(a,b,c){if(a=utils.parseNumber(a),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;c=c||!1;var d=c?function(a,b){return a-b}:function(a,b){return b-a};return b=b.sort(d),b.indexOf(a)+1},exports.ROW=function(a,b){return 2!==arguments.length?error.na:0>b?error.num:a instanceof Array&&"number"==typeof b?0===a.length?void 0:jStat.row(a,b):error.value},exports.ROWS=function(a){return 1!==arguments.length?error.na:a instanceof Array?0===a.length?0:jStat.rows(a):error.value},exports.RSQ=function(a,b){return a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b)?error.value:Math.pow(exports.PEARSON(a,b),2)},exports.SKEW=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=jStat.mean(a),c=a.length,d=0,e=0;c>e;e++)d+=Math.pow(a[e]-b,3);return c*d/((c-1)*(c-2)*Math.pow(jStat.stdev(a,!0),3))},exports.SKEW.P=function(){var a=utils.parseNumberArray(utils.flatten(arguments));if(a instanceof Error)return a;for(var b=jStat.mean(a),c=a.length,d=0,e=0,f=0;c>f;f++)e+=Math.pow(a[f]-b,3),d+=Math.pow(a[f]-b,2);return e/=c,d/=c,e/Math.pow(d,1.5)},exports.SLOPE=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;for(var c=jStat.mean(b),d=jStat.mean(a),e=b.length,f=0,g=0,h=0;e>h;h++)f+=(b[h]-c)*(a[h]-d),g+=Math.pow(b[h]-c,2);return f/g},exports.SMALL=function(a,b){return a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),utils.anyIsError(a,b)?a:a.sort(function(a,b){return a-b})[b-1]},exports.STANDARDIZE=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:(a-b)/c},exports.STDEV={},exports.STDEV.P=function(){var a=exports.VAR.P.apply(this,arguments);return Math.sqrt(a)},exports.STDEV.S=function(){var a=exports.VAR.S.apply(this,arguments);return Math.sqrt(a)},exports.STDEVA=function(){var a=exports.VARA.apply(this,arguments);return Math.sqrt(a)},exports.STDEVPA=function(){var a=exports.VARPA.apply(this,arguments);return Math.sqrt(a)},exports.STEYX=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;for(var c=jStat.mean(b),d=jStat.mean(a),e=b.length,f=0,g=0,h=0,i=0;e>i;i++)f+=Math.pow(a[i]-d,2),g+=(b[i]-c)*(a[i]-d),h+=Math.pow(b[i]-c,2);return Math.sqrt((f-g*g/h)/(e-2))},exports.TRANSPOSE=function(a){return a?jStat.transpose(a):error.na},exports.T=text.T,exports.T.DIST=function(a,b,c){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:c?jStat.studentt.cdf(a,b):jStat.studentt.pdf(a,b)},exports.T.DIST["2T"]=function(a,b){return 2!==arguments.length?error.na:0>a||1>b?error.num:"number"!=typeof a||"number"!=typeof b?error.value:2*(1-jStat.studentt.cdf(a,b))},exports.T.DIST.RT=function(a,b){return 2!==arguments.length?error.na:0>a||1>b?error.num:"number"!=typeof a||"number"!=typeof b?error.value:1-jStat.studentt.cdf(a,b)},exports.T.INV=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),utils.anyIsError(a,b)?error.value:jStat.studentt.inv(a,b)},exports.T.INV["2T"]=function(a,b){return a=utils.parseNumber(a),b=utils.parseNumber(b),0>=a||a>1||1>b?error.num:utils.anyIsError(a,b)?error.value:Math.abs(jStat.studentt.inv(a/2,b))},exports.T.TEST=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),utils.anyIsError(a,b))return error.value;var c,d=jStat.mean(a),e=jStat.mean(b),f=0,g=0;for(c=0;c<a.length;c++)f+=Math.pow(a[c]-d,2);for(c=0;c<b.length;c++)g+=Math.pow(b[c]-e,2);f/=a.length-1,g/=b.length-1;var h=Math.abs(d-e)/Math.sqrt(f/a.length+g/b.length);return exports.T.DIST["2T"](h,a.length+b.length-2)},exports.TREND=function(a,b,c){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumberArray(utils.flatten(b)),c=utils.parseNumberArray(utils.flatten(c)),utils.anyIsError(a,b,c))return error.value;var d=exports.LINEST(a,b),e=d[0],f=d[1],g=[];return c.forEach(function(a){g.push(e*a+f)}),g},exports.TRIMMEAN=function(a,b){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;var c=mathTrig.FLOOR(a.length*b,2)/2;return jStat.mean(utils.initial(utils.rest(a.sort(function(a,b){return a-b}),c),c))},exports.VAR={},exports.VAR.P=function(){for(var a=utils.numbers(utils.flatten(arguments)),b=a.length,c=0,d=exports.AVERAGE(a),e=0;b>e;e++)c+=Math.pow(a[e]-d,2);return c/b},exports.VAR.S=function(){for(var a=utils.numbers(utils.flatten(arguments)),b=a.length,c=0,d=exports.AVERAGE(a),e=0;b>e;e++)c+=Math.pow(a[e]-d,2);return c/(b-1)},exports.VARA=function(){for(var a=utils.flatten(arguments),b=a.length,c=0,d=0,e=exports.AVERAGEA(a),f=0;b>f;f++){var g=a[f];c+="number"==typeof g?Math.pow(g-e,2):g===!0?Math.pow(1-e,2):Math.pow(0-e,2),null!==g&&d++}return c/(d-1)},exports.VARPA=function(){for(var a=utils.flatten(arguments),b=a.length,c=0,d=0,e=exports.AVERAGEA(a),f=0;b>f;f++){var g=a[f];c+="number"==typeof g?Math.pow(g-e,2):g===!0?Math.pow(1-e,2):Math.pow(0-e,2),null!==g&&d++}return c/d},exports.WEIBULL={},exports.WEIBULL.DIST=function(a,b,c,d){return a=utils.parseNumber(a),b=utils.parseNumber(b),c=utils.parseNumber(c),utils.anyIsError(a,b,c)?error.value:d?1-Math.exp(-Math.pow(a/c,b)):Math.pow(a,b-1)*Math.exp(-Math.pow(a/c,b))*b/Math.pow(c,b)},exports.Z={},exports.Z.TEST=function(a,b,c){if(a=utils.parseNumberArray(utils.flatten(a)),b=utils.parseNumber(b),utils.anyIsError(a,b))return error.value;c=c||exports.STDEV.S(a);var d=a.length;return 1-exports.NORM.S.DIST((exports.AVERAGE(a)-b)/(c/Math.sqrt(d)),!0)}},function(a,b,c){var d=c(14),e=c(17);b.UNIQUE=function(){for(var a=[],b=0;b<arguments.length;++b){for(var c=!1,d=arguments[b],e=0;e<a.length&&!(c=a[e]===d);++e);c||a.push(d)}return a},b.FLATTEN=d.flatten,b.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},b.REFERENCE=function(a,b){try{for(var c=b.split("."),d=a,e=0;e<c.length;++e){var f=c[e];if("]"===f[f.length-1]){var g=f.indexOf("["),h=f.substring(g+1,f.length-1);d=d[f.substring(0,g)][h]}else d=d[f]}return d}catch(i){}},b.JOIN=function(a,b){return a.join(b)},b.NUMBERS=function(){var a=d.flatten(arguments);return a.filter(function(a){return"number"==typeof a})},b.NUMERAL=function(a,b){return e(a).format(b)}},function(a,b){b.nil=new Error("#NULL!"),b.div0=new Error("#DIV/0!"),b.value=new Error("#VALUE?"),b.ref=new Error("#REF!"),b.name=new Error("#NAME?"),b.num=new Error("#NUM!"),b.na=new Error("#N/A"),b.error=new Error("#ERROR!"),b.data=new Error("#GETTING_DATA")},function(a,b,c){function d(a){return a&&a.reduce?a.reduce(function(a,b){var c=Array.isArray(a),d=Array.isArray(b);return c&&d?a.concat(b):c?(a.push(b),a):d?[a].concat(b):[a,b]}):a}function e(a){if(!a)return!1;for(var b=0;b<a.length;++b)if(Array.isArray(a[b]))return!1;return!0}var f=c(13);b.flatten=function(){for(var a=b.argsToArray.apply(null,arguments);!e(a);)a=d(a);return a},b.argsToArray=function(a){return Array.prototype.slice.call(a,0)},b.numbers=function(){var a=this.flatten.apply(null,arguments);return a.filter(function(a){return"number"==typeof a})},b.cleanFloat=function(a){var b=1e14;return Math.round(a*b)/b},b.parseBool=function(a){if("boolean"==typeof a)return a;if(a instanceof Error)return a;if("number"==typeof a)return 0!==a;if("string"==typeof a){var b=a.toUpperCase();if("TRUE"===b)return!0;if("FALSE"===b)return!1}return a instanceof Date&&!isNaN(a)?!0:f.value},b.parseNumber=function(a){return void 0===a||""===a?f.value:isNaN(a)?f.value:parseFloat(a)},b.parseNumberArray=function(a){var c;if(!a||0===(c=a.length))return f.value;for(var d;c--;){if(d=b.parseNumber(a[c]),d===f.value)return d;a[c]=d}return a},b.parseMatrix=function(a){var c;if(!a||0===(c=a.length))return f.value;for(var d,e=0;e<a.length;e++)if(d=b.parseNumberArray(a[e]),a[e]=d,d instanceof Error)return d;return a};var g=new Date(1900,0,1);b.parseDate=function(a){if(!isNaN(a)){if(a instanceof Date)return new Date(a);var b=parseInt(a,10);return 0>b?f.num:new Date(60>=b?g.getTime()+864e5*(b-1):g.getTime()+864e5*(b-2))}return"string"!=typeof a||(a=new Date(a),isNaN(a))?f.value:a},b.parseDateArray=function(a){for(var b,c=a.length;c--;){if(b=this.parseDate(a[c]),b===f.value)return b;a[c]=b}return a},b.anyIsError=function(){for(var a=arguments.length;a--;)if(arguments[a]instanceof Error)return!0;return!1},b.arrayValuesToNumbers=function(a){for(var b,c=a.length;c--;)if(b=a[c],"number"!=typeof b)if(b!==!0)if(b!==!1){if("string"==typeof b){var d=this.parseNumber(b);a[c]=d instanceof Error?0:d}}else a[c]=0;else a[c]=1;return a},b.rest=function(a,b){return b=b||1,a&&"function"==typeof a.slice?a.slice(b):a},b.initial=function(a,b){return b=b||1,a&&"function"==typeof a.slice?a.slice(0,a.length-b):a}},function(a,b){function c(a,b){return a.reduce(function(a,c){return b*a+c},0)}function d(a,b,c,d,e){e||(e=-1);var f,g=2/a;if(0===b)return c;if(1===b)return d;for(var h=1;h!=b;++h)f=d*h*g+e*c,c=d,d=f;return d}function e(a,b,c,e,f){return function(g,h){if(0===h)return a(g);if(1===h)return b(g);if(0>h)throw c+": Order ("+h+") must be nonnegative";if(1==e&&0===g)throw c+": Undefined when x == 0";if(2==e&&0>=g)throw c+": Undefined when x <= 0";var i=a(g),j=b(g);return d(g,h,i,j,f)}}var f=Math,g=function(){function a(a){var b,d,k,l=a*a,m=f.abs(a)-.785398164;return f.abs(a)<8?(d=c(e,l),k=c(g,l),b=d/k):(l=64/l,d=c(h,l),k=c(i,l),b=f.sqrt(j/f.abs(a))*(f.cos(m)*d-f.sin(m)*k*8/f.abs(a))),b}function b(a){var b,d,e,g=a*a,h=f.abs(a)-2.356194491;return Math.abs(a)<8?(d=a*c(k,g),e=c(l,g),b=d/e):(g=64/g,d=c(m,g),e=c(n,g),b=f.sqrt(j/f.abs(a))*(f.cos(h)*d-f.sin(h)*e*8/f.abs(a)),0>a&&(b=-b)),b}var e=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),g=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),h=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),j=.636619772,k=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),l=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),m=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),n=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return function(c,e){if(e=Math.round(e),0===e)return a(f.abs(c));if(1===e)return b(f.abs(c));if(0>e)throw"BESSELJ: Order ("+e+") must be nonnegative";if(0===f.abs(c))return 0;var g,h,i,j,k,l,m,n,o=2/f.abs(c);if(f.abs(c)>e)g=d(c,e,a(f.abs(c)),b(f.abs(c)),-1);else{for(i=2*f.floor((e+f.floor(f.sqrt(40*e)))/2),j=0,l=g=k=0,m=1,h=i;h>0;h--)n=h*o*m-l,l=m,m=n,f.abs(m)>1e10&&(m*=1e-10,l*=1e-10,g*=1e-10,k*=1e-10),j&&(k+=m),j=!j,h==e&&(g=l);k=2*k-m,g/=k}return 0>c&&e%2?-g:g}}(),h=function(){function a(a){var b,e,l,m=a*a,n=a-.785398164;return 8>a?(e=c(d,m),l=c(h,m),b=e/l+k*g(a,0)*f.log(a)):(m=64/m,e=c(i,m),l=c(j,m),b=f.sqrt(k/a)*(f.sin(n)*e+f.cos(n)*l*8/a)),b}function b(a){var b,d,e,h=a*a,i=a-2.356194491;return 8>a?(d=a*c(l,h),e=c(m,h),b=d/e+k*(g(a,1)*f.log(a)-1/a)):(h=64/h,d=c(n,h),e=c(o,h),b=f.sqrt(k/a)*(f.sin(i)*d+f.cos(i)*e*8/a)),b}var d=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),h=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),i=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),j=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),k=.636619772,l=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),m=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),n=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),o=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return e(a,b,"BESSELY",1,-1)}(),i=function(){function a(a){return 3.75>=a?c(d,a*a/14.0625):f.exp(f.abs(a))/f.sqrt(f.abs(a))*c(e,3.75/f.abs(a))}function b(a){return 3.75>a?a*c(g,a*a/14.0625):(0>a?-1:1)*f.exp(f.abs(a))/f.sqrt(f.abs(a))*c(h,3.75/f.abs(a))}var d=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),e=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),g=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),h=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();return function i(c,d){if(d=Math.round(d),0===d)return a(c);if(1==d)return b(c);if(0>d)throw"BESSELI Order ("+d+") must be nonnegative";if(0===f.abs(c))return 0;var e,g,h,j,k,l,m=2/f.abs(c);for(h=2*f.round((d+f.round(f.sqrt(40*d)))/2),j=e=0,k=1,g=h;g>0;g--)l=g*m*k+j,j=k,k=l,f.abs(k)>1e10&&(k*=1e-10,j*=1e-10,e*=1e-10),g==d&&(e=j);return e*=i(c,0)/k,0>c&&d%2?-e:e}}(),j=function(){function a(a){return 2>=a?-f.log(a/2)*i(a,0)+c(d,a*a/4):f.exp(-a)/f.sqrt(a)*c(g,2/a)}function b(a){return 2>=a?f.log(a/2)*i(a,1)+1/a*c(h,a*a/4):f.exp(-a)/f.sqrt(a)*c(j,2/a)}var d=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),g=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),h=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),j=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return e(a,b,"BESSELK",2,1)}();b.besselj=g,b.bessely=h,b.besseli=i,b.besselk=j},function(module,exports,__webpack_require__){(function(global){"use strict";var numeric=exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(a,b){var c,d,e,f;for("undefined"==typeof b&&(b=15),e=.5,c=new Date;;){for(e*=2,f=e;f>3;f-=4)a(),a(),a(),a();for(;f>0;)a(),f--;if(d=new Date,d-c>b)break}for(f=e;f>3;f-=4)a(),a(),a(),a();for(;f>0;)a(),f--;return d=new Date,1e3*(3*e-1)/(d-c)},numeric._myIndexOf=function(a){var b,c=this.length;for(b=0;c>b;++b)if(this[b]===a)return b;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(a){function b(a){if(0===a)return"0";if(isNaN(a))return"NaN";if(0>a)return"-"+b(-a);if(isFinite(a)){var c=Math.floor(Math.log(a)/Math.log(10)),d=a/Math.pow(10,c),e=d.toPrecision(numeric.precision);return 10===parseFloat(e)&&(c++,d=1,e=d.toPrecision(numeric.precision)),parseFloat(e).toString()+"e"+c.toString()}return"Infinity"}function c(a){var e;if("undefined"==typeof a)return d.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof a)return d.push('"'+a+'"'),!1;if("boolean"==typeof a)return d.push(a.toString()),!1;if("number"==typeof a){var f=b(a),g=a.toPrecision(numeric.precision),h=parseFloat(a.toString()).toString(),i=[f,g,h,parseFloat(g).toString(),parseFloat(h).toString()];for(e=1;e<i.length;e++)i[e].length<f.length&&(f=i[e]);return d.push(Array(numeric.precision+8-f.length).join(" ")+f),!1}if(null===a)return d.push("null"),!1;if("function"==typeof a){d.push(a.toString());var j=!1;for(e in a)a.hasOwnProperty(e)&&(d.push(j?",\n":"\n{"),j=!0,d.push(e),d.push(": \n"),c(a[e]));return j&&d.push("}\n"),!0}if(a instanceof Array){if(a.length>numeric.largeArray)return d.push("...Large Array..."),!0;var j=!1;for(d.push("["),e=0;e<a.length;e++)e>0&&(d.push(","),j&&d.push("\n ")),j=c(a[e]);return d.push("]"),!0}d.push("{");var j=!1;for(e in a)a.hasOwnProperty(e)&&(j&&d.push(",\n"),j=!0,d.push(e),d.push(": \n"),c(a[e]));return d.push("}"),!0}var d=[];return c(a),d.join("")},numeric.parseDate=function(a){function b(a){if("string"==typeof a)return Date.parse(a.replace(/-/g,"/"));if(!(a instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var c,d=[];for(c=0;c<a.length;c++)d[c]=b(a[c]);return d}return b(a)},numeric.parseFloat=function(a){function b(a){if("string"==typeof a)return parseFloat(a);if(!(a instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var c,d=[];for(c=0;c<a.length;c++)d[c]=b(a[c]);return d}return b(a)},numeric.parseCSV=function(a){var b,c,d=a.split("\n"),e=[],f=/(([^'",]*)|('[^']*')|("[^"]*")),/g,g=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,h=function(a){return a.substr(0,a.length-1)},i=0;for(c=0;c<d.length;c++){var j,k=(d[c]+",").match(f);if(k.length>0){for(e[i]=[],b=0;b<k.length;b++)j=h(k[b]),e[i][b]=g.test(j)?parseFloat(j):j;i++}}return e},numeric.toCSV=function(a){var b,c,d,e,f,g,h=numeric.dim(a);for(d=h[0],e=h[1],g=[],b=0;d>b;b++){for(f=[],c=0;d>c;c++)f[c]=a[b][c].toString();g[b]=f.join(", ")}return g.join("\n")+"\n"},numeric.getURL=function(a){var b=new XMLHttpRequest;return b.open("GET",a,!1),b.send(),b},numeric.imageURL=function(a){function b(a){var b,c,d,e,f,g,h,i,j=a.length,k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="";for(b=0;j>b;b+=3)c=a[b],d=a[b+1],e=a[b+2],f=c>>2,g=((3&c)<<4)+(d>>4),h=((15&d)<<2)+(e>>6),i=63&e,b+1>=j?h=i=64:b+2>=j&&(i=64),l+=k.charAt(f)+k.charAt(g)+k.charAt(h)+k.charAt(i);return l}function c(a,b,c){"undefined"==typeof b&&(b=0),"undefined"==typeof c&&(c=a.length);var d,e=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],f=-1,g=0;for(a.length,d=b;c>d;d++)g=255&(f^a[d]),f=f>>>8^e[g];return-1^f}var d,e,f,g,h,i,j,k,l,m,n=a[0].length,o=a[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,o>>24&255,o>>16&255,o>>8&255,255&o,n>>24&255,n>>16&255,n>>8&255,255&n,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(m=c(p,12,29),p[29]=m>>24&255,p[30]=m>>16&255,p[31]=m>>8&255,p[32]=255&m,d=1,e=0,j=0;n>j;j++){for(p.push(n-1>j?0:1),h=3*o+1+(0===j)&255,i=3*o+1+(0===j)>>8&255,p.push(h),p.push(i),p.push(255&~h),p.push(255&~i),0===j&&p.push(0),k=0;o>k;k++)for(f=0;3>f;f++)h=a[f][j][k],h=h>255?255:0>h?0:Math.round(h),d=(d+h)%65521,e=(e+d)%65521,p.push(h);p.push(0)}return l=(e<<16)+d,p.push(l>>24&255),p.push(l>>16&255),p.push(l>>8&255),p.push(255&l),g=p.length-41,p[33]=g>>24&255,p[34]=g>>16&255,p[35]=g>>8&255,p[36]=255&g,m=c(p,37),p.push(m>>24&255),p.push(m>>16&255),p.push(m>>8&255),p.push(255&m),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+b(p)},numeric._dim=function(a){for(var b=[];"object"==typeof a;)b.push(a.length),a=a[0];return b},numeric.dim=function(a){var b,c;return"object"==typeof a?(b=a[0],"object"==typeof b?(c=b[0],"object"==typeof c?numeric._dim(a):[a.length,b.length]):[a.length]):[]},numeric.mapreduce=function(a,b){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+b+';\nif(typeof x === "number") { var xi = x; '+a+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+a+";\n    xi = x[i-1];\n    "+a+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+a+"\n}\nreturn accum;")},numeric.mapreduce2=function(a,b){return Function("x","var n = x.length;\nvar i,xi;\n"+b+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+a+";\n}\nreturn accum;")},numeric.same=function a(b,c){var d,e;if(!(b instanceof Array&&c instanceof Array))return!1;if(e=b.length,e!==c.length)return!1;for(d=0;e>d;d++)if(b[d]!==c[d]){if("object"!=typeof b[d])return!1;if(!a(b[d],c[d]))return!1}return!0},numeric.rep=function(a,b,c){"undefined"==typeof c&&(c=0);var d,e=a[c],f=Array(e);if(c===a.length-1){for(d=e-2;d>=0;d-=2)f[d+1]=b,f[d]=b;return-1===d&&(f[0]=b),f}for(d=e-1;d>=0;d--)f[d]=numeric.rep(a,b,c+1);return f},numeric.dotMMsmall=function(a,b){var c,d,e,f,g,h,i,j,k,l,m;for(f=a.length,g=b.length,h=b[0].length,i=Array(f),c=f-1;c>=0;c--){for(j=Array(h),k=a[c],e=h-1;e>=0;e--){for(l=k[g-1]*b[g-1][e],d=g-2;d>=1;d-=2)m=d-1,l+=k[d]*b[d][e]+k[m]*b[m][e];0===d&&(l+=k[0]*b[0][e]),j[e]=l}i[c]=j}return i},numeric._getCol=function(a,b,c){var d,e=a.length;for(d=e-1;d>0;--d)c[d]=a[d][b],--d,c[d]=a[d][b];0===d&&(c[0]=a[0][b])},numeric.dotMMbig=function(a,b){var c,d,e,f,g=numeric._getCol,h=b.length,i=Array(h),j=a.length,k=b[0].length,l=new Array(j),m=numeric.dotVV;for(--h,--j,d=j;-1!==d;--d)l[d]=Array(k);for(--k,d=k;-1!==d;--d)for(g(b,d,i),e=j;-1!==e;--e)f=0,c=a[e],l[e][d]=m(c,i);return l},numeric.dotMV=function(a,b){var c,d=a.length,e=(b.length,Array(d)),f=numeric.dotVV;for(c=d-1;c>=0;c--)e[c]=f(a[c],b);return e},numeric.dotVM=function(a,b){var c,d,e,f,g,h,i;for(e=a.length,f=b[0].length,g=Array(f),d=f-1;d>=0;d--){for(h=a[e-1]*b[e-1][d],c=e-2;c>=1;c-=2)i=c-1,h+=a[c]*b[c][d]+a[i]*b[i][d];0===c&&(h+=a[0]*b[0][d]),g[d]=h}return g},numeric.dotVV=function(a,b){var c,d,e=a.length,f=a[e-1]*b[e-1];for(c=e-2;c>=1;c-=2)d=c-1,f+=a[c]*b[c]+a[d]*b[d];return 0===c&&(f+=a[0]*b[0]),f},numeric.dot=function(a,b){var c=numeric.dim;switch(1e3*c(a).length+c(b).length){case 2002:return b.length<10?numeric.dotMMsmall(a,b):numeric.dotMMbig(a,b);case 2001:return numeric.dotMV(a,b);case 1002:return numeric.dotVM(a,b);case 1001:return numeric.dotVV(a,b);case 1e3:return numeric.mulVS(a,b);case 1:return numeric.mulSV(a,b);case 0:return a*b;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(a){var b,c,d,e,f=a.length,g=Array(f);for(b=f-1;b>=0;b--){for(e=Array(f),c=b+2,d=f-1;d>=c;d-=2)e[d]=0,e[d-1]=0;for(d>b&&(e[d]=0),e[b]=a[b],d=b-1;d>=1;d-=2)e[d]=0,e[d-1]=0;0===d&&(e[0]=0),g[b]=e}return g},numeric.getDiag=function(a){var b,c=Math.min(a.length,a[0].length),d=Array(c);for(b=c-1;b>=1;--b)d[b]=a[b][b],--b,d[b]=a[b][b];return 0===b&&(d[0]=a[0][0]),d},numeric.identity=function(a){return numeric.diag(numeric.rep([a],1))},numeric.pointwise=function(a,b,c){"undefined"==typeof c&&(c="");var d,e,f=[],g=/\[i\]$/,h="",i=!1;for(d=0;d<a.length;d++)g.test(a[d])?(e=a[d].substring(0,a[d].length-3),h=e):e=a[d],"ret"===e&&(i=!0),f.push(e);return f[a.length]="_s",f[a.length+1]="_k",f[a.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+h+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(i?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+a.join(",")+",_s,_k+1);\n    return ret;\n}\n"+c+"\nfor(i=_n-1;i!==-1;--i) {\n    "+b+"\n}\nreturn ret;",Function.apply(null,f)},numeric.pointwise2=function(a,b,c){"undefined"==typeof c&&(c="");var d,e,f=[],g=/\[i\]$/,h="",i=!1;for(d=0;d<a.length;d++)g.test(a[d])?(e=a[d].substring(0,a[d].length-3),h=e):e=a[d],"ret"===e&&(i=!0),f.push(e);return f[a.length]="var _n = "+h+".length;\nvar i"+(i?"":", ret = Array(_n)")+";\n"+c+"\nfor(i=_n-1;i!==-1;--i) {\n"+b+"\n}\nreturn ret;",Function.apply(null,f)},numeric._biforeach=function b(a,c,d,e,f){if(e===d.length-1)return void f(a,c);var g,h=d[e];for(g=h-1;g>=0;g--)b("object"==typeof a?a[g]:a,"object"==typeof c?c[g]:c,d,e+1,f)},numeric._biforeach2=function c(a,b,d,e,f){if(e===d.length-1)return f(a,b);var g,h=d[e],i=Array(h);for(g=h-1;g>=0;--g)i[g]=c("object"==typeof a?a[g]:a,"object"==typeof b?b[g]:b,d,e+1,f);return i},numeric._foreach=function d(a,b,c,e){if(c===b.length-1)return void e(a);var f,g=b[c];for(f=g-1;f>=0;f--)d(a[f],b,c+1,e)},numeric._foreach2=function e(a,b,c,d){if(c===b.length-1)return d(a);var f,g=b[c],h=Array(g);for(f=g-1;f>=0;f--)h[f]=e(a[f],b,c+1,d);return h},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var a,b;for(a=0;a<numeric.mathfuns2.length;++a)b=numeric.mathfuns2[a],numeric.ops2[b]=b;for(a in numeric.ops2)if(numeric.ops2.hasOwnProperty(a)){b=numeric.ops2[a];var c,d,e="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,a)?(e="var "+b+" = Math."+b+";\n",c=function(a,c,d){return a+" = "+b+"("+c+","+d+")"},d=function(a,c){return a+" = "+b+"("+a+","+c+")"}):(c=function(a,c,d){return a+" = "+c+" "+b+" "+d},d=numeric.opseq.hasOwnProperty(a+"eq")?function(a,c){return a+" "+b+"= "+c}:function(a,c){return a+" = "+a+" "+b+" "+c}),numeric[a+"VV"]=numeric.pointwise2(["x[i]","y[i]"],c("ret[i]","x[i]","y[i]"),e),numeric[a+"SV"]=numeric.pointwise2(["x","y[i]"],c("ret[i]","x","y[i]"),e),numeric[a+"VS"]=numeric.pointwise2(["x[i]","y"],c("ret[i]","x[i]","y"),e),numeric[a]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+a+"VV, VS = numeric."+a+"VS, SV = numeric."+a+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+d("x","y")+"\n}\nreturn x;\n"),numeric[b]=numeric[a],numeric[a+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],d("ret[i]","x[i]"),e),numeric[a+"eqS"]=numeric.pointwise2(["ret[i]","x"],d("ret[i]","x"),e),numeric[a+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+a+"eqV, S = numeric."+a+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')
}for(a=0;a<numeric.mathfuns2.length;++a)b=numeric.mathfuns2[a],delete numeric.ops2[b];for(a=0;a<numeric.mathfuns.length;++a)b=numeric.mathfuns[a],numeric.ops1[b]=b;for(a in numeric.ops1)numeric.ops1.hasOwnProperty(a)&&(e="",b=numeric.ops1[a],-1!==numeric.myIndexOf.call(numeric.mathfuns,a)&&Math.hasOwnProperty(b)&&(e="var "+b+" = Math."+b+";\n"),numeric[a+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+b+"(ret[i]);",e),numeric[a+"eq"]=Function("x",'if(typeof x !== "object") return '+b+"x\nvar i;\nvar V = numeric."+a+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[a+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+b+"(x[i]);",e),numeric[a]=Function("x",'if(typeof x !== "object") return '+b+"(x)\nvar i;\nvar V = numeric."+a+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(a=0;a<numeric.mathfuns.length;++a)b=numeric.mathfuns[a],delete numeric.ops1[b];for(a in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(a)&&(b=numeric.mapreducers[a],numeric[a+"V"]=numeric.mapreduce2(b[0],b[1]),numeric[a]=Function("x","s","k",b[1]+'if(typeof x !== "object") {    xi = x;\n'+b[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+a+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+b[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(a,b){return"object"==typeof a?"object"==typeof b?numeric.truncVV(a,b):numeric.truncVS(a,b):"object"==typeof b?numeric.truncSV(a,b):Math.round(a/b)*b},numeric.inv=function(a){var b,c,d,e,f,g,h,a,i=numeric.dim(a),j=Math.abs,k=i[0],l=i[1],m=numeric.clone(a),n=numeric.identity(k);for(g=0;l>g;++g){var o=-1,p=-1;for(f=g;f!==k;++f)h=j(m[f][g]),h>p&&(o=f,p=h);for(c=m[o],m[o]=m[g],m[g]=c,e=n[o],n[o]=n[g],n[g]=e,a=c[g],h=g;h!==l;++h)c[h]/=a;for(h=l-1;-1!==h;--h)e[h]/=a;for(f=k-1;-1!==f;--f)if(f!==g){for(b=m[f],d=n[f],a=b[g],h=g+1;h!==l;++h)b[h]-=c[h]*a;for(h=l-1;h>0;--h)d[h]-=e[h]*a,--h,d[h]-=e[h]*a;0===h&&(d[0]-=e[0]*a)}}return n},numeric.det=function(a){var b=numeric.dim(a);if(2!==b.length||b[0]!==b[1])throw new Error("numeric: det() only works on square matrices");var c,d,e,f,g,h,i,j,k=b[0],l=1,m=numeric.clone(a);for(d=0;k-1>d;d++){for(e=d,c=d+1;k>c;c++)Math.abs(m[c][d])>Math.abs(m[e][d])&&(e=c);for(e!==d&&(i=m[e],m[e]=m[d],m[d]=i,l*=-1),f=m[d],c=d+1;k>c;c++){for(g=m[c],h=g[d]/f[d],e=d+1;k-1>e;e+=2)j=e+1,g[e]-=f[e]*h,g[j]-=f[j]*h;e!==k&&(g[e]-=f[e]*h)}if(0===f[d])return 0;l*=f[d]}return l*m[d][d]},numeric.transpose=function(a){var b,c,d,e,f,g=a.length,h=a[0].length,i=Array(h);for(c=0;h>c;c++)i[c]=Array(g);for(b=g-1;b>=1;b-=2){for(e=a[b],d=a[b-1],c=h-1;c>=1;--c)f=i[c],f[b]=e[c],f[b-1]=d[c],--c,f=i[c],f[b]=e[c],f[b-1]=d[c];0===c&&(f=i[0],f[b]=e[0],f[b-1]=d[0])}if(0===b){for(d=a[0],c=h-1;c>=1;--c)i[c][0]=d[c],--c,i[c][0]=d[c];0===c&&(i[0][0]=d[0])}return i},numeric.negtranspose=function(a){var b,c,d,e,f,g=a.length,h=a[0].length,i=Array(h);for(c=0;h>c;c++)i[c]=Array(g);for(b=g-1;b>=1;b-=2){for(e=a[b],d=a[b-1],c=h-1;c>=1;--c)f=i[c],f[b]=-e[c],f[b-1]=-d[c],--c,f=i[c],f[b]=-e[c],f[b-1]=-d[c];0===c&&(f=i[0],f[b]=-e[0],f[b-1]=-d[0])}if(0===b){for(d=a[0],c=h-1;c>=1;--c)i[c][0]=-d[c],--c,i[c][0]=-d[c];0===c&&(i[0][0]=-d[0])}return i},numeric._random=function f(a,b){var c,d,e=a[b],g=Array(e);if(b===a.length-1){for(d=Math.random,c=e-1;c>=1;c-=2)g[c]=d(),g[c-1]=d();return 0===c&&(g[0]=d()),g}for(c=e-1;c>=0;c--)g[c]=f(a,b+1);return g},numeric.random=function(a){return numeric._random(a,0)},numeric.norm2=function(a){return Math.sqrt(numeric.norm2Squared(a))},numeric.linspace=function(a,b,c){if("undefined"==typeof c&&(c=Math.max(Math.round(b-a)+1,1)),2>c)return 1===c?[a]:[];var d,e=Array(c);for(c--,d=c;d>=0;d--)e[d]=(d*b+(c-d)*a)/c;return e},numeric.getBlock=function(a,b,c){function d(a,f){var g,h=b[f],i=c[f]-h,j=Array(i);if(f===e.length-1){for(g=i;g>=0;g--)j[g]=a[g+h];return j}for(g=i;g>=0;g--)j[g]=d(a[g+h],f+1);return j}var e=numeric.dim(a);return d(a,0)},numeric.setBlock=function(a,b,c,d){function e(a,d,g){var h,i=b[g],j=c[g]-i;if(g===f.length-1)for(h=j;h>=0;h--)a[h+i]=d[h];for(h=j;h>=0;h--)e(a[h+i],d[h],g+1)}var f=numeric.dim(a);return e(a,d,0),a},numeric.getRange=function(a,b,c){var d,e,f,g,h=b.length,i=c.length,j=Array(h);for(d=h-1;-1!==d;--d)for(j[d]=Array(i),f=j[d],g=a[b[d]],e=i-1;-1!==e;--e)f[e]=g[c[e]];return j},numeric.blockMatrix=function(a){var b=numeric.dim(a);if(b.length<4)return numeric.blockMatrix([a]);var c,d,e,f,g,h=b[0],i=b[1];for(c=0,d=0,e=0;h>e;++e)c+=a[e][0].length;for(f=0;i>f;++f)d+=a[0][f][0].length;var j=Array(c);for(e=0;c>e;++e)j[e]=Array(d);var k,l,m,n,o,p=0;for(e=0;h>e;++e){for(k=d,f=i-1;-1!==f;--f)for(g=a[e][f],k-=g[0].length,m=g.length-1;-1!==m;--m)for(o=g[m],l=j[p+m],n=o.length-1;-1!==n;--n)l[k+n]=o[n];p+=a[e][0].length}return j},numeric.tensor=function(a,b){if("number"==typeof a||"number"==typeof b)return numeric.mul(a,b);var c=numeric.dim(a),d=numeric.dim(b);if(1!==c.length||1!==d.length)throw new Error("numeric: tensor product is only defined for vectors");var e,f,g,h,i=c[0],j=d[0],k=Array(i);for(f=i-1;f>=0;f--){for(e=Array(j),h=a[f],g=j-1;g>=3;--g)e[g]=h*b[g],--g,e[g]=h*b[g],--g,e[g]=h*b[g],--g,e[g]=h*b[g];for(;g>=0;)e[g]=h*b[g],--g;k[f]=e}return k},numeric.T=function(a,b){this.x=a,this.y=b},numeric.t=function(a,b){return new numeric.T(a,b)},numeric.Tbinop=function(a,b,c,d,e){if(numeric.indexOf,"string"!=typeof e){var f;e="";for(f in numeric)numeric.hasOwnProperty(f)&&(a.indexOf(f)>=0||b.indexOf(f)>=0||c.indexOf(f)>=0||d.indexOf(f)>=0)&&f.length>1&&(e+="var "+f+" = numeric."+f+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+e+"\nif(x.y) {  if(y.y) {    return new numeric.T("+d+");\n  }\n  return new numeric.T("+c+");\n}\nif(y.y) {\n  return new numeric.T("+b+");\n}\nreturn new numeric.T("+a+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var a=numeric.mul,b=numeric.div;if(this.y){var c=numeric.add(a(this.x,this.x),a(this.y,this.y));return new numeric.T(b(this.x,c),b(numeric.neg(this.y),c))}return new T(b(1,this.x))},numeric.T.prototype.div=function g(a){if(a instanceof numeric.T||(a=new numeric.T(a)),a.y)return this.mul(a.reciprocal());var g=numeric.div;return this.y?new numeric.T(g(this.x,a.x),g(this.y,a.x)):new numeric.T(g(this.x,a.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var a=numeric.transpose,b=this.x,c=this.y;return c?new numeric.T(a(b),a(c)):new numeric.T(a(b))},numeric.T.prototype.transjugate=function(){var a=numeric.transpose,b=this.x,c=this.y;return c?new numeric.T(a(b),numeric.negtranspose(c)):new numeric.T(a(b))},numeric.Tunop=function(a,b,c){return"string"!=typeof c&&(c=""),Function("var x = this;\n"+c+"\nif(x.y) {  "+b+";\n}\n"+a+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var a=this;if("undefined"==typeof a.y)return new numeric.T(numeric.inv(a.x));var b,c,d,e,f,g,h,i,j,k,l,b,c,d,m,n,o,p,q,r,s,t=a.x.length,u=numeric.identity(t),v=numeric.rep([t,t],0),w=numeric.clone(a.x),x=numeric.clone(a.y);for(b=0;t>b;b++){for(o=w[b][b],p=x[b][b],m=o*o+p*p,d=b,c=b+1;t>c;c++)o=w[c][b],p=x[c][b],n=o*o+p*p,n>m&&(d=c,m=n);for(d!==b&&(s=w[b],w[b]=w[d],w[d]=s,s=x[b],x[b]=x[d],x[d]=s,s=u[b],u[b]=u[d],u[d]=s,s=v[b],v[b]=v[d],v[d]=s),e=w[b],f=x[b],i=u[b],j=v[b],o=e[b],p=f[b],c=b+1;t>c;c++)q=e[c],r=f[c],e[c]=(q*o+r*p)/m,f[c]=(r*o-q*p)/m;for(c=0;t>c;c++)q=i[c],r=j[c],i[c]=(q*o+r*p)/m,j[c]=(r*o-q*p)/m;for(c=b+1;t>c;c++){for(g=w[c],h=x[c],k=u[c],l=v[c],o=g[b],p=h[b],d=b+1;t>d;d++)q=e[d],r=f[d],g[d]-=q*o-r*p,h[d]-=r*o+q*p;for(d=0;t>d;d++)q=i[d],r=j[d],k[d]-=q*o-r*p,l[d]-=r*o+q*p}}for(b=t-1;b>0;b--)for(i=u[b],j=v[b],c=b-1;c>=0;c--)for(k=u[c],l=v[c],o=w[c][b],p=x[c][b],d=t-1;d>=0;d--)q=i[d],r=j[d],k[d]-=o*q-p*r,l[d]-=o*r+p*q;return new numeric.T(u,v)},numeric.T.prototype.get=function(a){var b,c=this.x,d=this.y,e=0,f=a.length;if(d){for(;f>e;)b=a[e],c=c[b],d=d[b],e++;return new numeric.T(c,d)}for(;f>e;)b=a[e],c=c[b],e++;return new numeric.T(c)},numeric.T.prototype.set=function(a,b){var c,d=this.x,e=this.y,f=0,g=a.length,h=b.x,i=b.y;if(0===g)return i?this.y=i:e&&(this.y=void 0),this.x=d,this;if(i){for(e||(e=numeric.rep(numeric.dim(d),0),this.y=e);g-1>f;)c=a[f],d=d[c],e=e[c],f++;return c=a[f],d[c]=h,e[c]=i,this}if(e){for(;g-1>f;)c=a[f],d=d[c],e=e[c],f++;return c=a[f],d[c]=h,e[c]=h instanceof Array?numeric.rep(numeric.dim(h),0):0,this}for(;g-1>f;)c=a[f],d=d[c],f++;return c=a[f],d[c]=h,this},numeric.T.prototype.getRows=function(a,b){var c,d,e=b-a+1,f=Array(e),g=this.x,h=this.y;for(c=a;b>=c;c++)f[c-a]=g[c];if(h){for(d=Array(e),c=a;b>=c;c++)d[c-a]=h[c];return new numeric.T(f,d)}return new numeric.T(f)},numeric.T.prototype.setRows=function(a,b,c){var d,e=this.x,f=this.y,g=c.x,h=c.y;for(d=a;b>=d;d++)e[d]=g[d-a];if(h)for(f||(f=numeric.rep(numeric.dim(e),0),this.y=f),d=a;b>=d;d++)f[d]=h[d-a];else if(f)for(d=a;b>=d;d++)f[d]=numeric.rep([g[d-a].length],0);return this},numeric.T.prototype.getRow=function(a){var b=this.x,c=this.y;return c?new numeric.T(b[a],c[a]):new numeric.T(b[a])},numeric.T.prototype.setRow=function(a,b){var c=this.x,d=this.y,e=b.x,f=b.y;return c[a]=e,f?(d||(d=numeric.rep(numeric.dim(c),0),this.y=d),d[a]=f):d&&(d=numeric.rep([e.length],0)),this},numeric.T.prototype.getBlock=function(a,b){var c=this.x,d=this.y,e=numeric.getBlock;return d?new numeric.T(e(c,a,b),e(d,a,b)):new numeric.T(e(c,a,b))},numeric.T.prototype.setBlock=function(a,b,c){c instanceof numeric.T||(c=new numeric.T(c));var d=this.x,e=this.y,f=numeric.setBlock,g=c.x,h=c.y;return h?(e||(this.y=numeric.rep(numeric.dim(this),0),e=this.y),f(d,a,b,g),f(e,a,b,h),this):(f(d,a,b,g),void(e&&f(e,a,b,numeric.rep(numeric.dim(g),0))))},numeric.T.rep=function(a,b){var c=numeric.T;b instanceof c||(b=new c(b));var d=b.x,e=b.y,f=numeric.rep;return e?new c(f(a,d),f(a,e)):new c(f(a,d))},numeric.T.diag=function h(a){a instanceof numeric.T||(a=new numeric.T(a));var b=a.x,c=a.y,h=numeric.diag;return c?new numeric.T(h(b),h(c)):new numeric.T(h(b))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(a){return new numeric.T(numeric.identity(a))},numeric.T.prototype.getDiag=function(){var a=numeric,b=this.x,c=this.y;return c?new a.T(a.getDiag(b),a.getDiag(c)):new a.T(a.getDiag(b))},numeric.house=function(a){var b=numeric.clone(a),c=a[0]>=0?1:-1,d=c*numeric.norm2(a);b[0]+=d;var e=numeric.norm2(b);if(0===e)throw new Error("eig: internal error");return numeric.div(b,e)},numeric.toUpperHessenberg=function(a){var b=numeric.dim(a);if(2!==b.length||b[0]!==b[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var c,d,e,f,g,h,i,j,k,l,m=b[0],n=numeric.clone(a),o=numeric.identity(m);for(d=0;m-2>d;d++){for(f=Array(m-d-1),c=d+1;m>c;c++)f[c-d-1]=n[c][d];if(numeric.norm2(f)>0){for(g=numeric.house(f),h=numeric.getBlock(n,[d+1,d],[m-1,m-1]),i=numeric.tensor(g,numeric.dot(g,h)),c=d+1;m>c;c++)for(j=n[c],k=i[c-d-1],e=d;m>e;e++)j[e]-=2*k[e-d];for(h=numeric.getBlock(n,[0,d+1],[m-1,m-1]),i=numeric.tensor(numeric.dot(h,g),g),c=0;m>c;c++)for(j=n[c],k=i[c],e=d+1;m>e;e++)j[e]-=2*k[e-d-1];for(h=Array(m-d-1),c=d+1;m>c;c++)h[c-d-1]=o[c];for(i=numeric.tensor(g,numeric.dot(g,h)),c=d+1;m>c;c++)for(l=o[c],k=i[c-d-1],e=0;m>e;e++)l[e]-=2*k[e]}}return{H:n,Q:o}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(a,b){"undefined"==typeof b&&(b=1e4),a=numeric.clone(a);var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=(numeric.clone(a),numeric.dim(a)),v=u[0],w=numeric.identity(v);if(3>v)return{Q:w,B:[[0,v-1]]};var x=numeric.epsilon;for(t=0;b>t;t++){for(r=0;v-1>r;r++)if(Math.abs(a[r+1][r])<x*(Math.abs(a[r][r])+Math.abs(a[r+1][r+1]))){var y=numeric.QRFrancis(numeric.getBlock(a,[0,0],[r,r]),b),z=numeric.QRFrancis(numeric.getBlock(a,[r+1,r+1],[v-1,v-1]),b);for(n=Array(r+1),q=0;r>=q;q++)n[q]=w[q];for(o=numeric.dot(y.Q,n),q=0;r>=q;q++)w[q]=o[q];for(n=Array(v-r-1),q=r+1;v>q;q++)n[q-r-1]=w[q];for(o=numeric.dot(z.Q,n),q=r+1;v>q;q++)w[q]=o[q-r-1];return{Q:w,B:y.B.concat(numeric.add(z.B,r+1))}}if(e=a[v-2][v-2],f=a[v-2][v-1],g=a[v-1][v-2],h=a[v-1][v-1],j=e+h,i=e*h-f*g,k=numeric.getBlock(a,[0,0],[2,2]),j*j>=4*i){var A,B;A=.5*(j+Math.sqrt(j*j-4*i)),B=.5*(j-Math.sqrt(j*j-4*i)),k=numeric.add(numeric.sub(numeric.dot(k,k),numeric.mul(k,A+B)),numeric.diag(numeric.rep([3],A*B)))}else k=numeric.add(numeric.sub(numeric.dot(k,k),numeric.mul(k,j)),numeric.diag(numeric.rep([3],i)));for(c=[k[0][0],k[1][0],k[2][0]],d=numeric.house(c),n=[a[0],a[1],a[2]],o=numeric.tensor(d,numeric.dot(d,n)),q=0;3>q;q++)for(m=a[q],p=o[q],s=0;v>s;s++)m[s]-=2*p[s];for(n=numeric.getBlock(a,[0,0],[v-1,2]),o=numeric.tensor(numeric.dot(n,d),d),q=0;v>q;q++)for(m=a[q],p=o[q],s=0;3>s;s++)m[s]-=2*p[s];for(n=[w[0],w[1],w[2]],o=numeric.tensor(d,numeric.dot(d,n)),q=0;3>q;q++)for(l=w[q],p=o[q],s=0;v>s;s++)l[s]-=2*p[s];var C;for(r=0;v-2>r;r++){for(s=r;r+1>=s;s++)if(Math.abs(a[s+1][s])<x*(Math.abs(a[s][s])+Math.abs(a[s+1][s+1]))){var y=numeric.QRFrancis(numeric.getBlock(a,[0,0],[s,s]),b),z=numeric.QRFrancis(numeric.getBlock(a,[s+1,s+1],[v-1,v-1]),b);for(n=Array(s+1),q=0;s>=q;q++)n[q]=w[q];for(o=numeric.dot(y.Q,n),q=0;s>=q;q++)w[q]=o[q];for(n=Array(v-s-1),q=s+1;v>q;q++)n[q-s-1]=w[q];for(o=numeric.dot(z.Q,n),q=s+1;v>q;q++)w[q]=o[q-s-1];return{Q:w,B:y.B.concat(numeric.add(z.B,s+1))}}for(C=Math.min(v-1,r+3),c=Array(C-r),q=r+1;C>=q;q++)c[q-r-1]=a[q][r];for(d=numeric.house(c),n=numeric.getBlock(a,[r+1,r],[C,v-1]),o=numeric.tensor(d,numeric.dot(d,n)),q=r+1;C>=q;q++)for(m=a[q],p=o[q-r-1],s=r;v>s;s++)m[s]-=2*p[s-r];for(n=numeric.getBlock(a,[0,r+1],[v-1,C]),o=numeric.tensor(numeric.dot(n,d),d),q=0;v>q;q++)for(m=a[q],p=o[q],s=r+1;C>=s;s++)m[s]-=2*p[s-r-1];for(n=Array(C-r),q=r+1;C>=q;q++)n[q-r-1]=w[q];for(o=numeric.tensor(d,numeric.dot(d,n)),q=r+1;C>=q;q++)for(l=w[q],p=o[q-r-1],s=0;v>s;s++)l[s]-=2*p[s]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=numeric.toUpperHessenberg(a),u=numeric.QRFrancis(t.H,b),v=numeric.T,w=a.length,x=u.B,y=numeric.dot(u.Q,numeric.dot(t.H,numeric.transpose(u.Q))),z=new v(numeric.dot(u.Q,t.Q)),A=x.length,B=Math.sqrt;for(d=0;A>d;d++)if(c=x[d][0],c===x[d][1]);else{if(f=c+1,g=y[c][c],h=y[c][f],i=y[f][c],j=y[f][f],0===h&&0===i)continue;k=-g-j,l=g*j-h*i,m=k*k-4*l,m>=0?(n=0>k?-.5*(k-B(m)):-.5*(k+B(m)),r=(g-n)*(g-n)+h*h,s=i*i+(j-n)*(j-n),r>s?(r=B(r),p=(g-n)/r,q=h/r):(s=B(s),p=i/s,q=(j-n)/s),e=new v([[q,-p],[p,q]]),z.setRows(c,f,e.dot(z.getRows(c,f)))):(n=-.5*k,o=.5*B(-m),r=(g-n)*(g-n)+h*h,s=i*i+(j-n)*(j-n),r>s?(r=B(r+o*o),p=(g-n)/r,q=h/r,n=0,o/=r):(s=B(s+o*o),p=i/s,q=(j-n)/s,n=o/s,o=0),e=new v([[q,-p],[p,q]],[[n,o],[o,-n]]),z.setRows(c,f,e.dot(z.getRows(c,f))))}var C=z.dot(a).dot(z.transjugate()),w=a.length,D=numeric.T.identity(w);for(f=0;w>f;f++)if(f>0)for(d=f-1;d>=0;d--){var E=C.get([d,d]),F=C.get([f,f]);numeric.neq(E.x,F.x)||numeric.neq(E.y,F.y)?(n=C.getRow(d).getBlock([d],[f-1]),o=D.getRow(f).getBlock([d],[f-1]),D.set([f,d],C.get([d,f]).neg().sub(n.dot(o)).div(E.sub(F)))):D.setRow(f,D.getRow(d))}for(f=0;w>f;f++)n=D.getRow(f),D.setRow(f,n.div(n.norm2()));return D=D.transpose(),D=z.transjugate().dot(D),{lambda:C.getDiag(),E:D}},numeric.ccsSparse=function(a){var b,c,d,e,f=a.length,g=[];for(d=f-1;-1!==d;--d){c=a[d];for(e in c){for(e=parseInt(e);e>=g.length;)g[g.length]=0;0!==c[e]&&g[e]++}}var b=g.length,h=Array(b+1);for(h[0]=0,d=0;b>d;++d)h[d+1]=h[d]+g[d];var i=Array(h[b]),j=Array(h[b]);for(d=f-1;-1!==d;--d){c=a[d];for(e in c)0!==c[e]&&(g[e]--,i[h[e]+g[e]]=d,j[h[e]+g[e]]=c[e])}return[h,i,j]},numeric.ccsFull=function(a){var b,c,d,e,f=a[0],g=a[1],h=a[2],i=numeric.ccsDim(a),j=i[0],k=i[1],l=numeric.rep([j,k],0);for(b=0;k>b;b++)for(d=f[b],e=f[b+1],c=d;e>c;++c)l[g[c]][b]=h[c];return l},numeric.ccsTSolve=function(a,b,c,d,e){function f(a){var b;if(0===c[a]){for(c[a]=1,b=g[a];b<g[a+1];++b)f(h[b]);e[l]=a,++l}}var g=a[0],h=a[1],i=a[2],j=g.length-1,k=Math.max,l=0;"undefined"==typeof d&&(c=numeric.rep([j],0)),"undefined"==typeof d&&(d=numeric.linspace(0,c.length-1)),"undefined"==typeof e&&(e=[]);var m,n,o,p,q,r,s;for(m=d.length-1;-1!==m;--m)f(d[m]);for(e.length=l,m=e.length-1;-1!==m;--m)c[e[m]]=0;for(m=d.length-1;-1!==m;--m)n=d[m],c[n]=b[n];for(m=e.length-1;-1!==m;--m){for(n=e[m],o=g[n],p=k(g[n+1],o),q=o;q!==p;++q)if(h[q]===n){c[n]/=i[q];break}for(s=c[n],q=o;q!==p;++q)r=h[q],r!==n&&(c[r]-=s*i[q])}return c},numeric.ccsDFS=function(a){this.k=Array(a),this.k1=Array(a),this.j=Array(a)},numeric.ccsDFS.prototype.dfs=function(a,b,c,d,e,f){var g,h,i,j=0,k=e.length,l=this.k,m=this.k1,n=this.j;if(0===d[a])for(d[a]=1,n[0]=a,l[0]=h=b[a],m[0]=i=b[a+1];;)if(h>=i){if(e[k]=n[j],0===j)return;++k,--j,h=l[j],i=m[j]}else g=f[c[h]],0===d[g]?(d[g]=1,l[j]=h,++j,n[j]=g,h=b[g],m[j]=i=b[g+1]):++h},numeric.ccsLPSolve=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q=a[0],r=a[1],s=a[2],t=(q.length-1,b[0]),u=b[1],v=b[2];for(i=t[e],j=t[e+1],d.length=0,h=i;j>h;++h)g.dfs(f[u[h]],q,r,c,d,f);for(h=d.length-1;-1!==h;--h)c[d[h]]=0;for(h=i;h!==j;++h)k=f[u[h]],c[k]=v[h];for(h=d.length-1;-1!==h;--h){for(k=d[h],l=q[k],m=q[k+1],n=l;m>n;++n)if(f[r[n]]===k){c[k]/=s[n];break}for(p=c[k],n=l;m>n;++n)o=f[r[n]],o!==k&&(c[o]-=p*s[n])}return c},numeric.ccsLUP1=function(a,b){var c,d,e,f,g,h,i,j=a[0].length-1,k=[numeric.rep([j+1],0),[],[]],l=[numeric.rep([j+1],0),[],[]],m=k[0],n=k[1],o=k[2],p=l[0],q=l[1],r=l[2],s=numeric.rep([j],0),t=numeric.rep([j],0),u=numeric.ccsLPSolve,v=(Math.max,Math.abs),w=numeric.linspace(0,j-1),x=numeric.linspace(0,j-1),y=new numeric.ccsDFS(j);for("undefined"==typeof b&&(b=1),c=0;j>c;++c){for(u(k,a,s,t,c,x,y),f=-1,g=-1,d=t.length-1;-1!==d;--d)e=t[d],c>=e||(h=v(s[e]),h>f&&(g=e,f=h));for(v(s[c])<b*f&&(d=w[c],f=w[g],w[c]=f,x[f]=c,w[g]=d,x[d]=g,f=s[c],s[c]=s[g],s[g]=f),f=m[c],g=p[c],i=s[c],n[f]=w[c],o[f]=1,++f,d=t.length-1;-1!==d;--d)e=t[d],h=s[e],t[d]=0,s[e]=0,c>=e?(q[g]=e,r[g]=h,++g):(n[f]=w[e],o[f]=h/i,++f);m[c+1]=f,p[c+1]=g}for(d=n.length-1;-1!==d;--d)n[d]=x[n[d]];return{L:k,U:l,P:w,Pinv:x}},numeric.ccsDFS0=function(a){this.k=Array(a),this.k1=Array(a),this.j=Array(a)},numeric.ccsDFS0.prototype.dfs=function(a,b,c,d,e,f){var g,h,i,j=0,k=e.length,l=this.k,m=this.k1,n=this.j;if(0===d[a])for(d[a]=1,n[0]=a,l[0]=h=b[f[a]],m[0]=i=b[f[a]+1];;){if(isNaN(h))throw new Error("Ow!");if(h>=i){if(e[k]=f[n[j]],0===j)return;++k,--j,h=l[j],i=m[j]}else g=c[h],0===d[g]?(d[g]=1,l[j]=h,++j,n[j]=g,g=f[g],h=b[g],m[j]=i=b[g+1]):++h}},numeric.ccsLPSolve0=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r=a[0],s=a[1],t=a[2],u=(r.length-1,b[0]),v=b[1],w=b[2];for(j=u[e],k=u[e+1],d.length=0,i=j;k>i;++i)h.dfs(v[i],r,s,c,d,f,g);for(i=d.length-1;-1!==i;--i)l=d[i],c[g[l]]=0;for(i=j;i!==k;++i)l=v[i],c[l]=w[i];for(i=d.length-1;-1!==i;--i){for(l=d[i],p=g[l],m=r[l],n=r[l+1],o=m;n>o;++o)if(s[o]===p){c[p]/=t[o];break}for(q=c[p],o=m;n>o;++o)c[s[o]]-=q*t[o];c[p]=q}},numeric.ccsLUP0=function(a,b){var c,d,e,f,g,h,i,j=a[0].length-1,k=[numeric.rep([j+1],0),[],[]],l=[numeric.rep([j+1],0),[],[]],m=k[0],n=k[1],o=k[2],p=l[0],q=l[1],r=l[2],s=numeric.rep([j],0),t=numeric.rep([j],0),u=numeric.ccsLPSolve0,v=(Math.max,Math.abs),w=numeric.linspace(0,j-1),x=numeric.linspace(0,j-1),y=new numeric.ccsDFS0(j);for("undefined"==typeof b&&(b=1),c=0;j>c;++c){for(u(k,a,s,t,c,x,w,y),f=-1,g=-1,d=t.length-1;-1!==d;--d)e=t[d],c>=e||(h=v(s[w[e]]),h>f&&(g=e,f=h));for(v(s[w[c]])<b*f&&(d=w[c],f=w[g],w[c]=f,x[f]=c,w[g]=d,x[d]=g),f=m[c],g=p[c],i=s[w[c]],n[f]=w[c],o[f]=1,++f,d=t.length-1;-1!==d;--d)e=t[d],h=s[w[e]],t[d]=0,s[w[e]]=0,c>=e?(q[g]=e,r[g]=h,++g):(n[f]=w[e],o[f]=h/i,++f);m[c+1]=f,p[c+1]=g}for(d=n.length-1;-1!==d;--d)n[d]=x[n[d]];return{L:k,U:l,P:w,Pinv:x}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(a){return[numeric.sup(a[1])+1,a[0].length-1]},numeric.ccsGetBlock=function(a,b,c){var d=numeric.ccsDim(a),e=d[0],f=d[1];"undefined"==typeof b?b=numeric.linspace(0,e-1):"number"==typeof b&&(b=[b]),"undefined"==typeof c?c=numeric.linspace(0,f-1):"number"==typeof c&&(c=[c]);var g,h,i,j,k,l=b.length,m=c.length,n=numeric.rep([f],0),o=[],p=[],q=[n,o,p],r=a[0],s=a[1],t=a[2],u=numeric.rep([e],0),v=0,w=numeric.rep([e],0);for(h=0;m>h;++h){j=c[h];var x=r[j],y=r[j+1];for(g=x;y>g;++g)i=s[g],w[i]=1,u[i]=t[g];for(g=0;l>g;++g)k=b[g],w[k]&&(o[v]=g,p[v]=u[b[g]],++v);for(g=x;y>g;++g)i=s[g],w[i]=0;n[h+1]=v}return q},numeric.ccsDot=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=a[0],o=a[1],p=a[2],q=b[0],r=b[1],s=b[2],t=numeric.ccsDim(a),u=numeric.ccsDim(b),v=t[0],w=(t[1],u[1]),x=numeric.rep([v],0),y=numeric.rep([v],0),z=Array(v),A=numeric.rep([w],0),B=[],C=[],D=[A,B,C];for(e=0;e!==w;++e){for(f=q[e],g=q[e+1],k=0,d=f;g>d;++d)for(l=r[d],m=s[d],h=n[l],i=n[l+1],c=h;i>c;++c)j=o[c],0===y[j]&&(z[k]=j,y[j]=1,k+=1),x[j]=x[j]+p[c]*m;for(f=A[e],g=f+k,A[e+1]=g,d=k-1;-1!==d;--d)m=f+d,c=z[d],B[m]=c,C[m]=x[c],y[c]=0,x[c]=0;A[e+1]=A[e]+k}return D},numeric.ccsLUPSolve=function(a,b){var c=a.L,d=a.U,e=(a.P,b[0]),f=!1;"object"!=typeof e&&(b=[[0,b.length],numeric.linspace(0,b.length-1),b],e=b[0],f=!0);var g,h,i,j,k,l,m=b[1],n=b[2],o=c[0].length-1,p=e.length-1,q=numeric.rep([o],0),r=Array(o),s=numeric.rep([o],0),t=Array(o),u=numeric.rep([p+1],0),v=[],w=[],x=numeric.ccsTSolve,y=0;for(g=0;p>g;++g){for(k=0,i=e[g],j=e[g+1],h=i;j>h;++h)l=a.Pinv[m[h]],t[k]=l,s[l]=n[h],++k;for(t.length=k,x(c,s,q,t,r),h=t.length-1;-1!==h;--h)s[t[h]]=0;if(x(d,q,s,r,t),f)return s;for(h=r.length-1;-1!==h;--h)q[r[h]]=0;for(h=t.length-1;-1!==h;--h)l=t[h],v[y]=l,w[y]=s[l],s[l]=0,++y;u[g+1]=y}return[u,v,w]},numeric.ccsbinop=function(a,b){return"undefined"==typeof b&&(b=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+b+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+a+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(a){var b,c=a[0],d=a[1],e=a[2],f=numeric.sup(d)+1,g=c.length,h=numeric.rep([f],0),i=Array(g),j=Array(g),k=numeric.rep([f],0);for(b=0;g>b;++b)k[d[b]]++;for(b=0;f>b;++b)h[b+1]=h[b]+k[b];var l,m,n=h.slice(0);for(b=0;g>b;++b)m=d[b],l=n[m],i[l]=c[b],j[l]=e[b],n[m]=n[m]+1;return[h,i,j]},numeric.ccsGather=function(a){var b,c,d,e,f,g=a[0],h=a[1],i=a[2],j=g.length-1,k=h.length,l=Array(k),m=Array(k),n=Array(k);for(f=0,b=0;j>b;++b)for(d=g[b],e=g[b+1],c=d;c!==e;++c)m[f]=b,l[f]=h[c],n[f]=i[c],++f;return[l,m,n]},numeric.sdim=function i(a,b,c){if("undefined"==typeof b&&(b=[]),"object"!=typeof a)return b;"undefined"==typeof c&&(c=0),c in b||(b[c]=0),a.length>b[c]&&(b[c]=a.length);var d;for(d in a)a.hasOwnProperty(d)&&i(a[d],b,c+1);return b},numeric.sclone=function j(a,b,c){"undefined"==typeof b&&(b=0),"undefined"==typeof c&&(c=numeric.sdim(a).length);var d,e=Array(a.length);if(b===c-1){for(d in a)a.hasOwnProperty(d)&&(e[d]=a[d]);return e}for(d in a)a.hasOwnProperty(d)&&(e[d]=j(a[d],b+1,c));return e},numeric.sdiag=function(a){var b,c,d=a.length,e=Array(d);for(b=d-1;b>=1;b-=2)c=b-1,e[b]=[],e[b][b]=a[b],e[c]=[],e[c][c]=a[c];return 0===b&&(e[0]=[],e[0][0]=a[b]),e},numeric.sidentity=function(a){return numeric.sdiag(numeric.rep([a],1))},numeric.stranspose=function(a){var b,c,d,e=[];a.length;for(b in a)if(a.hasOwnProperty(b)){d=a[b];for(c in d)d.hasOwnProperty(c)&&("object"!=typeof e[c]&&(e[c]=[]),e[c][b]=d[c])}return e},numeric.sLUP=function(){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(a,b){var c,d,e,f,g,h,i,j=a.length,k=(b.length,numeric.stranspose(b)),l=k.length,m=Array(j);for(e=j-1;e>=0;e--){for(i=[],c=a[e],g=l-1;g>=0;g--){h=0,d=k[g];for(f in c)c.hasOwnProperty(f)&&f in d&&(h+=c[f]*d[f]);h&&(i[g]=h)}m[e]=i}return m},numeric.sdotMV=function(a,b){var c,d,e,f,g=a.length,h=Array(g);for(d=g-1;d>=0;d--){c=a[d],f=0;for(e in c)c.hasOwnProperty(e)&&b[e]&&(f+=c[e]*b[e]);f&&(h[d]=f)}return h},numeric.sdotVM=function(a,b){var c,d,e,f,g=[];for(c in a)if(a.hasOwnProperty(c)){e=b[c],f=a[c];for(d in e)e.hasOwnProperty(d)&&(g[d]||(g[d]=0),g[d]+=f*e[d])}return g},numeric.sdotVV=function(a,b){var c,d=0;for(c in a)a[c]&&b[c]&&(d+=a[c]*b[c]);return d},numeric.sdot=function(a,b){var c=numeric.sdim(a).length,d=numeric.sdim(b).length,e=1e3*c+d;switch(e){case 0:return a*b;case 1001:return numeric.sdotVV(a,b);case 2001:return numeric.sdotMV(a,b);case 1002:return numeric.sdotVM(a,b);case 2002:return numeric.sdotMM(a,b);default:throw new Error("numeric.sdot not implemented for tensors of order "+c+" and "+d)}},numeric.sscatter=function(a){var b,c,d,e,f=a[0].length,g=a.length,h=[];for(c=f-1;c>=0;--c)if(a[g-1][c]){for(e=h,d=0;g-2>d;d++)b=a[d][c],e[b]||(e[b]=[]),e=e[b];e[a[d][c]]=a[d+1][c]}return h},numeric.sgather=function k(a,b,c){"undefined"==typeof b&&(b=[]),"undefined"==typeof c&&(c=[]);var d,e,f;d=c.length;for(e in a)if(a.hasOwnProperty(e))if(c[d]=parseInt(e),f=a[e],"number"==typeof f){if(f){if(0===b.length)for(e=d+1;e>=0;--e)b[e]=[];for(e=d;e>=0;--e)b[e].push(c[e]);b[d+1].push(f)}}else k(f,b,c);return c.length>d&&c.pop(),b},numeric.cLU=function(a){var b,c,d,e,f,g,h=a[0],i=a[1],j=a[2],k=h.length,l=0;for(b=0;k>b;b++)h[b]>l&&(l=h[b]);l++;var m,n,o,p=Array(l),q=Array(l),r=numeric.rep([l],1/0),s=numeric.rep([l],-1/0);for(d=0;k>d;d++)b=h[d],c=i[d],c<r[b]&&(r[b]=c),c>s[b]&&(s[b]=c);for(b=0;l-1>b;b++)s[b]>s[b+1]&&(s[b+1]=s[b]);for(b=l-1;b>=1;b--)r[b]<r[b-1]&&(r[b-1]=r[b]);var t=0,u=0;for(b=0;l>b;b++)q[b]=numeric.rep([s[b]-r[b]+1],0),p[b]=numeric.rep([b-r[b]],0),t+=b-r[b]+1,u+=s[b]-b+1;for(d=0;k>d;d++)b=h[d],q[b][i[d]-r[b]]=j[d];for(b=0;l-1>b;b++)for(e=b-r[b],m=q[b],c=b+1;r[c]<=b&&l>c;c++)if(f=b-r[c],g=s[b]-b,n=q[c],o=n[f]/m[e]){for(d=1;g>=d;d++)n[d+f]-=o*m[d+e];p[c][b-r[c]]=o}var k,v,w,m=[],n=[],x=[],y=[],z=[],A=[];for(k=0,v=0,b=0;l>b;b++){for(e=r[b],f=s[b],w=q[b],c=b;f>=c;c++)w[c-e]&&(m[k]=b,n[k]=c,x[k]=w[c-e],k++);for(w=p[b],c=e;b>c;c++)w[c-e]&&(y[v]=b,z[v]=c,A[v]=w[c-e],v++);y[v]=b,z[v]=b,A[v]=1,v++}return{U:[m,n,x],L:[y,z,A]}},numeric.cLUsolve=function(a,b){var c,d,e=a.L,f=a.U,g=numeric.clone(b),h=e[0],i=e[1],j=e[2],k=f[0],l=f[1],m=f[2],n=k.length,o=(h.length,g.length);for(d=0,c=0;o>c;c++){for(;i[d]<c;)g[c]-=j[d]*g[i[d]],d++;d++}for(d=n-1,c=o-1;c>=0;c--){for(;l[d]>c;)g[c]-=m[d]*g[l[d]],d--;g[c]/=m[d],d--}return g},numeric.cgrid=function(a,b){"number"==typeof a&&(a=[a,a]);var c,d,e,f=numeric.rep(a,-1);if("function"!=typeof b)switch(b){case"L":b=function(b,c){return b>=a[0]/2||c<a[1]/2};break;default:b=function(){return!0}}for(e=0,c=1;c<a[0]-1;c++)for(d=1;d<a[1]-1;d++)b(c,d)&&(f[c][d]=e,e++);return f},numeric.cdelsq=function(a){var b,c,d,e,f,g=[[-1,0],[0,-1],[0,1],[1,0]],h=numeric.dim(a),i=h[0],j=h[1],k=[],l=[],m=[];for(b=1;i-1>b;b++)for(c=1;j-1>c;c++)if(!(a[b][c]<0)){for(d=0;4>d;d++)e=b+g[d][0],f=c+g[d][1],a[e][f]<0||(k.push(a[b][c]),l.push(a[e][f]),m.push(-1));k.push(a[b][c]),l.push(a[b][c]),m.push(4)}return[k,l,m]},numeric.cdotMV=function(a,b){var c,d,e,f=a[0],g=a[1],h=a[2],i=f.length;for(e=0,d=0;i>d;d++)f[d]>e&&(e=f[d]);for(e++,c=numeric.rep([e],0),d=0;i>d;d++)c[f[d]]+=h[d]*b[g[d]];return c},numeric.Spline=function(a,b,c,d,e){this.x=a,this.yl=b,this.yr=c,this.kl=d,this.kr=e},numeric.Spline.prototype._at=function(a,b){var a,c,d,e,f=this.x,g=this.yl,h=this.yr,i=this.kl,j=this.kr,k=numeric.add,l=numeric.sub,m=numeric.mul;c=l(m(i[b],f[b+1]-f[b]),l(h[b+1],g[b])),d=k(m(j[b+1],f[b]-f[b+1]),l(h[b+1],g[b])),e=(a-f[b])/(f[b+1]-f[b]);var n=e*(1-e);return k(k(k(m(1-e,g[b]),m(e,h[b+1])),m(c,n*(1-e))),m(d,n*e))},numeric.Spline.prototype.at=function(a){if("number"==typeof a){var b,c,d,e=this.x,f=e.length,g=Math.floor;for(b=0,c=f-1;c-b>1;)d=g((b+c)/2),e[d]<=a?b=d:c=d;return this._at(a,b)}var h,f=a.length,i=Array(f);for(h=f-1;-1!==h;--h)i[h]=this.at(a[h]);return i},numeric.Spline.prototype.diff=function(){var a,b,c,d=this.x,e=this.yl,f=this.yr,g=this.kl,h=this.kr,i=e.length,j=g,k=h,l=Array(i),m=Array(i),n=numeric.add,o=numeric.mul,p=numeric.div,q=numeric.sub;for(a=i-1;-1!==a;--a)b=d[a+1]-d[a],c=q(f[a+1],e[a]),l[a]=p(n(o(c,6),o(g[a],-4*b),o(h[a+1],-2*b)),b*b),m[a+1]=p(n(o(c,-6),o(g[a],2*b),o(h[a+1],4*b)),b*b);return new numeric.Spline(d,j,k,l,m)},numeric.Spline.prototype.roots=function(){function a(a){return a*a}var b=[],c=this.x,d=this.yl,e=this.yr,f=this.kl,g=this.kr;"number"==typeof d[0]&&(d=[d],e=[e],f=[f],g=[g]);var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=d.length,G=c.length-1,b=Array(F),H=Math.sqrt;for(h=0;h!==F;++h){for(k=d[h],l=e[h],m=f[h],n=g[h],o=[],i=0;i!==G;i++){for(i>0&&l[i]*k[i]<0&&o.push(c[i]),w=c[i+1]-c[i],x=c[i],r=k[i],s=l[i+1],p=m[i]/w,q=n[i+1]/w,v=a(p-q+3*(r-s))+12*q*r,t=q+3*r+2*p-3*s,u=3*(q+p+2*(r-s)),0>=v?(z=t/u,y=z>c[i]&&z<c[i+1]?[c[i],z,c[i+1]]:[c[i],c[i+1]]):(z=(t-H(v))/u,A=(t+H(v))/u,y=[c[i]],z>c[i]&&z<c[i+1]&&y.push(z),A>c[i]&&A<c[i+1]&&y.push(A),y.push(c[i+1])),C=y[0],z=this._at(C,i),j=0;j<y.length-1;j++)if(D=y[j+1],A=this._at(D,i),0!==z)if(0===A||z*A>0)C=D,z=A;
else{for(var I=0;E=(z*D-A*C)/(z-A),!(C>=E||E>=D);)if(B=this._at(E,i),B*A>0)D=E,A=B,-1===I&&(z*=.5),I=-1;else{if(!(B*z>0))break;C=E,z=B,1===I&&(A*=.5),I=1}o.push(E),C=y[j+1],z=this._at(C,i)}else o.push(C),C=D,z=A;0===A&&o.push(D)}b[h]=o}return"number"==typeof this.yl[0]?b[0]:b},numeric.spline=function(a,b,c,d){var e,f=a.length,g=[],h=[],i=[],j=numeric.sub,k=numeric.mul,l=numeric.add;for(e=f-2;e>=0;e--)h[e]=a[e+1]-a[e],i[e]=j(b[e+1],b[e]);("string"==typeof c||"string"==typeof d)&&(c=d="periodic");var m=[[],[],[]];switch(typeof c){case"undefined":g[0]=k(3/(h[0]*h[0]),i[0]),m[0].push(0,0),m[1].push(0,1),m[2].push(2/h[0],1/h[0]);break;case"string":g[0]=l(k(3/(h[f-2]*h[f-2]),i[f-2]),k(3/(h[0]*h[0]),i[0])),m[0].push(0,0,0),m[1].push(f-2,0,1),m[2].push(1/h[f-2],2/h[f-2]+2/h[0],1/h[0]);break;default:g[0]=c,m[0].push(0),m[1].push(0),m[2].push(1)}for(e=1;f-1>e;e++)g[e]=l(k(3/(h[e-1]*h[e-1]),i[e-1]),k(3/(h[e]*h[e]),i[e])),m[0].push(e,e,e),m[1].push(e-1,e,e+1),m[2].push(1/h[e-1],2/h[e-1]+2/h[e],1/h[e]);switch(typeof d){case"undefined":g[f-1]=k(3/(h[f-2]*h[f-2]),i[f-2]),m[0].push(f-1,f-1),m[1].push(f-2,f-1),m[2].push(1/h[f-2],2/h[f-2]);break;case"string":m[1][m[1].length-1]=0;break;default:g[f-1]=d,m[0].push(f-1),m[1].push(f-1),m[2].push(1)}g="number"!=typeof g[0]?numeric.transpose(g):[g];var n=Array(g.length);if("string"==typeof c)for(e=n.length-1;-1!==e;--e)n[e]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(m)),g[e]),n[e][f-1]=n[e][0];else for(e=n.length-1;-1!==e;--e)n[e]=numeric.cLUsolve(numeric.cLU(m),g[e]);return n="number"==typeof b[0]?n[0]:numeric.transpose(n),new numeric.Spline(a,b,b,n,n)},numeric.fftpow2=function l(a,b){var c=a.length;if(1!==c){var d,e,f=Math.cos,g=Math.sin,h=Array(c/2),i=Array(c/2),j=Array(c/2),k=Array(c/2);for(e=c/2,d=c-1;-1!==d;--d)--e,j[e]=a[d],k[e]=b[d],--d,h[e]=a[d],i[e]=b[d];l(h,i),l(j,k),e=c/2;var m,n,o,p=-6.283185307179586/c;for(d=c-1;-1!==d;--d)--e,-1===e&&(e=c/2-1),m=p*d,n=f(m),o=g(m),a[d]=h[e]+n*j[e]-o*k[e],b[d]=i[e]+n*k[e]+o*j[e]}},numeric._ifftpow2=function m(a,b){var c=a.length;if(1!==c){var d,e,f=Math.cos,g=Math.sin,h=Array(c/2),i=Array(c/2),j=Array(c/2),k=Array(c/2);for(e=c/2,d=c-1;-1!==d;--d)--e,j[e]=a[d],k[e]=b[d],--d,h[e]=a[d],i[e]=b[d];m(h,i),m(j,k),e=c/2;var l,n,o,p=6.283185307179586/c;for(d=c-1;-1!==d;--d)--e,-1===e&&(e=c/2-1),l=p*d,n=f(l),o=g(l),a[d]=h[e]+n*j[e]-o*k[e],b[d]=i[e]+n*k[e]+o*j[e]}},numeric.ifftpow2=function(a,b){numeric._ifftpow2(a,b),numeric.diveq(a,a.length),numeric.diveq(b,b.length)},numeric.convpow2=function(a,b,c,d){numeric.fftpow2(a,b),numeric.fftpow2(c,d);var e,f,g,h,i,j=a.length;for(e=j-1;-1!==e;--e)f=a[e],h=b[e],g=c[e],i=d[e],a[e]=f*g-h*i,b[e]=f*i+h*g;numeric.ifftpow2(a,b)},numeric.T.prototype.fft=function(){var a,b,c=this.x,d=this.y,e=c.length,f=Math.log,g=f(2),h=Math.ceil(f(2*e-1)/g),i=Math.pow(2,h),j=numeric.rep([i],0),k=numeric.rep([i],0),l=Math.cos,m=Math.sin,n=-3.141592653589793/e,o=numeric.rep([i],0),p=numeric.rep([i],0);for(Math.floor(e/2),a=0;e>a;a++)o[a]=c[a];if("undefined"!=typeof d)for(a=0;e>a;a++)p[a]=d[a];for(j[0]=1,a=1;i/2>=a;a++)b=n*a*a,j[a]=l(b),k[a]=m(b),j[i-a]=l(b),k[i-a]=m(b);var q=new numeric.T(o,p),r=new numeric.T(j,k);return q=q.mul(r),numeric.convpow2(q.x,q.y,numeric.clone(r.x),numeric.neg(r.y)),q=q.mul(r),q.x.length=e,q.y.length=e,q},numeric.T.prototype.ifft=function(){var a,b,c=this.x,d=this.y,e=c.length,f=Math.log,g=f(2),h=Math.ceil(f(2*e-1)/g),i=Math.pow(2,h),j=numeric.rep([i],0),k=numeric.rep([i],0),l=Math.cos,m=Math.sin,n=3.141592653589793/e,o=numeric.rep([i],0),p=numeric.rep([i],0);for(Math.floor(e/2),a=0;e>a;a++)o[a]=c[a];if("undefined"!=typeof d)for(a=0;e>a;a++)p[a]=d[a];for(j[0]=1,a=1;i/2>=a;a++)b=n*a*a,j[a]=l(b),k[a]=m(b),j[i-a]=l(b),k[i-a]=m(b);var q=new numeric.T(o,p),r=new numeric.T(j,k);return q=q.mul(r),numeric.convpow2(q.x,q.y,numeric.clone(r.x),numeric.neg(r.y)),q=q.mul(r),q.x.length=e,q.y.length=e,q.div(e)},numeric.gradient=function(a,b){var c=b.length,d=a(b);if(isNaN(d))throw new Error("gradient: f(x) is a NaN!");var e,f,g,h,i,j,k,l,m,n,o=Math.max,p=numeric.clone(b),q=Array(c),o=(numeric.div,numeric.sub,Math.max),r=.001,s=Math.abs,t=Math.min,u=0;for(e=0;c>e;e++)for(var v=o(1e-6*d,1e-8);;){if(++u,u>20)throw new Error("Numerical gradient fails");if(p[e]=b[e]+v,f=a(p),p[e]=b[e]-v,g=a(p),p[e]=b[e],isNaN(f)||isNaN(g))v/=16;else{if(q[e]=(f-g)/(2*v),i=b[e]-v,j=b[e],k=b[e]+v,l=(f-d)/v,m=(d-g)/v,n=o(s(q[e]),s(d),s(f),s(g),s(i),s(j),s(k),1e-8),h=t(o(s(l-q[e]),s(m-q[e]),s(l-m))/n,v/n),!(h>r))break;v/=16}}return q},numeric.uncmin=function(a,b,c,d,e,f,g){var h=numeric.gradient;"undefined"==typeof g&&(g={}),"undefined"==typeof c&&(c=1e-8),"undefined"==typeof d&&(d=function(b){return h(a,b)}),"undefined"==typeof e&&(e=1e3),b=numeric.clone(b);var i,j,k=b.length,l=a(b);if(isNaN(l))throw new Error("uncmin: f(x0) is a NaN!");var m=Math.max,n=numeric.norm2;c=m(c,numeric.epsilon);var o,p,q,r,s,t,u,v,w,x,y=g.Hinv||numeric.identity(k),z=numeric.dot,A=(numeric.inv,numeric.sub),B=numeric.add,C=numeric.tensor,D=numeric.div,E=numeric.mul,F=numeric.all,G=numeric.isFinite,H=numeric.neg,I=0,J="";for(p=d(b);e>I;){if("function"==typeof f&&f(I,b,l,p,y)){J="Callback returned true";break}if(!F(G(p))){J="Gradient has Infinity or NaN";break}if(o=H(z(y,p)),!F(G(o))){J="Search direction has Infinity or NaN";break}if(x=n(o),c>x){J="Newton step smaller than tol";break}for(w=1,j=z(p,o),s=b;e>I&&!(c>w*x)&&(r=E(o,w),s=B(b,r),i=a(s),i-l>=.1*w*j||isNaN(i));)w*=.5,++I;if(c>w*x){J="Line search step size smaller than tol";break}if(I===e){J="maxit reached during line search";break}q=d(s),t=A(q,p),v=z(t,r),u=z(y,t),y=A(B(y,E((v+z(t,u))/(v*v),C(r,r))),D(B(C(u,r),C(r,u)),v)),b=s,l=i,p=q,++I}return{solution:b,f:l,gradient:p,invHessian:y,iterations:I,message:J}},numeric.Dopri=function(a,b,c,d,e,f,g){this.x=a,this.y=b,this.f=c,this.ymid=d,this.iterations=e,this.events=g,this.message=f},numeric.Dopri.prototype._at=function(a,b){function c(a){return a*a}var d,e,f,g,h,i,a,j,k,l,m,n=this,o=n.x,p=n.y,q=n.f,r=n.ymid,s=(o.length,Math.floor,.5),t=numeric.add,u=numeric.mul,v=numeric.sub;return d=o[b],e=o[b+1],g=p[b],h=p[b+1],j=e-d,f=d+s*j,i=r[b],k=v(q[b],u(g,1/(d-f)+2/(d-e))),l=v(q[b+1],u(h,1/(e-f)+2/(e-d))),m=[c(a-e)*(a-f)/c(d-e)/(d-f),c(a-d)*c(a-e)/c(d-f)/c(e-f),c(a-d)*(a-f)/c(e-d)/(e-f),(a-d)*c(a-e)*(a-f)/c(d-e)/(d-f),(a-e)*c(a-d)*(a-f)/c(d-e)/(e-f)],t(t(t(t(u(g,m[0]),u(i,m[1])),u(h,m[2])),u(k,m[3])),u(l,m[4]))},numeric.Dopri.prototype.at=function(a){var b,c,d,e=Math.floor;if("number"!=typeof a){var f=a.length,g=Array(f);for(b=f-1;-1!==b;--b)g[b]=this.at(a[b]);return g}var h=this.x;for(b=0,c=h.length-1;c-b>1;)d=e(.5*(b+c)),h[d]<=a?b=d:c=d;return this._at(a,b)},numeric.dopri=function(a,b,c,d,e,f,g){"undefined"==typeof e&&(e=1e-6),"undefined"==typeof f&&(f=1e3);var h,i,j,k,l,m,n,o,p,q,r,s,t,u=[a],v=[c],w=[d(a,c)],x=[],y=.2,z=[.075,.225],A=[44/45,-56/15,32/9],B=[19372/6561,-25360/2187,64448/6561,-212/729],C=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],D=[35/384,0,500/1113,125/192,-2187/6784,11/84],E=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],F=[.2,.3,.8,8/9,1,1],G=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],H=0,I=(b-a)/10,J=0,K=numeric.add,L=numeric.mul,M=(Math.max,Math.min),N=Math.abs,O=numeric.norminf,P=Math.pow,Q=numeric.any,R=numeric.lt,S=numeric.and,T=(numeric.sub,new numeric.Dopri(u,v,w,x,-1,""));for("function"==typeof g&&(r=g(a,c));b>a&&f>J;)if(++J,a+I>b&&(I=b-a),h=d(a+F[0]*I,K(c,L(y*I,w[H]))),i=d(a+F[1]*I,K(K(c,L(z[0]*I,w[H])),L(z[1]*I,h))),j=d(a+F[2]*I,K(K(K(c,L(A[0]*I,w[H])),L(A[1]*I,h)),L(A[2]*I,i))),k=d(a+F[3]*I,K(K(K(K(c,L(B[0]*I,w[H])),L(B[1]*I,h)),L(B[2]*I,i)),L(B[3]*I,j))),l=d(a+F[4]*I,K(K(K(K(K(c,L(C[0]*I,w[H])),L(C[1]*I,h)),L(C[2]*I,i)),L(C[3]*I,j)),L(C[4]*I,k))),p=K(K(K(K(K(c,L(w[H],I*D[0])),L(i,I*D[2])),L(j,I*D[3])),L(k,I*D[4])),L(l,I*D[5])),m=d(a+I,p),n=K(K(K(K(K(L(w[H],I*G[0]),L(i,I*G[2])),L(j,I*G[3])),L(k,I*G[4])),L(l,I*G[5])),L(m,I*G[6])),q="number"==typeof n?N(n):O(n),q>e){if(I=.2*I*P(e/q,.25),a+I===a){T.msg="Step size became too small";break}}else{if(x[H]=K(K(K(K(K(K(c,L(w[H],I*E[0])),L(i,I*E[2])),L(j,I*E[3])),L(k,I*E[4])),L(l,I*E[5])),L(m,I*E[6])),++H,u[H]=a+I,v[H]=p,w[H]=m,"function"==typeof g){var U,V,W=a,X=a+.5*I;if(s=g(X,x[H-1]),t=S(R(r,0),R(0,s)),Q(t)||(W=X,X=a+I,r=s,s=g(X,p),t=S(R(r,0),R(0,s))),Q(t)){for(var Y,Z,$=0,_=1,ab=1;;){if("number"==typeof r)V=(ab*s*W-_*r*X)/(ab*s-_*r);else for(V=X,o=r.length-1;-1!==o;--o)r[o]<0&&s[o]>0&&(V=M(V,(ab*s[o]*W-_*r[o]*X)/(ab*s[o]-_*r[o])));if(W>=V||V>=X)break;U=T._at(V,H-1),Z=g(V,U),Y=S(R(r,0),R(0,Z)),Q(Y)?(X=V,s=Z,t=Y,ab=1,-1===$?_*=.5:_=1,$=-1):(W=V,r=Z,_=1,1===$?ab*=.5:ab=1,$=1)}return p=T._at(.5*(a+V),H-1),T.f[H]=d(V,U),T.x[H]=V,T.y[H]=U,T.ymid[H-1]=p,T.events=t,T.iterations=J,T}}a+=I,c=p,r=s,I=M(.8*I*P(e/q,.25),4*I)}return T.iterations=J,T},numeric.LU=function(a,b){b=b||!1;var c,d,e,f,g,h,i,j,k,l=Math.abs,m=a.length,n=m-1,o=new Array(m);for(b||(a=numeric.clone(a)),e=0;m>e;++e){for(i=e,h=a[e],k=l(h[e]),d=e+1;m>d;++d)f=l(a[d][e]),f>k&&(k=f,i=d);for(o[e]=i,i!=e&&(a[e]=a[i],a[i]=h,h=a[e]),g=h[e],c=e+1;m>c;++c)a[c][e]/=g;for(c=e+1;m>c;++c){for(j=a[c],d=e+1;n>d;++d)j[d]-=j[e]*h[d],++d,j[d]-=j[e]*h[d];d===n&&(j[d]-=j[e]*h[d])}}return{LU:a,P:o}},numeric.LUsolve=function(a,b){var c,d,e,f,g,h=a.LU,i=h.length,j=numeric.clone(b),k=a.P;for(c=i-1;-1!==c;--c)j[c]=b[c];for(c=0;i>c;++c)for(e=k[c],k[c]!==c&&(g=j[c],j[c]=j[e],j[e]=g),f=h[c],d=0;c>d;++d)j[c]-=j[d]*f[d];for(c=i-1;c>=0;--c){for(f=h[c],d=c+1;i>d;++d)j[c]-=j[d]*f[d];j[c]/=f[c]}return j},numeric.solve=function(a,b,c){return numeric.LUsolve(numeric.LU(a,c),b)},numeric.echelonize=function(a){var b,c,d,e,f,g,h,i,j=numeric.dim(a),k=j[0],l=j[1],m=numeric.identity(k),n=Array(k),o=Math.abs,p=numeric.diveq;for(a=numeric.clone(a),b=0;k>b;++b){for(d=0,f=a[b],g=m[b],c=1;l>c;++c)o(f[d])<o(f[c])&&(d=c);for(n[b]=d,p(g,f[d]),p(f,f[d]),c=0;k>c;++c)if(c!==b){for(h=a[c],i=h[d],e=l-1;-1!==e;--e)h[e]-=f[e]*i;for(h=m[c],e=k-1;-1!==e;--e)h[e]-=g[e]*i}}return{I:m,A:a,P:n}},numeric.__solveLP=function(a,b,c,d,e,f,g){var h,i,j,k,l=numeric.sum,m=(numeric.log,numeric.mul),n=numeric.sub,o=numeric.dot,p=numeric.div,q=numeric.add,r=a.length,s=c.length,t=!1,u=0,v=1,w=(numeric.transpose(b),numeric.svd,numeric.transpose),x=(numeric.leq,Math.sqrt),y=Math.abs,z=(numeric.muleq,numeric.norminf,numeric.any,Math.min),A=numeric.all,B=numeric.gt,C=Array(r),D=Array(s),E=(numeric.rep([s],1),numeric.solve),F=n(c,o(b,f)),G=o(a,a);for(j=u;e>j;++j){var H,I;for(H=s-1;-1!==H;--H)D[H]=p(b[H],F[H]);var J=w(D);for(H=r-1;-1!==H;--H)C[H]=l(J[H]);v=.25*y(G/o(a,C));var K=100*x(G/o(C,C));for((!isFinite(v)||v>K)&&(v=K),k=q(a,m(v,C)),i=o(J,D),H=r-1;-1!==H;--H)i[H][H]+=1;I=E(i,p(k,v),!0);var L=p(F,o(b,I)),M=1;for(H=s-1;-1!==H;--H)L[H]<0&&(M=z(M,-.999*L[H]));if(h=n(f,m(I,M)),F=n(c,o(b,h)),!A(B(F,0)))return{solution:f,message:"",iterations:j};if(f=h,d>v)return{solution:h,message:"",iterations:j};if(g){var N=o(a,k),O=o(b,k);for(t=!0,H=s-1;-1!==H;--H)if(N*O[H]<0){t=!1;break}}else t=f[r-1]>=0?!1:!0;if(t)return{solution:h,message:"Unbounded",iterations:j}}return{solution:f,message:"maximum iteration count exceeded",iterations:j}},numeric._solveLP=function(a,b,c,d,e){var f,g=a.length,h=c.length,i=(numeric.sum,numeric.log,numeric.mul,numeric.sub),j=numeric.dot,k=(numeric.div,numeric.add,numeric.rep([g],0).concat([1])),l=numeric.rep([h,1],-1),m=numeric.blockMatrix([[b,l]]),n=c,f=numeric.rep([g],0).concat(Math.max(0,numeric.sup(numeric.neg(c)))+1),o=numeric.__solveLP(k,m,n,d,e,f,!1),p=numeric.clone(o.solution);p.length=g;var q=numeric.inf(i(c,j(b,p)));if(0>q)return{solution:0/0,message:"Infeasible",iterations:o.iterations};var r=numeric.__solveLP(a,b,c,d,e-o.iterations,p,!0);return r.iterations+=o.iterations,r},numeric.solveLP=function(a,b,c,d,e,f,g){if("undefined"==typeof g&&(g=1e3),"undefined"==typeof f&&(f=numeric.epsilon),"undefined"==typeof d)return numeric._solveLP(a,b,c,f,g);var h,i=d.length,j=d[0].length,k=b.length,l=numeric.echelonize(d),m=numeric.rep([j],0),n=l.P,o=[];for(h=n.length-1;-1!==h;--h)m[n[h]]=1;for(h=j-1;-1!==h;--h)0===m[h]&&o.push(h);var p=numeric.getRange,q=numeric.linspace(0,i-1),r=numeric.linspace(0,k-1),s=p(d,q,o),t=p(b,r,n),u=p(b,r,o),v=numeric.dot,w=numeric.sub,x=v(t,l.I),y=w(u,v(x,s)),z=w(c,v(x,e)),A=Array(n.length),B=Array(o.length);for(h=n.length-1;-1!==h;--h)A[h]=a[n[h]];for(h=o.length-1;-1!==h;--h)B[h]=a[o[h]];var C=w(B,v(A,v(l.I,s))),D=numeric._solveLP(C,y,z,f,g),E=D.solution;if(E!==E)return D;var F=v(l.I,w(e,v(s,E))),G=Array(a.length);for(h=n.length-1;-1!==h;--h)G[n[h]]=F[h];for(h=o.length-1;-1!==h;--h)G[o[h]]=E[h];return{solution:G,message:D.message,iterations:D.iterations}},numeric.MPStoLP=function(a){function b(b){throw new Error("MPStoLP: "+b+"\nLine "+c+": "+a[c]+"\nCurrent state: "+h[g]+"\n")}a instanceof String&&a.split("\n");var c,d,e,f,g=0,h=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],i=a.length,j=0,k={},l=[],m=0,n={},o=0,p=[],q=[],r=[];for(c=0;i>c;++c){e=a[c];var s=e.match(/\S*/g),t=[];for(d=0;d<s.length;++d)""!==s[d]&&t.push(s[d]);if(0!==t.length){for(d=0;d<h.length&&e.substr(0,h[d].length)!==h[d];++d);if(d<h.length){if(g=d,1===d&&(f=t[1]),6===d)return{name:f,c:p,A:numeric.transpose(q),b:r,rows:k,vars:n}}else switch(g){case 0:case 1:b("Unexpected line");case 2:switch(t[0]){case"N":0===j?j=t[1]:b("Two or more N rows");break;case"L":k[t[1]]=m,l[m]=1,r[m]=0,++m;break;case"G":k[t[1]]=m,l[m]=-1,r[m]=0,++m;break;case"E":k[t[1]]=m,l[m]=0,r[m]=0,++m;break;default:b("Parse error "+numeric.prettyPrint(t))}break;case 3:n.hasOwnProperty(t[0])||(n[t[0]]=o,p[o]=0,q[o]=numeric.rep([m],0),++o);var u=n[t[0]];for(d=1;d<t.length;d+=2)if(t[d]!==j){var v=k[t[d]];q[u][v]=(l[v]<0?-1:1)*parseFloat(t[d+1])}else p[u]=parseFloat(t[d+1]);break;case 4:for(d=1;d<t.length;d+=2)r[k[t[d]]]=(l[k[t[d]]]<0?-1:1)*parseFloat(t[d+1]);break;case 5:break;case 6:b("Internal error")}}}b("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(a,b,c,d,e,f,g){function h(a){var b,d,e=this,f=a.length,g=0,h=e.i=e.j=e.m=0;for(e.S=[],e.c=[],f||(a=[f++]);c>g;)e.S[g]=g++;for(g=0;c>g;g++)b=e.S[g],h=k(h+b+a[g%f]),d=e.S[h],e.S[g]=d,e.S[h]=b;e.g=function(a){var b=e.S,d=k(e.i+1),f=b[d],g=k(e.j+f),h=b[g];b[d]=h,b[g]=f;for(var i=b[k(f+h)];--a;)d=k(d+1),f=b[d],g=k(g+f),h=b[g],b[d]=h,b[g]=f,i=i*c+b[k(f+h)];return e.i=d,e.j=g,i},e.g(c)}function i(a,b,c,d,e){if(c=[],e=typeof a,b&&"object"==e)for(d in a)if(d.indexOf("S")<5)try{c.push(i(a[d],b-1))}catch(f){}return c.length?c:a+("string"!=e?"\x00":"")}function j(a,b,c,d){for(a+="",c=0,d=0;d<a.length;d++)b[k(d)]=k((c^=19*b[k(d)])+a.charCodeAt(d));a="";for(d in b)a+=String.fromCharCode(b[d]);return a}function k(a){return a&c-1}b.seedrandom=function(k,l){var m,n=[];return k=j(i(l?[k,a]:arguments.length?k:[(new Date).getTime(),a,window],3),n),m=new h(n),j(m.S,a),b.random=function(){for(var a=m.g(d),b=g,h=0;e>a;)a=(a+h)*c,b*=c,h=m.g(1);for(;a>=f;)a/=2,b/=2,h>>>=1;return(a+h)/b},k},g=b.pow(c,d),e=b.pow(2,e),f=2*e,j(b.random(),a)}([],numeric.seedrandom,256,6,52),function(a){function b(a){if("object"!=typeof a)return a;var c,d=[],e=a.length;for(c=0;e>c;c++)d[c+1]=b(a[c]);return d}function c(a){if("object"!=typeof a)return a;var b,d=[],e=a.length;for(b=1;e>b;b++)d[b-1]=c(a[b]);return d}function d(a,b,c){var d,e,f,g,h;for(f=1;c>=f;f+=1){for(a[f][f]=1/a[f][f],h=-a[f][f],d=1;f>d;d+=1)a[d][f]=h*a[d][f];if(g=f+1,g>c)break;for(e=g;c>=e;e+=1)for(h=a[f][e],a[f][e]=0,d=1;f>=d;d+=1)a[d][e]=a[d][e]+h*a[d][f]}}function e(a,b,c,d){var e,f,g,h;for(f=1;c>=f;f+=1){for(h=0,e=1;f>e;e+=1)h+=a[e][f]*d[e];d[f]=(d[f]-h)/a[f][f]}for(g=1;c>=g;g+=1)for(f=c+1-g,d[f]=d[f]/a[f][f],h=-d[f],e=1;f>e;e+=1)d[e]=d[e]+h*a[e][f]}function f(a,b,c,d){var e,f,g,h,i,j;for(f=1;c>=f;f+=1){if(d[1]=f,j=0,g=f-1,1>g){if(j=a[f][f]-j,0>=j)break;a[f][f]=Math.sqrt(j)}else{for(h=1;g>=h;h+=1){for(i=a[h][f],e=1;h>e;e+=1)i-=a[e][f]*a[e][h];i/=a[h][h],a[h][f]=i,j+=i*i}if(j=a[f][f]-j,0>=j)break;a[f][f]=Math.sqrt(j)}d[1]=0}}function g(a,b,c,g,h,i,j,k,l,m,n,o,p,q,r,s){function t(){for(q[1]=q[1]+1,A=H,y=1;m>=y;y+=1){for(A+=1,N=-k[y],z=1;g>=z;z+=1)N+=j[z][y]*h[z];if(Math.abs(N)<V&&(N=0),y>n)r[A]=N;else if(r[A]=-Math.abs(N),N>0){for(z=1;g>=z;z+=1)j[z][y]=-j[z][y];k[y]=-k[y]}}for(y=1;p>=y;y+=1)r[H+o[y]]=0;for(J=0,M=0,y=1;m>=y;y+=1)r[H+y]<M*r[L+y]&&(J=y,M=r[H+y]/r[L+y]);return 0===J?999:0}function u(){for(y=1;g>=y;y+=1){for(N=0,z=1;g>=z;z+=1)N+=a[z][y]*j[z][J];r[y]=N}for(B=E,y=1;g>=y;y+=1)r[B+y]=0;for(z=p+1;g>=z;z+=1)for(y=1;g>=y;y+=1)r[B+y]=r[B+y]+a[y][z]*r[z];for(T=!0,y=p;y>=1;y-=1){for(N=r[y],A=G+y*(y+3)/2,B=A-y,z=y+1;p>=z;z+=1)N-=r[A]*r[F+z],A+=z;if(N/=r[B],r[F+y]=N,o[y]<n)break;if(0>N)break;T=!1,D=y}if(!T)for(O=r[I+D]/r[F+D],y=1;p>=y&&!(o[y]<n)&&!(r[F+y]<0);y+=1)M=r[I+y]/r[F+y],O>M&&(O=M,D=y);for(N=0,y=E+1;E+g>=y;y+=1)N+=r[y]*r[y];if(Math.abs(N)<=V){if(T)return s[1]=1,999;for(y=1;p>=y;y+=1)r[I+y]=r[I+y]-O*r[F+y];return r[I+p+1]=r[I+p+1]+O,700}for(N=0,y=1;g>=y;y+=1)N+=r[E+y]*j[y][J];for(P=-r[H+J]/N,U=!0,T||P>O&&(P=O,U=!1),y=1;g>=y;y+=1)h[y]=h[y]+P*r[E+y],Math.abs(h[y])<V&&(h[y]=0);for(i[1]=i[1]+P*N*(P/2+r[I+p+1]),y=1;p>=y;y+=1)r[I+y]=r[I+y]-P*r[F+y];if(r[I+p+1]=r[I+p+1]+P,!U){for(N=-k[J],z=1;g>=z;z+=1)N+=h[z]*j[z][J];if(J>n)r[H+J]=N;else if(r[H+J]=-Math.abs(N),N>0){for(z=1;g>=z;z+=1)j[z][J]=-j[z][J];k[J]=-k[J]}return 700}for(p+=1,o[p]=J,A=G+(p-1)*p/2+1,y=1;p-1>=y;y+=1)r[A]=r[y],A+=1;if(p===g)r[A]=r[g];else{for(y=g;y>=p+1&&0!==r[y]&&(Q=Math.max(Math.abs(r[y-1]),Math.abs(r[y])),R=Math.min(Math.abs(r[y-1]),Math.abs(r[y])),M=r[y-1]>=0?Math.abs(Q*Math.sqrt(1+R*R/(Q*Q))):-Math.abs(Q*Math.sqrt(1+R*R/(Q*Q))),Q=r[y-1]/M,R=r[y]/M,1!==Q);y-=1)if(0===Q)for(r[y-1]=R*M,z=1;g>=z;z+=1)M=a[z][y-1],a[z][y-1]=a[z][y],a[z][y]=M;else for(r[y-1]=M,S=R/(1+Q),z=1;g>=z;z+=1)M=Q*a[z][y-1]+R*a[z][y],a[z][y]=S*(a[z][y-1]+M)-a[z][y],a[z][y-1]=M;r[A]=r[p]}return 0}function v(){if(A=G+D*(D+1)/2+1,B=A+D,0===r[B])return 798;if(Q=Math.max(Math.abs(r[B-1]),Math.abs(r[B])),R=Math.min(Math.abs(r[B-1]),Math.abs(r[B])),M=r[B-1]>=0?Math.abs(Q*Math.sqrt(1+R*R/(Q*Q))):-Math.abs(Q*Math.sqrt(1+R*R/(Q*Q))),Q=r[B-1]/M,R=r[B]/M,1===Q)return 798;if(0===Q){for(y=D+1;p>=y;y+=1)M=r[B-1],r[B-1]=r[B],r[B]=M,B+=y;for(y=1;g>=y;y+=1)M=a[y][D],a[y][D]=a[y][D+1],a[y][D+1]=M}else{for(S=R/(1+Q),y=D+1;p>=y;y+=1)M=Q*r[B-1]+R*r[B],r[B]=S*(r[B-1]+M)-r[B],r[B-1]=M,B+=y;for(y=1;g>=y;y+=1)M=Q*a[y][D]+R*a[y][D+1],a[y][D+1]=S*(a[y][D]+M)-a[y][D+1],a[y][D]=M}return 0}function w(){for(B=A-D,y=1;D>=y;y+=1)r[B]=r[A],A+=1,B+=1;return r[I+D]=r[I+D+1],o[D]=o[D+1],D+=1,p>D?797:0}function x(){return r[I+p]=r[I+p+1],r[I+p+1]=0,o[p]=0,p-=1,q[2]=q[2]+1,0}var y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y;K=Math.min(g,m),A=2*g+K*(K+5)/2+2*m+1,V=1e-60;do V+=V,W=1+.1*V,X=1+.2*V;while(1>=W||1>=X);for(y=1;g>=y;y+=1)r[y]=b[y];for(y=g+1;A>=y;y+=1)r[y]=0;for(y=1;m>=y;y+=1)o[y]=0;if(C=[],0===s[1]){if(f(a,c,g,C),0!==C[1])return void(s[1]=2);e(a,c,g,b),d(a,c,g)}else{for(z=1;g>=z;z+=1)for(h[z]=0,y=1;z>=y;y+=1)h[z]=h[z]+a[y][z]*b[y];for(z=1;g>=z;z+=1)for(b[z]=0,y=z;g>=y;y+=1)b[z]=b[z]+a[z][y]*h[y]}for(i[1]=0,z=1;g>=z;z+=1)for(h[z]=b[z],i[1]=i[1]+r[z]*h[z],r[z]=0,y=z+1;g>=y;y+=1)a[y][z]=0;for(i[1]=-i[1]/2,s[1]=0,E=g,F=E+g,I=F+K,G=I+K+1,H=G+K*(K+1)/2,L=H+m,y=1;m>=y;y+=1){for(N=0,z=1;g>=z;z+=1)N+=j[z][y]*j[z][y];r[L+y]=Math.sqrt(N)}for(p=0,q[1]=0,q[2]=0,Y=0;;){if(Y=t(),999===Y)return;for(;Y=u(),0!==Y;){if(999===Y)return;if(700===Y)if(D===p)x();else{for(;v(),Y=w(),797===Y;);x()}}}}function h(a,d,e,f,h,i){a=b(a),d=b(d),e=b(e);var j,k,l,m,n,o,p=[],q=[],r=[],s=[],t=[];if(h=h||0,i=i?b(i):[void 0,0],f=f?b(f):[],k=a.length-1,l=e[1].length-1,!f)for(j=1;l>=j;j+=1)f[j]=0;for(j=1;l>=j;j+=1)q[j]=0;for(m=0,n=Math.min(k,l),j=1;k>=j;j+=1)r[j]=0;for(p[1]=0,j=1;2*k+n*(n+5)/2+2*l+1>=j;j+=1)s[j]=0;for(j=1;2>=j;j+=1)t[j]=0;return g(a,d,k,k,r,p,e,f,k,l,h,q,m,t,s,i),o="",1===i[1]&&(o="constraints are inconsistent, no solution!"),2===i[1]&&(o="matrix D in quadratic function is not positive definite!"),{solution:c(r),value:c(p),unconstrained_solution:c(d),iterations:c(t),iact:c(q),message:o}}a.solveQP=h}(numeric),numeric.svd=function(a){function b(a,b){return a=Math.abs(a),b=Math.abs(b),a>b?a*Math.sqrt(1+b*b/a/a):0==b?a:b*Math.sqrt(1+a*a/b/b)}var c,d=numeric.epsilon,e=1e-64/d,f=50,g=0,h=0,i=0,j=0,k=0,l=numeric.clone(a),m=l.length,n=l[0].length;if(n>m)throw"Need more rows than columns";var o=new Array(n),p=new Array(n);for(h=0;n>h;h++)o[h]=p[h]=0;var q=numeric.rep([n,n],0),r=0,s=0,t=0,u=0,v=0,w=0,x=0;for(h=0;n>h;h++){for(o[h]=s,x=0,k=h+1,i=h;m>i;i++)x+=l[i][h]*l[i][h];if(e>=x)s=0;else for(r=l[h][h],s=Math.sqrt(x),r>=0&&(s=-s),t=r*s-x,l[h][h]=r-s,i=k;n>i;i++){for(x=0,j=h;m>j;j++)x+=l[j][h]*l[j][i];for(r=x/t,j=h;m>j;j++)l[j][i]+=r*l[j][h]}for(p[h]=s,x=0,i=k;n>i;i++)x+=l[h][i]*l[h][i];if(e>=x)s=0;else{for(r=l[h][h+1],s=Math.sqrt(x),r>=0&&(s=-s),t=r*s-x,l[h][h+1]=r-s,i=k;n>i;i++)o[i]=l[h][i]/t;for(i=k;m>i;i++){for(x=0,j=k;n>j;j++)x+=l[i][j]*l[h][j];for(j=k;n>j;j++)l[i][j]+=x*o[j]}}v=Math.abs(p[h])+Math.abs(o[h]),v>u&&(u=v)}for(h=n-1;-1!=h;h+=-1){if(0!=s){for(t=s*l[h][h+1],i=k;n>i;i++)q[i][h]=l[h][i]/t;for(i=k;n>i;i++){for(x=0,j=k;n>j;j++)x+=l[h][j]*q[j][i];for(j=k;n>j;j++)q[j][i]+=x*q[j][h]}}for(i=k;n>i;i++)q[h][i]=0,q[i][h]=0;q[h][h]=1,s=o[h],k=h}for(h=n-1;-1!=h;h+=-1){for(k=h+1,s=p[h],i=k;n>i;i++)l[h][i]=0;if(0!=s){for(t=l[h][h]*s,i=k;n>i;i++){for(x=0,j=k;m>j;j++)x+=l[j][h]*l[j][i];for(r=x/t,j=h;m>j;j++)l[j][i]+=r*l[j][h]}for(i=h;m>i;i++)l[i][h]=l[i][h]/s}else for(i=h;m>i;i++)l[i][h]=0;l[h][h]+=1}for(d*=u,j=n-1;-1!=j;j+=-1)for(var y=0;f>y;y++){var z=!1;for(k=j;-1!=k;k+=-1){if(Math.abs(o[k])<=d){z=!0;break}if(Math.abs(p[k-1])<=d)break}if(!z){g=0,x=1;var A=k-1;for(h=k;j+1>h&&(r=x*o[h],o[h]=g*o[h],!(Math.abs(r)<=d));h++)for(s=p[h],t=b(r,s),p[h]=t,g=s/t,x=-r/t,i=0;m>i;i++)v=l[i][A],w=l[i][h],l[i][A]=v*g+w*x,l[i][h]=-v*x+w*g}if(w=p[j],k==j){if(0>w)for(p[j]=-w,i=0;n>i;i++)q[i][j]=-q[i][j];break}if(y>=f-1)throw"Error: no convergence.";for(u=p[k],v=p[j-1],s=o[j-1],t=o[j],r=((v-w)*(v+w)+(s-t)*(s+t))/(2*t*v),s=b(r,1),r=0>r?((u-w)*(u+w)+t*(v/(r-s)-t))/u:((u-w)*(u+w)+t*(v/(r+s)-t))/u,g=1,x=1,h=k+1;j+1>h;h++){for(s=o[h],v=p[h],t=x*s,s=g*s,w=b(r,t),o[h-1]=w,g=r/w,x=t/w,r=u*g+s*x,s=-u*x+s*g,t=v*x,v*=g,i=0;n>i;i++)u=q[i][h-1],w=q[i][h],q[i][h-1]=u*g+w*x,q[i][h]=-u*x+w*g;for(w=b(r,t),p[h-1]=w,g=r/w,x=t/w,r=g*s+x*v,u=-x*s+g*v,i=0;m>i;i++)v=l[i][h-1],w=l[i][h],l[i][h-1]=v*g+w*x,l[i][h]=-v*x+w*g}o[k]=0,o[j]=r,p[j]=u}for(h=0;h<p.length;h++)p[h]<d&&(p[h]=0);for(h=0;n>h;h++)for(i=h-1;i>=0;i--)if(p[i]<p[h]){for(g=p[i],p[i]=p[h],p[h]=g,j=0;j<l.length;j++)c=l[j][h],l[j][h]=l[j][i],l[j][i]=c;for(j=0;j<q.length;j++)c=q[j][h],q[j][h]=q[j][i],q[j][i]=c;h=i}return{U:l,S:p,V:q}}}).call(exports,function(){return this}())},function(a,b){var c,d;(function(){function e(a){this._value=a}function f(a,b,c,d){var e,f,g=Math.pow(10,b);return f=(c(a*g)/g).toFixed(b),d&&(e=new RegExp("0{1,"+d+"}$"),f=f.replace(e,"")),f}function g(a,b,c){var d;return d=b.indexOf("$")>-1?i(a,b,c):b.indexOf("%")>-1?j(a,b,c):b.indexOf(":")>-1?k(a,b):m(a._value,b,c)}function h(a,b){var c,d,e,f,g,h=b,i=["KB","MB","GB","TB","PB","EB","ZB","YB"],j=!1;if(b.indexOf(":")>-1)a._value=l(b);else if(b===u)a._value=0;else{for("."!==s[t].delimiters.decimal&&(b=b.replace(/\./g,"").replace(s[t].delimiters.decimal,".")),c=new RegExp("[^a-zA-Z]"+s[t].abbreviations.thousand+"(?:\\)|(\\"+s[t].currency.symbol+")?(?:\\))?)?$"),d=new RegExp("[^a-zA-Z]"+s[t].abbreviations.million+"(?:\\)|(\\"+s[t].currency.symbol+")?(?:\\))?)?$"),e=new RegExp("[^a-zA-Z]"+s[t].abbreviations.billion+"(?:\\)|(\\"+s[t].currency.symbol+")?(?:\\))?)?$"),f=new RegExp("[^a-zA-Z]"+s[t].abbreviations.trillion+"(?:\\)|(\\"+s[t].currency.symbol+")?(?:\\))?)?$"),g=0;g<=i.length&&!(j=b.indexOf(i[g])>-1?Math.pow(1024,g+1):!1);g++);a._value=(j?j:1)*(h.match(c)?Math.pow(10,3):1)*(h.match(d)?Math.pow(10,6):1)*(h.match(e)?Math.pow(10,9):1)*(h.match(f)?Math.pow(10,12):1)*(b.indexOf("%")>-1?.01:1)*((b.split("-").length+Math.min(b.split("(").length-1,b.split(")").length-1))%2?1:-1)*Number(b.replace(/[^0-9\.]+/g,"")),a._value=j?Math.ceil(a._value):a._value}return a._value}function i(a,b,c){var d,e,f=b.indexOf("$"),g=b.indexOf("("),h=b.indexOf("-"),i="";return b.indexOf(" $")>-1?(i=" ",b=b.replace(" $","")):b.indexOf("$ ")>-1?(i=" ",b=b.replace("$ ","")):b=b.replace("$",""),e=m(a._value,b,c),1>=f?e.indexOf("(")>-1||e.indexOf("-")>-1?(e=e.split(""),d=1,(g>f||h>f)&&(d=0),e.splice(d,0,s[t].currency.symbol+i),e=e.join("")):e=s[t].currency.symbol+i+e:e.indexOf(")")>-1?(e=e.split(""),e.splice(-1,0,i+s[t].currency.symbol),e=e.join("")):e=e+i+s[t].currency.symbol,e}function j(a,b,c){var d,e="",f=100*a._value;return b.indexOf(" %")>-1?(e=" ",b=b.replace(" %","")):b=b.replace("%",""),d=m(f,b,c),d.indexOf(")")>-1?(d=d.split(""),d.splice(-1,0,e+"%"),d=d.join("")):d=d+e+"%",d}function k(a){var b=Math.floor(a._value/60/60),c=Math.floor((a._value-60*b*60)/60),d=Math.round(a._value-60*b*60-60*c);return b+":"+(10>c?"0"+c:c)+":"+(10>d?"0"+d:d)}function l(a){var b=a.split(":"),c=0;return 3===b.length?(c+=60*Number(b[0])*60,c+=60*Number(b[1]),c+=Number(b[2])):2===b.length&&(c+=60*Number(b[0]),c+=Number(b[1])),Number(c)}function m(a,b,c){var d,e,g,h,i,j,k=!1,l=!1,m=!1,n="",o=!1,p=!1,q=!1,r=!1,v=!1,w="",x="",y=Math.abs(a),z=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],A="",B=!1;if(0===a&&null!==u)return u;if(b.indexOf("(")>-1?(k=!0,b=b.slice(1,-1)):b.indexOf("+")>-1&&(l=!0,b=b.replace(/\+/g,"")),b.indexOf("a")>-1&&(o=b.indexOf("aK")>=0,p=b.indexOf("aM")>=0,q=b.indexOf("aB")>=0,r=b.indexOf("aT")>=0,v=o||p||q||r,b.indexOf(" a")>-1?(n=" ",b=b.replace(" a","")):b=b.replace("a",""),y>=Math.pow(10,12)&&!v||r?(n+=s[t].abbreviations.trillion,a/=Math.pow(10,12)):y<Math.pow(10,12)&&y>=Math.pow(10,9)&&!v||q?(n+=s[t].abbreviations.billion,a/=Math.pow(10,9)):y<Math.pow(10,9)&&y>=Math.pow(10,6)&&!v||p?(n+=s[t].abbreviations.million,a/=Math.pow(10,6)):(y<Math.pow(10,6)&&y>=Math.pow(10,3)&&!v||o)&&(n+=s[t].abbreviations.thousand,a/=Math.pow(10,3))),b.indexOf("b")>-1)for(b.indexOf(" b")>-1?(w=" ",b=b.replace(" b","")):b=b.replace("b",""),g=0;g<=z.length;g++)if(d=Math.pow(1024,g),e=Math.pow(1024,g+1),a>=d&&e>a){w+=z[g],d>0&&(a/=d);break}return b.indexOf("o")>-1&&(b.indexOf(" o")>-1?(x=" ",b=b.replace(" o","")):b=b.replace("o",""),x+=s[t].ordinal(a)),b.indexOf("[.]")>-1&&(m=!0,b=b.replace("[.]",".")),h=a.toString().split(".")[0],i=b.split(".")[1],j=b.indexOf(","),i?(i.indexOf("[")>-1?(i=i.replace("]",""),i=i.split("["),A=f(a,i[0].length+i[1].length,c,i[1].length)):A=f(a,i.length,c),h=A.split(".")[0],A=A.split(".")[1].length?s[t].delimiters.decimal+A.split(".")[1]:"",m&&0===Number(A.slice(1))&&(A="")):h=f(a,null,c),h.indexOf("-")>-1&&(h=h.slice(1),B=!0),j>-1&&(h=h.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+s[t].delimiters.thousands)),0===b.indexOf(".")&&(h=""),(k&&B?"(":"")+(!k&&B?"-":"")+(!B&&l?"+":"")+h+A+(x?x:"")+(n?n:"")+(w?w:"")+(k&&B?")":"")}function n(a,b){s[a]=b}function o(a){var b=a.toString().split(".");return b.length<2?1:Math.pow(10,b[1].length)}function p(){var a=Array.prototype.slice.call(arguments);return a.reduce(function(a,b){var c=o(a),d=o(b);return c>d?c:d},-1/0)}var q,r="1.5.3",s={},t="en",u=null,v="0,0",w="undefined"!=typeof a&&a.exports;q=function(a){return q.isNumeral(a)?a=a.value():0===a||"undefined"==typeof a?a=0:Number(a)||(a=q.fn.unformat(a)),new e(Number(a))},q.version=r,q.isNumeral=function(a){return a instanceof e},q.language=function(a,b){if(!a)return t;if(a&&!b){if(!s[a])throw new Error("Unknown language : "+a);t=a}return(b||!s[a])&&n(a,b),q},q.languageData=function(a){if(!a)return s[t];if(!s[a])throw new Error("Unknown language : "+a);return s[a]},q.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"$"}}),q.zeroFormat=function(a){u="string"==typeof a?a:null},q.defaultFormat=function(a){v="string"==typeof a?a:"0.0"},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(a,b){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof a)throw new TypeError(a+" is not a function");var c,d,e=this.length>>>0,f=!1;for(1<arguments.length&&(d=b,f=!0),c=0;e>c;++c)this.hasOwnProperty(c)&&(f?d=a(d,this[c],c,this):(d=this[c],f=!0));if(!f)throw new TypeError("Reduce of empty array with no initial value");return d}),q.fn=e.prototype={clone:function(){return q(this)},format:function(a,b){return g(this,a?a:v,void 0!==b?b:Math.round)},unformat:function(a){return"[object Number]"===Object.prototype.toString.call(a)?a:h(this,a?a:v)},value:function(){return this._value},valueOf:function(){return this._value},set:function(a){return this._value=Number(a),this},add:function(a){function b(a,b){return a+c*b}var c=p.call(null,this._value,a);return this._value=[this._value,a].reduce(b,0)/c,this},subtract:function(a){function b(a,b){return a-c*b}var c=p.call(null,this._value,a);return this._value=[a].reduce(b,this._value*c)/c,this},multiply:function(a){function b(a,b){var c=p(a,b);return a*c*b*c/(c*c)}return this._value=[this._value,a].reduce(b,1),this},divide:function(a){function b(a,b){var c=p(a,b);return a*c/(b*c)}return this._value=[this._value,a].reduce(b),this},difference:function(a){return Math.abs(q(this._value).subtract(a).value())}},w&&(a.exports=q),"undefined"==typeof ender&&(this.numeral=q),c=[],d=function(){return q}.apply(b,c),!(void 0!==d&&(a.exports=d))}).call(this)},function(){this.j$=this.jStat=function(a){function b(b,c){var d=b>c?b:c;return a.pow(10,17-~~(a.log(d>0?d:-d)*a.LOG10E))}function c(a){return"[object Function]"===l.call(a)}function d(a){return"number"==typeof a&&a===a}function e(a){return j.apply([],a)}function f(){return new f._init(arguments)}function g(){return 0}function h(){return 1}function i(a,b){return a===b?1:0}var j=Array.prototype.concat,k=Array.prototype.slice,l=Object.prototype.toString,m=Array.isArray||function(a){return"[object Array]"===l.call(a)};f.fn=f.prototype,f._init=function(a){var b;if(m(a[0]))if(m(a[0][0])){for(c(a[1])&&(a[0]=f.map(a[0],a[1])),b=0;b<a[0].length;b++)this[b]=a[0][b];this.length=a[0].length}else this[0]=c(a[1])?f.map(a[0],a[1]):a[0],this.length=1;else if(d(a[0]))this[0]=f.seq.apply(null,a),this.length=1;else{if(a[0]instanceof f)return f(a[0].toArray());this[0]=[],this.length=1}return this},f._init.prototype=f.prototype,f._init.constructor=f,f.utils={calcRdx:b,isArray:m,isFunction:c,isNumber:d,toVector:e},f.extend=function(a){var b,c;if(1===arguments.length){for(c in a)f[c]=a[c];return this}for(b=1;b<arguments.length;b++)for(c in arguments[b])a[c]=arguments[b][c];return a},f.rows=function(a){return a.length||1},f.cols=function(a){return a[0].length||1},f.dimensions=function(a){return{rows:f.rows(a),cols:f.cols(a)}},f.row=function(a,b){return a[b]},f.col=function(a,b){for(var c=new Array(a.length),d=0;d<a.length;d++)c[d]=[a[d][b]];return c},f.diag=function(a){for(var b=f.rows(a),c=new Array(b),d=0;b>d;d++)c[d]=[a[d][d]];return c},f.antidiag=function(a){for(var b=f.rows(a)-1,c=new Array(b),d=0;b>=0;b--,d++)c[d]=[a[d][b]];return c},f.transpose=function(a){var b,c,d,e,f,g=[];for(m(a[0])||(a=[a]),c=a.length,d=a[0].length,f=0;d>f;f++){for(b=new Array(c),e=0;c>e;e++)b[e]=a[e][f];g.push(b)}return 1===g.length?g[0]:g},f.map=function(a,b,c){var d,e,f,g,h;for(m(a[0])||(a=[a]),e=a.length,f=a[0].length,g=c?a:new Array(e),d=0;e>d;d++)for(g[d]||(g[d]=new Array(f)),h=0;f>h;h++)g[d][h]=b(a[d][h],d,h);return 1===g.length?g[0]:g},f.alter=function(a,b){return f.map(a,b,!0)},f.create=function(a,b,d){var e,f,g=new Array(a);for(c(b)&&(d=b,b=a),e=0;a>e;e++)for(g[e]=new Array(b),f=0;b>f;f++)g[e][f]=d(e,f);return g},f.zeros=function(a,b){return d(b)||(b=a),f.create(a,b,g)},f.ones=function(a,b){return d(b)||(b=a),f.create(a,b,h)},f.rand=function(b,c){return d(c)||(c=b),f.create(b,c,a.random)},f.identity=function(a,b){return d(b)||(b=a),f.create(a,b,i)},f.symmetric=function(a){var b,c,d=a.length;if(a.length!==a[0].length)return!1;
for(b=0;d>b;b++)for(c=0;d>c;c++)if(a[c][b]!==a[b][c])return!1;return!0},f.clear=function(a){return f.alter(a,g)},f.seq=function(a,d,e,f){c(f)||(f=!1);var g,h=[],i=b(a,d),j=(d*i-a*i)/((e-1)*i),k=a;for(g=0;d>=k;g++,k=(a*i+j*i*g)/i)h.push(f?f(k,g):k);return h};var n=f.prototype;return n.length=0,n.push=Array.prototype.push,n.sort=Array.prototype.sort,n.splice=Array.prototype.splice,n.slice=Array.prototype.slice,n.toArray=function(){return this.length>1?k.call(this):k.call(this)[0]},n.map=function(a,b){return f(f.map(this,a,b))},n.alter=function(a){return f.alter(this,a),this},function(a){for(var b=0;b<a.length;b++)(function(a){n[a]=function(b){var c,d=this;return b?(setTimeout(function(){b.call(d,n[a].call(d))}),this):(c=f[a](this),m(c)?f(c):c)}})(a[b])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(a){for(var b=0;b<a.length;b++)(function(a){n[a]=function(b,c){var d=this;return c?(setTimeout(function(){c.call(d,n[a].call(d,b))}),this):f(f[a](this,b))}})(a[b])}("row col".split(" ")),function(a){for(var b=0;b<a.length;b++)(function(a){n[a]=new Function("return jStat(jStat."+a+".apply(null, arguments));")})(a[b])}("create zeros ones rand identity".split(" ")),f}(Math),function(a,b){function c(a,b){return a-b}function d(a,c,d){return b.max(c,b.min(a,d))}var e=a.utils.isFunction;a.sum=function g(a){for(var g=0,b=a.length;--b>=0;)g+=a[b];return g},a.sumsqrd=function(a){for(var b=0,c=a.length;--c>=0;)b+=a[c]*a[c];return b},a.sumsqerr=function(b){for(var c,d=a.mean(b),e=0,f=b.length;--f>=0;)c=b[f]-d,e+=c*c;return e},a.product=function(a){for(var b=1,c=a.length;--c>=0;)b*=a[c];return b},a.min=function(a){for(var b=a[0],c=0;++c<a.length;)a[c]<b&&(b=a[c]);return b},a.max=function(a){for(var b=a[0],c=0;++c<a.length;)a[c]>b&&(b=a[c]);return b},a.mean=function(b){return a.sum(b)/b.length},a.meansqerr=function(b){return a.sumsqerr(b)/b.length},a.geomean=function(c){return b.pow(a.product(c),1/c.length)},a.median=function(a){var b=a.length,d=a.slice().sort(c);return 1&b?d[b/2|0]:(d[b/2-1]+d[b/2])/2},a.cumsum=function(a){var b,c=a.length,d=new Array(c);for(d[0]=a[0],b=1;c>b;b++)d[b]=d[b-1]+a[b];return d},a.diff=function(a){var b,c=[],d=a.length;for(b=1;d>b;b++)c.push(a[b]-a[b-1]);return c},a.mode=function(a){var b,d=a.length,e=a.slice().sort(c),f=1,g=0,h=0,i=[];for(b=0;d>b;b++)e[b]===e[b+1]?f++:(f>g?(i=[e[b]],g=f,h=0):f===g&&(i.push(e[b]),h++),f=1);return 0===h?i[0]:i},a.range=function(b){return a.max(b)-a.min(b)},a.variance=function(b,c){return a.sumsqerr(b)/(b.length-(c?1:0))},a.stdev=function(c,d){return b.sqrt(a.variance(c,d))},a.meandev=function(c){var d,e=0,f=a.mean(c);for(d=c.length-1;d>=0;d--)e+=b.abs(c[d]-f);return e/c.length},a.meddev=function(c){var d,e=0,f=a.median(c);for(d=c.length-1;d>=0;d--)e+=b.abs(c[d]-f);return e/c.length},a.coeffvar=function(b){return a.stdev(b)/a.mean(b)},a.quartiles=function(a){var d=a.length,e=a.slice().sort(c);return[e[b.round(d/4)-1],e[b.round(d/2)-1],e[b.round(3*d/4)-1]]},a.quantiles=function(a,e,f,g){var h,i,j,k,l,m,n=a.slice().sort(c),o=[e.length],p=a.length;for("undefined"==typeof f&&(f=3/8),"undefined"==typeof g&&(g=3/8),h=0;h<e.length;h++)i=e[h],j=f+i*(1-f-g),k=p*i+j,l=b.floor(d(k,1,p-1)),m=d(k-l,0,1),o[h]=(1-m)*n[l-1]+m*n[l];return o},a.percentileOfScore=function(a,b,c){var d,e,f=0,g=a.length,h=!1;for("strict"===c&&(h=!0),e=0;g>e;e++)d=a[e],(h&&b>d||!h&&b>=d)&&f++;return f/g},a.covariance=function(b,c){var d,e=a.mean(b),f=a.mean(c),g=b.length,h=new Array(g);for(d=0;g>d;d++)h[d]=(b[d]-e)*(c[d]-f);return a.sum(h)/(g-1)},a.corrcoeff=function(b,c){return a.covariance(b,c)/a.stdev(b,1)/a.stdev(c,1)};var f=a.prototype;f.cumsum=function(b,c){var d=[],g=0,h=this;if(e(b)&&(c=b,b=!1),c)return setTimeout(function(){c.call(h,f.cumsum.call(h,b))}),this;if(this.length>1){for(h=b===!0?this:this.transpose();g<h.length;g++)d[g]=a.cumsum(h[g]);return d}return a.cumsum(this[0],b)},function(b){for(var c=0;c<b.length;c++)(function(b){f[b]=function(c,d){var g=[],h=0,i=this;if(e(c)&&(d=c,c=!1),d)return setTimeout(function(){d.call(i,f[b].call(i,c))}),this;if(this.length>1){for(i=c===!0?this:this.transpose();h<i.length;h++)g[h]=a[b](i[h]);return c===!0?a[b](a.utils.toVector(g)):g}return a[b](this[0],c)}})(b[c])}("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles".split(" ")),function(b){for(var c=0;c<b.length;c++)(function(b){f[b]=function(){var c=[],d=0,g=this,h=Array.prototype.slice.call(arguments);if(e(h[h.length-1])){var i=h[h.length-1],j=h.slice(0,h.length-1);return setTimeout(function(){i.call(g,f[b].apply(g,j))}),this}var i=void 0,k=function(c){return a[b].apply(g,[c].concat(h))};if(this.length>1){for(g=g.transpose();d<g.length;d++)c[d]=k(g[d]);return c}return k(this[0])}})(b[c])}("quantiles percentileOfScore".split(" "))}(this.jStat,Math),function(a,b){a.gammaln=function(a){var c,d,e,f=0,g=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],h=1.000000000190015;for(e=(d=c=a)+5.5,e-=(c+.5)*b.log(e);6>f;f++)h+=g[f]/++d;return b.log(2.5066282746310007*h/c)-e},a.gammafn=function(a){var c,d,e,f,g=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],h=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],i=!1,j=0,k=0,l=0,m=a;if(0>=m){if(f=m%1+3.6e-16,!f)return 1/0;i=(1&m?-1:1)*b.PI/b.sin(b.PI*f),m=1-m}for(e=m,d=1>m?m++:(m-=j=(0|m)-1)-1,c=0;8>c;++c)l=(l+g[c])*d,k=k*d+h[c];if(f=l/k+1,m>e)f/=e;else if(e>m)for(c=0;j>c;++c)f*=m,m++;return i&&(f=i/f),f},a.gammap=function(c,d){var e,f=a.gammaln(c),g=c,h=1/c,i=h,j=d+1-c,k=1/1e-30,l=1/j,m=l,n=1,o=-~(8.5*b.log(c>=1?c:1/c)+.4*c+17);if(0>d||0>=c)return 0/0;if(c+1>d){for(;o>=n;n++)h+=i*=d/++g;return h*b.exp(-d+c*b.log(d)-f)}for(;o>=n;n++)e=-n*(n-c),j+=2,l=e*l+j,k=j+e/k,l=1/l,m*=l*k;return 1-m*b.exp(-d+c*b.log(d)-f)},a.factorialln=function(b){return 0>b?0/0:a.gammaln(b+1)},a.factorial=function(b){return 0>b?0/0:a.gammafn(b+1)},a.combination=function(c,d){return c>170||d>170?b.exp(a.combinationln(c,d)):a.factorial(c)/a.factorial(d)/a.factorial(c-d)},a.combinationln=function(b,c){return a.factorialln(b)-a.factorialln(c)-a.factorialln(b-c)},a.permutation=function(b,c){return a.factorial(b)/a.factorial(b-c)},a.betafn=function(c,d){return 0>=c||0>=d?void 0:c+d>170?b.exp(a.betaln(c,d)):a.gammafn(c)*a.gammafn(d)/a.gammafn(c+d)},a.betaln=function(b,c){return a.gammaln(b)+a.gammaln(c)-a.gammaln(b+c)},a.betacf=function(a,c,d){var e,f,g,h,i=1e-30,j=1,k=c+d,l=c+1,m=c-1,n=1,o=1-k*a/l;for(b.abs(o)<i&&(o=i),o=1/o,h=o;100>=j&&(e=2*j,f=j*(d-j)*a/((m+e)*(c+e)),o=1+f*o,b.abs(o)<i&&(o=i),n=1+f/n,b.abs(n)<i&&(n=i),o=1/o,h*=o*n,f=-(c+j)*(k+j)*a/((c+e)*(l+e)),o=1+f*o,b.abs(o)<i&&(o=i),n=1+f/n,b.abs(n)<i&&(n=i),o=1/o,g=o*n,h*=g,!(b.abs(g-1)<3e-7));j++);return h},a.gammapinv=function(c,d){var e,f,g,h,i,j,k,l=0,m=d-1,n=1e-8,o=a.gammaln(d);if(c>=1)return b.max(100,d+100*b.sqrt(d));if(0>=c)return 0;for(d>1?(j=b.log(m),k=b.exp(m*(j-1)-o),i=.5>c?c:1-c,g=b.sqrt(-2*b.log(i)),e=(2.30753+.27061*g)/(1+g*(.99229+.04481*g))-g,.5>c&&(e=-e),e=b.max(.001,d*b.pow(1-1/(9*d)-e/(3*b.sqrt(d)),3))):(g=1-d*(.253+.12*d),e=g>c?b.pow(c/g,1/d):1-b.log(1-(c-g)/(1-g)));12>l;l++){if(0>=e)return 0;if(f=a.gammap(d,e)-c,g=d>1?k*b.exp(-(e-m)+m*(b.log(e)-j)):b.exp(-e+m*b.log(e)-o),h=f/g,e-=g=h/(1-.5*b.min(1,h*((d-1)/e-1))),0>=e&&(e=.5*(e+g)),b.abs(g)<n*e)break}return e},a.erf=function(a){var c,d,e,f,g=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],h=g.length-1,i=!1,j=0,k=0;for(0>a&&(a=-a,i=!0),c=2/(2+a),d=4*c-2;h>0;h--)e=j,j=d*j-k+g[h],k=e;return f=c*b.exp(-a*a+.5*(g[0]+d*j)-k),i?f-1:1-f},a.erfc=function(b){return 1-a.erf(b)},a.erfcinv=function(c){var d,e,f,g,h=0;if(c>=2)return-100;if(0>=c)return 100;for(g=1>c?c:2-c,f=b.sqrt(-2*b.log(g/2)),d=-.70711*((2.30753+.27061*f)/(1+f*(.99229+.04481*f))-f);2>h;h++)e=a.erfc(d)-g,d+=e/(1.1283791670955126*b.exp(-d*d)-d*e);return 1>c?d:-d},a.ibetainv=function(c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=1e-8,r=d-1,s=e-1,t=0;if(0>=c)return 0;if(c>=1)return 1;for(d>=1&&e>=1?(h=.5>c?c:1-c,i=b.sqrt(-2*b.log(h)),l=(2.30753+.27061*i)/(1+i*(.99229+.04481*i))-i,.5>c&&(l=-l),m=(l*l-3)/6,n=2/(1/(2*d-1)+1/(2*e-1)),o=l*b.sqrt(m+n)/n-(1/(2*e-1)-1/(2*d-1))*(m+5/6-2/(3*n)),l=d/(d+e*b.exp(2*o))):(f=b.log(d/(d+e)),g=b.log(e/(d+e)),i=b.exp(d*f)/d,j=b.exp(e*g)/e,o=i+j,l=i/o>c?b.pow(d*o*c,1/d):1-b.pow(e*o*(1-c),1/e)),p=-a.gammaln(d)-a.gammaln(e)+a.gammaln(d+e);10>t;t++){if(0===l||1===l)return l;if(k=a.ibeta(l,d,e)-c,i=b.exp(r*b.log(l)+s*b.log(1-l)+p),j=k/i,l-=i=j/(1-.5*b.min(1,j*(r/l-s/(1-l)))),0>=l&&(l=.5*(l+i)),l>=1&&(l=.5*(l+i+1)),b.abs(i)<q*l&&t>0)break}return l},a.ibeta=function(c,d,e){var f=0===c||1===c?0:b.exp(a.gammaln(d+e)-a.gammaln(d)-a.gammaln(e)+d*b.log(c)+e*b.log(1-c));return 0>c||c>1?!1:(d+1)/(d+e+2)>c?f*a.betacf(c,d,e)/d:1-f*a.betacf(1-c,e,d)/e},a.randn=function(c,d){var e,f,g,h,i;if(d||(d=c),c)return a.create(c,d,function(){return a.randn()});do e=b.random(),f=1.7156*(b.random()-.5),g=e-.449871,h=b.abs(f)+.386595,i=g*g+h*(.196*h-.25472*g);while(i>.27597&&(i>.27846||f*f>-4*b.log(e)*e*e));return f/e},a.randg=function(c,d,e){var f,g,h,i,j,k,l=c;if(e||(e=d),c||(c=1),d)return k=a.zeros(d,e),k.alter(function(){return a.randg(c)}),k;1>c&&(c+=1),f=c-1/3,g=1/b.sqrt(9*f);do{do j=a.randn(),i=1+g*j;while(0>=i);i=i*i*i,h=b.random()}while(h>1-.331*b.pow(j,4)&&b.log(h)>.5*j*j+f*(1-i+b.log(i)));if(c==l)return f*i;do h=b.random();while(0===h);return b.pow(h,1/l)*f*i},function(b){for(var c=0;c<b.length;c++)(function(b){a.fn[b]=function(){return a(a.map(this,function(c){return a[b](c)}))}})(b[c])}("gammaln gammafn factorial factorialln".split(" ")),function(b){for(var c=0;c<b.length;c++)(function(b){a.fn[b]=function(){return a(a[b].apply(null,arguments))}})(b[c])}("randn".split(" "))}(this.jStat,Math),function(a,b){!function(b){for(var c=0;c<b.length;c++)(function(b){a[b]=function(a,b,c){return this instanceof arguments.callee?(this._a=a,this._b=b,this._c=c,this):new arguments.callee(a,b,c)},a.fn[b]=function(c,d,e){var f=a[b](c,d,e);return f.data=this,f},a[b].prototype.sample=function(c){var d=this._a,e=this._b,f=this._c;return c?a.alter(c,function(){return a[b].sample(d,e,f)}):a[b].sample(d,e,f)},function(c){for(var d=0;d<c.length;d++)(function(c){a[b].prototype[c]=function(d){var e=this._a,f=this._b,g=this._c;return d||0===d||(d=this.data),"number"!=typeof d?a.fn.map.call(d,function(d){return a[b][c](d,e,f,g)}):a[b][c](d,e,f,g)}})(c[d])}("pdf cdf inv".split(" ")),function(c){for(var d=0;d<c.length;d++)(function(c){a[b].prototype[c]=function(){return a[b][c](this._a,this._b,this._c)}})(c[d])}("mean median mode variance".split(" "))})(b[c])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" ")),a.extend(a.beta,{pdf:function(c,d,e){return c>1||0>c?0:1==d&&1==e?1:512>d||512>e?b.pow(c,d-1)*b.pow(1-c,e-1)/a.betafn(d,e):b.exp((d-1)*b.log(c)+(e-1)*b.log(1-c)-a.betaln(d,e))},cdf:function(b,c,d){return b>1||0>b?1*(b>1):a.ibeta(b,c,d)},inv:function(b,c,d){return a.ibetainv(b,c,d)},mean:function(a,b){return a/(a+b)},median:function(){throw new Error("median not yet implemented")},mode:function(a,c){return a*c/(b.pow(a+c,2)*(a+c+1))},sample:function(b,c){var d=a.randg(b);return d/(d+a.randg(c))},variance:function(a,c){return a*c/(b.pow(a+c,2)*(a+c+1))}}),a.extend(a.centralF,{pdf:function(c,d,e){return 0>c?void 0:b.sqrt(b.pow(d*c,d)*b.pow(e,e)/b.pow(d*c+e,d+e))/(c*a.betafn(d/2,e/2))},cdf:function(b,c,d){return a.ibeta(c*b/(c*b+d),c/2,d/2)},inv:function(b,c,d){return d/(c*(1/a.ibetainv(b,c/2,d/2)-1))},mean:function(a,b){return b>2?b/(b-2):void 0},mode:function(a,b){return a>2?b*(a-2)/(a*(b+2)):void 0},sample:function(b,c){var d=2*a.randg(b/2),e=2*a.randg(c/2);return d/b/(e/c)},variance:function(a,b){return 4>=b?void 0:2*b*b*(a+b-2)/(a*(b-2)*(b-2)*(b-4))}}),a.extend(a.cauchy,{pdf:function(a,c,d){return d/(b.pow(a-c,2)+b.pow(d,2))/b.PI},cdf:function(a,c,d){return b.atan((a-c)/d)/b.PI+.5},inv:function(a,c,d){return c+d*b.tan(b.PI*(a-.5))},median:function(a){return a},mode:function(a){return a},sample:function(c,d){return a.randn()*b.sqrt(1/(2*a.randg(.5)))*d+c}}),a.extend(a.chisquare,{pdf:function(c,d){return b.exp((d/2-1)*b.log(c)-c/2-d/2*b.log(2)-a.gammaln(d/2))},cdf:function(b,c){return a.gammap(c/2,b/2)},inv:function(b,c){return 2*a.gammapinv(b,.5*c)},mean:function(a){return a},median:function(a){return a*b.pow(1-2/(9*a),3)},mode:function(a){return a-2>0?a-2:0},sample:function(b){return 2*a.randg(b/2)},variance:function(a){return 2*a}}),a.extend(a.exponential,{pdf:function(a,c){return 0>a?0:c*b.exp(-c*a)},cdf:function(a,c){return 0>a?0:1-b.exp(-c*a)},inv:function(a,c){return-b.log(1-a)/c},mean:function(a){return 1/a},median:function(a){return 1/a*b.log(2)},mode:function(){return 0},sample:function(a){return-1/a*b.log(b.random())},variance:function(a){return b.pow(a,-2)}}),a.extend(a.gamma,{pdf:function(c,d,e){return b.exp((d-1)*b.log(c)-c/e-a.gammaln(d)-d*b.log(e))},cdf:function(b,c,d){return a.gammap(c,b/d)},inv:function(b,c,d){return a.gammapinv(b,c)*d},mean:function(a,b){return a*b},mode:function(a,b){return a>1?(a-1)*b:void 0},sample:function(b,c){return a.randg(b)*c},variance:function(a,b){return a*b*b}}),a.extend(a.invgamma,{pdf:function(c,d,e){return b.exp(-(d+1)*b.log(c)-e/c-a.gammaln(d)+d*b.log(e))},cdf:function(b,c,d){return 1-a.gammap(c,d/b)},inv:function(b,c,d){return d/a.gammapinv(1-b,c)},mean:function(a,b){return a>1?b/(a-1):void 0},mode:function(a,b){return b/(a+1)},sample:function(b,c){return c/a.randg(b)},variance:function(a,b){return 2>=a?void 0:b*b/((a-1)*(a-1)*(a-2))}}),a.extend(a.kumaraswamy,{pdf:function(a,c,d){return b.exp(b.log(c)+b.log(d)+(c-1)*b.log(a)+(d-1)*b.log(1-b.pow(a,c)))},cdf:function(a,c,d){return 1-b.pow(1-b.pow(a,c),d)},mean:function(b,c){return c*a.gammafn(1+1/b)*a.gammafn(c)/a.gammafn(1+1/b+c)},median:function(a,c){return b.pow(1-b.pow(2,-1/c),1/a)},mode:function(a,c){return a>=1&&c>=1&&1!==a&&1!==c?b.pow((a-1)/(a*c-1),1/a):void 0},variance:function(){throw new Error("variance not yet implemented")}}),a.extend(a.lognormal,{pdf:function(a,c,d){return b.exp(-b.log(a)-.5*b.log(2*b.PI)-b.log(d)-b.pow(b.log(a)-c,2)/(2*d*d))},cdf:function(c,d,e){return.5+.5*a.erf((b.log(c)-d)/b.sqrt(2*e*e))},inv:function(c,d,e){return b.exp(-1.4142135623730951*e*a.erfcinv(2*c)+d)},mean:function(a,c){return b.exp(a+c*c/2)},median:function(a){return b.exp(a)},mode:function(a,c){return b.exp(a-c*c)},sample:function(c,d){return b.exp(a.randn()*d+c)},variance:function(a,c){return(b.exp(c*c)-1)*b.exp(2*a+c*c)}}),a.extend(a.normal,{pdf:function(a,c,d){return b.exp(-.5*b.log(2*b.PI)-b.log(d)-b.pow(a-c,2)/(2*d*d))},cdf:function(c,d,e){return.5*(1+a.erf((c-d)/b.sqrt(2*e*e)))},inv:function(b,c,d){return-1.4142135623730951*d*a.erfcinv(2*b)+c},mean:function(a){return a},median:function(a){return a},mode:function(a){return a},sample:function(b,c){return a.randn()*c+b},variance:function(a,b){return b*b}}),a.extend(a.pareto,{pdf:function(a,c,d){return c>=a?void 0:d*b.pow(c,d)/b.pow(a,d+1)},cdf:function(a,c,d){return 1-b.pow(c/a,d)},mean:function(a,c){return 1>=c?void 0:c*b.pow(a,c)/(c-1)},median:function(a,c){return a*c*b.SQRT2},mode:function(a){return a},variance:function(a,c){return 2>=c?void 0:a*a*c/(b.pow(c-1,2)*(c-2))}}),a.extend(a.studentt,{pdf:function(c,d){return a.gammafn((d+1)/2)/(b.sqrt(d*b.PI)*a.gammafn(d/2))*b.pow(1+c*c/d,-((d+1)/2))},cdf:function(c,d){var e=d/2;return a.ibeta((c+b.sqrt(c*c+d))/(2*b.sqrt(c*c+d)),e,e)},inv:function(c,d){var e=a.ibetainv(2*b.min(c,1-c),.5*d,.5);return e=b.sqrt(d*(1-e)/e),c>.5?e:-e},mean:function(a){return a>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(c){return a.randn()*b.sqrt(c/(2*a.randg(c/2)))},variance:function(a){return a>2?a/(a-2):a>1?1/0:void 0}}),a.extend(a.weibull,{pdf:function(a,c,d){return 0>a?0:d/c*b.pow(a/c,d-1)*b.exp(-b.pow(a/c,d))},cdf:function(a,c,d){return 0>a?0:1-b.exp(-b.pow(a/c,d))},inv:function(a,c,d){return c*b.pow(-b.log(1-a),1/d)},mean:function(b,c){return b*a.gammafn(1+1/c)},median:function(a,c){return a*b.pow(b.log(2),1/c)},mode:function(a,c){return 1>=c?void 0:a*b.pow((c-1)/c,1/c)},sample:function(a,c){return a*b.pow(-b.log(b.random()),1/c)},variance:function(c,d){return c*c*a.gammafn(1+2/d)-b.pow(this.mean(c,d),2)}}),a.extend(a.uniform,{pdf:function(a,b,c){return b>a||a>c?0:1/(c-b)},cdf:function(a,b,c){return b>a?0:c>a?(a-b)/(c-b):1},mean:function(a,b){return.5*(a+b)},median:function(b,c){return a.mean(b,c)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(a,c){return a/2+c/2+(c/2-a/2)*(2*b.random()-1)},variance:function(a,c){return b.pow(c-a,2)/12}}),a.extend(a.binomial,{pdf:function(c,d,e){return 0===e||1===e?d*e===c?1:0:a.combination(d,c)*b.pow(e,c)*b.pow(1-e,d-c)},cdf:function(b,c,d){var e=[],f=0;if(0>b)return 0;if(c>b){for(;b>=f;f++)e[f]=a.binomial.pdf(f,c,d);return a.sum(e)}return 1}}),a.extend(a.negbin,{pdf:function(c,d,e){return c!==c|0?!1:0>c?0:a.combination(c+d-1,d-1)*b.pow(1-e,c)*b.pow(e,d)},cdf:function(b,c,d){var e=0,f=0;if(0>b)return 0;for(;b>=f;f++)e+=a.negbin.pdf(f,c,d);return e}}),a.extend(a.hypgeom,{pdf:function(c,d,e,f){if(c!==c|0)return!1;if(0>c||e-(d-f)>c)return 0;if(c>f||c>e)return 0;if(2*e>d)return 2*f>d?a.hypgeom.pdf(d-e-f+c,d,d-e,d-f):a.hypgeom.pdf(f-c,d,d-e,f);if(2*f>d)return a.hypgeom.pdf(e-c,d,e,d-f);if(f>e)return a.hypgeom.pdf(c,d,f,e);for(var g=1,h=0,i=0;c>i;i++){for(;g>1&&f>h;)g*=1-e/(d-h),h++;g*=(f-i)*(e-i)/((i+1)*(d-e-f+i+1))}for(;f>h;h++)g*=1-e/(d-h);return b.min(1,b.max(0,g))},cdf:function(c,d,e,f){if(0>c||e-(d-f)>c)return 0;if(c>=f||c>=e)return 1;if(2*e>d)return 2*f>d?a.hypgeom.cdf(d-e-f+c,d,d-e,d-f):1-a.hypgeom.cdf(f-c-1,d,d-e,f);if(2*f>d)return 1-a.hypgeom.cdf(e-c-1,d,e,d-f);if(f>e)return a.hypgeom.cdf(c,d,f,e);for(var g=1,h=1,i=0,j=0;c>j;j++){for(;g>1&&f>i;){var k=1-e/(d-i);h*=k,g*=k,i++}h*=(f-j)*(e-j)/((j+1)*(d-e-f+j+1)),g+=h}for(;f>i;i++)g*=1-e/(d-i);return b.min(1,b.max(0,g))}}),a.extend(a.poisson,{pdf:function(c,d){return b.pow(d,c)*b.exp(-d)/a.factorial(c)},cdf:function(b,c){var d=[],e=0;if(0>b)return 0;for(;b>=e;e++)d.push(a.poisson.pdf(e,c));return a.sum(d)},mean:function(a){return a},variance:function(a){return a},sample:function(a){var c=1,d=0,e=b.exp(-a);do d++,c*=b.random();while(c>e);return d-1}}),a.extend(a.triangular,{pdf:function(a,b,c,d){return b>=c||b>d||d>c?void 0:b>a||a>c?0:d>=a?2*(a-b)/((c-b)*(d-b)):2*(c-a)/((c-b)*(c-d))},cdf:function(a,c,d,e){return c>=d||c>e||e>d?void 0:c>a?0:e>=a?b.pow(a-c,2)/((d-c)*(e-c)):1-b.pow(d-a,2)/((d-c)*(d-e))},mean:function(a,b,c){return(a+b+c)/3},median:function(a,c,d){return(a+c)/2>=d?c-b.sqrt((c-a)*(c-d))/b.sqrt(2):d>(a+c)/2?a+b.sqrt((c-a)*(d-a))/b.sqrt(2):void 0},mode:function(a,b,c){return c},sample:function(a,c,d){var e=b.random();return(d-a)/(c-a)>e?a+b.sqrt(e*(c-a)*(d-a)):c-b.sqrt((1-e)*(c-a)*(c-d))},variance:function(a,b,c){return(a*a+b*b+c*c-a*b-a*c-b*c)/18}})}(this.jStat,Math),function(a,b){var d=Array.prototype.push,e=a.utils.isArray;a.extend({add:function(b,c){return e(c)?(e(c[0])||(c=[c]),a.map(b,function(a,b,d){return a+c[b][d]})):a.map(b,function(a){return a+c})},subtract:function(b,c){return e(c)?(e(c[0])||(c=[c]),a.map(b,function(a,b,d){return a-c[b][d]||0})):a.map(b,function(a){return a-c})},divide:function(b,c){return e(c)?(e(c[0])||(c=[c]),a.multiply(b,a.inv(c))):a.map(b,function(a){return a/c})},multiply:function(b,c){var d,f,g,h,i=b.length,j=b[0].length,k=a.zeros(i,g=e(c)?c[0].length:j),l=0;if(e(c)){for(;g>l;l++)for(d=0;i>d;d++){for(h=0,f=0;j>f;f++)h+=b[d][f]*c[f][l];k[d][l]=h}return 1===i&&1===l?k[0][0]:k}return a.map(b,function(a){return a*c})},dot:function(b,c){e(b[0])||(b=[b]),e(c[0])||(c=[c]);for(var d,f,g=1===b[0].length&&1!==b.length?a.transpose(b):b,h=1===c[0].length&&1!==c.length?a.transpose(c):c,i=[],j=0,k=g.length,l=g[0].length;k>j;j++){for(i[j]=[],d=0,f=0;l>f;f++)d+=g[j][f]*h[j][f];i[j]=d}return 1===i.length?i[0]:i},pow:function(c,d){return a.map(c,function(a){return b.pow(a,d)})},abs:function(c){return a.map(c,function(a){return b.abs(a)})},norm:function(a,c){var d=0,f=0;for(isNaN(c)&&(c=2),e(a[0])&&(a=a[0]);f<a.length;f++)d+=b.pow(b.abs(a[f]),c);return b.pow(d,1/c)},angle:function(c,d){return b.acos(a.dot(c,d)/(a.norm(c)*a.norm(d)))},aug:function(a,b){for(var c=a.slice(),e=0;e<c.length;e++)d.apply(c[e],b[e]);return c},inv:function(b){for(var c,d=b.length,e=b[0].length,f=a.identity(d,e),g=a.gauss_jordan(b,f),h=[],i=0;d>i;i++)for(h[i]=[],c=e-1;c<g[0].length;c++)h[i][c-e]=g[i][c];return h},det:function(a){var b,c=a.length,d=2*c,e=new Array(d),f=c-1,g=d-1,h=f-c+1,i=g,j=0,k=0;if(2===c)return a[0][0]*a[1][1]-a[0][1]*a[1][0];for(;d>j;j++)e[j]=1;for(j=0;c>j;j++){for(b=0;c>b;b++)e[0>h?h+c:h]*=a[j][b],e[c>i?i+c:i]*=a[j][b],h++,i--;h=--f-c+1,i=--g}for(j=0;c>j;j++)k+=e[j];for(;d>j;j++)k-=e[j];return k},gauss_elimination:function(c,d){var e,f,g,h,i=0,j=0,k=c.length,l=c[0].length,m=1,n=0,o=[];for(c=a.aug(c,d),e=c[0].length;k>i;i++){for(f=c[i][i],j=i,h=i+1;l>h;h++)f<b.abs(c[h][i])&&(f=c[h][i],j=h);if(j!=i)for(h=0;e>h;h++)g=c[i][h],c[i][h]=c[j][h],c[j][h]=g;for(j=i+1;k>j;j++)for(m=c[j][i]/c[i][i],h=i;e>h;h++)c[j][h]=c[j][h]-m*c[i][h]}for(i=k-1;i>=0;i--){for(n=0,j=i+1;k-1>=j;j++)n=o[j]*c[i][j];o[i]=(c[i][e-1]-n)/c[i][i]}return o},gauss_jordan:function(d,e){for(var f=a.aug(d,e),g=f.length,h=f[0].length,i=0;g>i;i++){for(var j=i,k=i+1;g>k;k++)b.abs(f[k][i])>b.abs(f[j][i])&&(j=k);var l=f[i];f[i]=f[j],f[j]=l;for(var k=i+1;g>k;k++){c=f[k][i]/f[i][i];for(var m=i;h>m;m++)f[k][m]-=f[i][m]*c}}for(var i=g-1;i>=0;i--){c=f[i][i];for(var k=0;i>k;k++)for(var m=h-1;m>i-1;m--)f[k][m]-=f[i][m]*f[k][i]/c;f[i][i]/=c;for(var m=g;h>m;m++)f[i][m]/=c}return f},lu:function(){throw new Error("lu not yet implemented")},cholesky:function(){throw new Error("cholesky not yet implemented")},gauss_jacobi:function(c,d,e,f){for(var g,h,i,j,k=0,l=0,m=c.length,n=[],o=[],p=[];m>k;k++)for(n[k]=[],o[k]=[],p[k]=[],l=0;m>l;l++)k>l?(n[k][l]=c[k][l],o[k][l]=p[k][l]=0):l>k?(o[k][l]=c[k][l],n[k][l]=p[k][l]=0):(p[k][l]=c[k][l],n[k][l]=o[k][l]=0);for(i=a.multiply(a.multiply(a.inv(p),a.add(n,o)),-1),h=a.multiply(a.inv(p),d),g=e,j=a.add(a.multiply(i,e),h),k=2;b.abs(a.norm(a.subtract(j,g)))>f;)g=j,j=a.add(a.multiply(i,g),h),k++;return j},gauss_seidel:function(c,d,e,f){for(var g,h,i,j,k,l=0,m=c.length,n=[],o=[],p=[];m>l;l++)for(n[l]=[],o[l]=[],p[l]=[],g=0;m>g;g++)l>g?(n[l][g]=c[l][g],o[l][g]=p[l][g]=0):g>l?(o[l][g]=c[l][g],n[l][g]=p[l][g]=0):(p[l][g]=c[l][g],n[l][g]=o[l][g]=0);for(j=a.multiply(a.multiply(a.inv(a.add(p,n)),o),-1),i=a.multiply(a.inv(a.add(p,n)),d),h=e,k=a.add(a.multiply(j,e),i),l=2;b.abs(a.norm(a.subtract(k,h)))>f;)h=k,k=a.add(a.multiply(j,h),i),l+=1;return k},SOR:function(c,d,e,f,g){for(var h,i,j,k,l,m=0,n=c.length,o=[],p=[],q=[];n>m;m++)for(o[m]=[],p[m]=[],q[m]=[],h=0;n>h;h++)m>h?(o[m][h]=c[m][h],p[m][h]=q[m][h]=0):h>m?(p[m][h]=c[m][h],o[m][h]=q[m][h]=0):(q[m][h]=c[m][h],o[m][h]=p[m][h]=0);for(k=a.multiply(a.inv(a.add(q,a.multiply(o,g))),a.subtract(a.multiply(q,1-g),a.multiply(p,g))),j=a.multiply(a.multiply(a.inv(a.add(q,a.multiply(o,g))),d),g),i=e,l=a.add(a.multiply(k,e),j),m=2;b.abs(a.norm(a.subtract(l,i)))>f;)i=l,l=a.add(a.multiply(k,i),j),m++;return l},householder:function(c){for(var d,e,f,g,h,i=c.length,j=c[0].length,k=0,l=[],m=[];i-1>k;k++){for(d=0,g=k+1;j>g;g++)d+=c[g][k]*c[g][k];for(h=c[k+1][k]>0?-1:1,d=h*b.sqrt(d),e=b.sqrt((d*d-c[k+1][k]*d)/2),l=a.zeros(i,1),l[k+1][0]=(c[k+1][k]-d)/(2*e),f=k+2;i>f;f++)l[f][0]=c[f][k]/(2*e);m=a.subtract(a.identity(i,j),a.multiply(a.multiply(l,a.transpose(l)),2)),c=a.multiply(m,a.multiply(c,m))}return c},QR:function(c,d){for(var e,f,g,h,i,j,k=c.length,l=c[0].length,m=0,n=[],o=[],p=[];k-1>m;m++){for(f=0,e=m+1;l>e;e++)f+=c[e][m]*c[e][m];for(i=c[m+1][m]>0?-1:1,f=i*b.sqrt(f),g=b.sqrt((f*f-c[m+1][m]*f)/2),n=a.zeros(k,1),n[m+1][0]=(c[m+1][m]-f)/(2*g),h=m+2;k>h;h++)n[h][0]=c[h][m]/(2*g);o=a.subtract(a.identity(k,l),a.multiply(a.multiply(n,a.transpose(n)),2)),c=a.multiply(o,c),d=a.multiply(o,d)}for(m=k-1;m>=0;m--){for(j=0,e=m+1;l-1>=e;e++)j=p[e]*c[m][e];p[m]=d[m][0]/c[m][m]}return p},jacobi:function(c){for(var d,e,f,g,h,i,j,k,l=1,m=0,n=c.length,o=a.identity(n,n),p=[];1===l;){for(m++,i=c[0][1],g=0,h=1,e=0;n>e;e++)for(f=0;n>f;f++)e!=f&&i<b.abs(c[e][f])&&(i=b.abs(c[e][f]),g=e,h=f);for(j=c[g][g]===c[h][h]?c[g][h]>0?b.PI/4:-b.PI/4:b.atan(2*c[g][h]/(c[g][g]-c[h][h]))/2,k=a.identity(n,n),k[g][g]=b.cos(j),k[g][h]=-b.sin(j),k[h][g]=b.sin(j),k[h][h]=b.cos(j),o=a.multiply(o,k),d=a.multiply(a.multiply(a.inv(k),c),k),c=d,l=0,e=1;n>e;e++)for(f=1;n>f;f++)e!=f&&b.abs(c[e][f])>.001&&(l=1)}for(e=0;n>e;e++)p.push(c[e][e]);return[o,p]},rungekutta:function(a,b,c,d,e,f){var g,h,i,j,k;if(2===f)for(;c>=d;)g=b*a(d,e),h=b*a(d+b,e+g),i=e+(g+h)/2,e=i,d+=b;if(4===f)for(;c>=d;)g=b*a(d,e),h=b*a(d+b/2,e+g/2),j=b*a(d+b/2,e+h/2),k=b*a(d+b,e+j),i=e+(g+2*h+2*j+k)/6,e=i,d+=b;return e},romberg:function(a,c,d,e){for(var f,g,h,i,j,k=0,l=(d-c)/2,m=[],n=[],o=[];e/2>k;){for(j=a(c),h=c,i=0;d>=h;h+=l,i++)m[i]=h;for(f=m.length,h=1;f-1>h;h++)j+=(h%2!==0?4:2)*a(m[h]);j=l/3*(j+a(d)),o[k]=j,l/=2,k++}for(g=o.length,f=1;1!==g;){for(h=0;g-1>h;h++)n[h]=(b.pow(4,f)*o[h+1]-o[h])/(b.pow(4,f)-1);g=n.length,o=n,n=[],f++}return o},richardson:function(a,c,d,e){function f(a,b){for(var c,d=0,e=a.length;e>d;d++)a[d]===b&&(c=d);return c}for(var g,h,i,j,k,l=(a.length,b.abs(d-a[f(a,d)+1])),m=0,n=[],o=[];e>=l;)g=f(a,d+e),h=f(a,d),n[m]=(c[g]-2*c[h]+c[2*h-g])/(e*e),e/=2,m++;for(j=n.length,i=1;1!=j;){for(k=0;j-1>k;k++)o[k]=(b.pow(4,i)*n[k+1]-n[k])/(b.pow(4,i)-1);j=o.length,n=o,o=[],i++}return n},simpson:function(a,b,c,d){for(var e,f=(c-b)/d,g=a(b),h=[],i=b,j=0,k=1;c>=i;i+=f,j++)h[j]=i;for(e=h.length;e-1>k;k++)g+=(k%2!==0?4:2)*a(h[k]);return f/3*(g+a(c))},hermite:function(a,b,c,d){for(var e,f=a.length,g=0,h=0,i=[],j=[],k=[],l=[];f>h;h++){for(i[h]=1,e=0;f>e;e++)h!=e&&(i[h]*=(d-a[e])/(a[h]-a[e]));for(j[h]=0,e=0;f>e;e++)h!=e&&(j[h]+=1/(a[h]-a[e]));k[h]=(1-2*(d-a[h])*j[h])*i[h]*i[h],l[h]=(d-a[h])*i[h]*i[h],g+=k[h]*b[h]+l[h]*c[h]}return g},lagrange:function(a,b,c){for(var d,e,f=0,g=0,h=a.length;h>g;g++){for(e=b[g],d=0;h>d;d++)g!=d&&(e*=(c-a[d])/(a[g]-a[d]));f+=e}return f},cubic_spline:function(b,c,d){for(var e,f=b.length,g=0,h=[],i=[],j=[],k=[],l=[],m=[],n=[];f-1>g;g++)l[g]=b[g+1]-b[g];for(j[0]=0,g=1;f-1>g;g++)j[g]=3/l[g]*(c[g+1]-c[g])-3/l[g-1]*(c[g]-c[g-1]);for(g=1;f-1>g;g++)h[g]=[],i[g]=[],h[g][g-1]=l[g-1],h[g][g]=2*(l[g-1]+l[g]),h[g][g+1]=l[g],i[g][0]=j[g];for(k=a.multiply(a.inv(h),i),e=0;f-1>e;e++)m[e]=(c[e+1]-c[e])/l[e]-l[e]*(k[e+1][0]+2*k[e][0])/3,n[e]=(k[e+1][0]-k[e][0])/(3*l[e]);for(e=0;f>e&&!(b[e]>d);e++);return e-=1,c[e]+(d-b[e])*m[e]+a.sq(d-b[e])*k[e]+(d-b[e])*a.sq(d-b[e])*n[e]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(b){var c,d,e=b.length,f=b[0].length,g=0,h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[],q=[];for(g=0;e>g;g++)h[g]=a.sum(b[g])/f;for(g=0;f>g;g++)for(n[g]=[],c=0;e>c;c++)n[g][c]=b[c][g]-h[c];for(n=a.transpose(n),g=0;e>g;g++)for(o[g]=[],c=0;e>c;c++)o[g][c]=a.dot([n[g]],[n[c]])/(f-1);for(j=a.jacobi(o),p=j[0],i=j[1],q=a.transpose(p),g=0;g<i.length;g++)for(c=g;c<i.length;c++)i[g]<i[c]&&(d=i[g],i[g]=i[c],i[c]=d,k=q[g],q[g]=q[c],q[c]=k);for(m=a.transpose(n),g=0;e>g;g++)for(l[g]=[],c=0;c<m.length;c++)l[g][c]=a.dot([q[g]],[m[c]]);return[b,i,q,l]}}),function(b){for(var c=0;c<b.length;c++)(function(b){a.fn[b]=function(c,d){var e=this;return d?(setTimeout(function(){d.call(e,a.fn[b].call(e,c))},15),this):"number"==typeof a[b](this,c)?a[b](this,c):a(a[b](this,c))}})(b[c])}("add divide multiply subtract dot pow abs norm angle".split(" "))}(this.jStat,Math),function(a,b){var c=[].slice,d=a.utils.isNumber;a.extend({zscore:function(){var b=c.call(arguments);return d(b[1])?(b[0]-b[1])/b[2]:(b[0]-a.mean(b[1]))/a.stdev(b[1],b[2])},ztest:function(){var e=c.call(arguments);if(4===e.length){if(d(e[1])){var f=a.zscore(e[0],e[1],e[2]);return 1===e[3]?a.normal.cdf(-b.abs(f),0,1):2*a.normal.cdf(-b.abs(f),0,1)}var f=e[0];return 1===e[2]?a.normal.cdf(-b.abs(f),0,1):2*a.normal.cdf(-b.abs(f),0,1)}var f=a.zscore(e[0],e[1],e[3]);return 1===e[1]?a.normal.cdf(-b.abs(f),0,1):2*a.normal.cdf(-b.abs(f),0,1)}}),a.extend(a.fn,{zscore:function(a,b){return(a-this.mean())/this.stdev(b)},ztest:function(c,d,e){var f=b.abs(this.zscore(c,e));return 1===d?a.normal.cdf(-f,0,1):2*a.normal.cdf(-f,0,1)}}),a.extend({tscore:function(){var d=c.call(arguments);return 4===d.length?(d[0]-d[1])/(d[2]/b.sqrt(d[3])):(d[0]-a.mean(d[1]))/(a.stdev(d[1],!0)/b.sqrt(d[1].length))},ttest:function(){var e,f=c.call(arguments);return 5===f.length?(e=b.abs(a.tscore(f[0],f[1],f[2],f[3])),1===f[4]?a.studentt.cdf(-e,f[3]-1):2*a.studentt.cdf(-e,f[3]-1)):d(f[1])?(e=b.abs(f[0]),1==f[2]?a.studentt.cdf(-e,f[1]-1):2*a.studentt.cdf(-e,f[1]-1)):(e=b.abs(a.tscore(f[0],f[1])),1==f[2]?a.studentt.cdf(-e,f[1].length-1):2*a.studentt.cdf(-e,f[1].length-1))}}),a.extend(a.fn,{tscore:function(a){return(a-this.mean())/(this.stdev(!0)/b.sqrt(this.cols()))},ttest:function(c,d){return 1===d?1-a.studentt.cdf(b.abs(this.tscore(c)),this.cols()-1):2*a.studentt.cdf(-b.abs(this.tscore(c)),this.cols()-1)}}),a.extend({anovafscore:function(){var d,e,f,g,h,i,j,k,l=c.call(arguments);if(1===l.length){for(h=new Array(l[0].length),j=0;j<l[0].length;j++)h[j]=l[0][j];l=h}if(2===l.length)return a.variance(l[0])/a.variance(l[1]);for(e=new Array,j=0;j<l.length;j++)e=e.concat(l[j]);for(f=a.mean(e),d=0,j=0;j<l.length;j++)d+=l[j].length*b.pow(a.mean(l[j])-f,2);for(d/=l.length-1,i=0,j=0;j<l.length;j++)for(g=a.mean(l[j]),k=0;k<l[j].length;k++)i+=b.pow(l[j][k]-g,2);return i/=e.length-l.length,d/i},anovaftest:function(){var b,e,f,g,h=c.call(arguments);if(d(h[0]))return 1-a.centralF.cdf(h[0],h[1],h[2]);for(anovafscore=a.anovafscore(h),b=h.length-1,f=0,g=0;g<h.length;g++)f+=h[g].length;return e=f-b-1,1-a.centralF.cdf(anovafscore,b,e)},ftest:function(b,c,d){return 1-a.centralF.cdf(b,c,d)}}),a.extend(a.fn,{anovafscore:function(){return a.anovafscore(this.toArray())},anovaftes:function(){var b,c=0;for(b=0;b<this.length;b++)c+=this[b].length;return a.ftest(this.anovafscore(),this.length-1,c-this.length)}}),a.extend({normalci:function(){var d,e=c.call(arguments),f=new Array(2);return d=b.abs(4===e.length?a.normal.inv(e[1]/2,0,1)*e[2]/b.sqrt(e[3]):a.normal.inv(e[1]/2,0,1)*a.stdev(e[2])/b.sqrt(e[2].length)),f[0]=e[0]-d,f[1]=e[0]+d,f},tci:function(){var d,e=c.call(arguments),f=new Array(2);return d=b.abs(4===e.length?a.studentt.inv(e[1]/2,e[3]-1)*e[2]/b.sqrt(e[3]):a.studentt.inv(e[1]/2,e[2].length-1)*a.stdev(e[2],!0)/b.sqrt(e[2].length)),f[0]=e[0]-d,f[1]=e[0]+d,f},significant:function(a,b){return b>a}}),a.extend(a.fn,{normalci:function(b,c){return a.normalci(b,c,this.toArray())},tci:function(b,c){return a.tci(b,c,this.toArray())}})}(this.jStat,Math)}])}),function(a){a.Cell=function(a){return this.hasFormula=!1,this.isNumber=!1,this.set(a),this},a.Cell.prototype.value=function(a){return arguments.length>0?void this.set(a):this.get()},a.Cell.prototype.get=function(){return this.hasFormula?this.content():this.content},a.Cell.prototype.set=function(a){this.hasFormula="function"==typeof a?!0:!1;var b=parseFloat(a);this.content=isNaN(b)?a:b}}(window.sheetCalc=window.sheetCalc||{});